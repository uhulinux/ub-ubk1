diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/FAQ/i4lfaq.sgml isdn4k-utils-v3.3/FAQ/i4lfaq.sgml
--- isdn4k-utils-v3.2p1/FAQ/i4lfaq.sgml	2002-07-18 00:00:27.000000000 +0000
+++ isdn4k-utils-v3.3/FAQ/i4lfaq.sgml	2003-07-14 19:42:49.000000000 +0000
@@ -4,7 +4,7 @@
 
 <title>FAQ for isdn4linux
 <author>Matthias Hessler (<tt><htmlurl url="mailto:hessler@isdn4linux.de" name="hessler@isdn4linux.de"></tt>)
-<date>v2.0.67, 14. July 2002
+<date>v2.0.78, 14. July 2003
 <abstract>
 If you are reading this FAQ online, you may consider downloading the whole
 thing, and reading it offline (much cheaper). To download the latest
@@ -90,9 +90,10 @@
 Generally, isdn4linux can control ISDN cards that are connected to the PC's
 ISA or PCI bus. Also a few PCMCIA cards are supported. However, isdn4linux can
 <bf/not/ make use of any devices connected via a serial or parallel
-interface (which are called 'terminal adaptors'), with only one exception:
-the Creatix/Teles S0 box for the parallel port. For more details on which
-cards are supported see section <ref id="hardware" name="hardware">.
+interface (which are called 'terminal adaptors'), with only a few exceptions:
+the Creatix/Teles S0 box for the parallel port, and the Gazel 128 USB.
+For more details on which cards are supported see section
+<ref id="hardware" name="hardware">.
 
 <sect1> general_features: What features are supported by isdn4linux?  
 <label id="general_features">
@@ -466,7 +467,7 @@
 the Internet with &dquot;netdate&dquot; or &dquot;rdate&dquot;.
 Check out the following urls on information about using time servers:
 <itemize>
-<item> <url url="http://www.eecis.udel.edu/~mills/ntp/servers.htm">
+<item> <url url="http://www.eecis.udel.edu/~mills/ntp/servers.html">
 <item> In German: <url url="http://www.ptb.de/deutsch/org/4/43/433/verb.htm">
 <item> In German: <url url="http://www.ptb.de/deutsch/aktuell/pi/pi00/pi0100.htm">
 </itemize>
@@ -627,6 +628,20 @@
 will be delayed by 3 seconds). If the ABC-extensions are not installed,
 isdnlog prints hints to the log file, which provider would have been chosen.
 
+<sect1> feature_internetdialin: Can isdn4linux be setup such that it  
+dials into the Internet, whenever I call it via telephone?  
+<label id="feature_internetdialin">
+<p>
+Yes, this is possible with isdnlog. You have to configure isdnlog such that
+it can execute a script whenever someone dials in. In the script you can
+check for the correct telephone number, then trigger the dialin.
+To access your computer then over the internet, you can then access it via
+its ip address. In case of dynamic ip address assignment, you probably want
+to store the new ip somehow. Storage in a html page or via dynamic DNS
+may be good possibilities. If you understand German, there was an article
+about exactly this setup in ct 18/2002, page 204 (Bei Anruf Internet - Handy-
+Anruf l&ouml;st Internet-Einwahl aus).
+
 <sect1> feature_future: Which features are planned for the future?  
 <label id="feature_future">
 <p>
@@ -679,6 +694,8 @@
 <item>ct 7/2001, page 228: <tt>Des Surfers Bastelstunde: Mobilfunktechnik
 HSCSD aussch&ouml;pfen</tt>
 (also contains information on dial-in configuration without HSCSD).
+<item>ct 15/2002, page 204: <tt>Bei Anruf Internet: Handy-Anruf l&ouml;st
+Internet-Einwahl aus</tt>
 </itemize>
 
 Also have a look at question <ref id="config_links" name="config_links"> for
@@ -885,6 +902,9 @@
 <item>Xircom Cardbus Eth10/100+ (PCMCIA) is not supported by isdn4linux,
 but you can use it like an active external ISDN terminal adapter
 (requires the xircom and serial driver).
+<item>Gazel 128 USB from BeWAN Systems is supported as hisax_st5481 module.
+For configuration hints have a look at:
+<url url="http://www.posern.org/my-prjs/isdn/">.
 </itemize>
 
 In Germany: every ISDN card which German Telekom distributed in the past is
@@ -941,24 +961,37 @@
 If you want to buy an active card, then the developers would recommend
 the PCI Server from Eicon. The reason is that it can fax on both channels
 with AT class 2 commands, and includes a V.90 modem.
-The AVM B1 works also very well, but can only fax on one channel.
+The AVM B1 works also very well, and is likewise recommended. Old versions
+(up to 3.0) could receive faxes only on one channel, but since AVM B1 PCI V4
+all channels can be used simulateously for sending and receiving faxes.
+See also question <ref id="hardware_avmb1" name="hardware_avmb1"> for more details about this card.
 The Hypercope cards have also been reported to work very well, servicing
 all available channels for faxing. However, they require a hardware update
-for faxing and their linux driver is fairly new.
+for faxing and their linux driver is fairly new. See also question
+<ref id="hardware_hypercope" name="hardware_hypercope"> for more details about this card.
 
 If faxing is important for you, but you don't want to spent the money for an
 active card, then a card with ISAR chipset may work well for you, e.g.
 Sedlbauer Speedfax+ (in Germany you may be able to buy it at Conrads).
 
+And if you want to buy a USB terminal adapter, then the Gazel 128 USB from
+BeWAN Systems <url url="http://www.bewan.com"> has been reported to work fine
+with the hisax_st5481 module.
+
 <sect1> hardware_external: Does isdn4linux support external terminal adapters?  
 <label id="hardware_external">
 <p>
-No, but it doesn't need to. Terminal adapters are designed to behave
+Generally not, but it doesn't need to. Terminal adapters are designed to behave
 either like a modem or like a network card. Linux already supports both
 modems and network cards without isdn4linux - so no special ISDN driver
 is necessary (which usually greatly simplifies the configuration).
 For example, have a look at the dialout program wvdial.
 
+However, there is (at least) one exception. The Gazel 128 USB from BeWAN
+System in France <url url="http://www.bewan.com"> has been reported to
+work fine with the hisax_st5481 module. For configuration hints
+have a look at: <url url="http://www.posern.org/my-prjs/isdn/">.
+
 <sect1> hardware_cabeling: How should I wire my ISDN cables?  
 <label id="hardware_cabeling">
 <p>
@@ -4123,6 +4156,12 @@
 <code>
 isdnctrl hangup slave
 </code>
+When using manual control please ensure that the slave device is shut down
+before the master device. Currently (August 2002) there is a hard-to-fix bug
+in the MPPP code which will cause a crash on the next dialout. A patch exists
+which cures the symptoms to prevent the crash (see mailing list). However,
+since the dialout will fail in any case it is best to avoid this situation
+altogether by using the proper shutdown sequence.
 
 With syncPPP, there is no automatic activation of slave devices, they have to
 be added and removed. However, there is the program <tt>ibod</tt> available,
@@ -4157,6 +4196,37 @@
 and the kernel can not find a corresponding network device. You can safely
 ignore this information message, MPPP should work nevertheless.
 
+<sect1> 2channel_multiplenumbers: How can I set up multiple number when  
+using MPPP?  
+<label id="2channel_multiplenumbers">
+<p>
+Master and slave device are fully independent of each other, except for using
+the same network device to deliver packets. Setting up multiple number for
+master and slave devices will result in synchronized dialout (to the same
+number). Therefore it is best to give the slave device no number by default
+and set up the slave with the same number as the master in some ip-up script.
+
+<sect1> 2channel_freebchannel: How could I set up isdn4linux to free the  
+second B-channel if a phone call comes in?  
+<label id="2channel_freebchannel">
+<p>
+Well, this is a tough one, due to technical limits. Even if isdn4linux freed
+a B-channel, the exchange would not repeat the setup call. Therefore, the
+phone would not ring. The phone only signals a second incoming phone call if
+you are on the phone with another call that could be suspended.
+
+One option would be that isdn4linux frees one B-channel, then takes the call,
+and transfers it to the phone via ECT (explicit call transfer); however, this
+feature requires proprietary (unknown) protocol extensions, and is usually
+only available behind large private exchanges - therefore not implemented
+in isdn4linux.
+Another option is that isdn4linux frees one B-channel, takes the call, then
+suspends it. However, the user would have to know to resume it without any
+phone ringing.
+The most sensible option is that you handle it will a phone application
+making use of isdn4linux. Possibly ant-phone could be used for such a purpose:
+<tt><url url="http://www.antcom.de/"></tt>
+
 
 <!-- Pecularities of your counterpart (remote device)
 -->
@@ -4571,8 +4641,35 @@
 (CBCP)?  
 <label id="callback_microsoft">
 <p>
-No, this is not implemented in isdn4linux. Since it is not trivial to
-implement, there are currently no plans to implement it.
+Yes, this is implemented in ipppd. To enable it you have to set the
+parameter &dquot;callback 6&dquot; as an ipppd option on the client side
+(server side not tested so far - please let me know if you have some feedback
+on using CBCP as a server).
+To start the callback trigger it from the client via:
+<code>
+isdnctrl cbdelay &lt;device&gt; 5
+isdnctrl callback &lt;device&gt; out
+</code>
+Please note that the man page may be confusing about the callback parameter for
+ipppd. Please note these hints from NOTES.IPPPD:
+<verb>
+- 'callback type[,message]' enables the callback feature
+  also UNTESTED!
+  ie: 'callback 0'       -> simple callback (info via auth. etc.)
+      'callback 3,12346' -> us E.164 (tel) number 123456 for callback
+      'callback 6' is different. This value means, that the whole negotiation
+  is done with a seperate protocol after the authentification phase. Currently
+  it's not possible to set any options in this case. The ipppd accepts
+  everything from the remote side.
+</verb>
+If you have a Red Hat distribution, setting the following parameters in
+ifcfg-ippp0 might do the trick:
+<code>
+CALLBACK=out
+CBDELAY=5
+CBCP=on
+</code>
+
 
 
 <!-- Isdnlog
@@ -5000,8 +5097,14 @@
 isdn4linux.
 <item>Elsa Quickstep series cards (new name Microlink PCI)
 <item>Eicon Diva 2.01 PCI
+<item>Teles 16.3 ISA (with Siemens chipset)
+<item>Sedlbauer Speedfax+ PCI
 <item>Passive cards: all cards based on the HFC-S chipset.
 </itemize>
+Actually, since April 2000 the rules for certification have changed. Now
+the producer of an ISDN card has to do only hardware tests, the driver is
+not part of the certification anymore. This applies to the whole European
+Community.
 
 <sect> 1tr6: German Pecularities for 1TR6 
 <label id="1tr6">
@@ -5134,7 +5237,7 @@
 
 See Documentation/isdn/README.HiSax for details on how to set up your
 system with HiSax (protocol type is 4, give SPID together with your own
-number).
+number in the form of &lt;OWNNUMBER&gt;:&lt;SPID&gt;).
 
 Quite some time ago, the firm &dquot;Spellcaster&dquot; has written their own
 isdn4linux driver for their (active) cards. Both BRI and PRI cards are
@@ -5201,6 +5304,11 @@
 By the way: for a BT Speedway card try to select AVM Fritz card (either
 ISA or PCI - depends on what you got; see question <ref id="hardware_fritz" name="hardware_fritz">).
 
+Since about November 2001, all BT home highway and possibly Business Highway
+NTE boxes come with a built in USB terminal adapter. This terminal adapter is
+based on the ST-5481 chipset. Load the module st5481 for this device, then
+set up your isdn configuration with isdnctrl.
+
 Also, check out <url url="http://www.wurtel.demon.nl/i4l-howto-uk.html">.
 
 <sect> misc: Miscellaneous  
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/Makefile isdn4k-utils-v3.3/Makefile
--- isdn4k-utils-v3.2p1/Makefile	2002-07-19 19:03:49.000000000 +0000
+++ isdn4k-utils-v3.3/Makefile	2003-07-28 19:50:13.000000000 +0000
@@ -1,11 +1,11 @@
-# $Id: Makefile,v 1.52 2002/07/19 19:03:49 keil Exp $
+# $Id: Makefile,v 1.55 2003/07/28 19:50:13 keil Exp $
 #
 # Toplevel Makefile for isdn4k-utils
 #
 
 .EXPORT_ALL_VARIABLES:
 
-export I4LVERSION = 3.2p1
+export I4LVERSION = 3.3
 
 all:	do-it-all
 
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/capi20/Makefile.am isdn4k-utils-v3.3/capi20/Makefile.am
--- isdn4k-utils-v3.2p1/capi20/Makefile.am	2002-07-06 00:26:12.000000000 +0000
+++ isdn4k-utils-v3.3/capi20/Makefile.am	2003-06-16 12:08:23.000000000 +0000
@@ -18,5 +18,7 @@
 
 $(OBJECTS): libtool
 
+export SED
+
 libtool: $(LIBTOOL_DEPS)
 	$(SHELL) ./config.status --recheck
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/capi20/Makefile.in isdn4k-utils-v3.3/capi20/Makefile.in
--- isdn4k-utils-v3.2p1/capi20/Makefile.in	2002-07-06 00:26:12.000000000 +0000
+++ isdn4k-utils-v3.3/capi20/Makefile.in	2003-06-16 12:08:23.000000000 +0000
@@ -1,4 +1,4 @@
-# Makefile.in generated automatically by automake 1.4 from Makefile.am
+# Makefile.in generated automatically by automake 1.4-p4 from Makefile.am
 
 # Copyright (C) 1994, 1995-8, 1999 Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
@@ -62,14 +62,19 @@
 AS = @AS@
 CC = @CC@
 DLLTOOL = @DLLTOOL@
+ECHO = @ECHO@
+EXEEXT = @EXEEXT@
 INSTALL = @INSTALL@
 LIBTOOL = @LIBTOOL@
 LIBTOOL_DEPS = @LIBTOOL_DEPS@
 LN_S = @LN_S@
 MAKEINFO = @MAKEINFO@
 OBJDUMP = @OBJDUMP@
+OBJEXT = @OBJEXT@
 PACKAGE = @PACKAGE@
 RANLIB = @RANLIB@
+SED = @SED@
+STRIP = @STRIP@
 VERSION = @VERSION@
 
 AUTOMAKE_OPTIONS = no-dependencies foreign
@@ -96,7 +101,7 @@
 LDFLAGS = @LDFLAGS@
 LIBS = @LIBS@
 libcapi20dyn_a_LIBADD = 
-libcapi20dyn_a_OBJECTS =  capidyn.o
+libcapi20dyn_a_OBJECTS =  capidyn.$(OBJEXT)
 AR = ar
 LTLIBRARIES =  $(lib_LTLIBRARIES)
 
@@ -123,7 +128,7 @@
 
 all: all-redirect
 .SUFFIXES:
-.SUFFIXES: .S .c .lo .o .s
+.SUFFIXES: .S .c .lo .o .obj .s
 $(srcdir)/Makefile.in: Makefile.am $(top_srcdir)/configure.in $(ACLOCAL_M4) 
 	cd $(top_srcdir) && $(AUTOMAKE) --foreign Makefile
 
@@ -134,7 +139,7 @@
 $(ACLOCAL_M4):  configure.in 
 	cd $(srcdir) && $(ACLOCAL)
 
-config.status: $(srcdir)/configure $(CONFIG_STATUS_DEPENDENCIES)
+config.status: $(srcdir)/configure.in $(CONFIG_STATUS_DEPENDENCIES)
 	$(SHELL) ./config.status --recheck
 $(srcdir)/configure: $(srcdir)/configure.in $(ACLOCAL_M4) $(CONFIGURE_DEPENDENCIES)
 	cd $(srcdir) && $(AUTOCONF)
@@ -174,6 +179,11 @@
 .c.o:
 	$(COMPILE) -c $<
 
+# FIXME: We should only use cygpath when building on Windows,
+# and only if it is available.
+.c.obj:
+	$(COMPILE) -c `cygpath -w $<`
+
 .s.o:
 	$(COMPILE) -c $<
 
@@ -182,6 +192,7 @@
 
 mostlyclean-compile:
 	-rm -f *.o core *.core
+	-rm -f *.$(OBJEXT)
 
 clean-compile:
 
@@ -425,6 +436,8 @@
 
 $(OBJECTS): libtool
 
+export SED
+
 libtool: $(LIBTOOL_DEPS)
 	$(SHELL) ./config.status --recheck
 
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/capi20/aclocal.m4 isdn4k-utils-v3.3/capi20/aclocal.m4
--- isdn4k-utils-v3.2p1/capi20/aclocal.m4	2000-10-05 20:45:21.000000000 +0000
+++ isdn4k-utils-v3.3/capi20/aclocal.m4	2003-06-16 12:08:23.000000000 +0000
@@ -1,4 +1,4 @@
-dnl aclocal.m4 generated automatically by aclocal 1.4
+dnl aclocal.m4 generated automatically by aclocal 1.4-p4
 
 dnl Copyright (C) 1994, 1995-8, 1999 Free Software Foundation, Inc.
 dnl This file is free software; the Free Software Foundation
@@ -102,81 +102,72 @@
 fi
 AC_SUBST($1)])
 
+# libtool.m4 - Configure libtool for the host system. -*-Shell-script-*-
 
-# serial 40 AC_PROG_LIBTOOL
-AC_DEFUN(AC_PROG_LIBTOOL,
-[AC_REQUIRE([AC_LIBTOOL_SETUP])dnl
-
-# Save cache, so that ltconfig can load it
-AC_CACHE_SAVE
-
-# Actually configure libtool.  ac_aux_dir is where install-sh is found.
-CC="$CC" CFLAGS="$CFLAGS" CPPFLAGS="$CPPFLAGS" \
-LD="$LD" LDFLAGS="$LDFLAGS" LIBS="$LIBS" \
-LN_S="$LN_S" NM="$NM" RANLIB="$RANLIB" \
-DLLTOOL="$DLLTOOL" AS="$AS" OBJDUMP="$OBJDUMP" \
-${CONFIG_SHELL-/bin/sh} $ac_aux_dir/ltconfig --no-reexec \
-$libtool_flags --no-verify $ac_aux_dir/ltmain.sh $lt_target \
-|| AC_MSG_ERROR([libtool configure failed])
+# serial 46 AC_PROG_LIBTOOL
 
-# Reload cache, that may have been modified by ltconfig
-AC_CACHE_LOAD
+AC_DEFUN([AC_PROG_LIBTOOL],
+[AC_REQUIRE([AC_LIBTOOL_SETUP])dnl
 
 # This can be used to rebuild libtool when needed
-LIBTOOL_DEPS="$ac_aux_dir/ltconfig $ac_aux_dir/ltmain.sh"
+LIBTOOL_DEPS="$ac_aux_dir/ltmain.sh"
 
 # Always use our own libtool.
 LIBTOOL='$(SHELL) $(top_builddir)/libtool'
 AC_SUBST(LIBTOOL)dnl
 
-# Redirect the config.log output again, so that the ltconfig log is not
-# clobbered by the next message.
-exec 5>>./config.log
+# Prevent multiple expansion
+define([AC_PROG_LIBTOOL], [])
 ])
 
-AC_DEFUN(AC_LIBTOOL_SETUP,
+AC_DEFUN([AC_LIBTOOL_SETUP],
 [AC_PREREQ(2.13)dnl
 AC_REQUIRE([AC_ENABLE_SHARED])dnl
 AC_REQUIRE([AC_ENABLE_STATIC])dnl
 AC_REQUIRE([AC_ENABLE_FAST_INSTALL])dnl
 AC_REQUIRE([AC_CANONICAL_HOST])dnl
 AC_REQUIRE([AC_CANONICAL_BUILD])dnl
-AC_REQUIRE([AC_PROG_RANLIB])dnl
 AC_REQUIRE([AC_PROG_CC])dnl
 AC_REQUIRE([AC_PROG_LD])dnl
+AC_REQUIRE([AC_PROG_LD_RELOAD_FLAG])dnl
 AC_REQUIRE([AC_PROG_NM])dnl
+AC_REQUIRE([LT_AC_PROG_SED])dnl
+
 AC_REQUIRE([AC_PROG_LN_S])dnl
+AC_REQUIRE([AC_DEPLIBS_CHECK_METHOD])dnl
+AC_REQUIRE([AC_OBJEXT])dnl
+AC_REQUIRE([AC_EXEEXT])dnl
 dnl
 
-case "$target" in
-NONE) lt_target="$host" ;;
-*) lt_target="$target" ;;
+_LT_AC_PROG_ECHO_BACKSLASH
+# Only perform the check for file, if the check method requires it
+case $deplibs_check_method in
+file_magic*)
+  if test "$file_magic_cmd" = '$MAGIC_CMD'; then
+    AC_PATH_MAGIC
+  fi
+  ;;
 esac
 
-# Check for any special flags to pass to ltconfig.
-libtool_flags="--cache-file=$cache_file"
-test "$enable_shared" = no && libtool_flags="$libtool_flags --disable-shared"
-test "$enable_static" = no && libtool_flags="$libtool_flags --disable-static"
-test "$enable_fast_install" = no && libtool_flags="$libtool_flags --disable-fast-install"
-test "$ac_cv_prog_gcc" = yes && libtool_flags="$libtool_flags --with-gcc"
-test "$ac_cv_prog_gnu_ld" = yes && libtool_flags="$libtool_flags --with-gnu-ld"
-ifdef([AC_PROVIDE_AC_LIBTOOL_DLOPEN],
-[libtool_flags="$libtool_flags --enable-dlopen"])
+AC_CHECK_TOOL(RANLIB, ranlib, :)
+AC_CHECK_TOOL(STRIP, strip, :)
+
+ifdef([AC_PROVIDE_AC_LIBTOOL_DLOPEN], enable_dlopen=yes, enable_dlopen=no)
 ifdef([AC_PROVIDE_AC_LIBTOOL_WIN32_DLL],
-[libtool_flags="$libtool_flags --enable-win32-dll"])
+enable_win32_dll=yes, enable_win32_dll=no)
+
 AC_ARG_ENABLE(libtool-lock,
   [  --disable-libtool-lock  avoid locking (might break parallel builds)])
-test "x$enable_libtool_lock" = xno && libtool_flags="$libtool_flags --disable-lock"
-test x"$silent" = xyes && libtool_flags="$libtool_flags --silent"
+test "x$enable_libtool_lock" != xno && enable_libtool_lock=yes
 
 # Some flags need to be propagated to the compiler or linker for good
 # libtool support.
-case "$lt_target" in
+case $host in
 *-*-irix6*)
   # Find out which ABI we are using.
   echo '[#]line __oline__ "configure"' > conftest.$ac_ext
   if AC_TRY_EVAL(ac_compile); then
-    case "`/usr/bin/file conftest.o`" in
+    case `/usr/bin/file conftest.$ac_objext` in
     *32-bit*)
       LD="${LD-ld} -32"
       ;;
@@ -196,7 +187,10 @@
   SAVE_CFLAGS="$CFLAGS"
   CFLAGS="$CFLAGS -belf"
   AC_CACHE_CHECK([whether the C compiler needs -belf], lt_cv_cc_needs_belf,
-    [AC_TRY_LINK([],[],[lt_cv_cc_needs_belf=yes],[lt_cv_cc_needs_belf=no])])
+    [AC_LANG_SAVE
+     AC_LANG_C
+     AC_TRY_LINK([],[],[lt_cv_cc_needs_belf=yes],[lt_cv_cc_needs_belf=no])
+     AC_LANG_RESTORE])
   if test x"$lt_cv_cc_needs_belf" != x"yes"; then
     # this is probably gcc 2.8.0, egcs 1.0 or newer; no need for -belf
     CFLAGS="$SAVE_CFLAGS"
@@ -204,33 +198,2873 @@
   ;;
 
 ifdef([AC_PROVIDE_AC_LIBTOOL_WIN32_DLL],
-[*-*-cygwin* | *-*-mingw*)
+[*-*-cygwin* | *-*-mingw* | *-*-pw32*)
   AC_CHECK_TOOL(DLLTOOL, dlltool, false)
   AC_CHECK_TOOL(AS, as, false)
   AC_CHECK_TOOL(OBJDUMP, objdump, false)
+
+  # recent cygwin and mingw systems supply a stub DllMain which the user
+  # can override, but on older systems we have to supply one
+  AC_CACHE_CHECK([if libtool should supply DllMain function], lt_cv_need_dllmain,
+    [AC_TRY_LINK([],
+      [extern int __attribute__((__stdcall__)) DllMain(void*, int, void*);
+      DllMain (0, 0, 0);],
+      [lt_cv_need_dllmain=no],[lt_cv_need_dllmain=yes])])
+
+  case $host/$CC in
+  *-*-cygwin*/gcc*-mno-cygwin*|*-*-mingw*)
+    # old mingw systems require "-dll" to link a DLL, while more recent ones
+    # require "-mdll"
+    SAVE_CFLAGS="$CFLAGS"
+    CFLAGS="$CFLAGS -mdll"
+    AC_CACHE_CHECK([how to link DLLs], lt_cv_cc_dll_switch,
+      [AC_TRY_LINK([], [], [lt_cv_cc_dll_switch=-mdll],[lt_cv_cc_dll_switch=-dll])])
+    CFLAGS="$SAVE_CFLAGS" ;;
+  *-*-cygwin* | *-*-pw32*)
+    # cygwin systems need to pass --dll to the linker, and not link
+    # crt.o which will require a WinMain@16 definition.
+    lt_cv_cc_dll_switch="-Wl,--dll -nostartfiles" ;;
+  esac
   ;;
+  ])
+esac
+
+_LT_AC_LTCONFIG_HACK
+
 ])
+
+# AC_LIBTOOL_HEADER_ASSERT
+# ------------------------
+AC_DEFUN([AC_LIBTOOL_HEADER_ASSERT],
+[AC_CACHE_CHECK([whether $CC supports assert without backlinking],
+    [lt_cv_func_assert_works],
+    [case $host in
+    *-*-solaris*)
+      if test "$GCC" = yes && test "$with_gnu_ld" != yes; then
+        case `$CC --version 2>/dev/null` in
+        [[12]].*) lt_cv_func_assert_works=no ;;
+        *)        lt_cv_func_assert_works=yes ;;
+        esac
+      fi
+      ;;
+    esac])
+
+if test "x$lt_cv_func_assert_works" = xyes; then
+  AC_CHECK_HEADERS(assert.h)
+fi
+])# AC_LIBTOOL_HEADER_ASSERT
+
+# _LT_AC_CHECK_DLFCN
+# --------------------
+AC_DEFUN([_LT_AC_CHECK_DLFCN],
+[AC_CHECK_HEADERS(dlfcn.h)
+])# _LT_AC_CHECK_DLFCN
+
+# AC_LIBTOOL_SYS_GLOBAL_SYMBOL_PIPE
+# ---------------------------------
+AC_DEFUN([AC_LIBTOOL_SYS_GLOBAL_SYMBOL_PIPE],
+[AC_REQUIRE([AC_CANONICAL_HOST])
+AC_REQUIRE([AC_PROG_NM])
+AC_REQUIRE([AC_OBJEXT])
+# Check for command to grab the raw symbol name followed by C symbol from nm.
+AC_MSG_CHECKING([command to parse $NM output])
+AC_CACHE_VAL([lt_cv_sys_global_symbol_pipe], [dnl
+
+# These are sane defaults that work on at least a few old systems.
+# [They come from Ultrix.  What could be older than Ultrix?!! ;)]
+
+# Character class describing NM global symbol codes.
+symcode='[[BCDEGRST]]'
+
+# Regexp to match symbols that can be accessed directly from C.
+sympat='\([[_A-Za-z]][[_A-Za-z0-9]]*\)'
+
+# Transform the above into a raw symbol and a C symbol.
+symxfrm='\1 \2\3 \3'
+
+# Transform an extracted symbol line into a proper C declaration
+lt_cv_global_symbol_to_cdecl="sed -n -e 's/^. .* \(.*\)$/extern char \1;/p'"
+
+# Transform an extracted symbol line into symbol name and symbol address
+lt_cv_global_symbol_to_c_name_address="sed -n -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (lt_ptr) 0},/p' -e 's/^$symcode \([[^ ]]*\) \([[^ ]]*\)$/  {\"\2\", (lt_ptr) \&\2},/p'"
+
+# Define system-specific variables.
+case $host_os in
+aix*)
+  symcode='[[BCDT]]'
+  ;;
+cygwin* | mingw* | pw32*)
+  symcode='[[ABCDGISTW]]'
+  ;;
+hpux*) # Its linker distinguishes data from code symbols
+  lt_cv_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern char \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+  lt_cv_global_symbol_to_c_name_address="sed -n -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (lt_ptr) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\"\2\", (lt_ptr) \&\2},/p'"
+  ;;
+irix* | nonstopux*)
+  symcode='[[BCDEGRST]]'
+  ;;
+osf*)
+  symcode='[[BCDEGQRST]]'
+  ;;
+solaris* | sysv5*)
+  symcode='[[BDT]]'
+  ;;
+sysv4)
+  symcode='[[DFNSTU]]'
+  ;;
+esac
+
+# Handle CRLF in mingw tool chain
+opt_cr=
+case $host_os in
+mingw*)
+  opt_cr=`echo 'x\{0,1\}' | tr x '\015'` # option cr in regexp
+  ;;
 esac
+
+# If we're using GNU nm, then use its standard symbol codes.
+if $NM -V 2>&1 | egrep '(GNU|with BFD)' > /dev/null; then
+  symcode='[[ABCDGISTW]]'
+fi
+
+# Try without a prefix undercore, then with it.
+for ac_symprfx in "" "_"; do
+
+  # Write the raw and C identifiers.
+lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[[ 	]]\($symcode$symcode*\)[[ 	]][[ 	]]*\($ac_symprfx\)$sympat$opt_cr$/$symxfrm/p'"
+
+  # Check to see that the pipe works correctly.
+  pipe_works=no
+  rm -f conftest*
+  cat > conftest.$ac_ext <<EOF
+#ifdef __cplusplus
+extern "C" {
+#endif
+char nm_test_var;
+void nm_test_func(){}
+#ifdef __cplusplus
+}
+#endif
+int main(){nm_test_var='a';nm_test_func();return(0);}
+EOF
+
+  if AC_TRY_EVAL(ac_compile); then
+    # Now try to grab the symbols.
+    nlist=conftest.nm
+    if AC_TRY_EVAL(NM conftest.$ac_objext \| $lt_cv_sys_global_symbol_pipe \> $nlist) && test -s "$nlist"; then
+      # Try sorting and uniquifying the output.
+      if sort "$nlist" | uniq > "$nlist"T; then
+	mv -f "$nlist"T "$nlist"
+      else
+	rm -f "$nlist"T
+      fi
+
+      # Make sure that we snagged all the symbols we need.
+      if egrep ' nm_test_var$' "$nlist" >/dev/null; then
+	if egrep ' nm_test_func$' "$nlist" >/dev/null; then
+	  cat <<EOF > conftest.$ac_ext
+#ifdef __cplusplus
+extern "C" {
+#endif
+
+EOF
+	  # Now generate the symbol file.
+	  eval "$lt_cv_global_symbol_to_cdecl"' < "$nlist" >> conftest.$ac_ext'
+
+	  cat <<EOF >> conftest.$ac_ext
+#if defined (__STDC__) && __STDC__
+# define lt_ptr void *
+#else
+# define lt_ptr char *
+# define const
+#endif
+
+/* The mapping between symbol names and symbols. */
+const struct {
+  const char *name;
+  lt_ptr address;
+}
+lt_preloaded_symbols[[]] =
+{
+EOF
+	  sed "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (lt_ptr) \&\2},/" < "$nlist" >> conftest.$ac_ext
+	  cat <<\EOF >> conftest.$ac_ext
+  {0, (lt_ptr) 0}
+};
+
+#ifdef __cplusplus
+}
+#endif
+EOF
+	  # Now try linking the two files.
+	  mv conftest.$ac_objext conftstm.$ac_objext
+	  save_LIBS="$LIBS"
+	  save_CFLAGS="$CFLAGS"
+	  LIBS="conftstm.$ac_objext"
+	  CFLAGS="$CFLAGS$no_builtin_flag"
+	  if AC_TRY_EVAL(ac_link) && test -s conftest$ac_exeext; then
+	    pipe_works=yes
+	  fi
+	  LIBS="$save_LIBS"
+	  CFLAGS="$save_CFLAGS"
+	else
+	  echo "cannot find nm_test_func in $nlist" >&AC_FD_CC
+	fi
+      else
+	echo "cannot find nm_test_var in $nlist" >&AC_FD_CC
+      fi
+    else
+      echo "cannot run $lt_cv_sys_global_symbol_pipe" >&AC_FD_CC
+    fi
+  else
+    echo "$progname: failed program was:" >&AC_FD_CC
+    cat conftest.$ac_ext >&5
+  fi
+  rm -f conftest* conftst*
+
+  # Do not use the global_symbol_pipe unless it works.
+  if test "$pipe_works" = yes; then
+    break
+  else
+    lt_cv_sys_global_symbol_pipe=
+  fi
+done
 ])
+global_symbol_pipe="$lt_cv_sys_global_symbol_pipe"
+if test -z "$lt_cv_sys_global_symbol_pipe"; then
+  global_symbol_to_cdecl=
+  global_symbol_to_c_name_address=
+else
+  global_symbol_to_cdecl="$lt_cv_global_symbol_to_cdecl"
+  global_symbol_to_c_name_address="$lt_cv_global_symbol_to_c_name_address"
+fi
+if test -z "$global_symbol_pipe$global_symbol_to_cdec$global_symbol_to_c_name_address";
+then
+  AC_MSG_RESULT(failed)
+else
+  AC_MSG_RESULT(ok)
+fi
+]) # AC_LIBTOOL_SYS_GLOBAL_SYMBOL_PIPE
+
+# _LT_AC_LIBTOOL_SYS_PATH_SEPARATOR
+# ---------------------------------
+AC_DEFUN([_LT_AC_LIBTOOL_SYS_PATH_SEPARATOR],
+[# Find the correct PATH separator.  Usually this is `:', but
+# DJGPP uses `;' like DOS.
+if test "X${PATH_SEPARATOR+set}" != Xset; then
+  UNAME=${UNAME-`uname 2>/dev/null`}
+  case X$UNAME in
+    *-DOS) lt_cv_sys_path_separator=';' ;;
+    *)     lt_cv_sys_path_separator=':' ;;
+  esac
+  PATH_SEPARATOR=$lt_cv_sys_path_separator
+fi
+])# _LT_AC_LIBTOOL_SYS_PATH_SEPARATOR
+
+# _LT_AC_PROG_ECHO_BACKSLASH
+# --------------------------
+# Add some code to the start of the generated configure script which
+# will find an echo command which doesn't interpret backslashes.
+AC_DEFUN([_LT_AC_PROG_ECHO_BACKSLASH],
+[ifdef([AC_DIVERSION_NOTICE], [AC_DIVERT_PUSH(AC_DIVERSION_NOTICE)],
+			      [AC_DIVERT_PUSH(NOTICE)])
+_LT_AC_LIBTOOL_SYS_PATH_SEPARATOR
+
+# Check that we are running under the correct shell.
+SHELL=${CONFIG_SHELL-/bin/sh}
+
+case X$ECHO in
+X*--fallback-echo)
+  # Remove one level of quotation (which was required for Make).
+  ECHO=`echo "$ECHO" | sed 's,\\\\\[$]\\[$]0,'[$]0','`
+  ;;
+esac
+
+echo=${ECHO-echo}
+if test "X[$]1" = X--no-reexec; then
+  # Discard the --no-reexec flag, and continue.
+  shift
+elif test "X[$]1" = X--fallback-echo; then
+  # Avoid inline document here, it may be left over
+  :
+elif test "X`($echo '\t') 2>/dev/null`" = 'X\t'; then
+  # Yippee, $echo works!
+  :
+else
+  # Restart under the correct shell.
+  exec $SHELL "[$]0" --no-reexec ${1+"[$]@"}
+fi
+
+if test "X[$]1" = X--fallback-echo; then
+  # used as fallback echo
+  shift
+  cat <<EOF
+$*
+EOF
+  exit 0
+fi
+
+# The HP-UX ksh and POSIX shell print the target directory to stdout
+# if CDPATH is set.
+if test "X${CDPATH+set}" = Xset; then CDPATH=:; export CDPATH; fi
+
+if test -z "$ECHO"; then
+if test "X${echo_test_string+set}" != Xset; then
+# find a string as large as possible, as long as the shell can cope with it
+  for cmd in 'sed 50q "[$]0"' 'sed 20q "[$]0"' 'sed 10q "[$]0"' 'sed 2q "[$]0"' 'echo test'; do
+    # expected sizes: less than 2Kb, 1Kb, 512 bytes, 16 bytes, ...
+    if (echo_test_string="`eval $cmd`") 2>/dev/null &&
+       echo_test_string="`eval $cmd`" &&
+       (test "X$echo_test_string" = "X$echo_test_string") 2>/dev/null
+    then
+      break
+    fi
+  done
+fi
+
+if test "X`($echo '\t') 2>/dev/null`" = 'X\t' &&
+   echo_testing_string=`($echo "$echo_test_string") 2>/dev/null` &&
+   test "X$echo_testing_string" = "X$echo_test_string"; then
+  :
+else
+  # The Solaris, AIX, and Digital Unix default echo programs unquote
+  # backslashes.  This makes it impossible to quote backslashes using
+  #   echo "$something" | sed 's/\\/\\\\/g'
+  #
+  # So, first we look for a working echo in the user's PATH.
+
+  IFS="${IFS= 	}"; save_ifs="$IFS"; IFS=$PATH_SEPARATOR
+  for dir in $PATH /usr/ucb; do
+    if (test -f $dir/echo || test -f $dir/echo$ac_exeext) &&
+       test "X`($dir/echo '\t') 2>/dev/null`" = 'X\t' &&
+       echo_testing_string=`($dir/echo "$echo_test_string") 2>/dev/null` &&
+       test "X$echo_testing_string" = "X$echo_test_string"; then
+      echo="$dir/echo"
+      break
+    fi
+  done
+  IFS="$save_ifs"
+
+  if test "X$echo" = Xecho; then
+    # We didn't find a better echo, so look for alternatives.
+    if test "X`(print -r '\t') 2>/dev/null`" = 'X\t' &&
+       echo_testing_string=`(print -r "$echo_test_string") 2>/dev/null` &&
+       test "X$echo_testing_string" = "X$echo_test_string"; then
+      # This shell has a builtin print -r that does the trick.
+      echo='print -r'
+    elif (test -f /bin/ksh || test -f /bin/ksh$ac_exeext) &&
+	 test "X$CONFIG_SHELL" != X/bin/ksh; then
+      # If we have ksh, try running configure again with it.
+      ORIGINAL_CONFIG_SHELL=${CONFIG_SHELL-/bin/sh}
+      export ORIGINAL_CONFIG_SHELL
+      CONFIG_SHELL=/bin/ksh
+      export CONFIG_SHELL
+      exec $CONFIG_SHELL "[$]0" --no-reexec ${1+"[$]@"}
+    else
+      # Try using printf.
+      echo='printf %s\n'
+      if test "X`($echo '\t') 2>/dev/null`" = 'X\t' &&
+	 echo_testing_string=`($echo "$echo_test_string") 2>/dev/null` &&
+	 test "X$echo_testing_string" = "X$echo_test_string"; then
+	# Cool, printf works
+	:
+      elif echo_testing_string=`($ORIGINAL_CONFIG_SHELL "[$]0" --fallback-echo '\t') 2>/dev/null` &&
+	   test "X$echo_testing_string" = 'X\t' &&
+	   echo_testing_string=`($ORIGINAL_CONFIG_SHELL "[$]0" --fallback-echo "$echo_test_string") 2>/dev/null` &&
+	   test "X$echo_testing_string" = "X$echo_test_string"; then
+	CONFIG_SHELL=$ORIGINAL_CONFIG_SHELL
+	export CONFIG_SHELL
+	SHELL="$CONFIG_SHELL"
+	export SHELL
+	echo="$CONFIG_SHELL [$]0 --fallback-echo"
+      elif echo_testing_string=`($CONFIG_SHELL "[$]0" --fallback-echo '\t') 2>/dev/null` &&
+	   test "X$echo_testing_string" = 'X\t' &&
+	   echo_testing_string=`($CONFIG_SHELL "[$]0" --fallback-echo "$echo_test_string") 2>/dev/null` &&
+	   test "X$echo_testing_string" = "X$echo_test_string"; then
+	echo="$CONFIG_SHELL [$]0 --fallback-echo"
+      else
+	# maybe with a smaller string...
+	prev=:
+
+	for cmd in 'echo test' 'sed 2q "[$]0"' 'sed 10q "[$]0"' 'sed 20q "[$]0"' 'sed 50q "[$]0"'; do
+	  if (test "X$echo_test_string" = "X`eval $cmd`") 2>/dev/null
+	  then
+	    break
+	  fi
+	  prev="$cmd"
+	done
+
+	if test "$prev" != 'sed 50q "[$]0"'; then
+	  echo_test_string=`eval $prev`
+	  export echo_test_string
+	  exec ${ORIGINAL_CONFIG_SHELL-${CONFIG_SHELL-/bin/sh}} "[$]0" ${1+"[$]@"}
+	else
+	  # Oops.  We lost completely, so just stick with echo.
+	  echo=echo
+	fi
+      fi
+    fi
+  fi
+fi
+fi
+
+# Copy echo and quote the copy suitably for passing to libtool from
+# the Makefile, instead of quoting the original, which is used later.
+ECHO=$echo
+if test "X$ECHO" = "X$CONFIG_SHELL [$]0 --fallback-echo"; then
+   ECHO="$CONFIG_SHELL \\\$\[$]0 --fallback-echo"
+fi
+
+AC_SUBST(ECHO)
+AC_DIVERT_POP
+])# _LT_AC_PROG_ECHO_BACKSLASH
+
+# _LT_AC_TRY_DLOPEN_SELF (ACTION-IF-TRUE, ACTION-IF-TRUE-W-USCORE,
+#                           ACTION-IF-FALSE, ACTION-IF-CROSS-COMPILING)
+# ------------------------------------------------------------------
+AC_DEFUN([_LT_AC_TRY_DLOPEN_SELF],
+[if test "$cross_compiling" = yes; then :
+  [$4]
+else
+  AC_REQUIRE([_LT_AC_CHECK_DLFCN])dnl
+  lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
+  lt_status=$lt_dlunknown
+  cat > conftest.$ac_ext <<EOF
+[#line __oline__ "configure"
+#include "confdefs.h"
+
+#if HAVE_DLFCN_H
+#include <dlfcn.h>
+#endif
+
+#include <stdio.h>
+
+#ifdef RTLD_GLOBAL
+#  define LT_DLGLOBAL		RTLD_GLOBAL
+#else
+#  ifdef DL_GLOBAL
+#    define LT_DLGLOBAL		DL_GLOBAL
+#  else
+#    define LT_DLGLOBAL		0
+#  endif
+#endif
+
+/* We may have to define LT_DLLAZY_OR_NOW in the command line if we
+   find out it does not work in some platform. */
+#ifndef LT_DLLAZY_OR_NOW
+#  ifdef RTLD_LAZY
+#    define LT_DLLAZY_OR_NOW		RTLD_LAZY
+#  else
+#    ifdef DL_LAZY
+#      define LT_DLLAZY_OR_NOW		DL_LAZY
+#    else
+#      ifdef RTLD_NOW
+#        define LT_DLLAZY_OR_NOW	RTLD_NOW
+#      else
+#        ifdef DL_NOW
+#          define LT_DLLAZY_OR_NOW	DL_NOW
+#        else
+#          define LT_DLLAZY_OR_NOW	0
+#        endif
+#      endif
+#    endif
+#  endif
+#endif
+
+#ifdef __cplusplus
+extern "C" void exit (int);
+#endif
+
+void fnord() { int i=42;}
+int main ()
+{
+  void *self = dlopen (0, LT_DLGLOBAL|LT_DLLAZY_OR_NOW);
+  int status = $lt_dlunknown;
+
+  if (self)
+    {
+      if (dlsym (self,"fnord"))       status = $lt_dlno_uscore;
+      else if (dlsym( self,"_fnord")) status = $lt_dlneed_uscore;
+      /* dlclose (self); */
+    }
+
+    exit (status);
+}]
+EOF
+  if AC_TRY_EVAL(ac_link) && test -s conftest${ac_exeext} 2>/dev/null; then
+    (./conftest; exit; ) 2>/dev/null
+    lt_status=$?
+    case x$lt_status in
+      x$lt_dlno_uscore) $1 ;;
+      x$lt_dlneed_uscore) $2 ;;
+      x$lt_unknown|x*) $3 ;;
+    esac
+  else :
+    # compilation failed
+    $3
+  fi
+fi
+rm -fr conftest*
+])# _LT_AC_TRY_DLOPEN_SELF
+
+# AC_LIBTOOL_DLOPEN_SELF
+# -------------------
+AC_DEFUN([AC_LIBTOOL_DLOPEN_SELF],
+[if test "x$enable_dlopen" != xyes; then
+  enable_dlopen=unknown
+  enable_dlopen_self=unknown
+  enable_dlopen_self_static=unknown
+else
+  lt_cv_dlopen=no
+  lt_cv_dlopen_libs=
+
+  case $host_os in
+  beos*)
+    lt_cv_dlopen="load_add_on"
+    lt_cv_dlopen_libs=
+    lt_cv_dlopen_self=yes
+    ;;
+
+  cygwin* | mingw* | pw32*)
+    lt_cv_dlopen="LoadLibrary"
+    lt_cv_dlopen_libs=
+   ;;
+
+  *)
+    AC_CHECK_FUNC([shl_load],
+          [lt_cv_dlopen="shl_load"],
+      [AC_CHECK_LIB([dld], [shl_load],
+            [lt_cv_dlopen="shl_load" lt_cv_dlopen_libs="-dld"],
+	[AC_CHECK_FUNC([dlopen],
+	      [lt_cv_dlopen="dlopen"],
+	  [AC_CHECK_LIB([dl], [dlopen],
+	        [lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-ldl"],
+	    [AC_CHECK_LIB([svld], [dlopen],
+	          [lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-lsvld"],
+	      [AC_CHECK_LIB([dld], [dld_link],
+	            [lt_cv_dlopen="dld_link" lt_cv_dlopen_libs="-dld"])
+	      ])
+	    ])
+	  ])
+	])
+      ])
+    ;;
+  esac
+
+  if test "x$lt_cv_dlopen" != xno; then
+    enable_dlopen=yes
+  else
+    enable_dlopen=no
+  fi
+
+  case $lt_cv_dlopen in
+  dlopen)
+    save_CPPFLAGS="$CPPFLAGS"
+    AC_REQUIRE([_LT_AC_CHECK_DLFCN])dnl
+    test "x$ac_cv_header_dlfcn_h" = xyes && CPPFLAGS="$CPPFLAGS -DHAVE_DLFCN_H"
+
+    save_LDFLAGS="$LDFLAGS"
+    eval LDFLAGS=\"\$LDFLAGS $export_dynamic_flag_spec\"
+
+    save_LIBS="$LIBS"
+    LIBS="$lt_cv_dlopen_libs $LIBS"
+
+    AC_CACHE_CHECK([whether a program can dlopen itself],
+	  lt_cv_dlopen_self, [dnl
+	  _LT_AC_TRY_DLOPEN_SELF(
+	    lt_cv_dlopen_self=yes, lt_cv_dlopen_self=yes,
+	    lt_cv_dlopen_self=no, lt_cv_dlopen_self=cross)
+    ])
+
+    if test "x$lt_cv_dlopen_self" = xyes; then
+      LDFLAGS="$LDFLAGS $link_static_flag"
+      AC_CACHE_CHECK([whether a statically linked program can dlopen itself],
+    	  lt_cv_dlopen_self_static, [dnl
+	  _LT_AC_TRY_DLOPEN_SELF(
+	    lt_cv_dlopen_self_static=yes, lt_cv_dlopen_self_static=yes,
+	    lt_cv_dlopen_self_static=no,  lt_cv_dlopen_self_static=cross)
+      ])
+    fi
+
+    CPPFLAGS="$save_CPPFLAGS"
+    LDFLAGS="$save_LDFLAGS"
+    LIBS="$save_LIBS"
+    ;;
+  esac
+
+  case $lt_cv_dlopen_self in
+  yes|no) enable_dlopen_self=$lt_cv_dlopen_self ;;
+  *) enable_dlopen_self=unknown ;;
+  esac
+
+  case $lt_cv_dlopen_self_static in
+  yes|no) enable_dlopen_self_static=$lt_cv_dlopen_self_static ;;
+  *) enable_dlopen_self_static=unknown ;;
+  esac
+fi
+])# AC_LIBTOOL_DLOPEN_SELF
+
+AC_DEFUN([_LT_AC_LTCONFIG_HACK],
+[AC_REQUIRE([AC_LIBTOOL_SYS_GLOBAL_SYMBOL_PIPE])dnl
+# Sed substitution that helps us do robust quoting.  It backslashifies
+# metacharacters that are still active within double-quoted strings.
+Xsed='sed -e s/^X//'
+sed_quote_subst='s/\([[\\"\\`$\\\\]]\)/\\\1/g'
+
+# Same as above, but do not quote variable references.
+double_quote_subst='s/\([[\\"\\`\\\\]]\)/\\\1/g'
+
+# Sed substitution to delay expansion of an escaped shell variable in a
+# double_quote_subst'ed string.
+delay_variable_subst='s/\\\\\\\\\\\$/\\\\\\$/g'
+
+# Constants:
+rm="rm -f"
+
+# Global variables:
+default_ofile=libtool
+can_build_shared=yes
+
+# All known linkers require a `.a' archive for static linking (except M$VC,
+# which needs '.lib').
+libext=a
+ltmain="$ac_aux_dir/ltmain.sh"
+ofile="$default_ofile"
+with_gnu_ld="$lt_cv_prog_gnu_ld"
+need_locks="$enable_libtool_lock"
+
+old_CC="$CC"
+old_CFLAGS="$CFLAGS"
+
+# Set sane defaults for various variables
+test -z "$AR" && AR=ar
+test -z "$AR_FLAGS" && AR_FLAGS=cru
+test -z "$AS" && AS=as
+test -z "$CC" && CC=cc
+test -z "$DLLTOOL" && DLLTOOL=dlltool
+test -z "$LD" && LD=ld
+test -z "$LN_S" && LN_S="ln -s"
+test -z "$MAGIC_CMD" && MAGIC_CMD=file
+test -z "$NM" && NM=nm
+test -z "$OBJDUMP" && OBJDUMP=objdump
+test -z "$RANLIB" && RANLIB=:
+test -z "$STRIP" && STRIP=:
+test -z "$ac_objext" && ac_objext=o
+
+if test x"$host" != x"$build"; then
+  ac_tool_prefix=${host_alias}-
+else
+  ac_tool_prefix=
+fi
+
+# Transform linux* to *-*-linux-gnu*, to support old configure scripts.
+case $host_os in
+linux-gnu*) ;;
+linux*) host=`echo $host | sed 's/^\(.*-.*-linux\)\(.*\)$/\1-gnu\2/'`
+esac
+
+case $host_os in
+aix3*)
+  # AIX sometimes has problems with the GCC collect2 program.  For some
+  # reason, if we set the COLLECT_NAMES environment variable, the problems
+  # vanish in a puff of smoke.
+  if test "X${COLLECT_NAMES+set}" != Xset; then
+    COLLECT_NAMES=
+    export COLLECT_NAMES
+  fi
+  ;;
+esac
+
+# Determine commands to create old-style static archives.
+old_archive_cmds='$AR $AR_FLAGS $oldlib$oldobjs$old_deplibs'
+old_postinstall_cmds='chmod 644 $oldlib'
+old_postuninstall_cmds=
+
+if test -n "$RANLIB"; then
+  case $host_os in
+  openbsd*)
+    old_postinstall_cmds="\$RANLIB -t \$oldlib~$old_postinstall_cmds"
+    ;;
+  *)
+    old_postinstall_cmds="\$RANLIB \$oldlib~$old_postinstall_cmds"
+    ;;
+  esac
+  old_archive_cmds="$old_archive_cmds~\$RANLIB \$oldlib"
+fi
+
+# Allow CC to be a program name with arguments.
+set dummy $CC
+compiler="[$]2"
+
+AC_MSG_CHECKING([for objdir])
+rm -f .libs 2>/dev/null
+mkdir .libs 2>/dev/null
+if test -d .libs; then
+  objdir=.libs
+else
+  # MS-DOS does not allow filenames that begin with a dot.
+  objdir=_libs
+fi
+rmdir .libs 2>/dev/null
+AC_MSG_RESULT($objdir)
+
+
+AC_ARG_WITH(pic,
+[  --with-pic              try to use only PIC/non-PIC objects [default=use both]],
+pic_mode="$withval", pic_mode=default)
+test -z "$pic_mode" && pic_mode=default
+
+# We assume here that the value for lt_cv_prog_cc_pic will not be cached
+# in isolation, and that seeing it set (from the cache) indicates that
+# the associated values are set (in the cache) correctly too.
+AC_MSG_CHECKING([for $compiler option to produce PIC])
+AC_CACHE_VAL(lt_cv_prog_cc_pic,
+[ lt_cv_prog_cc_pic=
+  lt_cv_prog_cc_shlib=
+  lt_cv_prog_cc_wl=
+  lt_cv_prog_cc_static=
+  lt_cv_prog_cc_no_builtin=
+  lt_cv_prog_cc_can_build_shared=$can_build_shared
+
+  if test "$GCC" = yes; then
+    lt_cv_prog_cc_wl='-Wl,'
+    lt_cv_prog_cc_static='-static'
+
+    case $host_os in
+    aix*)
+      # Below there is a dirty hack to force normal static linking with -ldl
+      # The problem is because libdl dynamically linked with both libc and
+      # libC (AIX C++ library), which obviously doesn't included in libraries
+      # list by gcc. This cause undefined symbols with -static flags.
+      # This hack allows C programs to be linked with "-static -ldl", but
+      # not sure about C++ programs.
+      lt_cv_prog_cc_static="$lt_cv_prog_cc_static ${lt_cv_prog_cc_wl}-lC"
+      ;;
+    amigaos*)
+      # FIXME: we need at least 68020 code to build shared libraries, but
+      # adding the `-m68020' flag to GCC prevents building anything better,
+      # like `-m68040'.
+      lt_cv_prog_cc_pic='-m68020 -resident32 -malways-restore-a4'
+      ;;
+    beos* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
+      # PIC is the default for these OSes.
+      ;;
+    darwin* | rhapsody*)
+      # PIC is the default on this platform
+      # Common symbols not allowed in MH_DYLIB files
+      lt_cv_prog_cc_pic='-fno-common'
+      ;;
+    cygwin* | mingw* | pw32* | os2*)
+      # This hack is so that the source file can tell whether it is being
+      # built for inclusion in a dll (and should export symbols for example).
+      lt_cv_prog_cc_pic='-DDLL_EXPORT'
+      ;;
+    sysv4*MP*)
+      if test -d /usr/nec; then
+	 lt_cv_prog_cc_pic=-Kconform_pic
+      fi
+      ;;
+    *)
+      lt_cv_prog_cc_pic='-fPIC'
+      ;;
+    esac
+  else
+    # PORTME Check for PIC flags for the system compiler.
+    case $host_os in
+    aix3* | aix4* | aix5*)
+      lt_cv_prog_cc_wl='-Wl,'
+      # All AIX code is PIC.
+      if test "$host_cpu" = ia64; then
+	# AIX 5 now supports IA64 processor
+	lt_cv_prog_cc_static='-Bstatic'
+      else
+	lt_cv_prog_cc_static='-bnso -bI:/lib/syscalls.exp'
+      fi
+      ;;
+
+    hpux9* | hpux10* | hpux11*)
+      # Is there a better lt_cv_prog_cc_static that works with the bundled CC?
+      lt_cv_prog_cc_wl='-Wl,'
+      lt_cv_prog_cc_static="${lt_cv_prog_cc_wl}-a ${lt_cv_prog_cc_wl}archive"
+      lt_cv_prog_cc_pic='+Z'
+      ;;
+
+    irix5* | irix6* | nonstopux*)
+      lt_cv_prog_cc_wl='-Wl,'
+      lt_cv_prog_cc_static='-non_shared'
+      # PIC (with -KPIC) is the default.
+      ;;
+
+    cygwin* | mingw* | pw32* | os2*)
+      # This hack is so that the source file can tell whether it is being
+      # built for inclusion in a dll (and should export symbols for example).
+      lt_cv_prog_cc_pic='-DDLL_EXPORT'
+      ;;
+
+    newsos6)
+      lt_cv_prog_cc_pic='-KPIC'
+      lt_cv_prog_cc_static='-Bstatic'
+      ;;
+
+    osf3* | osf4* | osf5*)
+      # All OSF/1 code is PIC.
+      lt_cv_prog_cc_wl='-Wl,'
+      lt_cv_prog_cc_static='-non_shared'
+      ;;
+
+    sco3.2v5*)
+      lt_cv_prog_cc_pic='-Kpic'
+      lt_cv_prog_cc_static='-dn'
+      lt_cv_prog_cc_shlib='-belf'
+      ;;
+
+    solaris*)
+      lt_cv_prog_cc_pic='-KPIC'
+      lt_cv_prog_cc_static='-Bstatic'
+      lt_cv_prog_cc_wl='-Wl,'
+      ;;
+
+    sunos4*)
+      lt_cv_prog_cc_pic='-PIC'
+      lt_cv_prog_cc_static='-Bstatic'
+      lt_cv_prog_cc_wl='-Qoption ld '
+      ;;
+
+    sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)
+      lt_cv_prog_cc_pic='-KPIC'
+      lt_cv_prog_cc_static='-Bstatic'
+      lt_cv_prog_cc_wl='-Wl,'
+      ;;
+
+    uts4*)
+      lt_cv_prog_cc_pic='-pic'
+      lt_cv_prog_cc_static='-Bstatic'
+      ;;
+
+    sysv4*MP*)
+      if test -d /usr/nec ;then
+	lt_cv_prog_cc_pic='-Kconform_pic'
+	lt_cv_prog_cc_static='-Bstatic'
+      fi
+      ;;
+
+    *)
+      lt_cv_prog_cc_can_build_shared=no
+      ;;
+    esac
+  fi
+])
+if test -z "$lt_cv_prog_cc_pic"; then
+  AC_MSG_RESULT([none])
+else
+  AC_MSG_RESULT([$lt_cv_prog_cc_pic])
+
+  # Check to make sure the pic_flag actually works.
+  AC_MSG_CHECKING([if $compiler PIC flag $lt_cv_prog_cc_pic works])
+  AC_CACHE_VAL(lt_cv_prog_cc_pic_works, [dnl
+    save_CFLAGS="$CFLAGS"
+    CFLAGS="$CFLAGS $lt_cv_prog_cc_pic -DPIC"
+    AC_TRY_COMPILE([], [], [dnl
+      case $host_os in
+      hpux9* | hpux10* | hpux11*)
+	# On HP-UX, both CC and GCC only warn that PIC is supported... then
+	# they create non-PIC objects.  So, if there were any warnings, we
+	# assume that PIC is not supported.
+	if test -s conftest.err; then
+	  lt_cv_prog_cc_pic_works=no
+	else
+	  lt_cv_prog_cc_pic_works=yes
+	fi
+	;;
+      *)
+	lt_cv_prog_cc_pic_works=yes
+	;;
+      esac
+    ], [dnl
+      lt_cv_prog_cc_pic_works=no
+    ])
+    CFLAGS="$save_CFLAGS"
+  ])
+
+  if test "X$lt_cv_prog_cc_pic_works" = Xno; then
+    lt_cv_prog_cc_pic=
+    lt_cv_prog_cc_can_build_shared=no
+  else
+    lt_cv_prog_cc_pic=" $lt_cv_prog_cc_pic"
+  fi
+
+  AC_MSG_RESULT([$lt_cv_prog_cc_pic_works])
+fi
+
+# Check for any special shared library compilation flags.
+if test -n "$lt_cv_prog_cc_shlib"; then
+  AC_MSG_WARN([\`$CC' requires \`$lt_cv_prog_cc_shlib' to build shared libraries])
+  if echo "$old_CC $old_CFLAGS " | egrep -e "[[ 	]]$lt_cv_prog_cc_shlib[[ 	]]" >/dev/null; then :
+  else
+   AC_MSG_WARN([add \`$lt_cv_prog_cc_shlib' to the CC or CFLAGS env variable and reconfigure])
+    lt_cv_prog_cc_can_build_shared=no
+  fi
+fi
+
+AC_MSG_CHECKING([if $compiler static flag $lt_cv_prog_cc_static works])
+AC_CACHE_VAL([lt_cv_prog_cc_static_works], [dnl
+  lt_cv_prog_cc_static_works=no
+  save_LDFLAGS="$LDFLAGS"
+  LDFLAGS="$LDFLAGS $lt_cv_prog_cc_static"
+  AC_TRY_LINK([], [], [lt_cv_prog_cc_static_works=yes])
+  LDFLAGS="$save_LDFLAGS"
+])
+
+# Belt *and* braces to stop my trousers falling down:
+test "X$lt_cv_prog_cc_static_works" = Xno && lt_cv_prog_cc_static=
+AC_MSG_RESULT([$lt_cv_prog_cc_static_works])
+
+pic_flag="$lt_cv_prog_cc_pic"
+special_shlib_compile_flags="$lt_cv_prog_cc_shlib"
+wl="$lt_cv_prog_cc_wl"
+link_static_flag="$lt_cv_prog_cc_static"
+no_builtin_flag="$lt_cv_prog_cc_no_builtin"
+can_build_shared="$lt_cv_prog_cc_can_build_shared"
+
+
+# Check to see if options -o and -c are simultaneously supported by compiler
+AC_MSG_CHECKING([if $compiler supports -c -o file.$ac_objext])
+AC_CACHE_VAL([lt_cv_compiler_c_o], [
+$rm -r conftest 2>/dev/null
+mkdir conftest
+cd conftest
+echo "int some_variable = 0;" > conftest.$ac_ext
+mkdir out
+# According to Tom Tromey, Ian Lance Taylor reported there are C compilers
+# that will create temporary files in the current directory regardless of
+# the output directory.  Thus, making CWD read-only will cause this test
+# to fail, enabling locking or at least warning the user not to do parallel
+# builds.
+chmod -w .
+save_CFLAGS="$CFLAGS"
+CFLAGS="$CFLAGS -o out/conftest2.$ac_objext"
+compiler_c_o=no
+if { (eval echo configure:__oline__: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>out/conftest.err; } && test -s out/conftest2.$ac_objext; then
+  # The compiler can only warn and ignore the option if not recognized
+  # So say no if there are warnings
+  if test -s out/conftest.err; then
+    lt_cv_compiler_c_o=no
+  else
+    lt_cv_compiler_c_o=yes
+  fi
+else
+  # Append any errors to the config.log.
+  cat out/conftest.err 1>&AC_FD_CC
+  lt_cv_compiler_c_o=no
+fi
+CFLAGS="$save_CFLAGS"
+chmod u+w .
+$rm conftest* out/*
+rmdir out
+cd ..
+rmdir conftest
+$rm -r conftest 2>/dev/null
+])
+compiler_c_o=$lt_cv_compiler_c_o
+AC_MSG_RESULT([$compiler_c_o])
+
+if test x"$compiler_c_o" = x"yes"; then
+  # Check to see if we can write to a .lo
+  AC_MSG_CHECKING([if $compiler supports -c -o file.lo])
+  AC_CACHE_VAL([lt_cv_compiler_o_lo], [
+  lt_cv_compiler_o_lo=no
+  save_CFLAGS="$CFLAGS"
+  CFLAGS="$CFLAGS -c -o conftest.lo"
+  save_objext="$ac_objext"
+  ac_objext=lo
+  AC_TRY_COMPILE([], [int some_variable = 0;], [dnl
+    # The compiler can only warn and ignore the option if not recognized
+    # So say no if there are warnings
+    if test -s conftest.err; then
+      lt_cv_compiler_o_lo=no
+    else
+      lt_cv_compiler_o_lo=yes
+    fi
+  ])
+  ac_objext="$save_objext"
+  CFLAGS="$save_CFLAGS"
+  ])
+  compiler_o_lo=$lt_cv_compiler_o_lo
+  AC_MSG_RESULT([$compiler_o_lo])
+else
+  compiler_o_lo=no
+fi
+
+# Check to see if we can do hard links to lock some files if needed
+hard_links="nottested"
+if test "$compiler_c_o" = no && test "$need_locks" != no; then
+  # do not overwrite the value of need_locks provided by the user
+  AC_MSG_CHECKING([if we can lock with hard links])
+  hard_links=yes
+  $rm conftest*
+  ln conftest.a conftest.b 2>/dev/null && hard_links=no
+  touch conftest.a
+  ln conftest.a conftest.b 2>&5 || hard_links=no
+  ln conftest.a conftest.b 2>/dev/null && hard_links=no
+  AC_MSG_RESULT([$hard_links])
+  if test "$hard_links" = no; then
+    AC_MSG_WARN([\`$CC' does not support \`-c -o', so \`make -j' may be unsafe])
+    need_locks=warn
+  fi
+else
+  need_locks=no
+fi
+
+if test "$GCC" = yes; then
+  # Check to see if options -fno-rtti -fno-exceptions are supported by compiler
+  AC_MSG_CHECKING([if $compiler supports -fno-rtti -fno-exceptions])
+  echo "int some_variable = 0;" > conftest.$ac_ext
+  save_CFLAGS="$CFLAGS"
+  CFLAGS="$CFLAGS -fno-rtti -fno-exceptions -c conftest.$ac_ext"
+  compiler_rtti_exceptions=no
+  AC_TRY_COMPILE([], [int some_variable = 0;], [dnl
+    # The compiler can only warn and ignore the option if not recognized
+    # So say no if there are warnings
+    if test -s conftest.err; then
+      compiler_rtti_exceptions=no
+    else
+      compiler_rtti_exceptions=yes
+    fi
+  ])
+  CFLAGS="$save_CFLAGS"
+  AC_MSG_RESULT([$compiler_rtti_exceptions])
+
+  if test "$compiler_rtti_exceptions" = "yes"; then
+    no_builtin_flag=' -fno-builtin -fno-rtti -fno-exceptions'
+  else
+    no_builtin_flag=' -fno-builtin'
+  fi
+fi
+
+# See if the linker supports building shared libraries.
+AC_MSG_CHECKING([whether the linker ($LD) supports shared libraries])
+
+allow_undefined_flag=
+no_undefined_flag=
+need_lib_prefix=unknown
+need_version=unknown
+# when you set need_version to no, make sure it does not cause -set_version
+# flags to be left without arguments
+archive_cmds=
+archive_expsym_cmds=
+old_archive_from_new_cmds=
+old_archive_from_expsyms_cmds=
+export_dynamic_flag_spec=
+whole_archive_flag_spec=
+thread_safe_flag_spec=
+hardcode_into_libs=no
+hardcode_libdir_flag_spec=
+hardcode_libdir_separator=
+hardcode_direct=no
+hardcode_minus_L=no
+hardcode_shlibpath_var=unsupported
+runpath_var=
+link_all_deplibs=unknown
+always_export_symbols=no
+export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | sed '\''s/.* //'\'' | sort | uniq > $export_symbols'
+# include_expsyms should be a list of space-separated symbols to be *always*
+# included in the symbol list
+include_expsyms=
+# exclude_expsyms can be an egrep regular expression of symbols to exclude
+# it will be wrapped by ` (' and `)$', so one must not match beginning or
+# end of line.  Example: `a|bc|.*d.*' will exclude the symbols `a' and `bc',
+# as well as any symbol that contains `d'.
+exclude_expsyms="_GLOBAL_OFFSET_TABLE_"
+# Although _GLOBAL_OFFSET_TABLE_ is a valid symbol C name, most a.out
+# platforms (ab)use it in PIC code, but their linkers get confused if
+# the symbol is explicitly referenced.  Since portable code cannot
+# rely on this symbol name, it's probably fine to never include it in
+# preloaded symbol tables.
+extract_expsyms_cmds=
+
+case $host_os in
+cygwin* | mingw* | pw32*)
+  # FIXME: the MSVC++ port hasn't been tested in a loooong time
+  # When not using gcc, we currently assume that we are using
+  # Microsoft Visual C++.
+  if test "$GCC" != yes; then
+    with_gnu_ld=no
+  fi
+  ;;
+openbsd*)
+  with_gnu_ld=no
+  ;;
+esac
+
+ld_shlibs=yes
+if test "$with_gnu_ld" = yes; then
+  # If archive_cmds runs LD, not CC, wlarc should be empty
+  wlarc='${wl}'
+
+  # See if GNU ld supports shared libraries.
+  case $host_os in
+  aix3* | aix4* | aix5*)
+    # On AIX, the GNU linker is very broken
+    # Note:Check GNU linker on AIX 5-IA64 when/if it becomes available.
+    ld_shlibs=no
+    cat <<EOF 1>&2
+
+*** Warning: the GNU linker, at least up to release 2.9.1, is reported
+*** to be unable to reliably create shared libraries on AIX.
+*** Therefore, libtool is disabling shared libraries support.  If you
+*** really care for shared libraries, you may want to modify your PATH
+*** so that a non-GNU linker is found, and then restart.
+
+EOF
+    ;;
+
+  amigaos*)
+    archive_cmds='$rm $output_objdir/a2ixlibrary.data~$echo "#define NAME $libname" > $output_objdir/a2ixlibrary.data~$echo "#define LIBRARY_ID 1" >> $output_objdir/a2ixlibrary.data~$echo "#define VERSION $major" >> $output_objdir/a2ixlibrary.data~$echo "#define REVISION $revision" >> $output_objdir/a2ixlibrary.data~$AR $AR_FLAGS $lib $libobjs~$RANLIB $lib~(cd $output_objdir && a2ixlibrary -32)'
+    hardcode_libdir_flag_spec='-L$libdir'
+    hardcode_minus_L=yes
+
+    # Samuel A. Falvo II <kc5tja@dolphin.openprojects.net> reports
+    # that the semantics of dynamic libraries on AmigaOS, at least up
+    # to version 4, is to share data among multiple programs linked
+    # with the same dynamic library.  Since this doesn't match the
+    # behavior of shared libraries on other platforms, we can use
+    # them.
+    ld_shlibs=no
+    ;;
+
+  beos*)
+    if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      allow_undefined_flag=unsupported
+      # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
+      # support --undefined.  This deserves some investigation.  FIXME
+      archive_cmds='$CC -nostart $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+    else
+      ld_shlibs=no
+    fi
+    ;;
+
+  cygwin* | mingw* | pw32*)
+    # hardcode_libdir_flag_spec is actually meaningless, as there is
+    # no search path for DLLs.
+    hardcode_libdir_flag_spec='-L$libdir'
+    allow_undefined_flag=unsupported
+    always_export_symbols=yes
+
+    extract_expsyms_cmds='test -f $output_objdir/impgen.c || \
+      sed -e "/^# \/\* impgen\.c starts here \*\//,/^# \/\* impgen.c ends here \*\// { s/^# //;s/^# *$//; p; }" -e d < $''0 > $output_objdir/impgen.c~
+      test -f $output_objdir/impgen.exe || (cd $output_objdir && \
+      if test "x$HOST_CC" != "x" ; then $HOST_CC -o impgen impgen.c ; \
+      else $CC -o impgen impgen.c ; fi)~
+      $output_objdir/impgen $dir/$soroot > $output_objdir/$soname-def'
+
+    old_archive_from_expsyms_cmds='$DLLTOOL --as=$AS --dllname $soname --def $output_objdir/$soname-def --output-lib $output_objdir/$newlib'
+
+    # cygwin and mingw dlls have different entry points and sets of symbols
+    # to exclude.
+    # FIXME: what about values for MSVC?
+    dll_entry=__cygwin_dll_entry@12
+    dll_exclude_symbols=DllMain@12,_cygwin_dll_entry@12,_cygwin_noncygwin_dll_entry@12~
+    case $host_os in
+    mingw*)
+      # mingw values
+      dll_entry=_DllMainCRTStartup@12
+      dll_exclude_symbols=DllMain@12,DllMainCRTStartup@12,DllEntryPoint@12~
+      ;;
+    esac
+
+    # mingw and cygwin differ, and it's simplest to just exclude the union
+    # of the two symbol sets.
+    dll_exclude_symbols=DllMain@12,_cygwin_dll_entry@12,_cygwin_noncygwin_dll_entry@12,DllMainCRTStartup@12,DllEntryPoint@12
+
+    # recent cygwin and mingw systems supply a stub DllMain which the user
+    # can override, but on older systems we have to supply one (in ltdll.c)
+    if test "x$lt_cv_need_dllmain" = "xyes"; then
+      ltdll_obj='$output_objdir/$soname-ltdll.'"$ac_objext "
+      ltdll_cmds='test -f $output_objdir/$soname-ltdll.c || sed -e "/^# \/\* ltdll\.c starts here \*\//,/^# \/\* ltdll.c ends here \*\// { s/^# //; p; }" -e d < $''0 > $output_objdir/$soname-ltdll.c~
+	test -f $output_objdir/$soname-ltdll.$ac_objext || (cd $output_objdir && $CC -c $soname-ltdll.c)~'
+    else
+      ltdll_obj=
+      ltdll_cmds=
+    fi
+
+    # Extract the symbol export list from an `--export-all' def file,
+    # then regenerate the def file from the symbol export list, so that
+    # the compiled dll only exports the symbol export list.
+    # Be careful not to strip the DATA tag left be newer dlltools.
+    export_symbols_cmds="$ltdll_cmds"'
+      $DLLTOOL --export-all --exclude-symbols '$dll_exclude_symbols' --output-def $output_objdir/$soname-def '$ltdll_obj'$libobjs $convenience~
+      sed -e "1,/EXPORTS/d" -e "s/ @ [[0-9]]*//" -e "s/ *;.*$//" < $output_objdir/$soname-def > $export_symbols'
+
+    # If the export-symbols file already is a .def file (1st line
+    # is EXPORTS), use it as is.
+    # If DATA tags from a recent dlltool are present, honour them!
+    archive_expsym_cmds='if test "x`sed 1q $export_symbols`" = xEXPORTS; then
+	cp $export_symbols $output_objdir/$soname-def;
+      else
+	echo EXPORTS > $output_objdir/$soname-def;
+	_lt_hint=1;
+	cat $export_symbols | while read symbol; do
+	 set dummy \$symbol;
+	 case \[$]# in
+	   2) echo "   \[$]2 @ \$_lt_hint ; " >> $output_objdir/$soname-def;;
+	   4) echo "   \[$]2 \[$]3 \[$]4 ; " >> $output_objdir/$soname-def; _lt_hint=`expr \$_lt_hint - 1`;;
+	   *) echo "     \[$]2 @ \$_lt_hint \[$]3 ; " >> $output_objdir/$soname-def;;
+	 esac;
+	 _lt_hint=`expr 1 + \$_lt_hint`;
+	done;
+      fi~
+      '"$ltdll_cmds"'
+      $CC -Wl,--base-file,$output_objdir/$soname-base '$lt_cv_cc_dll_switch' -Wl,-e,'$dll_entry' -o $output_objdir/$soname '$ltdll_obj'$libobjs $deplibs $compiler_flags~
+      $DLLTOOL --as=$AS --dllname $soname --exclude-symbols '$dll_exclude_symbols' --def $output_objdir/$soname-def --base-file $output_objdir/$soname-base --output-exp $output_objdir/$soname-exp~
+      $CC -Wl,--base-file,$output_objdir/$soname-base $output_objdir/$soname-exp '$lt_cv_cc_dll_switch' -Wl,-e,'$dll_entry' -o $output_objdir/$soname '$ltdll_obj'$libobjs $deplibs $compiler_flags~
+      $DLLTOOL --as=$AS --dllname $soname --exclude-symbols '$dll_exclude_symbols' --def $output_objdir/$soname-def --base-file $output_objdir/$soname-base --output-exp $output_objdir/$soname-exp --output-lib $output_objdir/$libname.dll.a~
+      $CC $output_objdir/$soname-exp '$lt_cv_cc_dll_switch' -Wl,-e,'$dll_entry' -o $output_objdir/$soname '$ltdll_obj'$libobjs $deplibs $compiler_flags'
+    ;;
+
+  netbsd*)
+    if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
+      archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
+      wlarc=
+    else
+      archive_cmds='$CC -shared -nodefaultlibs $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+      archive_expsym_cmds='$CC -shared -nodefaultlibs $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
+    fi
+    ;;
+
+  solaris* | sysv5*)
+    if $LD -v 2>&1 | egrep 'BFD 2\.8' > /dev/null; then
+      ld_shlibs=no
+      cat <<EOF 1>&2
+
+*** Warning: The releases 2.8.* of the GNU linker cannot reliably
+*** create shared libraries on Solaris systems.  Therefore, libtool
+*** is disabling shared libraries support.  We urge you to upgrade GNU
+*** binutils to release 2.9.1 or newer.  Another option is to modify
+*** your PATH or compiler configuration so that the native linker is
+*** used, and then restart.
+
+EOF
+    elif $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+      archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
+    else
+      ld_shlibs=no
+    fi
+    ;;
+
+  sunos4*)
+    archive_cmds='$LD -assert pure-text -Bshareable -o $lib $libobjs $deplibs $linker_flags'
+    wlarc=
+    hardcode_direct=yes
+    hardcode_shlibpath_var=no
+    ;;
+
+  *)
+    if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+      archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
+    else
+      ld_shlibs=no
+    fi
+    ;;
+  esac
+
+  if test "$ld_shlibs" = yes; then
+    runpath_var=LD_RUN_PATH
+    hardcode_libdir_flag_spec='${wl}--rpath ${wl}$libdir'
+    export_dynamic_flag_spec='${wl}--export-dynamic'
+    case $host_os in
+    cygwin* | mingw* | pw32*)
+      # dlltool doesn't understand --whole-archive et. al.
+      whole_archive_flag_spec=
+      ;;
+    *)
+      # ancient GNU ld didn't support --whole-archive et. al.
+      if $LD --help 2>&1 | egrep 'no-whole-archive' > /dev/null; then
+	whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
+      else
+	whole_archive_flag_spec=
+      fi
+      ;;
+    esac
+  fi
+else
+  # PORTME fill in a description of your system's linker (not GNU ld)
+  case $host_os in
+  aix3*)
+    allow_undefined_flag=unsupported
+    always_export_symbols=yes
+    archive_expsym_cmds='$LD -o $output_objdir/$soname $libobjs $deplibs $linker_flags -bE:$export_symbols -T512 -H512 -bM:SRE~$AR $AR_FLAGS $lib $output_objdir/$soname'
+    # Note: this linker hardcodes the directories in LIBPATH if there
+    # are no directories specified by -L.
+    hardcode_minus_L=yes
+    if test "$GCC" = yes && test -z "$link_static_flag"; then
+      # Neither direct hardcoding nor static linking is supported with a
+      # broken collect2.
+      hardcode_direct=unsupported
+    fi
+    ;;
+
+  aix4* | aix5*)
+    if test "$host_cpu" = ia64; then
+      # On IA64, the linker does run time linking by default, so we don't
+      # have to do anything special.
+      aix_use_runtimelinking=no
+      exp_sym_flag='-Bexport'
+      no_entry_flag=""
+    else
+      aix_use_runtimelinking=no
+
+      # Test if we are trying to use run time linking or normal
+      # AIX style linking. If -brtl is somewhere in LDFLAGS, we
+      # need to do runtime linking.
+      case $host_os in aix4.[[23]]|aix4.[[23]].*|aix5*)
+	for ld_flag in $LDFLAGS; do
+	  case $ld_flag in
+	  *-brtl*)
+	    aix_use_runtimelinking=yes
+	    break
+	  ;;
+	  esac
+	done
+      esac
+
+      exp_sym_flag='-bexport'
+      no_entry_flag='-bnoentry'
+    fi
+
+    # When large executables or shared objects are built, AIX ld can
+    # have problems creating the table of contents.  If linking a library
+    # or program results in "error TOC overflow" add -mminimal-toc to
+    # CXXFLAGS/CFLAGS for g++/gcc.  In the cases where that is not
+    # enough to fix the problem, add -Wl,-bbigtoc to LDFLAGS.
+
+    hardcode_direct=yes
+    archive_cmds=''
+    hardcode_libdir_separator=':'
+    if test "$GCC" = yes; then
+      case $host_os in aix4.[[012]]|aix4.[[012]].*)
+	collect2name=`${CC} -print-prog-name=collect2`
+	if test -f "$collect2name" && \
+	  strings "$collect2name" | grep resolve_lib_name >/dev/null
+	then
+	  # We have reworked collect2
+	  hardcode_direct=yes
+	else
+	  # We have old collect2
+	  hardcode_direct=unsupported
+	  # It fails to find uninstalled libraries when the uninstalled
+	  # path is not listed in the libpath.  Setting hardcode_minus_L
+	  # to unsupported forces relinking
+	  hardcode_minus_L=yes
+	  hardcode_libdir_flag_spec='-L$libdir'
+	  hardcode_libdir_separator=
+	fi
+      esac
+
+      shared_flag='-shared'
+    else
+      # not using gcc
+      if test "$host_cpu" = ia64; then
+	shared_flag='${wl}-G'
+      else
+	if test "$aix_use_runtimelinking" = yes; then
+	  shared_flag='${wl}-G'
+	else
+	  shared_flag='${wl}-bM:SRE'
+	fi
+      fi
+    fi
+
+    # It seems that -bexpall can do strange things, so it is better to
+    # generate a list of symbols to export.
+    always_export_symbols=yes
+    if test "$aix_use_runtimelinking" = yes; then
+      # Warning - without using the other runtime loading flags (-brtl),
+      # -berok will link without error, but may produce a broken library.
+      allow_undefined_flag='-berok'
+      hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:/usr/lib:/lib'
+      archive_expsym_cmds="\$CC"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags `if test "x${allow_undefined_flag}" != "x"; then echo "${wl}${allow_undefined_flag}"; else :; fi` '"\${wl}$no_entry_flag \${wl}$exp_sym_flag:\$export_symbols $shared_flag"
+    else
+      if test "$host_cpu" = ia64; then
+	hardcode_libdir_flag_spec='${wl}-R $libdir:/usr/lib:/lib'
+	allow_undefined_flag="-z nodefs"
+	archive_expsym_cmds="\$CC $shared_flag"' -o $output_objdir/$soname ${wl}-h$soname $libobjs $deplibs $compiler_flags ${wl}${allow_undefined_flag} '"\${wl}$no_entry_flag \${wl}$exp_sym_flag:\$export_symbols"
+      else
+	hardcode_libdir_flag_spec='${wl}-bnolibpath ${wl}-blibpath:$libdir:/usr/lib:/lib'
+	# Warning - without using the other run time loading flags,
+	# -berok will link without error, but may produce a broken library.
+	allow_undefined_flag='${wl}-berok'
+	# This is a bit strange, but is similar to how AIX traditionally builds
+	# it's shared libraries.
+	archive_expsym_cmds="\$CC $shared_flag"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${allow_undefined_flag} '"\${wl}$no_entry_flag \${wl}$exp_sym_flag:\$export_symbols"' ~$AR -crlo $objdir/$libname$release.a $objdir/$soname'
+      fi
+    fi
+    ;;
+
+  amigaos*)
+    archive_cmds='$rm $output_objdir/a2ixlibrary.data~$echo "#define NAME $libname" > $output_objdir/a2ixlibrary.data~$echo "#define LIBRARY_ID 1" >> $output_objdir/a2ixlibrary.data~$echo "#define VERSION $major" >> $output_objdir/a2ixlibrary.data~$echo "#define REVISION $revision" >> $output_objdir/a2ixlibrary.data~$AR $AR_FLAGS $lib $libobjs~$RANLIB $lib~(cd $output_objdir && a2ixlibrary -32)'
+    hardcode_libdir_flag_spec='-L$libdir'
+    hardcode_minus_L=yes
+    # see comment about different semantics on the GNU ld section
+    ld_shlibs=no
+    ;;
+
+  cygwin* | mingw* | pw32*)
+    # When not using gcc, we currently assume that we are using
+    # Microsoft Visual C++.
+    # hardcode_libdir_flag_spec is actually meaningless, as there is
+    # no search path for DLLs.
+    hardcode_libdir_flag_spec=' '
+    allow_undefined_flag=unsupported
+    # Tell ltmain to make .lib files, not .a files.
+    libext=lib
+    # FIXME: Setting linknames here is a bad hack.
+    archive_cmds='$CC -o $lib $libobjs $compiler_flags `echo "$deplibs" | sed -e '\''s/ -lc$//'\''` -link -dll~linknames='
+    # The linker will automatically build a .lib file if we build a DLL.
+    old_archive_from_new_cmds='true'
+    # FIXME: Should let the user specify the lib program.
+    old_archive_cmds='lib /OUT:$oldlib$oldobjs$old_deplibs'
+    fix_srcfile_path='`cygpath -w "$srcfile"`'
+    ;;
+
+  darwin* | rhapsody*)
+    case "$host_os" in
+    rhapsody* | darwin1.[[012]])
+      allow_undefined_flag='-undefined suppress'
+      ;;
+    *) # Darwin 1.3 on
+      allow_undefined_flag='-flat_namespace -undefined suppress'
+      ;;
+    esac
+    # FIXME: Relying on posixy $() will cause problems for
+    #        cross-compilation, but unfortunately the echo tests do not
+    #        yet detect zsh echo's removal of \ escapes.  Also zsh mangles
+    #	     `"' quotes if we put them in here... so don't!
+    archive_cmds='$CC -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs && $CC $(test .$module = .yes && echo -bundle || echo -dynamiclib) $allow_undefined_flag -o $lib ${lib}-master.o $deplibs$linker_flags $(test .$module != .yes && echo -install_name $rpath/$soname $verstring)'
+    # We need to add '_' to the symbols in $export_symbols first
+    #archive_expsym_cmds="$archive_cmds"' && strip -s $export_symbols'
+    hardcode_direct=yes
+    hardcode_shlibpath_var=no
+    whole_archive_flag_spec='-all_load $convenience'
+    ;;
+
+  freebsd1*)
+    ld_shlibs=no
+    ;;
+
+  # FreeBSD 2.2.[012] allows us to include c++rt0.o to get C++ constructor
+  # support.  Future versions do this automatically, but an explicit c++rt0.o
+  # does not break anything, and helps significantly (at the cost of a little
+  # extra space).
+  freebsd2.2*)
+    archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags /usr/lib/c++rt0.o'
+    hardcode_libdir_flag_spec='-R$libdir'
+    hardcode_direct=yes
+    hardcode_shlibpath_var=no
+    ;;
+
+  # Unfortunately, older versions of FreeBSD 2 do not have this feature.
+  freebsd2*)
+    archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
+    hardcode_direct=yes
+    hardcode_minus_L=yes
+    hardcode_shlibpath_var=no
+    ;;
+
+  # FreeBSD 3 and greater uses gcc -shared to do shared libraries.
+  freebsd*)
+    archive_cmds='$CC -shared -o $lib $libobjs $deplibs $compiler_flags'
+    hardcode_libdir_flag_spec='-R$libdir'
+    hardcode_direct=yes
+    hardcode_shlibpath_var=no
+    ;;
+
+  hpux9* | hpux10* | hpux11*)
+    case $host_os in
+    hpux9*) archive_cmds='$rm $output_objdir/$soname~$LD -b +b $install_libdir -o $output_objdir/$soname $libobjs $deplibs $linker_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib' ;;
+    *) archive_cmds='$LD -b +h $soname +b $install_libdir -o $lib $libobjs $deplibs $linker_flags' ;;
+    esac
+    hardcode_libdir_flag_spec='${wl}+b ${wl}$libdir'
+    hardcode_libdir_separator=:
+    hardcode_direct=yes
+    hardcode_minus_L=yes # Not in the search PATH, but as the default
+			 # location of the library.
+    export_dynamic_flag_spec='${wl}-E'
+    ;;
+
+  irix5* | irix6* | nonstopux*)
+    if test "$GCC" = yes; then
+      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
+      hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
+    else
+      archive_cmds='$LD -shared $libobjs $deplibs $linker_flags -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
+      hardcode_libdir_flag_spec='-rpath $libdir'
+    fi
+    hardcode_libdir_separator=:
+    link_all_deplibs=yes
+    ;;
+
+  netbsd*)
+    if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
+      archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
+    else
+      archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
+    fi
+    hardcode_libdir_flag_spec='-R$libdir'
+    hardcode_direct=yes
+    hardcode_shlibpath_var=no
+    ;;
+
+  newsos6)
+    archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+    hardcode_direct=yes
+    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
+    hardcode_libdir_separator=:
+    hardcode_shlibpath_var=no
+    ;;
+
+  openbsd*)
+    hardcode_direct=yes
+    hardcode_shlibpath_var=no
+    if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+      archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+      hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
+      export_dynamic_flag_spec='${wl}-E'
+    else
+      case "$host_os" in
+      openbsd[[01]].* | openbsd2.[[0-7]] | openbsd2.[[0-7]].*)
+	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
+	hardcode_libdir_flag_spec='-R$libdir'
+        ;;
+      *)
+        archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+        hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
+        ;;
+      esac
+    fi
+    ;;
+
+  os2*)
+    hardcode_libdir_flag_spec='-L$libdir'
+    hardcode_minus_L=yes
+    allow_undefined_flag=unsupported
+    archive_cmds='$echo "LIBRARY $libname INITINSTANCE" > $output_objdir/$libname.def~$echo "DESCRIPTION \"$libname\"" >> $output_objdir/$libname.def~$echo DATA >> $output_objdir/$libname.def~$echo " SINGLE NONSHARED" >> $output_objdir/$libname.def~$echo EXPORTS >> $output_objdir/$libname.def~emxexp $libobjs >> $output_objdir/$libname.def~$CC -Zdll -Zcrtdll -o $lib $libobjs $deplibs $compiler_flags $output_objdir/$libname.def'
+    old_archive_from_new_cmds='emximp -o $output_objdir/$libname.a $output_objdir/$libname.def'
+    ;;
+
+  osf3*)
+    if test "$GCC" = yes; then
+      allow_undefined_flag=' ${wl}-expect_unresolved ${wl}\*'
+      archive_cmds='$CC -shared${allow_undefined_flag} $libobjs $deplibs $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
+    else
+      allow_undefined_flag=' -expect_unresolved \*'
+      archive_cmds='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
+    fi
+    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
+    hardcode_libdir_separator=:
+    ;;
+
+  osf4* | osf5*)	# as osf3* with the addition of -msym flag
+    if test "$GCC" = yes; then
+      allow_undefined_flag=' ${wl}-expect_unresolved ${wl}\*'
+      archive_cmds='$CC -shared${allow_undefined_flag} $libobjs $deplibs $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
+      hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
+    else
+      allow_undefined_flag=' -expect_unresolved \*'
+      archive_cmds='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -msym -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
+      archive_expsym_cmds='for i in `cat $export_symbols`; do printf "-exported_symbol " >> $lib.exp; echo "\$i" >> $lib.exp; done; echo "-hidden">> $lib.exp~
+      $LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib~$rm $lib.exp'
+
+      #Both c and cxx compiler support -rpath directly
+      hardcode_libdir_flag_spec='-rpath $libdir'
+    fi
+    hardcode_libdir_separator=:
+    ;;
+
+  sco3.2v5*)
+    archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+    hardcode_shlibpath_var=no
+    runpath_var=LD_RUN_PATH
+    hardcode_runpath_var=yes
+    export_dynamic_flag_spec='${wl}-Bexport'
+    ;;
+
+  solaris*)
+    # gcc --version < 3.0 without binutils cannot create self contained
+    # shared libraries reliably, requiring libgcc.a to resolve some of
+    # the object symbols generated in some cases.  Libraries that use
+    # assert need libgcc.a to resolve __eprintf, for example.  Linking
+    # a copy of libgcc.a into every shared library to guarantee resolving
+    # such symbols causes other problems:  According to Tim Van Holder
+    # <tim.van.holder@pandora.be>, C++ libraries end up with a separate
+    # (to the application) exception stack for one thing.
+    no_undefined_flag=' -z defs'
+    if test "$GCC" = yes; then
+      case `$CC --version 2>/dev/null` in
+      [[12]].*)
+	cat <<EOF 1>&2
+
+*** Warning: Releases of GCC earlier than version 3.0 cannot reliably
+*** create self contained shared libraries on Solaris systems, without
+*** introducing a dependency on libgcc.a.  Therefore, libtool is disabling
+*** -no-undefined support, which will at least allow you to build shared
+*** libraries.  However, you may find that when you link such libraries
+*** into an application without using GCC, you have to manually add
+*** \`gcc --print-libgcc-file-name\` to the link command.  We urge you to
+*** upgrade to a newer version of GCC.  Another option is to rebuild your
+*** current GCC to use the GNU linker from GNU binutils 2.9.1 or newer.
+
+EOF
+        no_undefined_flag=
+	;;
+      esac
+    fi
+    # $CC -shared without GNU ld will not create a library from C++
+    # object files and a static libstdc++, better avoid it by now
+    archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
+    archive_expsym_cmds='$echo "{ global:" > $lib.exp~cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
+		$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
+    hardcode_libdir_flag_spec='-R$libdir'
+    hardcode_shlibpath_var=no
+    case $host_os in
+    solaris2.[[0-5]] | solaris2.[[0-5]].*) ;;
+    *) # Supported since Solaris 2.6 (maybe 2.5.1?)
+      whole_archive_flag_spec='-z allextract$convenience -z defaultextract' ;;
+    esac
+    link_all_deplibs=yes
+    ;;
+
+  sunos4*)
+    if test "x$host_vendor" = xsequent; then
+      # Use $CC to link under sequent, because it throws in some extra .o
+      # files that make .init and .fini sections work.
+      archive_cmds='$CC -G ${wl}-h $soname -o $lib $libobjs $deplibs $compiler_flags'
+    else
+      archive_cmds='$LD -assert pure-text -Bstatic -o $lib $libobjs $deplibs $linker_flags'
+    fi
+    hardcode_libdir_flag_spec='-L$libdir'
+    hardcode_direct=yes
+    hardcode_minus_L=yes
+    hardcode_shlibpath_var=no
+    ;;
+
+  sysv4)
+    case $host_vendor in
+      sni)
+        archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+        hardcode_direct=yes # is this really true???
+        ;;
+      siemens)
+        ## LD is ld it makes a PLAMLIB
+        ## CC just makes a GrossModule.
+        archive_cmds='$LD -G -o $lib $libobjs $deplibs $linker_flags'
+        reload_cmds='$CC -r -o $output$reload_objs'
+        hardcode_direct=no
+        ;;
+      motorola)
+        archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+        hardcode_direct=no #Motorola manual says yes, but my tests say they lie
+        ;;
+    esac
+    runpath_var='LD_RUN_PATH'
+    hardcode_shlibpath_var=no
+    ;;
+
+  sysv4.3*)
+    archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+    hardcode_shlibpath_var=no
+    export_dynamic_flag_spec='-Bexport'
+    ;;
+
+  sysv5*)
+    no_undefined_flag=' -z text'
+    # $CC -shared without GNU ld will not create a library from C++
+    # object files and a static libstdc++, better avoid it by now
+    archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
+    archive_expsym_cmds='$echo "{ global:" > $lib.exp~cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
+		$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
+    hardcode_libdir_flag_spec=
+    hardcode_shlibpath_var=no
+    runpath_var='LD_RUN_PATH'
+    ;;
+
+  uts4*)
+    archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+    hardcode_libdir_flag_spec='-L$libdir'
+    hardcode_shlibpath_var=no
+    ;;
+
+  dgux*)
+    archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+    hardcode_libdir_flag_spec='-L$libdir'
+    hardcode_shlibpath_var=no
+    ;;
+
+  sysv4*MP*)
+    if test -d /usr/nec; then
+      archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+      hardcode_shlibpath_var=no
+      runpath_var=LD_RUN_PATH
+      hardcode_runpath_var=yes
+      ld_shlibs=yes
+    fi
+    ;;
+
+  sysv4.2uw2*)
+    archive_cmds='$LD -G -o $lib $libobjs $deplibs $linker_flags'
+    hardcode_direct=yes
+    hardcode_minus_L=no
+    hardcode_shlibpath_var=no
+    hardcode_runpath_var=yes
+    runpath_var=LD_RUN_PATH
+    ;;
+
+  sysv5uw7* | unixware7*)
+    no_undefined_flag='${wl}-z ${wl}text'
+    if test "$GCC" = yes; then
+      archive_cmds='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
+    else
+      archive_cmds='$CC -G ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
+    fi
+    runpath_var='LD_RUN_PATH'
+    hardcode_shlibpath_var=no
+    ;;
+
+  *)
+    ld_shlibs=no
+    ;;
+  esac
+fi
+AC_MSG_RESULT([$ld_shlibs])
+test "$ld_shlibs" = no && can_build_shared=no
+
+# Check hardcoding attributes.
+AC_MSG_CHECKING([how to hardcode library paths into programs])
+hardcode_action=
+if test -n "$hardcode_libdir_flag_spec" || \
+   test -n "$runpath_var"; then
+
+  # We can hardcode non-existant directories.
+  if test "$hardcode_direct" != no &&
+     # If the only mechanism to avoid hardcoding is shlibpath_var, we
+     # have to relink, otherwise we might link with an installed library
+     # when we should be linking with a yet-to-be-installed one
+     ## test "$hardcode_shlibpath_var" != no &&
+     test "$hardcode_minus_L" != no; then
+    # Linking always hardcodes the temporary library directory.
+    hardcode_action=relink
+  else
+    # We can link without hardcoding, and we can hardcode nonexisting dirs.
+    hardcode_action=immediate
+  fi
+else
+  # We cannot hardcode anything, or else we can only hardcode existing
+  # directories.
+  hardcode_action=unsupported
+fi
+AC_MSG_RESULT([$hardcode_action])
+
+striplib=
+old_striplib=
+AC_MSG_CHECKING([whether stripping libraries is possible])
+if test -n "$STRIP" && $STRIP -V 2>&1 | grep "GNU strip" >/dev/null; then
+  test -z "$old_striplib" && old_striplib="$STRIP --strip-debug"
+  test -z "$striplib" && striplib="$STRIP --strip-unneeded"
+  AC_MSG_RESULT([yes])
+else
+  AC_MSG_RESULT([no])
+fi
+
+reload_cmds='$LD$reload_flag -o $output$reload_objs'
+test -z "$deplibs_check_method" && deplibs_check_method=unknown
+
+# PORTME Fill in your ld.so characteristics
+AC_MSG_CHECKING([dynamic linker characteristics])
+library_names_spec=
+libname_spec='lib$name'
+soname_spec=
+postinstall_cmds=
+postuninstall_cmds=
+finish_cmds=
+finish_eval=
+shlibpath_var=
+shlibpath_overrides_runpath=unknown
+version_type=none
+dynamic_linker="$host_os ld.so"
+sys_lib_dlsearch_path_spec="/lib /usr/lib"
+sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
+
+case $host_os in
+aix3*)
+  version_type=linux
+  library_names_spec='${libname}${release}.so$versuffix $libname.a'
+  shlibpath_var=LIBPATH
+
+  # AIX has no versioning support, so we append a major version to the name.
+  soname_spec='${libname}${release}.so$major'
+  ;;
+
+aix4* | aix5*)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  hardcode_into_libs=yes
+  if test "$host_cpu" = ia64; then
+    # AIX 5 supports IA64
+    library_names_spec='${libname}${release}.so$major ${libname}${release}.so$versuffix $libname.so'
+    shlibpath_var=LD_LIBRARY_PATH
+  else
+    # With GCC up to 2.95.x, collect2 would create an import file
+    # for dependence libraries.  The import file would start with
+    # the line `#! .'.  This would cause the generated library to
+    # depend on `.', always an invalid library.  This was fixed in
+    # development snapshots of GCC prior to 3.0.
+    case $host_os in
+      aix4 | aix4.[[01]] | aix4.[[01]].*)
+	if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
+	     echo ' yes '
+	     echo '#endif'; } | ${CC} -E - | grep yes > /dev/null; then
+	  :
+	else
+	  can_build_shared=no
+	fi
+	;;
+    esac
+    # AIX (on Power*) has no versioning support, so currently we can
+    # not hardcode correct soname into executable. Probably we can
+    # add versioning support to collect2, so additional links can
+    # be useful in future.
+    if test "$aix_use_runtimelinking" = yes; then
+      # If using run time linking (on AIX 4.2 or later) use lib<name>.so
+      # instead of lib<name>.a to let people know that these are not
+      # typical AIX shared libraries.
+      library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+    else
+      # We preserve .a as extension for shared libraries through AIX4.2
+      # and later when we are not doing run time linking.
+      library_names_spec='${libname}${release}.a $libname.a'
+      soname_spec='${libname}${release}.so$major'
+    fi
+    shlibpath_var=LIBPATH
+  fi
+  hardcode_into_libs=yes
+  ;;
+
+amigaos*)
+  library_names_spec='$libname.ixlibrary $libname.a'
+  # Create ${libname}_ixlibrary.a entries in /sys/libs.
+  finish_eval='for lib in `ls $libdir/*.ixlibrary 2>/dev/null`; do libname=`$echo "X$lib" | $Xsed -e '\''s%^.*/\([[^/]]*\)\.ixlibrary$%\1%'\''`; test $rm /sys/libs/${libname}_ixlibrary.a; $show "(cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a)"; (cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a) || exit 1; done'
+  ;;
+
+beos*)
+  library_names_spec='${libname}.so'
+  dynamic_linker="$host_os ld.so"
+  shlibpath_var=LIBRARY_PATH
+  ;;
+
+bsdi4*)
+  version_type=linux
+  need_version=no
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  soname_spec='${libname}${release}.so$major'
+  finish_cmds='PATH="\$PATH:/sbin" ldconfig $libdir'
+  shlibpath_var=LD_LIBRARY_PATH
+  sys_lib_search_path_spec="/shlib /usr/lib /usr/X11/lib /usr/contrib/lib /lib /usr/local/lib"
+  sys_lib_dlsearch_path_spec="/shlib /usr/lib /usr/local/lib"
+  export_dynamic_flag_spec=-rdynamic
+  # the default ld.so.conf also contains /usr/contrib/lib and
+  # /usr/X11R6/lib (/usr/X11 is a link to /usr/X11R6), but let us allow
+  # libtool to hard-code these into programs
+  ;;
+
+cygwin* | mingw* | pw32*)
+  version_type=windows
+  need_version=no
+  need_lib_prefix=no
+  case $GCC,$host_os in
+  yes,cygwin*)
+    library_names_spec='$libname.dll.a'
+    soname_spec='`echo ${libname} | sed -e 's/^lib/cyg/'``echo ${release} | sed -e 's/[[.]]/-/g'`${versuffix}.dll'
+    postinstall_cmds='dlpath=`bash 2>&1 -c '\''. $dir/${file}i;echo \$dlname'\''`~
+      dldir=$destdir/`dirname \$dlpath`~
+      test -d \$dldir || mkdir -p \$dldir~
+      $install_prog .libs/$dlname \$dldir/$dlname'
+    postuninstall_cmds='dldll=`bash 2>&1 -c '\''. $file; echo \$dlname'\''`~
+      dlpath=$dir/\$dldll~
+       $rm \$dlpath'
+    ;;
+  yes,mingw*)
+    library_names_spec='${libname}`echo ${release} | sed -e 's/[[.]]/-/g'`${versuffix}.dll'
+    sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | sed -e "s/^libraries://" -e "s/;/ /g" -e "s,=/,/,g"`
+    ;;
+  yes,pw32*)
+    library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | sed -e 's/[.]/-/g'`${versuffix}.dll'
+    ;;
+  *)
+    library_names_spec='${libname}`echo ${release} | sed -e 's/[[.]]/-/g'`${versuffix}.dll $libname.lib'
+    ;;
+  esac
+  dynamic_linker='Win32 ld.exe'
+  # FIXME: first we should search . and the directory the executable is in
+  shlibpath_var=PATH
+  ;;
+
+darwin* | rhapsody*)
+  dynamic_linker="$host_os dyld"
+  version_type=darwin
+  need_lib_prefix=no
+  need_version=no
+  # FIXME: Relying on posixy $() will cause problems for
+  #        cross-compilation, but unfortunately the echo tests do not
+  #        yet detect zsh echo's removal of \ escapes.
+  library_names_spec='${libname}${release}${versuffix}.$(test .$module = .yes && echo so || echo dylib) ${libname}${release}${major}.$(test .$module = .yes && echo so || echo dylib) ${libname}.$(test .$module = .yes && echo so || echo dylib)'
+  soname_spec='${libname}${release}${major}.$(test .$module = .yes && echo so || echo dylib)'
+  shlibpath_overrides_runpath=yes
+  shlibpath_var=DYLD_LIBRARY_PATH
+  ;;
+
+freebsd1*)
+  dynamic_linker=no
+  ;;
+
+freebsd*-gnu*)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  soname_spec='${libname}${release}.so$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=no
+  hardcode_into_libs=yes
+  dynamic_linker='GNU/FreeBSD ld.so'
+  ;;
+
+freebsd*)
+  objformat=`test -x /usr/bin/objformat && /usr/bin/objformat || echo aout`
+  version_type=freebsd-$objformat
+  case $version_type in
+    freebsd-elf*)
+      library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so $libname.so'
+      need_version=no
+      need_lib_prefix=no
+      ;;
+    freebsd-*)
+      library_names_spec='${libname}${release}.so$versuffix $libname.so$versuffix'
+      need_version=yes
+      ;;
+  esac
+  shlibpath_var=LD_LIBRARY_PATH
+  case $host_os in
+  freebsd2*)
+    shlibpath_overrides_runpath=yes
+    ;;
+  *)
+    shlibpath_overrides_runpath=no
+    hardcode_into_libs=yes
+    ;;
+  esac
+  ;;
+
+gnu*)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so${major} ${libname}.so'
+  soname_spec='${libname}${release}.so$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  hardcode_into_libs=yes
+  ;;
+
+hpux9* | hpux10* | hpux11*)
+  # Give a soname corresponding to the major version so that dld.sl refuses to
+  # link against other versions.
+  dynamic_linker="$host_os dld.sl"
+  version_type=sunos
+  need_lib_prefix=no
+  need_version=no
+  shlibpath_var=SHLIB_PATH
+  shlibpath_overrides_runpath=no # +s is required to enable SHLIB_PATH
+  library_names_spec='${libname}${release}.sl$versuffix ${libname}${release}.sl$major $libname.sl'
+  soname_spec='${libname}${release}.sl$major'
+  # HP-UX runs *really* slowly unless shared libraries are mode 555.
+  postinstall_cmds='chmod 555 $lib'
+  ;;
+
+irix5* | irix6* | nonstopux*)
+  case $host_os in
+    nonstopux*) version_type=nonstopux ;;
+    *)          version_type=irix ;;
+  esac
+  need_lib_prefix=no
+  need_version=no
+  soname_spec='${libname}${release}.so$major'
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major ${libname}${release}.so $libname.so'
+  case $host_os in
+  irix5* | nonstopux*)
+    libsuff= shlibsuff=
+    ;;
+  *)
+    case $LD in # libtool.m4 will add one of these switches to LD
+    *-32|*"-32 ") libsuff= shlibsuff= libmagic=32-bit;;
+    *-n32|*"-n32 ") libsuff=32 shlibsuff=N32 libmagic=N32;;
+    *-64|*"-64 ") libsuff=64 shlibsuff=64 libmagic=64-bit;;
+    *) libsuff= shlibsuff= libmagic=never-match;;
+    esac
+    ;;
+  esac
+  shlibpath_var=LD_LIBRARY${shlibsuff}_PATH
+  shlibpath_overrides_runpath=no
+  sys_lib_search_path_spec="/usr/lib${libsuff} /lib${libsuff} /usr/local/lib${libsuff}"
+  sys_lib_dlsearch_path_spec="/usr/lib${libsuff} /lib${libsuff}"
+  ;;
+
+# No shared lib support for Linux oldld, aout, or coff.
+linux-gnuoldld* | linux-gnuaout* | linux-gnucoff*)
+  dynamic_linker=no
+  ;;
+
+# This must be Linux ELF.
+linux-gnu*)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  soname_spec='${libname}${release}.so$major'
+  finish_cmds='PATH="\$PATH:/sbin" ldconfig -n $libdir'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=no
+  # This implies no fast_install, which is unacceptable.
+  # Some rework will be needed to allow for fast_install
+  # before this can be enabled.
+  hardcode_into_libs=yes
+
+  # We used to test for /lib/ld.so.1 and disable shared libraries on
+  # powerpc, because MkLinux only supported shared libraries with the
+  # GNU dynamic linker.  Since this was broken with cross compilers,
+  # most powerpc-linux boxes support dynamic linking these days and
+  # people can always --disable-shared, the test was removed, and we
+  # assume the GNU/Linux dynamic linker is in use.
+  dynamic_linker='GNU/Linux ld.so'
+  ;;
+
+netbsd*)
+  version_type=sunos
+  need_lib_prefix=no
+  need_version=no
+  if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
+    library_names_spec='${libname}${release}.so$versuffix ${libname}.so$versuffix'
+    finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
+    dynamic_linker='NetBSD (a.out) ld.so'
+  else
+    library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major ${libname}${release}.so ${libname}.so'
+    soname_spec='${libname}${release}.so$major'
+    dynamic_linker='NetBSD ld.elf_so'
+  fi
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=yes
+  hardcode_into_libs=yes
+  ;;
+
+newsos6)
+  version_type=linux
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=yes
+  ;;
+
+openbsd*)
+  version_type=sunos
+  need_lib_prefix=no
+  need_version=no
+  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+    case "$host_os" in
+    openbsd2.[[89]] | openbsd2.[[89]].*)
+      shlibpath_overrides_runpath=no
+      ;;
+    *)
+      shlibpath_overrides_runpath=yes
+      ;;
+    esac
+  else
+    shlibpath_overrides_runpath=yes
+  fi
+  library_names_spec='${libname}${release}.so$versuffix ${libname}.so$versuffix'
+  finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
+  shlibpath_var=LD_LIBRARY_PATH
+  ;;
+
+os2*)
+  libname_spec='$name'
+  need_lib_prefix=no
+  library_names_spec='$libname.dll $libname.a'
+  dynamic_linker='OS/2 ld.exe'
+  shlibpath_var=LIBPATH
+  ;;
+
+osf3* | osf4* | osf5*)
+  version_type=osf
+  need_version=no
+  need_lib_prefix=no
+  soname_spec='${libname}${release}.so$major'
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  shlibpath_var=LD_LIBRARY_PATH
+  sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
+  sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
+  hardcode_into_libs=yes
+  ;;
+
+sco3.2v5*)
+  version_type=osf
+  soname_spec='${libname}${release}.so$major'
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  shlibpath_var=LD_LIBRARY_PATH
+  ;;
+
+solaris*)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  soname_spec='${libname}${release}.so$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=yes
+  hardcode_into_libs=yes
+  # ldd complains unless libraries are executable
+  postinstall_cmds='chmod +x $lib'
+  ;;
+
+sunos4*)
+  version_type=sunos
+  library_names_spec='${libname}${release}.so$versuffix ${libname}.so$versuffix'
+  finish_cmds='PATH="\$PATH:/usr/etc" ldconfig $libdir'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=yes
+  if test "$with_gnu_ld" = yes; then
+    need_lib_prefix=no
+  fi
+  need_version=yes
+  ;;
+
+sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)
+  version_type=linux
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  soname_spec='${libname}${release}.so$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  case $host_vendor in
+    sni)
+      shlibpath_overrides_runpath=no
+      need_lib_prefix=no
+      export_dynamic_flag_spec='${wl}-Blargedynsym'
+      runpath_var=LD_RUN_PATH
+      ;;
+    siemens)
+      need_lib_prefix=no
+      ;;
+    motorola)
+      need_lib_prefix=no
+      need_version=no
+      shlibpath_overrides_runpath=no
+      sys_lib_search_path_spec='/lib /usr/lib /usr/ccs/lib'
+      ;;
+  esac
+  ;;
+
+uts4*)
+  version_type=linux
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  soname_spec='${libname}${release}.so$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  ;;
+
+dgux*)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  soname_spec='${libname}${release}.so$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  ;;
+
+sysv4*MP*)
+  if test -d /usr/nec ;then
+    version_type=linux
+    library_names_spec='$libname.so.$versuffix $libname.so.$major $libname.so'
+    soname_spec='$libname.so.$major'
+    shlibpath_var=LD_LIBRARY_PATH
+  fi
+  ;;
+
+*)
+  dynamic_linker=no
+  ;;
+esac
+AC_MSG_RESULT([$dynamic_linker])
+test "$dynamic_linker" = no && can_build_shared=no
+
+# Report the final consequences.
+AC_MSG_CHECKING([if libtool supports shared libraries])
+AC_MSG_RESULT([$can_build_shared])
+
+AC_MSG_CHECKING([whether to build shared libraries])
+test "$can_build_shared" = "no" && enable_shared=no
+
+# On AIX, shared libraries and static libraries use the same namespace, and
+# are all built from PIC.
+case "$host_os" in
+aix3*)
+  test "$enable_shared" = yes && enable_static=no
+  if test -n "$RANLIB"; then
+    archive_cmds="$archive_cmds~\$RANLIB \$lib"
+    postinstall_cmds='$RANLIB $lib'
+  fi
+  ;;
+
+aix4*)
+  if test "$host_cpu" != ia64 && test "$aix_use_runtimelinking" = no ; then
+    test "$enable_shared" = yes && enable_static=no
+  fi
+  ;;
+esac
+AC_MSG_RESULT([$enable_shared])
+
+AC_MSG_CHECKING([whether to build static libraries])
+# Make sure either enable_shared or enable_static is yes.
+test "$enable_shared" = yes || enable_static=yes
+AC_MSG_RESULT([$enable_static])
+
+if test "$hardcode_action" = relink; then
+  # Fast installation is not supported
+  enable_fast_install=no
+elif test "$shlibpath_overrides_runpath" = yes ||
+     test "$enable_shared" = no; then
+  # Fast installation is not necessary
+  enable_fast_install=needless
+fi
+
+variables_saved_for_relink="PATH $shlibpath_var $runpath_var"
+if test "$GCC" = yes; then
+  variables_saved_for_relink="$variables_saved_for_relink GCC_EXEC_PREFIX COMPILER_PATH LIBRARY_PATH"
+fi
+
+AC_LIBTOOL_DLOPEN_SELF
+
+if test "$enable_shared" = yes && test "$GCC" = yes; then
+  case $archive_cmds in
+  *'~'*)
+    # FIXME: we may have to deal with multi-command sequences.
+    ;;
+  '$CC '*)
+    # Test whether the compiler implicitly links with -lc since on some
+    # systems, -lgcc has to come before -lc. If gcc already passes -lc
+    # to ld, don't add -lc before -lgcc.
+    AC_MSG_CHECKING([whether -lc should be explicitly linked in])
+    AC_CACHE_VAL([lt_cv_archive_cmds_need_lc],
+    [$rm conftest*
+    echo 'static int dummy;' > conftest.$ac_ext
+
+    if AC_TRY_EVAL(ac_compile); then
+      soname=conftest
+      lib=conftest
+      libobjs=conftest.$ac_objext
+      deplibs=
+      wl=$lt_cv_prog_cc_wl
+      compiler_flags=-v
+      linker_flags=-v
+      verstring=
+      output_objdir=.
+      libname=conftest
+      save_allow_undefined_flag=$allow_undefined_flag
+      allow_undefined_flag=
+      if AC_TRY_EVAL(archive_cmds 2\>\&1 \| grep \" -lc \" \>/dev/null 2\>\&1)
+      then
+	lt_cv_archive_cmds_need_lc=no
+      else
+	lt_cv_archive_cmds_need_lc=yes
+      fi
+      allow_undefined_flag=$save_allow_undefined_flag
+    else
+      cat conftest.err 1>&5
+    fi])
+    AC_MSG_RESULT([$lt_cv_archive_cmds_need_lc])
+    ;;
+  esac
+fi
+need_lc=${lt_cv_archive_cmds_need_lc-yes}
+
+# The second clause should only fire when bootstrapping the
+# libtool distribution, otherwise you forgot to ship ltmain.sh
+# with your package, and you will get complaints that there are
+# no rules to generate ltmain.sh.
+if test -f "$ltmain"; then
+  :
+else
+  # If there is no Makefile yet, we rely on a make rule to execute
+  # `config.status --recheck' to rerun these tests and create the
+  # libtool script then.
+  test -f Makefile && make "$ltmain"
+fi
+
+if test -f "$ltmain"; then
+  trap "$rm \"${ofile}T\"; exit 1" 1 2 15
+  $rm -f "${ofile}T"
+
+  echo creating $ofile
+
+  # Now quote all the things that may contain metacharacters while being
+  # careful not to overquote the AC_SUBSTed values.  We take copies of the
+  # variables and quote the copies for generation of the libtool script.
+  for var in echo old_CC old_CFLAGS SED \
+    AR AR_FLAGS CC LD LN_S NM SHELL \
+    reload_flag reload_cmds wl \
+    pic_flag link_static_flag no_builtin_flag export_dynamic_flag_spec \
+    thread_safe_flag_spec whole_archive_flag_spec libname_spec \
+    library_names_spec soname_spec \
+    RANLIB old_archive_cmds old_archive_from_new_cmds old_postinstall_cmds \
+    old_postuninstall_cmds archive_cmds archive_expsym_cmds postinstall_cmds \
+    postuninstall_cmds extract_expsyms_cmds old_archive_from_expsyms_cmds \
+    old_striplib striplib file_magic_cmd export_symbols_cmds \
+    deplibs_check_method allow_undefined_flag no_undefined_flag \
+    finish_cmds finish_eval global_symbol_pipe global_symbol_to_cdecl \
+    global_symbol_to_c_name_address \
+    hardcode_libdir_flag_spec hardcode_libdir_separator  \
+    sys_lib_search_path_spec sys_lib_dlsearch_path_spec \
+    compiler_c_o compiler_o_lo need_locks exclude_expsyms include_expsyms; do
+
+    case $var in
+    reload_cmds | old_archive_cmds | old_archive_from_new_cmds | \
+    old_postinstall_cmds | old_postuninstall_cmds | \
+    export_symbols_cmds | archive_cmds | archive_expsym_cmds | \
+    extract_expsyms_cmds | old_archive_from_expsyms_cmds | \
+    postinstall_cmds | postuninstall_cmds | \
+    finish_cmds | sys_lib_search_path_spec | sys_lib_dlsearch_path_spec)
+      # Double-quote double-evaled strings.
+      eval "lt_$var=\\\"\`\$echo \"X\$$var\" | \$Xsed -e \"\$double_quote_subst\" -e \"\$sed_quote_subst\" -e \"\$delay_variable_subst\"\`\\\""
+      ;;
+    *)
+      eval "lt_$var=\\\"\`\$echo \"X\$$var\" | \$Xsed -e \"\$sed_quote_subst\"\`\\\""
+      ;;
+    esac
+  done
+
+  cat <<__EOF__ > "${ofile}T"
+#! $SHELL
+
+# `$echo "$ofile" | sed 's%^.*/%%'` - Provide generalized library-building support services.
+# Generated automatically by $PROGRAM (GNU $PACKAGE $VERSION$TIMESTAMP)
+# NOTE: Changes made to this file will be lost: look at ltmain.sh.
+#
+# Copyright (C) 1996-2000 Free Software Foundation, Inc.
+# Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996
+#
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful, but
+# WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+# General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+#
+# As a special exception to the GNU General Public License, if you
+# distribute this file as part of a program that contains a
+# configuration script generated by Autoconf, you may include it under
+# the same distribution terms that you use for the rest of that program.
+
+# A sed that does not truncate output.
+SED=$lt_SED
+
+# Sed that helps us avoid accidentally triggering echo(1) options like -n.
+Xsed="${SED} -e s/^X//"
+
+# The HP-UX ksh and POSIX shell print the target directory to stdout
+# if CDPATH is set.
+if test "X\${CDPATH+set}" = Xset; then CDPATH=:; export CDPATH; fi
+
+# ### BEGIN LIBTOOL CONFIG
+
+# Libtool was configured on host `(hostname || uname -n) 2>/dev/null | sed 1q`:
+
+# Shell to use when invoking shell scripts.
+SHELL=$lt_SHELL
+
+# Whether or not to build shared libraries.
+build_libtool_libs=$enable_shared
+
+# Whether or not to build static libraries.
+build_old_libs=$enable_static
+
+# Whether or not to add -lc for building shared libraries.
+build_libtool_need_lc=$need_lc
+
+# Whether or not to optimize for fast installation.
+fast_install=$enable_fast_install
+
+# The host system.
+host_alias=$host_alias
+host=$host
+
+# An echo program that does not interpret backslashes.
+echo=$lt_echo
+
+# The archiver.
+AR=$lt_AR
+AR_FLAGS=$lt_AR_FLAGS
+
+# The default C compiler.
+CC=$lt_CC
+
+# Is the compiler the GNU C compiler?
+with_gcc=$GCC
+
+# The linker used to build libraries.
+LD=$lt_LD
+
+# Whether we need hard or soft links.
+LN_S=$lt_LN_S
+
+# A BSD-compatible nm program.
+NM=$lt_NM
+
+# A symbol stripping program
+STRIP=$STRIP
+
+# Used to examine libraries when file_magic_cmd begins "file"
+MAGIC_CMD=$MAGIC_CMD
+
+# Used on cygwin: DLL creation program.
+DLLTOOL="$DLLTOOL"
+
+# Used on cygwin: object dumper.
+OBJDUMP="$OBJDUMP"
+
+# Used on cygwin: assembler.
+AS="$AS"
+
+# The name of the directory that contains temporary libtool files.
+objdir=$objdir
+
+# How to create reloadable object files.
+reload_flag=$lt_reload_flag
+reload_cmds=$lt_reload_cmds
+
+# How to pass a linker flag through the compiler.
+wl=$lt_wl
+
+# Object file suffix (normally "o").
+objext="$ac_objext"
+
+# Old archive suffix (normally "a").
+libext="$libext"
+
+# Executable file suffix (normally "").
+exeext="$exeext"
+
+# Additional compiler flags for building library objects.
+pic_flag=$lt_pic_flag
+pic_mode=$pic_mode
+
+# Does compiler simultaneously support -c and -o options?
+compiler_c_o=$lt_compiler_c_o
+
+# Can we write directly to a .lo ?
+compiler_o_lo=$lt_compiler_o_lo
+
+# Must we lock files when doing compilation ?
+need_locks=$lt_need_locks
+
+# Do we need the lib prefix for modules?
+need_lib_prefix=$need_lib_prefix
+
+# Do we need a version for libraries?
+need_version=$need_version
+
+# Whether dlopen is supported.
+dlopen_support=$enable_dlopen
+
+# Whether dlopen of programs is supported.
+dlopen_self=$enable_dlopen_self
+
+# Whether dlopen of statically linked programs is supported.
+dlopen_self_static=$enable_dlopen_self_static
+
+# Compiler flag to prevent dynamic linking.
+link_static_flag=$lt_link_static_flag
+
+# Compiler flag to turn off builtin functions.
+no_builtin_flag=$lt_no_builtin_flag
+
+# Compiler flag to allow reflexive dlopens.
+export_dynamic_flag_spec=$lt_export_dynamic_flag_spec
+
+# Compiler flag to generate shared objects directly from archives.
+whole_archive_flag_spec=$lt_whole_archive_flag_spec
+
+# Compiler flag to generate thread-safe objects.
+thread_safe_flag_spec=$lt_thread_safe_flag_spec
+
+# Library versioning type.
+version_type=$version_type
+
+# Format of library name prefix.
+libname_spec=$lt_libname_spec
+
+# List of archive names.  First name is the real one, the rest are links.
+# The last name is the one that the linker finds with -lNAME.
+library_names_spec=$lt_library_names_spec
+
+# The coded name of the library, if different from the real name.
+soname_spec=$lt_soname_spec
+
+# Commands used to build and install an old-style archive.
+RANLIB=$lt_RANLIB
+old_archive_cmds=$lt_old_archive_cmds
+old_postinstall_cmds=$lt_old_postinstall_cmds
+old_postuninstall_cmds=$lt_old_postuninstall_cmds
+
+# Create an old-style archive from a shared archive.
+old_archive_from_new_cmds=$lt_old_archive_from_new_cmds
+
+# Create a temporary old-style archive to link instead of a shared archive.
+old_archive_from_expsyms_cmds=$lt_old_archive_from_expsyms_cmds
+
+# Commands used to build and install a shared archive.
+archive_cmds=$lt_archive_cmds
+archive_expsym_cmds=$lt_archive_expsym_cmds
+postinstall_cmds=$lt_postinstall_cmds
+postuninstall_cmds=$lt_postuninstall_cmds
+
+# Commands to strip libraries.
+old_striplib=$lt_old_striplib
+striplib=$lt_striplib
+
+# Method to check whether dependent libraries are shared objects.
+deplibs_check_method=$lt_deplibs_check_method
+
+# Command to use when deplibs_check_method == file_magic.
+file_magic_cmd=$lt_file_magic_cmd
+
+# Flag that allows shared libraries with undefined symbols to be built.
+allow_undefined_flag=$lt_allow_undefined_flag
+
+# Flag that forces no undefined symbols.
+no_undefined_flag=$lt_no_undefined_flag
+
+# Commands used to finish a libtool library installation in a directory.
+finish_cmds=$lt_finish_cmds
+
+# Same as above, but a single script fragment to be evaled but not shown.
+finish_eval=$lt_finish_eval
+
+# Take the output of nm and produce a listing of raw symbols and C names.
+global_symbol_pipe=$lt_global_symbol_pipe
+
+# Transform the output of nm in a proper C declaration
+global_symbol_to_cdecl=$lt_global_symbol_to_cdecl
+
+# Transform the output of nm in a C name address pair
+global_symbol_to_c_name_address=$lt_global_symbol_to_c_name_address
+
+# This is the shared library runtime path variable.
+runpath_var=$runpath_var
+
+# This is the shared library path variable.
+shlibpath_var=$shlibpath_var
+
+# Is shlibpath searched before the hard-coded library search path?
+shlibpath_overrides_runpath=$shlibpath_overrides_runpath
+
+# How to hardcode a shared library path into an executable.
+hardcode_action=$hardcode_action
+
+# Whether we should hardcode library paths into libraries.
+hardcode_into_libs=$hardcode_into_libs
+
+# Flag to hardcode \$libdir into a binary during linking.
+# This must work even if \$libdir does not exist.
+hardcode_libdir_flag_spec=$lt_hardcode_libdir_flag_spec
+
+# Whether we need a single -rpath flag with a separated argument.
+hardcode_libdir_separator=$lt_hardcode_libdir_separator
+
+# Set to yes if using DIR/libNAME.so during linking hardcodes DIR into the
+# resulting binary.
+hardcode_direct=$hardcode_direct
+
+# Set to yes if using the -LDIR flag during linking hardcodes DIR into the
+# resulting binary.
+hardcode_minus_L=$hardcode_minus_L
+
+# Set to yes if using SHLIBPATH_VAR=DIR during linking hardcodes DIR into
+# the resulting binary.
+hardcode_shlibpath_var=$hardcode_shlibpath_var
+
+# Variables whose values should be saved in libtool wrapper scripts and
+# restored at relink time.
+variables_saved_for_relink="$variables_saved_for_relink"
+
+# Whether libtool must link a program against all its dependency libraries.
+link_all_deplibs=$link_all_deplibs
+
+# Compile-time system search path for libraries
+sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
+
+# Run-time system search path for libraries
+sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
+
+# Fix the shell variable \$srcfile for the compiler.
+fix_srcfile_path="$fix_srcfile_path"
+
+# Set to yes if exported symbols are required.
+always_export_symbols=$always_export_symbols
+
+# The commands to list exported symbols.
+export_symbols_cmds=$lt_export_symbols_cmds
+
+# The commands to extract the exported symbol list from a shared archive.
+extract_expsyms_cmds=$lt_extract_expsyms_cmds
+
+# Symbols that should not be listed in the preloaded symbols.
+exclude_expsyms=$lt_exclude_expsyms
+
+# Symbols that must always be exported.
+include_expsyms=$lt_include_expsyms
+
+# ### END LIBTOOL CONFIG
+
+__EOF__
+
+  case $host_os in
+  aix3*)
+    cat <<\EOF >> "${ofile}T"
+
+# AIX sometimes has problems with the GCC collect2 program.  For some
+# reason, if we set the COLLECT_NAMES environment variable, the problems
+# vanish in a puff of smoke.
+if test "X${COLLECT_NAMES+set}" != Xset; then
+  COLLECT_NAMES=
+  export COLLECT_NAMES
+fi
+EOF
+    ;;
+  esac
+
+  case $host_os in
+  cygwin* | mingw* | pw32* | os2*)
+    cat <<'EOF' >> "${ofile}T"
+      # This is a source program that is used to create dlls on Windows
+      # Don't remove nor modify the starting and closing comments
+# /* ltdll.c starts here */
+# #define WIN32_LEAN_AND_MEAN
+# #include <windows.h>
+# #undef WIN32_LEAN_AND_MEAN
+# #include <stdio.h>
+#
+# #ifndef __CYGWIN__
+# #  ifdef __CYGWIN32__
+# #    define __CYGWIN__ __CYGWIN32__
+# #  endif
+# #endif
+#
+# #ifdef __cplusplus
+# extern "C" {
+# #endif
+# BOOL APIENTRY DllMain (HINSTANCE hInst, DWORD reason, LPVOID reserved);
+# #ifdef __cplusplus
+# }
+# #endif
+#
+# #ifdef __CYGWIN__
+# #include <cygwin/cygwin_dll.h>
+# DECLARE_CYGWIN_DLL( DllMain );
+# #endif
+# HINSTANCE __hDllInstance_base;
+#
+# BOOL APIENTRY
+# DllMain (HINSTANCE hInst, DWORD reason, LPVOID reserved)
+# {
+#   __hDllInstance_base = hInst;
+#   return TRUE;
+# }
+# /* ltdll.c ends here */
+	# This is a source program that is used to create import libraries
+	# on Windows for dlls which lack them. Don't remove nor modify the
+	# starting and closing comments
+# /* impgen.c starts here */
+# /*   Copyright (C) 1999-2000 Free Software Foundation, Inc.
+#
+#  This file is part of GNU libtool.
+#
+#  This program is free software; you can redistribute it and/or modify
+#  it under the terms of the GNU General Public License as published by
+#  the Free Software Foundation; either version 2 of the License, or
+#  (at your option) any later version.
+#
+#  This program is distributed in the hope that it will be useful,
+#  but WITHOUT ANY WARRANTY; without even the implied warranty of
+#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+#  GNU General Public License for more details.
+#
+#  You should have received a copy of the GNU General Public License
+#  along with this program; if not, write to the Free Software
+#  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+#  */
+#
+# #include <stdio.h>		/* for printf() */
+# #include <unistd.h>		/* for open(), lseek(), read() */
+# #include <fcntl.h>		/* for O_RDONLY, O_BINARY */
+# #include <string.h>		/* for strdup() */
+#
+# /* O_BINARY isn't required (or even defined sometimes) under Unix */
+# #ifndef O_BINARY
+# #define O_BINARY 0
+# #endif
+#
+# static unsigned int
+# pe_get16 (fd, offset)
+#      int fd;
+#      int offset;
+# {
+#   unsigned char b[2];
+#   lseek (fd, offset, SEEK_SET);
+#   read (fd, b, 2);
+#   return b[0] + (b[1]<<8);
+# }
+#
+# static unsigned int
+# pe_get32 (fd, offset)
+#     int fd;
+#     int offset;
+# {
+#   unsigned char b[4];
+#   lseek (fd, offset, SEEK_SET);
+#   read (fd, b, 4);
+#   return b[0] + (b[1]<<8) + (b[2]<<16) + (b[3]<<24);
+# }
+#
+# static unsigned int
+# pe_as32 (ptr)
+#      void *ptr;
+# {
+#   unsigned char *b = ptr;
+#   return b[0] + (b[1]<<8) + (b[2]<<16) + (b[3]<<24);
+# }
+#
+# int
+# main (argc, argv)
+#     int argc;
+#     char *argv[];
+# {
+#     int dll;
+#     unsigned long pe_header_offset, opthdr_ofs, num_entries, i;
+#     unsigned long export_rva, export_size, nsections, secptr, expptr;
+#     unsigned long name_rvas, nexp;
+#     unsigned char *expdata, *erva;
+#     char *filename, *dll_name;
+#
+#     filename = argv[1];
+#
+#     dll = open(filename, O_RDONLY|O_BINARY);
+#     if (dll < 1)
+# 	return 1;
+#
+#     dll_name = filename;
+#
+#     for (i=0; filename[i]; i++)
+# 	if (filename[i] == '/' || filename[i] == '\\'  || filename[i] == ':')
+# 	    dll_name = filename + i +1;
+#
+#     pe_header_offset = pe_get32 (dll, 0x3c);
+#     opthdr_ofs = pe_header_offset + 4 + 20;
+#     num_entries = pe_get32 (dll, opthdr_ofs + 92);
+#
+#     if (num_entries < 1) /* no exports */
+# 	return 1;
+#
+#     export_rva = pe_get32 (dll, opthdr_ofs + 96);
+#     export_size = pe_get32 (dll, opthdr_ofs + 100);
+#     nsections = pe_get16 (dll, pe_header_offset + 4 +2);
+#     secptr = (pe_header_offset + 4 + 20 +
+# 	      pe_get16 (dll, pe_header_offset + 4 + 16));
+#
+#     expptr = 0;
+#     for (i = 0; i < nsections; i++)
+#     {
+# 	char sname[8];
+# 	unsigned long secptr1 = secptr + 40 * i;
+# 	unsigned long vaddr = pe_get32 (dll, secptr1 + 12);
+# 	unsigned long vsize = pe_get32 (dll, secptr1 + 16);
+# 	unsigned long fptr = pe_get32 (dll, secptr1 + 20);
+# 	lseek(dll, secptr1, SEEK_SET);
+# 	read(dll, sname, 8);
+# 	if (vaddr <= export_rva && vaddr+vsize > export_rva)
+# 	{
+# 	    expptr = fptr + (export_rva - vaddr);
+# 	    if (export_rva + export_size > vaddr + vsize)
+# 		export_size = vsize - (export_rva - vaddr);
+# 	    break;
+# 	}
+#     }
+#
+#     expdata = (unsigned char*)malloc(export_size);
+#     lseek (dll, expptr, SEEK_SET);
+#     read (dll, expdata, export_size);
+#     erva = expdata - export_rva;
+#
+#     nexp = pe_as32 (expdata+24);
+#     name_rvas = pe_as32 (expdata+32);
+#
+#     printf ("EXPORTS\n");
+#     for (i = 0; i<nexp; i++)
+#     {
+# 	unsigned long name_rva = pe_as32 (erva+name_rvas+i*4);
+# 	printf ("\t%s @ %ld ;\n", erva+name_rva, 1+ i);
+#     }
+#
+#     return 0;
+# }
+# /* impgen.c ends here */
+
+EOF
+    ;;
+  esac
+
+  # We use sed instead of cat because bash on DJGPP gets confused if
+  # if finds mixed CR/LF and LF-only lines.  Since sed operates in
+  # text mode, it properly converts lines to CR/LF.  This bash problem
+  # is reportedly fixed, but why not run on old versions too?
+  sed '$q' "$ltmain" >> "${ofile}T" || (rm -f "${ofile}T"; exit 1)
+
+  mv -f "${ofile}T" "$ofile" || \
+    (rm -f "$ofile" && cp "${ofile}T" "$ofile" && rm -f "${ofile}T")
+  chmod +x "$ofile"
+fi
+
+])# _LT_AC_LTCONFIG_HACK
 
 # AC_LIBTOOL_DLOPEN - enable checks for dlopen support
-AC_DEFUN(AC_LIBTOOL_DLOPEN, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])])
+AC_DEFUN([AC_LIBTOOL_DLOPEN], [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])])
 
 # AC_LIBTOOL_WIN32_DLL - declare package support for building win32 dll's
-AC_DEFUN(AC_LIBTOOL_WIN32_DLL, [AC_BEFORE([$0], [AC_LIBTOOL_SETUP])])
+AC_DEFUN([AC_LIBTOOL_WIN32_DLL], [AC_BEFORE([$0], [AC_LIBTOOL_SETUP])])
 
 # AC_ENABLE_SHARED - implement the --enable-shared flag
 # Usage: AC_ENABLE_SHARED[(DEFAULT)]
 #   Where DEFAULT is either `yes' or `no'.  If omitted, it defaults to
 #   `yes'.
-AC_DEFUN(AC_ENABLE_SHARED, [dnl
-define([AC_ENABLE_SHARED_DEFAULT], ifelse($1, no, no, yes))dnl
+AC_DEFUN([AC_ENABLE_SHARED],
+[define([AC_ENABLE_SHARED_DEFAULT], ifelse($1, no, no, yes))dnl
 AC_ARG_ENABLE(shared,
 changequote(<<, >>)dnl
 <<  --enable-shared[=PKGS]  build shared libraries [default=>>AC_ENABLE_SHARED_DEFAULT],
 changequote([, ])dnl
 [p=${PACKAGE-default}
-case "$enableval" in
+case $enableval in
 yes) enable_shared=yes ;;
 no) enable_shared=no ;;
 *)
@@ -249,21 +3083,22 @@
 ])
 
 # AC_DISABLE_SHARED - set the default shared flag to --disable-shared
-AC_DEFUN(AC_DISABLE_SHARED, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
+AC_DEFUN([AC_DISABLE_SHARED],
+[AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
 AC_ENABLE_SHARED(no)])
 
 # AC_ENABLE_STATIC - implement the --enable-static flag
 # Usage: AC_ENABLE_STATIC[(DEFAULT)]
 #   Where DEFAULT is either `yes' or `no'.  If omitted, it defaults to
 #   `yes'.
-AC_DEFUN(AC_ENABLE_STATIC, [dnl
-define([AC_ENABLE_STATIC_DEFAULT], ifelse($1, no, no, yes))dnl
+AC_DEFUN([AC_ENABLE_STATIC],
+[define([AC_ENABLE_STATIC_DEFAULT], ifelse($1, no, no, yes))dnl
 AC_ARG_ENABLE(static,
 changequote(<<, >>)dnl
 <<  --enable-static[=PKGS]  build static libraries [default=>>AC_ENABLE_STATIC_DEFAULT],
 changequote([, ])dnl
 [p=${PACKAGE-default}
-case "$enableval" in
+case $enableval in
 yes) enable_static=yes ;;
 no) enable_static=no ;;
 *)
@@ -282,7 +3117,8 @@
 ])
 
 # AC_DISABLE_STATIC - set the default static flag to --disable-static
-AC_DEFUN(AC_DISABLE_STATIC, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
+AC_DEFUN([AC_DISABLE_STATIC],
+[AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
 AC_ENABLE_STATIC(no)])
 
 
@@ -290,14 +3126,14 @@
 # Usage: AC_ENABLE_FAST_INSTALL[(DEFAULT)]
 #   Where DEFAULT is either `yes' or `no'.  If omitted, it defaults to
 #   `yes'.
-AC_DEFUN(AC_ENABLE_FAST_INSTALL, [dnl
-define([AC_ENABLE_FAST_INSTALL_DEFAULT], ifelse($1, no, no, yes))dnl
+AC_DEFUN([AC_ENABLE_FAST_INSTALL],
+[define([AC_ENABLE_FAST_INSTALL_DEFAULT], ifelse($1, no, no, yes))dnl
 AC_ARG_ENABLE(fast-install,
 changequote(<<, >>)dnl
 <<  --enable-fast-install[=PKGS]  optimize for fast installation [default=>>AC_ENABLE_FAST_INSTALL_DEFAULT],
 changequote([, ])dnl
 [p=${PACKAGE-default}
-case "$enableval" in
+case $enableval in
 yes) enable_fast_install=yes ;;
 no) enable_fast_install=no ;;
 *)
@@ -315,29 +3151,120 @@
 enable_fast_install=AC_ENABLE_FAST_INSTALL_DEFAULT)dnl
 ])
 
-# AC_ENABLE_FAST_INSTALL - set the default to --disable-fast-install
-AC_DEFUN(AC_DISABLE_FAST_INSTALL, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
+# AC_DISABLE_FAST_INSTALL - set the default to --disable-fast-install
+AC_DEFUN([AC_DISABLE_FAST_INSTALL],
+[AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
 AC_ENABLE_FAST_INSTALL(no)])
 
+# AC_LIBTOOL_PICMODE - implement the --with-pic flag
+# Usage: AC_LIBTOOL_PICMODE[(MODE)]
+#   Where MODE is either `yes' or `no'.  If omitted, it defaults to
+#   `both'.
+AC_DEFUN([AC_LIBTOOL_PICMODE],
+[AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
+pic_mode=ifelse($#,1,$1,default)])
+
+
+# AC_PATH_TOOL_PREFIX - find a file program which can recognise shared library
+AC_DEFUN([AC_PATH_TOOL_PREFIX],
+[AC_MSG_CHECKING([for $1])
+AC_CACHE_VAL(lt_cv_path_MAGIC_CMD,
+[case $MAGIC_CMD in
+  /*)
+  lt_cv_path_MAGIC_CMD="$MAGIC_CMD" # Let the user override the test with a path.
+  ;;
+  ?:/*)
+  lt_cv_path_MAGIC_CMD="$MAGIC_CMD" # Let the user override the test with a dos path.
+  ;;
+  *)
+  ac_save_MAGIC_CMD="$MAGIC_CMD"
+  IFS="${IFS=   }"; ac_save_ifs="$IFS"; IFS=":"
+dnl $ac_dummy forces splitting on constant user-supplied paths.
+dnl POSIX.2 word splitting is done only on the output of word expansions,
+dnl not every word.  This closes a longstanding sh security hole.
+  ac_dummy="ifelse([$2], , $PATH, [$2])"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$1; then
+      lt_cv_path_MAGIC_CMD="$ac_dir/$1"
+      if test -n "$file_magic_test_file"; then
+	case $deplibs_check_method in
+	"file_magic "*)
+	  file_magic_regex="`expr \"$deplibs_check_method\" : \"file_magic \(.*\)\"`"
+	  MAGIC_CMD="$lt_cv_path_MAGIC_CMD"
+	  if eval $file_magic_cmd \$file_magic_test_file 2> /dev/null |
+	    egrep "$file_magic_regex" > /dev/null; then
+	    :
+	  else
+	    cat <<EOF 1>&2
+
+*** Warning: the command libtool uses to detect shared libraries,
+*** $file_magic_cmd, produces output that libtool cannot recognize.
+*** The result is that libtool may fail to recognize shared libraries
+*** as such.  This will affect the creation of libtool libraries that
+*** depend on shared libraries, but programs linked with such libtool
+*** libraries will work regardless of this problem.  Nevertheless, you
+*** may want to report the problem to your system manager and/or to
+*** bug-libtool@gnu.org
+
+EOF
+	  fi ;;
+	esac
+      fi
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
+  MAGIC_CMD="$ac_save_MAGIC_CMD"
+  ;;
+esac])
+MAGIC_CMD="$lt_cv_path_MAGIC_CMD"
+if test -n "$MAGIC_CMD"; then
+  AC_MSG_RESULT($MAGIC_CMD)
+else
+  AC_MSG_RESULT(no)
+fi
+])
+
+
+# AC_PATH_MAGIC - find a file program which can recognise a shared library
+AC_DEFUN([AC_PATH_MAGIC],
+[AC_REQUIRE([AC_CHECK_TOOL_PREFIX])dnl
+AC_PATH_TOOL_PREFIX(${ac_tool_prefix}file, /usr/bin:$PATH)
+if test -z "$lt_cv_path_MAGIC_CMD"; then
+  if test -n "$ac_tool_prefix"; then
+    AC_PATH_TOOL_PREFIX(file, /usr/bin:$PATH)
+  else
+    MAGIC_CMD=:
+  fi
+fi
+])
+
+
 # AC_PROG_LD - find the path to the GNU or non-GNU linker
-AC_DEFUN(AC_PROG_LD,
+AC_DEFUN([AC_PROG_LD],
 [AC_ARG_WITH(gnu-ld,
 [  --with-gnu-ld           assume the C compiler uses GNU ld [default=no]],
 test "$withval" = no || with_gnu_ld=yes, with_gnu_ld=no)
 AC_REQUIRE([AC_PROG_CC])dnl
 AC_REQUIRE([AC_CANONICAL_HOST])dnl
 AC_REQUIRE([AC_CANONICAL_BUILD])dnl
+AC_REQUIRE([_LT_AC_LIBTOOL_SYS_PATH_SEPARATOR])dnl
 ac_prog=ld
-if test "$ac_cv_prog_gcc" = yes; then
+if test "$GCC" = yes; then
   # Check if gcc -print-prog-name=ld gives a path.
   AC_MSG_CHECKING([for ld used by GCC])
-  ac_prog=`($CC -print-prog-name=ld) 2>&5`
-  case "$ac_prog" in
+  case $host in
+  *-*-mingw*)
+    # gcc leaves a trailing carriage return which upsets mingw
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+  *)
+    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+  esac
+  case $ac_prog in
     # Accept absolute paths.
-changequote(,)dnl
-    [\\/]* | [A-Za-z]:[\\/]*)
-      re_direlt='/[^/][^/]*/\.\./'
-changequote([,])dnl
+    [[\\/]]* | [[A-Za-z]]:[[\\/]]*)
+      re_direlt='/[[^/]][[^/]]*/\.\./'
       # Canonicalize the path of ld
       ac_prog=`echo $ac_prog| sed 's%\\\\%/%g'`
       while echo $ac_prog | grep "$re_direlt" > /dev/null 2>&1; do
@@ -359,17 +3286,17 @@
 else
   AC_MSG_CHECKING([for non-GNU ld])
 fi
-AC_CACHE_VAL(ac_cv_path_LD,
+AC_CACHE_VAL(lt_cv_path_LD,
 [if test -z "$LD"; then
-  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}${PATH_SEPARATOR-:}"
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=$PATH_SEPARATOR
   for ac_dir in $PATH; do
     test -z "$ac_dir" && ac_dir=.
     if test -f "$ac_dir/$ac_prog" || test -f "$ac_dir/$ac_prog$ac_exeext"; then
-      ac_cv_path_LD="$ac_dir/$ac_prog"
+      lt_cv_path_LD="$ac_dir/$ac_prog"
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some GNU ld's only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      if "$ac_cv_path_LD" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then
+      if "$lt_cv_path_LD" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then
 	test "$with_gnu_ld" != no && break
       else
 	test "$with_gnu_ld" != yes && break
@@ -378,9 +3305,9 @@
   done
   IFS="$ac_save_ifs"
 else
-  ac_cv_path_LD="$LD" # Let the user override the test with a path.
+  lt_cv_path_LD="$LD" # Let the user override the test with a path.
 fi])
-LD="$ac_cv_path_LD"
+LD="$lt_cv_path_LD"
 if test -n "$LD"; then
   AC_MSG_RESULT($LD)
 else
@@ -390,56 +3317,255 @@
 AC_PROG_LD_GNU
 ])
 
-AC_DEFUN(AC_PROG_LD_GNU,
-[AC_CACHE_CHECK([if the linker ($LD) is GNU ld], ac_cv_prog_gnu_ld,
+# AC_PROG_LD_GNU -
+AC_DEFUN([AC_PROG_LD_GNU],
+[AC_CACHE_CHECK([if the linker ($LD) is GNU ld], lt_cv_prog_gnu_ld,
 [# I'd rather use --version here, but apparently some GNU ld's only accept -v.
 if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then
-  ac_cv_prog_gnu_ld=yes
+  lt_cv_prog_gnu_ld=yes
 else
-  ac_cv_prog_gnu_ld=no
+  lt_cv_prog_gnu_ld=no
 fi])
+with_gnu_ld=$lt_cv_prog_gnu_ld
 ])
 
+# AC_PROG_LD_RELOAD_FLAG - find reload flag for linker
+#   -- PORTME Some linkers may need a different reload flag.
+AC_DEFUN([AC_PROG_LD_RELOAD_FLAG],
+[AC_CACHE_CHECK([for $LD option to reload object files], lt_cv_ld_reload_flag,
+[lt_cv_ld_reload_flag='-r'])
+reload_flag=$lt_cv_ld_reload_flag
+test -n "$reload_flag" && reload_flag=" $reload_flag"
+])
+
+# AC_DEPLIBS_CHECK_METHOD - how to check for library dependencies
+#  -- PORTME fill in with the dynamic library characteristics
+AC_DEFUN([AC_DEPLIBS_CHECK_METHOD],
+[AC_CACHE_CHECK([how to recognise dependent libraries],
+lt_cv_deplibs_check_method,
+[lt_cv_file_magic_cmd='$MAGIC_CMD'
+lt_cv_file_magic_test_file=
+lt_cv_deplibs_check_method='unknown'
+# Need to set the preceding variable on all platforms that support
+# interlibrary dependencies.
+# 'none' -- dependencies not supported.
+# `unknown' -- same as none, but documents that we really don't know.
+# 'pass_all' -- all dependencies passed with no checks.
+# 'test_compile' -- check by making test program.
+# 'file_magic [[regex]]' -- check by looking for files in library path
+# which responds to the $file_magic_cmd with a given egrep regex.
+# If you have `file' or equivalent on your system and you're not sure
+# whether `pass_all' will *always* work, you probably want this one.
+
+case $host_os in
+aix4* | aix5*)
+  lt_cv_deplibs_check_method=pass_all
+  ;;
+
+beos*)
+  lt_cv_deplibs_check_method=pass_all
+  ;;
+
+bsdi4*)
+  lt_cv_deplibs_check_method='file_magic ELF [[0-9]][[0-9]]*-bit [[ML]]SB (shared object|dynamic lib)'
+  lt_cv_file_magic_cmd='/usr/bin/file -L'
+  lt_cv_file_magic_test_file=/shlib/libc.so
+  ;;
+
+cygwin* | mingw* | pw32*)
+  lt_cv_deplibs_check_method='file_magic file format pei*-i386(.*architecture: i386)?'
+  lt_cv_file_magic_cmd='$OBJDUMP -f'
+  ;;
+
+darwin* | rhapsody*)
+  lt_cv_deplibs_check_method='file_magic Mach-O dynamically linked shared library'
+  lt_cv_file_magic_cmd='/usr/bin/file -L'
+  case "$host_os" in
+  rhapsody* | darwin1.[[012]])
+    lt_cv_file_magic_test_file=`echo /System/Library/Frameworks/System.framework/Versions/*/System | head -1`
+    ;;
+  *) # Darwin 1.3 on
+    lt_cv_file_magic_test_file='/usr/lib/libSystem.dylib'
+    ;;
+  esac
+  ;;
+
+freebsd*)
+  if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then
+    case $host_cpu in
+    i*86 )
+      # Not sure whether the presence of OpenBSD here was a mistake.
+      # Let's accept both of them until this is cleared up.
+      lt_cv_deplibs_check_method='file_magic (FreeBSD|OpenBSD)/i[[3-9]]86 (compact )?demand paged shared library'
+      lt_cv_file_magic_cmd=/usr/bin/file
+      lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`
+      ;;
+    esac
+  else
+    lt_cv_deplibs_check_method=pass_all
+  fi
+  ;;
+
+gnu*)
+  lt_cv_deplibs_check_method=pass_all
+  ;;
+
+hpux10.20*|hpux11*)
+  lt_cv_deplibs_check_method='file_magic (s[[0-9]][[0-9]][[0-9]]|PA-RISC[[0-9]].[[0-9]]) shared library'
+  lt_cv_file_magic_cmd=/usr/bin/file
+  lt_cv_file_magic_test_file=/usr/lib/libc.sl
+  ;;
+
+irix5* | irix6* | nonstopux*)
+  case $host_os in
+  irix5* | nonstopux*)
+    # this will be overridden with pass_all, but let us keep it just in case
+    lt_cv_deplibs_check_method="file_magic ELF 32-bit MSB dynamic lib MIPS - version 1"
+    ;;
+  *)
+    case $LD in
+    *-32|*"-32 ") libmagic=32-bit;;
+    *-n32|*"-n32 ") libmagic=N32;;
+    *-64|*"-64 ") libmagic=64-bit;;
+    *) libmagic=never-match;;
+    esac
+    # this will be overridden with pass_all, but let us keep it just in case
+    lt_cv_deplibs_check_method="file_magic ELF ${libmagic} MSB mips-[[1234]] dynamic lib MIPS - version 1"
+    ;;
+  esac
+  lt_cv_file_magic_test_file=`echo /lib${libsuff}/libc.so*`
+  lt_cv_deplibs_check_method=pass_all
+  ;;
+
+# This must be Linux ELF.
+linux-gnu*)
+  case $host_cpu in
+  alpha* | hppa* | i*86 | mips | mipsel | powerpc* | sparc* | ia64*)
+    lt_cv_deplibs_check_method=pass_all ;;
+  *)
+    # glibc up to 2.1.1 does not perform some relocations on ARM
+    lt_cv_deplibs_check_method='file_magic ELF [[0-9]][[0-9]]*-bit [[LM]]SB (shared object|dynamic lib )' ;;
+  esac
+  lt_cv_file_magic_test_file=`echo /lib/libc.so* /lib/libc-*.so`
+  ;;
+
+netbsd*)
+  if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then
+    lt_cv_deplibs_check_method='match_pattern /lib[[^/\.]]+\.so\.[[0-9]]+\.[[0-9]]+$'
+  else
+    lt_cv_deplibs_check_method='match_pattern /lib[[^/\.]]+\.so$'
+  fi
+  ;;
+
+newos6*)
+  lt_cv_deplibs_check_method='file_magic ELF [[0-9]][[0-9]]*-bit [[ML]]SB (executable|dynamic lib)'
+  lt_cv_file_magic_cmd=/usr/bin/file
+  lt_cv_file_magic_test_file=/usr/lib/libnls.so
+  ;;
+
+openbsd*)
+  lt_cv_file_magic_cmd=/usr/bin/file
+  lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`
+  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+    lt_cv_deplibs_check_method='file_magic ELF [[0-9]][[0-9]]*-bit [[LM]]SB shared object'
+  else
+    lt_cv_deplibs_check_method='file_magic OpenBSD.* shared library'
+  fi
+  ;;
+
+osf3* | osf4* | osf5*)
+  # this will be overridden with pass_all, but let us keep it just in case
+  lt_cv_deplibs_check_method='file_magic COFF format alpha shared library'
+  lt_cv_file_magic_test_file=/shlib/libc.so
+  lt_cv_deplibs_check_method=pass_all
+  ;;
+
+sco3.2v5*)
+  lt_cv_deplibs_check_method=pass_all
+  ;;
+
+solaris*)
+  lt_cv_deplibs_check_method=pass_all
+  lt_cv_file_magic_test_file=/lib/libc.so
+  ;;
+
+sysv5uw[[78]]* | sysv4*uw2*)
+  lt_cv_deplibs_check_method=pass_all
+  ;;
+
+sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)
+  case $host_vendor in
+  motorola)
+    lt_cv_deplibs_check_method='file_magic ELF [[0-9]][[0-9]]*-bit [[ML]]SB (shared object|dynamic lib) M[[0-9]][[0-9]]* Version [[0-9]]'
+    lt_cv_file_magic_test_file=`echo /usr/lib/libc.so*`
+    ;;
+  ncr)
+    lt_cv_deplibs_check_method=pass_all
+    ;;
+  sequent)
+    lt_cv_file_magic_cmd='/bin/file'
+    lt_cv_deplibs_check_method='file_magic ELF [[0-9]][[0-9]]*-bit [[LM]]SB (shared object|dynamic lib )'
+    ;;
+  sni)
+    lt_cv_file_magic_cmd='/bin/file'
+    lt_cv_deplibs_check_method="file_magic ELF [[0-9]][[0-9]]*-bit [[LM]]SB dynamic lib"
+    lt_cv_file_magic_test_file=/lib/libc.so
+    ;;
+  siemens)
+    lt_cv_deplibs_check_method=pass_all
+    ;;
+  esac
+  ;;
+esac
+])
+file_magic_cmd=$lt_cv_file_magic_cmd
+deplibs_check_method=$lt_cv_deplibs_check_method
+])
+
+
 # AC_PROG_NM - find the path to a BSD-compatible name lister
-AC_DEFUN(AC_PROG_NM,
-[AC_MSG_CHECKING([for BSD-compatible nm])
-AC_CACHE_VAL(ac_cv_path_NM,
+AC_DEFUN([AC_PROG_NM],
+[AC_REQUIRE([_LT_AC_LIBTOOL_SYS_PATH_SEPARATOR])dnl
+AC_MSG_CHECKING([for BSD-compatible nm])
+AC_CACHE_VAL(lt_cv_path_NM,
 [if test -n "$NM"; then
   # Let the user override the test.
-  ac_cv_path_NM="$NM"
+  lt_cv_path_NM="$NM"
 else
-  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}${PATH_SEPARATOR-:}"
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=$PATH_SEPARATOR
   for ac_dir in $PATH /usr/ccs/bin /usr/ucb /bin; do
     test -z "$ac_dir" && ac_dir=.
-    if test -f $ac_dir/nm || test -f $ac_dir/nm$ac_exeext ; then
+    tmp_nm=$ac_dir/${ac_tool_prefix}nm
+    if test -f $tmp_nm || test -f $tmp_nm$ac_exeext ; then
       # Check to see if the nm accepts a BSD-compat flag.
       # Adding the `sed 1q' prevents false positives on HP-UX, which says:
       #   nm: unknown option "B" ignored
-      if ($ac_dir/nm -B /dev/null 2>&1 | sed '1q'; exit 0) | egrep /dev/null >/dev/null; then
-	ac_cv_path_NM="$ac_dir/nm -B"
+      # Tru64's nm complains that /dev/null is an invalid object file
+      if ($tmp_nm -B /dev/null 2>&1 | sed '1q'; exit 0) | egrep '(/dev/null|Invalid file or object type)' >/dev/null; then
+	lt_cv_path_NM="$tmp_nm -B"
 	break
-      elif ($ac_dir/nm -p /dev/null 2>&1 | sed '1q'; exit 0) | egrep /dev/null >/dev/null; then
-	ac_cv_path_NM="$ac_dir/nm -p"
+      elif ($tmp_nm -p /dev/null 2>&1 | sed '1q'; exit 0) | egrep /dev/null >/dev/null; then
+	lt_cv_path_NM="$tmp_nm -p"
 	break
       else
-	ac_cv_path_NM=${ac_cv_path_NM="$ac_dir/nm"} # keep the first match, but
+	lt_cv_path_NM=${lt_cv_path_NM="$tmp_nm"} # keep the first match, but
 	continue # so that we can try to find one that supports BSD flags
       fi
     fi
   done
   IFS="$ac_save_ifs"
-  test -z "$ac_cv_path_NM" && ac_cv_path_NM=nm
+  test -z "$lt_cv_path_NM" && lt_cv_path_NM=nm
 fi])
-NM="$ac_cv_path_NM"
+NM="$lt_cv_path_NM"
 AC_MSG_RESULT([$NM])
 ])
 
 # AC_CHECK_LIBM - check for math library
-AC_DEFUN(AC_CHECK_LIBM,
+AC_DEFUN([AC_CHECK_LIBM],
 [AC_REQUIRE([AC_CANONICAL_HOST])dnl
 LIBM=
-case "$lt_target" in
-*-*-beos* | *-*-cygwin*)
+case $host in
+*-*-beos* | *-*-cygwin* | *-*-pw32*)
   # These system don't have libm
   ;;
 *-ncr-sysv4.3*)
@@ -453,37 +3579,41 @@
 ])
 
 # AC_LIBLTDL_CONVENIENCE[(dir)] - sets LIBLTDL to the link flags for
-# the libltdl convenience library and INCLTDL to the include flags for
+# the libltdl convenience library and LTDLINCL to the include flags for
 # the libltdl header and adds --enable-ltdl-convenience to the
-# configure arguments.  Note that LIBLTDL and INCLTDL are not
+# configure arguments.  Note that LIBLTDL and LTDLINCL are not
 # AC_SUBSTed, nor is AC_CONFIG_SUBDIRS called.  If DIR is not
 # provided, it is assumed to be `libltdl'.  LIBLTDL will be prefixed
-# with '${top_builddir}/' and INCLTDL will be prefixed with
+# with '${top_builddir}/' and LTDLINCL will be prefixed with
 # '${top_srcdir}/' (note the single quotes!).  If your package is not
 # flat and you're not using automake, define top_builddir and
 # top_srcdir appropriately in the Makefiles.
-AC_DEFUN(AC_LIBLTDL_CONVENIENCE, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
-  case "$enable_ltdl_convenience" in
+AC_DEFUN([AC_LIBLTDL_CONVENIENCE],
+[AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
+  case $enable_ltdl_convenience in
   no) AC_MSG_ERROR([this package needs a convenience libltdl]) ;;
   "") enable_ltdl_convenience=yes
       ac_configure_args="$ac_configure_args --enable-ltdl-convenience" ;;
   esac
   LIBLTDL='${top_builddir}/'ifelse($#,1,[$1],['libltdl'])/libltdlc.la
-  INCLTDL='-I${top_srcdir}/'ifelse($#,1,[$1],['libltdl'])
+  LTDLINCL='-I${top_srcdir}/'ifelse($#,1,[$1],['libltdl'])
+  # For backwards non-gettext consistent compatibility...
+  INCLTDL="$LTDLINCL"
 ])
 
 # AC_LIBLTDL_INSTALLABLE[(dir)] - sets LIBLTDL to the link flags for
-# the libltdl installable library and INCLTDL to the include flags for
+# the libltdl installable library and LTDLINCL to the include flags for
 # the libltdl header and adds --enable-ltdl-install to the configure
-# arguments.  Note that LIBLTDL and INCLTDL are not AC_SUBSTed, nor is
+# arguments.  Note that LIBLTDL and LTDLINCL are not AC_SUBSTed, nor is
 # AC_CONFIG_SUBDIRS called.  If DIR is not provided and an installed
 # libltdl is not found, it is assumed to be `libltdl'.  LIBLTDL will
-# be prefixed with '${top_builddir}/' and INCLTDL will be prefixed
+# be prefixed with '${top_builddir}/' and LTDLINCL will be prefixed
 # with '${top_srcdir}/' (note the single quotes!).  If your package is
 # not flat and you're not using automake, define top_builddir and
 # top_srcdir appropriately in the Makefiles.
 # In the future, this macro may have to be called after AC_PROG_LIBTOOL.
-AC_DEFUN(AC_LIBLTDL_INSTALLABLE, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
+AC_DEFUN([AC_LIBLTDL_INSTALLABLE],
+[AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
   AC_CHECK_LIB(ltdl, main,
   [test x"$enable_ltdl_install" != xyes && enable_ltdl_install=no],
   [if test x"$enable_ltdl_install" = xno; then
@@ -495,23 +3625,114 @@
   if test x"$enable_ltdl_install" = x"yes"; then
     ac_configure_args="$ac_configure_args --enable-ltdl-install"
     LIBLTDL='${top_builddir}/'ifelse($#,1,[$1],['libltdl'])/libltdl.la
-    INCLTDL='-I${top_srcdir}/'ifelse($#,1,[$1],['libltdl'])
+    LTDLINCL='-I${top_srcdir}/'ifelse($#,1,[$1],['libltdl'])
   else
     ac_configure_args="$ac_configure_args --enable-ltdl-install=no"
     LIBLTDL="-lltdl"
-    INCLTDL=
+    LTDLINCL=
   fi
+  # For backwards non-gettext consistent compatibility...
+  INCLTDL="$LTDLINCL"
 ])
 
-dnl old names
-AC_DEFUN(AM_PROG_LIBTOOL, [indir([AC_PROG_LIBTOOL])])dnl
-AC_DEFUN(AM_ENABLE_SHARED, [indir([AC_ENABLE_SHARED], $@)])dnl
-AC_DEFUN(AM_ENABLE_STATIC, [indir([AC_ENABLE_STATIC], $@)])dnl
-AC_DEFUN(AM_DISABLE_SHARED, [indir([AC_DISABLE_SHARED], $@)])dnl
-AC_DEFUN(AM_DISABLE_STATIC, [indir([AC_DISABLE_STATIC], $@)])dnl
-AC_DEFUN(AM_PROG_LD, [indir([AC_PROG_LD])])dnl
-AC_DEFUN(AM_PROG_NM, [indir([AC_PROG_NM])])dnl
+# old names
+AC_DEFUN([AM_PROG_LIBTOOL],   [AC_PROG_LIBTOOL])
+AC_DEFUN([AM_ENABLE_SHARED],  [AC_ENABLE_SHARED($@)])
+AC_DEFUN([AM_ENABLE_STATIC],  [AC_ENABLE_STATIC($@)])
+AC_DEFUN([AM_DISABLE_SHARED], [AC_DISABLE_SHARED($@)])
+AC_DEFUN([AM_DISABLE_STATIC], [AC_DISABLE_STATIC($@)])
+AC_DEFUN([AM_PROG_LD],        [AC_PROG_LD])
+AC_DEFUN([AM_PROG_NM],        [AC_PROG_NM])
 
-dnl This is just to silence aclocal about the macro not being used
-ifelse([AC_DISABLE_FAST_INSTALL])dnl
+# This is just to silence aclocal about the macro not being used
+ifelse([AC_DISABLE_FAST_INSTALL])
+
+# NOTE: This macro has been submitted for inclusion into   #
+#  GNU Autoconf as AC_PROG_SED.  When it is available in   #
+#  a released version of Autoconf we should remove this    #
+#  macro and use it instead.                               #
+# LT_AC_PROG_SED
+# --------------
+# Check for a fully-functional sed program, that truncates
+# as few characters as possible.  Prefer GNU sed if found.
+AC_DEFUN([LT_AC_PROG_SED],
+[AC_MSG_CHECKING([for a sed that does not truncate output])
+AC_CACHE_VAL(lt_cv_path_SED,
+[# Loop through the user's path and test for sed and gsed.
+# Then use that list of sed's as ones to test for truncation.
+as_executable_p="test -f"
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  for ac_prog in sed gsed; do
+    for ac_exec_ext in '' $ac_executable_extensions; do
+      if $as_executable_p "$as_dir/$ac_prog$ac_exec_ext"; then
+        _sed_list="$_sed_list $as_dir/$ac_prog$ac_exec_ext"
+      fi
+    done
+  done
+done
+
+  # Create a temporary directory, and hook for its removal unless debugging.
+$debug ||
+{
+  trap 'exit_status=$?; rm -rf $tmp && exit $exit_status' 0
+  trap '{ (exit 1); exit 1; }' 1 2 13 15
+}
+
+# Create a (secure) tmp directory for tmp files.
+: ${TMPDIR=/tmp}
+{
+  tmp=`(umask 077 && mktemp -d -q "$TMPDIR/sedXXXXXX") 2>/dev/null` &&
+  test -n "$tmp" && test -d "$tmp"
+}  ||
+{
+  tmp=$TMPDIR/sed$$-$RANDOM
+  (umask 077 && mkdir $tmp)
+} ||
+{
+   echo "$me: cannot create a temporary directory in $TMPDIR" >&2
+   { (exit 1); exit 1; }
+}
+  _max=0
+  _count=0
+  # Add /usr/xpg4/bin/sed as it is typically found on Solaris
+  # along with /bin/sed that truncates output.
+  for _sed in $_sed_list /usr/xpg4/bin/sed; do
+    test ! -f ${_sed} && break
+    cat /dev/null > "$tmp/sed.in"
+    _count=0
+    echo ${ECHO_N-$ac_n} "0123456789${ECHO_C-$ac_c}" >"$tmp/sed.in"
+    # Check for GNU sed and select it if it is found.
+    if "${_sed}" --version 2>&1 < /dev/null | egrep '(GNU)' > /dev/null; then
+      lt_cv_path_SED=${_sed}
+      break
+    fi
+    while true; do
+      cat "$tmp/sed.in" "$tmp/sed.in" >"$tmp/sed.tmp"
+      mv "$tmp/sed.tmp" "$tmp/sed.in"
+      cp "$tmp/sed.in" "$tmp/sed.nl"
+      echo >>"$tmp/sed.nl"
+      ${_sed} -e 's/a$//' < "$tmp/sed.nl" >"$tmp/sed.out" || break
+      cmp -s "$tmp/sed.out" "$tmp/sed.nl" || break
+      # 40000 chars as input seems more than enough
+      test $_count -gt 10 && break
+      _count=`expr $_count + 1`
+      if test $_count -gt $_max; then
+        _max=$_count
+        lt_cv_path_SED=$_sed
+      fi
+    done
+  done
+  rm -rf "$tmp"
+])
+if test "X$SED" != "X"; then
+  lt_cv_path_SED=$SED
+else
+  SED=$lt_cv_path_SED
+fi
+AC_MSG_RESULT([$SED])
+])
 
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/capi20/config.guess isdn4k-utils-v3.3/capi20/config.guess
--- isdn4k-utils-v3.2p1/capi20/config.guess	2000-10-05 20:45:22.000000000 +0000
+++ isdn4k-utils-v3.3/capi20/config.guess	2003-06-16 12:08:23.000000000 +0000
@@ -1,8 +1,10 @@
 #! /bin/sh
 # Attempt to guess a canonical system name.
-#   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999
-#   Free Software Foundation, Inc.
-#
+#   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
+#   2000, 2001, 2002 Free Software Foundation, Inc.
+
+timestamp='2002-11-30'
+
 # This file is free software; you can redistribute it and/or modify it
 # under the terms of the GNU General Public License as published by
 # the Free Software Foundation; either version 2 of the License, or
@@ -22,52 +24,216 @@
 # configuration script generated by Autoconf, you may include it under
 # the same distribution terms that you use for the rest of that program.
 
-# Written by Per Bothner <bothner@cygnus.com>.
-# The master version of this file is at the FSF in /home/gd/gnu/lib.
-# Please send patches to the Autoconf mailing list <autoconf@gnu.org>.
+# Originally written by Per Bothner <per@bothner.com>.
+# Please send patches to <config-patches@gnu.org>.  Submit a context
+# diff and a properly formatted ChangeLog entry.
 #
 # This script attempts to guess a canonical system name similar to
 # config.sub.  If it succeeds, it prints the system name on stdout, and
 # exits with 0.  Otherwise, it exits with 1.
 #
 # The plan is that this can be called by configure scripts if you
-# don't specify an explicit system type (host/target name).
-#
-# Only a few systems have been added to this list; please add others
-# (but try to keep the structure clean).
-#
+# don't specify an explicit build system type.
 
-# Use $HOST_CC if defined. $CC may point to a cross-compiler
-if test x"$CC_FOR_BUILD" = x; then
-  if test x"$HOST_CC" != x; then
-    CC_FOR_BUILD="$HOST_CC"
-  else
-    if test x"$CC" != x; then
-      CC_FOR_BUILD="$CC"
-    else
-      CC_FOR_BUILD=cc
-    fi
-  fi
+me=`echo "$0" | sed -e 's,.*/,,'`
+
+usage="\
+Usage: $0 [OPTION]
+
+Output the configuration name of the system \`$me' is run on.
+
+Operation modes:
+  -h, --help         print this help, then exit
+  -t, --time-stamp   print date of last modification, then exit
+  -v, --version      print version number, then exit
+
+Report bugs and patches to <config-patches@gnu.org>."
+
+version="\
+GNU config.guess ($timestamp)
+
+Originally written by Per Bothner.
+Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001
+Free Software Foundation, Inc.
+
+This is free software; see the source for copying conditions.  There is NO
+warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."
+
+help="
+Try \`$me --help' for more information."
+
+# Parse command line
+while test $# -gt 0 ; do
+  case $1 in
+    --time-stamp | --time* | -t )
+       echo "$timestamp" ; exit 0 ;;
+    --version | -v )
+       echo "$version" ; exit 0 ;;
+    --help | --h* | -h )
+       echo "$usage"; exit 0 ;;
+    -- )     # Stop option processing
+       shift; break ;;
+    - )	# Use stdin as input.
+       break ;;
+    -* )
+       echo "$me: invalid option $1$help" >&2
+       exit 1 ;;
+    * )
+       break ;;
+  esac
+done
+
+if test $# != 0; then
+  echo "$me: too many arguments$help" >&2
+  exit 1
 fi
 
+trap 'exit 1' 1 2 15
+
+# CC_FOR_BUILD -- compiler used by this script. Note that the use of a
+# compiler to aid in system detection is discouraged as it requires
+# temporary files to be created and, as you can see below, it is a
+# headache to deal with in a portable fashion.
+
+# Historically, `CC_FOR_BUILD' used to be named `HOST_CC'. We still
+# use `HOST_CC' if defined, but it is deprecated.
+
+# This shell variable is my proudest work .. or something. --bje
+
+set_cc_for_build='tmpdir=${TMPDIR-/tmp}/config-guess-$$ ;
+(old=`umask` && umask 077 && mkdir $tmpdir && umask $old && unset old)
+   || (echo "$me: cannot create $tmpdir" >&2 && exit 1) ;
+dummy=$tmpdir/dummy ;
+files="$dummy.c $dummy.o $dummy.rel $dummy" ;
+trap '"'"'rm -f $files; rmdir $tmpdir; exit 1'"'"' 1 2 15 ;
+case $CC_FOR_BUILD,$HOST_CC,$CC in
+ ,,)    echo "int x;" > $dummy.c ;
+	for c in cc gcc c89 c99 ; do
+	  if ($c -c -o $dummy.o $dummy.c) >/dev/null 2>&1 ; then
+	     CC_FOR_BUILD="$c"; break ;
+	  fi ;
+	done ;
+	rm -f $files ;
+	if test x"$CC_FOR_BUILD" = x ; then
+	  CC_FOR_BUILD=no_compiler_found ;
+	fi
+	;;
+ ,,*)   CC_FOR_BUILD=$CC ;;
+ ,*,*)  CC_FOR_BUILD=$HOST_CC ;;
+esac ;
+unset files'
 
 # This is needed to find uname on a Pyramid OSx when run in the BSD universe.
-# (ghazi@noc.rutgers.edu 8/24/94.)
+# (ghazi@noc.rutgers.edu 1994-08-24)
 if (test -f /.attbin/uname) >/dev/null 2>&1 ; then
 	PATH=$PATH:/.attbin ; export PATH
 fi
 
 UNAME_MACHINE=`(uname -m) 2>/dev/null` || UNAME_MACHINE=unknown
 UNAME_RELEASE=`(uname -r) 2>/dev/null` || UNAME_RELEASE=unknown
-UNAME_SYSTEM=`(uname -s) 2>/dev/null` || UNAME_SYSTEM=unknown
+UNAME_SYSTEM=`(uname -s) 2>/dev/null`  || UNAME_SYSTEM=unknown
 UNAME_VERSION=`(uname -v) 2>/dev/null` || UNAME_VERSION=unknown
 
-dummy=dummy-$$
-trap 'rm -f $dummy.c $dummy.o $dummy; exit 1' 1 2 15
-
 # Note: order is significant - the case branches are not exclusive.
 
 case "${UNAME_MACHINE}:${UNAME_SYSTEM}:${UNAME_RELEASE}:${UNAME_VERSION}" in
+    *:NetBSD:*:*)
+	# NetBSD (nbsd) targets should (where applicable) match one or
+	# more of the tupples: *-*-netbsdelf*, *-*-netbsdaout*,
+	# *-*-netbsdecoff* and *-*-netbsd*.  For targets that recently
+	# switched to ELF, *-*-netbsd* would select the old
+	# object file format.  This provides both forward
+	# compatibility and a consistent mechanism for selecting the
+	# object file format.
+	#
+	# Note: NetBSD doesn't particularly care about the vendor
+	# portion of the name.  We always set it to "unknown".
+	sysctl="sysctl -n hw.machine_arch"
+	UNAME_MACHINE_ARCH=`(/sbin/$sysctl 2>/dev/null || \
+	    /usr/sbin/$sysctl 2>/dev/null || echo unknown)`
+	case "${UNAME_MACHINE_ARCH}" in
+	    armeb) machine=armeb-unknown ;;
+	    arm*) machine=arm-unknown ;;
+	    sh3el) machine=shl-unknown ;;
+	    sh3eb) machine=sh-unknown ;;
+	    *) machine=${UNAME_MACHINE_ARCH}-unknown ;;
+	esac
+	# The Operating System including object format, if it has switched
+	# to ELF recently, or will in the future.
+	case "${UNAME_MACHINE_ARCH}" in
+	    arm*|i386|m68k|ns32k|sh3*|sparc|vax)
+		eval $set_cc_for_build
+		if echo __ELF__ | $CC_FOR_BUILD -E - 2>/dev/null \
+			| grep __ELF__ >/dev/null
+		then
+		    # Once all utilities can be ECOFF (netbsdecoff) or a.out (netbsdaout).
+		    # Return netbsd for either.  FIX?
+		    os=netbsd
+		else
+		    os=netbsdelf
+		fi
+		;;
+	    *)
+	        os=netbsd
+		;;
+	esac
+	# The OS release
+	# Debian GNU/NetBSD machines have a different userland, and
+	# thus, need a distinct triplet. However, they do not need
+	# kernel version information, so it can be replaced with a
+	# suitable tag, in the style of linux-gnu.
+	case "${UNAME_VERSION}" in
+	    Debian*)
+		release='-gnu'
+		;;
+	    *)
+		release=`echo ${UNAME_RELEASE}|sed -e 's/[-_].*/\./'`
+		;;
+	esac
+	# Since CPU_TYPE-MANUFACTURER-KERNEL-OPERATING_SYSTEM:
+	# contains redundant information, the shorter form:
+	# CPU_TYPE-MANUFACTURER-OPERATING_SYSTEM is used.
+	echo "${machine}-${os}${release}"
+	exit 0 ;;
+    amiga:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    arc:OpenBSD:*:*)
+	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    hp300:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mac68k:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    macppc:OpenBSD:*:*)
+	echo powerpc-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mvme68k:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mvme88k:OpenBSD:*:*)
+	echo m88k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mvmeppc:OpenBSD:*:*)
+	echo powerpc-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    pmax:OpenBSD:*:*)
+	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    sgi:OpenBSD:*:*)
+	echo mipseb-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    sun3:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    wgrisc:OpenBSD:*:*)
+	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    *:OpenBSD:*:*)
+	echo ${UNAME_MACHINE}-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
     alpha:OSF1:*:*)
 	if test $UNAME_RELEASE = "V4.0"; then
 		UNAME_RELEASE=`/usr/sbin/sizer -v | awk '{print $3}'`
@@ -76,45 +242,62 @@
 	# A Tn.n version is a released field test version.
 	# A Xn.n version is an unreleased experimental baselevel.
 	# 1.2 uses "1.2" for uname -r.
+	eval $set_cc_for_build
 	cat <<EOF >$dummy.s
+	.data
+\$Lformat:
+	.byte 37,100,45,37,120,10,0	# "%d-%x\n"
+
+	.text
 	.globl main
+	.align 4
 	.ent main
 main:
-	.frame \$30,0,\$26,0
-	.prologue 0
-	.long 0x47e03d80 # implver $0
-	lda \$2,259
-	.long 0x47e20c21 # amask $2,$1
-	srl \$1,8,\$2
-	sll \$2,2,\$2
-	sll \$0,3,\$0
-	addl \$1,\$0,\$0
-	addl \$2,\$0,\$0
-	ret \$31,(\$26),1
+	.frame \$30,16,\$26,0
+	ldgp \$29,0(\$27)
+	.prologue 1
+	.long 0x47e03d80 # implver \$0
+	lda \$2,-1
+	.long 0x47e20c21 # amask \$2,\$1
+	lda \$16,\$Lformat
+	mov \$0,\$17
+	not \$1,\$18
+	jsr \$26,printf
+	ldgp \$29,0(\$26)
+	mov 0,\$16
+	jsr \$26,exit
 	.end main
 EOF
-	$CC_FOR_BUILD $dummy.s -o $dummy 2>/dev/null
+	$CC_FOR_BUILD -o $dummy $dummy.s 2>/dev/null
 	if test "$?" = 0 ; then
-		./$dummy
-		case "$?" in
-			7)
+		case `$dummy` in
+			0-0)
 				UNAME_MACHINE="alpha"
 				;;
-			15)
+			1-0)
 				UNAME_MACHINE="alphaev5"
 				;;
-			14)
+			1-1)
 				UNAME_MACHINE="alphaev56"
 				;;
-			10)
+			1-101)
 				UNAME_MACHINE="alphapca56"
 				;;
-			16)
+			2-303)
 				UNAME_MACHINE="alphaev6"
 				;;
+			2-307)
+				UNAME_MACHINE="alphaev67"
+				;;
+			2-1307)
+				UNAME_MACHINE="alphaev68"
+				;;
+			3-1307)
+				UNAME_MACHINE="alphaev7"
+				;;
 		esac
 	fi
-	rm -f $dummy.s $dummy
+	rm -f $dummy.s $dummy && rmdir $tmpdir
 	echo ${UNAME_MACHINE}-dec-osf`echo ${UNAME_RELEASE} | sed -e 's/^[VTX]//' | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz'`
 	exit 0 ;;
     Alpha\ *:Windows_NT*:*)
@@ -127,42 +310,21 @@
 	echo alpha-dec-winnt3.5
 	exit 0 ;;
     Amiga*:UNIX_System_V:4.0:*)
-	echo m68k-cbm-sysv4
+	echo m68k-unknown-sysv4
 	exit 0;;
-    amiga:NetBSD:*:*)
-      echo m68k-cbm-netbsd${UNAME_RELEASE}
-      exit 0 ;;
-    amiga:OpenBSD:*:*)
-	echo m68k-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
     *:[Aa]miga[Oo][Ss]:*:*)
 	echo ${UNAME_MACHINE}-unknown-amigaos
 	exit 0 ;;
-    arc64:OpenBSD:*:*)
-	echo mips64el-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    arc:OpenBSD:*:*)
-	echo mipsel-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    hkmips:OpenBSD:*:*)
-	echo mips-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    pmax:OpenBSD:*:*)
-	echo mipsel-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    sgi:OpenBSD:*:*)
-	echo mips-unknown-openbsd${UNAME_RELEASE}
+    *:[Mm]orph[Oo][Ss]:*:*)
+	echo ${UNAME_MACHINE}-unknown-morphos
 	exit 0 ;;
-    wgrisc:OpenBSD:*:*)
-	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+    *:OS/390:*:*)
+	echo i370-ibm-openedition
 	exit 0 ;;
     arm:RISC*:1.[012]*:*|arm:riscix:1.[012]*:*)
 	echo arm-acorn-riscix${UNAME_RELEASE}
 	exit 0;;
-    arm32:NetBSD:*:*)
-	echo arm-unknown-netbsd`echo ${UNAME_RELEASE}|sed -e 's/[-_].*/\./'`
-	exit 0 ;;
-    SR2?01:HI-UX/MPP:*:*)
+    SR2?01:HI-UX/MPP:*:* | SR8000:HI-UX/MPP:*:*)
 	echo hppa1.1-hitachi-hiuxmpp
 	exit 0;;
     Pyramid*:OSx*:*:* | MIS*:OSx*:*:* | MIS*:SMP_DC-OSx*:*:*)
@@ -176,6 +338,10 @@
     NILE*:*:*:dcosx)
 	echo pyramid-pyramid-svr4
 	exit 0 ;;
+    DRS?6000:UNIX_SV:4.2*:7*)
+	case `/usr/bin/uname -p` in
+	    sparc) echo sparc-icl-nx7 && exit 0 ;;
+	esac ;;
     sun4H:SunOS:5.*:*)
 	echo sparc-hal-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
 	exit 0 ;;
@@ -204,7 +370,7 @@
 	echo m68k-sun-sunos${UNAME_RELEASE}
 	exit 0 ;;
     sun*:*:4.2BSD:*)
-	UNAME_RELEASE=`(head -1 /etc/motd | awk '{print substr($5,1,3)}') 2>/dev/null`
+	UNAME_RELEASE=`(sed 1q /etc/motd | awk '{print substr($5,1,3)}') 2>/dev/null`
 	test "x${UNAME_RELEASE}" = "x" && UNAME_RELEASE=3
 	case "`/bin/arch`" in
 	    sun3)
@@ -218,15 +384,9 @@
     aushp:SunOS:*:*)
 	echo sparc-auspex-sunos${UNAME_RELEASE}
 	exit 0 ;;
-    atari*:NetBSD:*:*)
-	echo m68k-atari-netbsd${UNAME_RELEASE}
-	exit 0 ;;
-    atari*:OpenBSD:*:*)
-	echo m68k-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
     # The situation for MiNT is a little confusing.  The machine name
     # can be virtually everything (everything which is not
-    # "atarist" or "atariste" at least should have a processor 
+    # "atarist" or "atariste" at least should have a processor
     # > m68000).  The system name ranges from "MiNT" over "FreeMiNT"
     # to the lowercase version "mint" (or "freemint").  Finally
     # the system name "TOS" denotes a system which is actually not
@@ -250,30 +410,9 @@
     *:*MiNT:*:* | *:*mint:*:* | *:*TOS:*:*)
         echo m68k-unknown-mint${UNAME_RELEASE}
         exit 0 ;;
-    sun3*:NetBSD:*:*)
-	echo m68k-sun-netbsd${UNAME_RELEASE}
-	exit 0 ;;
-    sun3*:OpenBSD:*:*)
-	echo m68k-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    mac68k:NetBSD:*:*)
-	echo m68k-apple-netbsd${UNAME_RELEASE}
-	exit 0 ;;
-    mac68k:OpenBSD:*:*)
-	echo m68k-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    mvme68k:OpenBSD:*:*)
-	echo m68k-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    mvme88k:OpenBSD:*:*)
-	echo m88k-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
     powerpc:machten:*:*)
 	echo powerpc-apple-machten${UNAME_RELEASE}
 	exit 0 ;;
-    macppc:NetBSD:*:*)
-        echo powerpc-apple-netbsd${UNAME_RELEASE}
-        exit 0 ;;
     RISC*:Mach:*:*)
 	echo mips-dec-mach_bsd4.3
 	exit 0 ;;
@@ -287,8 +426,10 @@
 	echo clipper-intergraph-clix${UNAME_RELEASE}
 	exit 0 ;;
     mips:*:*:UMIPS | mips:*:*:RISCos)
+	eval $set_cc_for_build
 	sed 's/^	//' << EOF >$dummy.c
 #ifdef __cplusplus
+#include <stdio.h>  /* for printf() prototype */
 	int main (int argc, char *argv[]) {
 #else
 	int main (argc, argv) int argc; char *argv[]; {
@@ -307,12 +448,21 @@
 	  exit (-1);
 	}
 EOF
-	$CC_FOR_BUILD $dummy.c -o $dummy \
-	  && ./$dummy `echo "${UNAME_RELEASE}" | sed -n 's/\([0-9]*\).*/\1/p'` \
-	  && rm $dummy.c $dummy && exit 0
-	rm -f $dummy.c $dummy
+	$CC_FOR_BUILD -o $dummy $dummy.c \
+	  && $dummy `echo "${UNAME_RELEASE}" | sed -n 's/\([0-9]*\).*/\1/p'` \
+	  && rm -f $dummy.c $dummy && rmdir $tmpdir && exit 0
+	rm -f $dummy.c $dummy && rmdir $tmpdir
 	echo mips-mips-riscos${UNAME_RELEASE}
 	exit 0 ;;
+    Motorola:PowerMAX_OS:*:*)
+	echo powerpc-motorola-powermax
+	exit 0 ;;
+    Motorola:*:4.3:PL8-*)
+	echo powerpc-harris-powermax
+	exit 0 ;;
+    Night_Hawk:*:*:PowerMAX_OS | Synergy:PowerMAX_OS:*:*)
+	echo powerpc-harris-powermax
+	exit 0 ;;
     Night_Hawk:Power_UNIX:*:*)
 	echo powerpc-harris-powerunix
 	exit 0 ;;
@@ -328,15 +478,18 @@
     AViiON:dgux:*:*)
         # DG/UX returns AViiON for all architectures
         UNAME_PROCESSOR=`/usr/bin/uname -p`
-        if [ $UNAME_PROCESSOR = mc88100 -o $UNAME_PROCESSOR = mc88110 ] ; then
-	if [ ${TARGET_BINARY_INTERFACE}x = m88kdguxelfx \
-	     -o ${TARGET_BINARY_INTERFACE}x = x ] ; then
+	if [ $UNAME_PROCESSOR = mc88100 ] || [ $UNAME_PROCESSOR = mc88110 ]
+	then
+	    if [ ${TARGET_BINARY_INTERFACE}x = m88kdguxelfx ] || \
+	       [ ${TARGET_BINARY_INTERFACE}x = x ]
+	    then
 		echo m88k-dg-dgux${UNAME_RELEASE}
-	else
+	    else
 		echo m88k-dg-dguxbcs${UNAME_RELEASE}
+	    fi
+	else
+	    echo i586-dg-dgux${UNAME_RELEASE}
 	fi
-        else echo i586-dg-dgux${UNAME_RELEASE}
-        fi
  	exit 0 ;;
     M88*:DolphinOS:*:*)	# DolphinOS (SVR3)
 	echo m88k-dolphin-sysv3
@@ -357,11 +510,20 @@
     ????????:AIX?:[12].1:2)   # AIX 2.2.1 or AIX 2.1.1 is RT/PC AIX.
 	echo romp-ibm-aix      # uname -m gives an 8 hex-code CPU id
 	exit 0 ;;              # Note that: echo "'`uname -s`'" gives 'AIX '
-    i?86:AIX:*:*)
+    i*86:AIX:*:*)
 	echo i386-ibm-aix
 	exit 0 ;;
+    ia64:AIX:*:*)
+	if [ -x /usr/bin/oslevel ] ; then
+		IBM_REV=`/usr/bin/oslevel`
+	else
+		IBM_REV=${UNAME_VERSION}.${UNAME_RELEASE}
+	fi
+	echo ${UNAME_MACHINE}-ibm-aix${IBM_REV}
+	exit 0 ;;
     *:AIX:2:3)
 	if grep bos325 /usr/include/stdio.h >/dev/null 2>&1; then
+		eval $set_cc_for_build
 		sed 's/^		//' << EOF >$dummy.c
 		#include <sys/systemcfg.h>
 
@@ -373,8 +535,8 @@
 			exit(0);
 			}
 EOF
-		$CC_FOR_BUILD $dummy.c -o $dummy && ./$dummy && rm $dummy.c $dummy && exit 0
-		rm -f $dummy.c $dummy
+		$CC_FOR_BUILD -o $dummy $dummy.c && $dummy && rm -f $dummy.c $dummy && rmdir $tmpdir && exit 0
+		rm -f $dummy.c $dummy && rmdir $tmpdir
 		echo rs6000-ibm-aix3.2.5
 	elif grep bos324 /usr/include/stdio.h >/dev/null 2>&1; then
 		echo rs6000-ibm-aix3.2.4
@@ -382,9 +544,9 @@
 		echo rs6000-ibm-aix3.2
 	fi
 	exit 0 ;;
-    *:AIX:*:4)
-	IBM_CPU_ID=`/usr/sbin/lsdev -C -c processor -S available | head -1 | awk '{ print $1 }'`
-	if /usr/sbin/lsattr -EHl ${IBM_CPU_ID} | grep POWER >/dev/null 2>&1; then
+    *:AIX:*:[45])
+	IBM_CPU_ID=`/usr/sbin/lsdev -C -c processor -S available | sed 1q | awk '{ print $1 }'`
+	if /usr/sbin/lsattr -El ${IBM_CPU_ID} | grep ' POWER' >/dev/null 2>&1; then
 		IBM_ARCH=rs6000
 	else
 		IBM_ARCH=powerpc
@@ -392,7 +554,7 @@
 	if [ -x /usr/bin/oslevel ] ; then
 		IBM_REV=`/usr/bin/oslevel`
 	else
-		IBM_REV=4.${UNAME_RELEASE}
+		IBM_REV=${UNAME_VERSION}.${UNAME_RELEASE}
 	fi
 	echo ${IBM_ARCH}-ibm-aix${IBM_REV}
 	exit 0 ;;
@@ -402,7 +564,7 @@
     ibmrt:4.4BSD:*|romp-ibm:BSD:*)
 	echo romp-ibm-bsd4.4
 	exit 0 ;;
-    ibmrt:*BSD:*|romp-ibm:BSD:*)            # covers RT/PC NetBSD and
+    ibmrt:*BSD:*|romp-ibm:BSD:*)            # covers RT/PC BSD and
 	echo romp-ibm-bsd${UNAME_RELEASE}   # 4.3 with uname added to
 	exit 0 ;;                           # report: romp-ibm BSD 4.3
     *:BOSX:*:*)
@@ -418,11 +580,30 @@
 	echo m68k-hp-bsd4.4
 	exit 0 ;;
     9000/[34678]??:HP-UX:*:*)
+	HPUX_REV=`echo ${UNAME_RELEASE}|sed -e 's/[^.]*.[0B]*//'`
 	case "${UNAME_MACHINE}" in
 	    9000/31? )            HP_ARCH=m68000 ;;
 	    9000/[34]?? )         HP_ARCH=m68k ;;
 	    9000/[678][0-9][0-9])
-              sed 's/^              //' << EOF >$dummy.c
+		if [ -x /usr/bin/getconf ]; then
+		    sc_cpu_version=`/usr/bin/getconf SC_CPU_VERSION 2>/dev/null`
+                    sc_kernel_bits=`/usr/bin/getconf SC_KERNEL_BITS 2>/dev/null`
+                    case "${sc_cpu_version}" in
+                      523) HP_ARCH="hppa1.0" ;; # CPU_PA_RISC1_0
+                      528) HP_ARCH="hppa1.1" ;; # CPU_PA_RISC1_1
+                      532)                      # CPU_PA_RISC2_0
+                        case "${sc_kernel_bits}" in
+                          32) HP_ARCH="hppa2.0n" ;;
+                          64) HP_ARCH="hppa2.0w" ;;
+			  '') HP_ARCH="hppa2.0" ;;   # HP-UX 10.20
+                        esac ;;
+                    esac
+		fi
+		if [ "${HP_ARCH}" = "" ]; then
+		    eval $set_cc_for_build
+		    sed 's/^              //' << EOF >$dummy.c
+
+              #define _HPUX_SOURCE
               #include <stdlib.h>
               #include <unistd.h>
 
@@ -453,13 +634,19 @@
                   exit (0);
               }
 EOF
-	($CC_FOR_BUILD $dummy.c -o $dummy 2>/dev/null ) && HP_ARCH=`./$dummy`
-	rm -f $dummy.c $dummy
+		    (CCOPTS= $CC_FOR_BUILD -o $dummy $dummy.c 2>/dev/null) && HP_ARCH=`$dummy`
+		    if test -z "$HP_ARCH"; then HP_ARCH=hppa; fi
+		    rm -f $dummy.c $dummy && rmdir $tmpdir
+		fi ;;
 	esac
-	HPUX_REV=`echo ${UNAME_RELEASE}|sed -e 's/[^.]*.[0B]*//'`
 	echo ${HP_ARCH}-hp-hpux${HPUX_REV}
 	exit 0 ;;
+    ia64:HP-UX:*:*)
+	HPUX_REV=`echo ${UNAME_RELEASE}|sed -e 's/[^.]*.[0B]*//'`
+	echo ia64-hp-hpux${HPUX_REV}
+	exit 0 ;;
     3050*:HI-UX:*:*)
+	eval $set_cc_for_build
 	sed 's/^	//' << EOF >$dummy.c
 	#include <unistd.h>
 	int
@@ -485,8 +672,8 @@
 	  exit (0);
 	}
 EOF
-	$CC_FOR_BUILD $dummy.c -o $dummy && ./$dummy && rm $dummy.c $dummy && exit 0
-	rm -f $dummy.c $dummy
+	$CC_FOR_BUILD -o $dummy $dummy.c && $dummy && rm -f $dummy.c $dummy && rmdir $tmpdir && exit 0
+	rm -f $dummy.c $dummy && rmdir $tmpdir
 	echo unknown-hitachi-hiuxwe2
 	exit 0 ;;
     9000/7??:4.3bsd:*:* | 9000/8?[79]:4.3bsd:*:* )
@@ -495,7 +682,7 @@
     9000/8??:4.3bsd:*:*)
 	echo hppa1.0-hp-bsd
 	exit 0 ;;
-    *9??*:MPE/iX:*:*)
+    *9??*:MPE/iX:*:* | *3000*:MPE/iX:*:*)
 	echo hppa1.0-hp-mpeix
 	exit 0 ;;
     hp7??:OSF1:*:* | hp8?[79]:OSF1:*:* )
@@ -504,7 +691,7 @@
     hp8??:OSF1:*:*)
 	echo hppa1.0-hp-osf
 	exit 0 ;;
-    i?86:OSF1:*:*)
+    i*86:OSF1:*:*)
 	if [ -x /usr/sbin/sysversion ] ; then
 	    echo ${UNAME_MACHINE}-unknown-osf1mk
 	else
@@ -514,9 +701,6 @@
     parisc*:Lites*:*:*)
 	echo hppa1.1-hp-lites
 	exit 0 ;;
-    hppa*:OpenBSD:*:*)
-	echo hppa-unknown-openbsd
-	exit 0 ;;
     C1*:ConvexOS:*:* | convex:ConvexOS:C1*:*)
 	echo c1-convex-bsd
         exit 0 ;;
@@ -535,41 +719,34 @@
     C4*:ConvexOS:*:* | convex:ConvexOS:C4*:*)
 	echo c4-convex-bsd
         exit 0 ;;
-    CRAY*X-MP:*:*:*)
-	echo xmp-cray-unicos
-        exit 0 ;;
     CRAY*Y-MP:*:*:*)
-	echo ymp-cray-unicos${UNAME_RELEASE}
+	echo ymp-cray-unicos${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
 	exit 0 ;;
     CRAY*[A-Z]90:*:*:*)
 	echo ${UNAME_MACHINE}-cray-unicos${UNAME_RELEASE} \
 	| sed -e 's/CRAY.*\([A-Z]90\)/\1/' \
-	      -e y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/
+	      -e y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/ \
+	      -e 's/\.[^.]*$/.X/'
 	exit 0 ;;
     CRAY*TS:*:*:*)
-	echo t90-cray-unicos${UNAME_RELEASE}
+	echo t90-cray-unicos${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
+	exit 0 ;;
+    CRAY*T3D:*:*:*)
+	echo alpha-cray-unicosmk${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
 	exit 0 ;;
     CRAY*T3E:*:*:*)
-	echo alpha-cray-unicosmk${UNAME_RELEASE}
+	echo alphaev5-cray-unicosmk${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
 	exit 0 ;;
-    CRAY-2:*:*:*)
-	echo cray2-cray-unicos
-        exit 0 ;;
-    F300:UNIX_System_V:*:*)
+    CRAY*SV1:*:*:*)
+	echo sv1-cray-unicos${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
+	exit 0 ;;
+    F30[01]:UNIX_System_V:*:* | F700:UNIX_System_V:*:*)
+	FUJITSU_PROC=`uname -m | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz'`
         FUJITSU_SYS=`uname -p | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz' | sed -e 's/\///'`
         FUJITSU_REL=`echo ${UNAME_RELEASE} | sed -e 's/ /_/'`
-        echo "f300-fujitsu-${FUJITSU_SYS}${FUJITSU_REL}"
+        echo "${FUJITSU_PROC}-fujitsu-${FUJITSU_SYS}${FUJITSU_REL}"
         exit 0 ;;
-    F301:UNIX_System_V:*:*)
-       echo f301-fujitsu-uxpv`echo $UNAME_RELEASE | sed 's/ .*//'`
-       exit 0 ;;
-    hp3[0-9][05]:NetBSD:*:*)
-	echo m68k-hp-netbsd${UNAME_RELEASE}
-	exit 0 ;;
-    hp300:OpenBSD:*:*)
-	echo m68k-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    i?86:BSD/386:*:* | i?86:BSD/OS:*:*)
+    i*86:BSD/386:*:* | i*86:BSD/OS:*:* | *:Ascend\ Embedded/OS:*:*)
 	echo ${UNAME_MACHINE}-pc-bsdi${UNAME_RELEASE}
 	exit 0 ;;
     sparc*:BSD/OS:*:*)
@@ -579,19 +756,19 @@
 	echo ${UNAME_MACHINE}-unknown-bsdi${UNAME_RELEASE}
 	exit 0 ;;
     *:FreeBSD:*:*)
-	if test -x /usr/bin/objformat; then
-	    if test "elf" = "`/usr/bin/objformat`"; then
-		echo ${UNAME_MACHINE}-unknown-freebsdelf`echo ${UNAME_RELEASE}|sed -e 's/[-_].*//'`
-		exit 0
-	    fi
-	fi
-	echo ${UNAME_MACHINE}-unknown-freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`
-	exit 0 ;;
-    *:NetBSD:*:*)
-	echo ${UNAME_MACHINE}-unknown-netbsd`echo ${UNAME_RELEASE}|sed -e 's/[-_].*/\./'`
-	exit 0 ;;
-    *:OpenBSD:*:*)
-	echo ${UNAME_MACHINE}-unknown-openbsd`echo ${UNAME_RELEASE}|sed -e 's/[-_].*/\./'`
+	# Determine whether the default compiler uses glibc.
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+	#include <features.h>
+	#if __GLIBC__ >= 2
+	LIBC=gnu
+	#else
+	LIBC=
+	#endif
+EOF
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^LIBC=`
+	rm -f $dummy.c && rmdir $tmpdir
+	echo ${UNAME_MACHINE}-unknown-freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`${LIBC:+-$LIBC}
 	exit 0 ;;
     i*:CYGWIN*:*)
 	echo ${UNAME_MACHINE}-pc-cygwin
@@ -599,11 +776,20 @@
     i*:MINGW*:*)
 	echo ${UNAME_MACHINE}-pc-mingw32
 	exit 0 ;;
+    i*:PW*:*)
+	echo ${UNAME_MACHINE}-pc-pw32
+	exit 0 ;;
+    x86:Interix*:3*)
+	echo i586-pc-interix3
+	exit 0 ;;
+    [345]86:Windows_95:* | [345]86:Windows_98:* | [345]86:Windows_NT:*)
+	echo i${UNAME_MACHINE}-pc-mks
+	exit 0 ;;
     i*:Windows_NT*:* | Pentium*:Windows_NT*:*)
 	# How do we know it's Interix rather than the generic POSIX subsystem?
 	# It also conflicts with pre-2.0 versions of AT&T UWIN. Should we
 	# UNAME_MACHINE based on the output of uname instead of i386?
-	echo i386-pc-interix
+	echo i586-pc-interix
 	exit 0 ;;
     i*:UWIN*:*)
 	echo ${UNAME_MACHINE}-pc-uwin
@@ -617,179 +803,162 @@
     *:GNU:*:*)
 	echo `echo ${UNAME_MACHINE}|sed -e 's,[-/].*$,,'`-unknown-gnu`echo ${UNAME_RELEASE}|sed -e 's,/.*$,,'`
 	exit 0 ;;
-    *:Linux:*:*)
-	# uname on the ARM produces all sorts of strangeness, and we need to
-	# filter it out.
-	case "$UNAME_MACHINE" in
-	  armv*)		      UNAME_MACHINE=$UNAME_MACHINE ;;
-	  arm* | sa110*)	      UNAME_MACHINE="arm" ;;
+    i*86:Minix:*:*)
+	echo ${UNAME_MACHINE}-pc-minix
+	exit 0 ;;
+    arm*:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    ia64:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    m68*:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    mips:Linux:*:*)
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+	#undef CPU
+	#undef mips
+	#undef mipsel
+	#if defined(__MIPSEL__) || defined(__MIPSEL) || defined(_MIPSEL) || defined(MIPSEL)
+	CPU=mipsel
+	#else
+	#if defined(__MIPSEB__) || defined(__MIPSEB) || defined(_MIPSEB) || defined(MIPSEB)
+	CPU=mips
+	#else
+	CPU=
+	#endif
+	#endif
+EOF
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^CPU=`
+	rm -f $dummy.c && rmdir $tmpdir
+	test x"${CPU}" != x && echo "${CPU}-unknown-linux-gnu" && exit 0
+	;;
+    mips64:Linux:*:*)
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+	#undef CPU
+	#undef mips64
+	#undef mips64el
+	#if defined(__MIPSEL__) || defined(__MIPSEL) || defined(_MIPSEL) || defined(MIPSEL)
+	CPU=mips64el
+	#else
+	#if defined(__MIPSEB__) || defined(__MIPSEB) || defined(_MIPSEB) || defined(MIPSEB)
+	CPU=mips64
+	#else
+	CPU=
+	#endif
+	#endif
+EOF
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^CPU=`
+	rm -f $dummy.c && rmdir $tmpdir
+	test x"${CPU}" != x && echo "${CPU}-unknown-linux-gnu" && exit 0
+	;;
+    ppc:Linux:*:*)
+	echo powerpc-unknown-linux-gnu
+	exit 0 ;;
+    ppc64:Linux:*:*)
+	echo powerpc64-unknown-linux-gnu
+	exit 0 ;;
+    alpha:Linux:*:*)
+	case `sed -n '/^cpu model/s/^.*: \(.*\)/\1/p' < /proc/cpuinfo` in
+	  EV5)   UNAME_MACHINE=alphaev5 ;;
+	  EV56)  UNAME_MACHINE=alphaev56 ;;
+	  PCA56) UNAME_MACHINE=alphapca56 ;;
+	  PCA57) UNAME_MACHINE=alphapca56 ;;
+	  EV6)   UNAME_MACHINE=alphaev6 ;;
+	  EV67)  UNAME_MACHINE=alphaev67 ;;
+	  EV68*) UNAME_MACHINE=alphaev68 ;;
+        esac
+	objdump --private-headers /bin/sh | grep ld.so.1 >/dev/null
+	if test "$?" = 0 ; then LIBC="libc1" ; else LIBC="" ; fi
+	echo ${UNAME_MACHINE}-unknown-linux-gnu${LIBC}
+	exit 0 ;;
+    parisc:Linux:*:* | hppa:Linux:*:*)
+	# Look for CPU level
+	case `grep '^cpu[^a-z]*:' /proc/cpuinfo 2>/dev/null | cut -d' ' -f2` in
+	  PA7*) echo hppa1.1-unknown-linux-gnu ;;
+	  PA8*) echo hppa2.0-unknown-linux-gnu ;;
+	  *)    echo hppa-unknown-linux-gnu ;;
 	esac
-
+	exit 0 ;;
+    parisc64:Linux:*:* | hppa64:Linux:*:*)
+	echo hppa64-unknown-linux-gnu
+	exit 0 ;;
+    s390:Linux:*:* | s390x:Linux:*:*)
+	echo ${UNAME_MACHINE}-ibm-linux
+	exit 0 ;;
+    sh*:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    sparc:Linux:*:* | sparc64:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    x86_64:Linux:*:*)
+	echo x86_64-unknown-linux-gnu
+	exit 0 ;;
+    i*86:Linux:*:*)
 	# The BFD linker knows what the default object file format is, so
 	# first see if it will tell us. cd to the root directory to prevent
 	# problems with other programs or directories called `ld' in the path.
-	ld_help_string=`cd /; ld --help 2>&1`
-	ld_supported_emulations=`echo $ld_help_string \
-			 | sed -ne '/supported emulations:/!d
+	# Set LC_ALL=C to ensure ld outputs messages in English.
+	ld_supported_targets=`cd /; LC_ALL=C ld --help 2>&1 \
+			 | sed -ne '/supported targets:/!d
 				    s/[ 	][ 	]*/ /g
-				    s/.*supported emulations: *//
+				    s/.*supported targets: *//
 				    s/ .*//
 				    p'`
-        case "$ld_supported_emulations" in
-	  *ia64)      echo "${UNAME_MACHINE}-unknown-linux"         ; exit 0 ;;
-	  i?86linux)  echo "${UNAME_MACHINE}-pc-linux-gnuaout"      ; exit 0 ;;
-	  i?86coff)   echo "${UNAME_MACHINE}-pc-linux-gnucoff"      ; exit 0 ;;
-	  sparclinux) echo "${UNAME_MACHINE}-unknown-linux-gnuaout" ; exit 0 ;;
-	  armlinux)   echo "${UNAME_MACHINE}-unknown-linux-gnuaout" ; exit 0 ;;
-	  m68klinux)  echo "${UNAME_MACHINE}-unknown-linux-gnuaout" ; exit 0 ;;
-	  elf32ppc | elf32ppclinux)
-		# Determine Lib Version
-		cat >$dummy.c <<EOF
-#include <features.h>
-#if defined(__GLIBC__)
-extern char __libc_version[];
-extern char __libc_release[];
-#endif
-main(argc, argv)
-     int argc;
-     char *argv[];
-{
-#if defined(__GLIBC__)
-  printf("%s %s\n", __libc_version, __libc_release);
-#else
-  printf("unkown\n");
-#endif
-  return 0;
-}
-EOF
-		LIBC=""
-		$CC_FOR_BUILD $dummy.c -o $dummy 2>/dev/null
-		if test "$?" = 0 ; then
-			./$dummy | grep 1\.99 > /dev/null
-			if test "$?" = 0 ; then
-				LIBC="libc1"
-			fi
-		fi	
-		rm -f $dummy.c $dummy
-		echo powerpc-unknown-linux-gnu${LIBC} ; exit 0 ;;
+        case "$ld_supported_targets" in
+	  elf32-i386)
+		TENTATIVE="${UNAME_MACHINE}-pc-linux-gnu"
+		;;
+	  a.out-i386-linux)
+		echo "${UNAME_MACHINE}-pc-linux-gnuaout"
+		exit 0 ;;
+	  coff-i386)
+		echo "${UNAME_MACHINE}-pc-linux-gnucoff"
+		exit 0 ;;
+	  "")
+		# Either a pre-BFD a.out linker (linux-gnuoldld) or
+		# one that does not give us useful --help.
+		echo "${UNAME_MACHINE}-pc-linux-gnuoldld"
+		exit 0 ;;
 	esac
-
-	if test "${UNAME_MACHINE}" = "alpha" ; then
-		sed 's/^	//'  <<EOF >$dummy.s
-		.globl main
-		.ent main
-	main:
-		.frame \$30,0,\$26,0
-		.prologue 0
-		.long 0x47e03d80 # implver $0
-		lda \$2,259
-		.long 0x47e20c21 # amask $2,$1
-		srl \$1,8,\$2
-		sll \$2,2,\$2
-		sll \$0,3,\$0
-		addl \$1,\$0,\$0
-		addl \$2,\$0,\$0
-		ret \$31,(\$26),1
-		.end main
-EOF
-		LIBC=""
-		$CC_FOR_BUILD $dummy.s -o $dummy 2>/dev/null
-		if test "$?" = 0 ; then
-			./$dummy
-			case "$?" in
-			7)
-				UNAME_MACHINE="alpha"
-				;;
-			15)
-				UNAME_MACHINE="alphaev5"
-				;;
-			14)
-				UNAME_MACHINE="alphaev56"
-				;;
-			10)
-				UNAME_MACHINE="alphapca56"
-				;;
-			16)
-				UNAME_MACHINE="alphaev6"
-				;;
-			esac
-
-			objdump --private-headers $dummy | \
-			  grep ld.so.1 > /dev/null
-			if test "$?" = 0 ; then
-				LIBC="libc1"
-			fi
-		fi
-		rm -f $dummy.s $dummy
-		echo ${UNAME_MACHINE}-unknown-linux-gnu${LIBC} ; exit 0
-	elif test "${UNAME_MACHINE}" = "mips" ; then
-	  cat >$dummy.c <<EOF
-#ifdef __cplusplus
-	int main (int argc, char *argv[]) {
-#else
-	int main (argc, argv) int argc; char *argv[]; {
-#endif
-#ifdef __MIPSEB__
-  printf ("%s-unknown-linux-gnu\n", argv[1]);
-#endif
-#ifdef __MIPSEL__
-  printf ("%sel-unknown-linux-gnu\n", argv[1]);
-#endif
-  return 0;
-}
-EOF
-	  $CC_FOR_BUILD $dummy.c -o $dummy 2>/dev/null && ./$dummy "${UNAME_MACHINE}" && rm $dummy.c $dummy && exit 0
-	  rm -f $dummy.c $dummy
-	else
-	  # Either a pre-BFD a.out linker (linux-gnuoldld)
-	  # or one that does not give us useful --help.
-	  # GCC wants to distinguish between linux-gnuoldld and linux-gnuaout.
-	  # If ld does not provide *any* "supported emulations:"
-	  # that means it is gnuoldld.
-	  echo "$ld_help_string" | grep >/dev/null 2>&1 "supported emulations:"
-	  test $? != 0 && echo "${UNAME_MACHINE}-pc-linux-gnuoldld" && exit 0
-
-	  case "${UNAME_MACHINE}" in
-	  i?86)
-	    VENDOR=pc;
-	    ;;
-	  *)
-	    VENDOR=unknown;
-	    ;;
-	  esac
-	  # Determine whether the default compiler is a.out or elf
-	  cat >$dummy.c <<EOF
-#include <features.h>
-#ifdef __cplusplus
-	int main (int argc, char *argv[]) {
-#else
-	int main (argc, argv) int argc; char *argv[]; {
-#endif
-#ifdef __ELF__
-# ifdef __GLIBC__
-#  if __GLIBC__ >= 2
-    printf ("%s-${VENDOR}-linux-gnu\n", argv[1]);
-#  else
-    printf ("%s-${VENDOR}-linux-gnulibc1\n", argv[1]);
-#  endif
-# else
-   printf ("%s-${VENDOR}-linux-gnulibc1\n", argv[1]);
-# endif
-#else
-  printf ("%s-${VENDOR}-linux-gnuaout\n", argv[1]);
-#endif
-  return 0;
-}
+	# Determine whether the default compiler is a.out or elf
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+	#include <features.h>
+	#ifdef __ELF__
+	# ifdef __GLIBC__
+	#  if __GLIBC__ >= 2
+	LIBC=gnu
+	#  else
+	LIBC=gnulibc1
+	#  endif
+	# else
+	LIBC=gnulibc1
+	# endif
+	#else
+	#ifdef __INTEL_COMPILER
+	LIBC=gnu
+	#else
+	LIBC=gnuaout
+	#endif
+	#endif
 EOF
-	  $CC_FOR_BUILD $dummy.c -o $dummy 2>/dev/null && ./$dummy "${UNAME_MACHINE}" && rm $dummy.c $dummy && exit 0
-	  rm -f $dummy.c $dummy
-	fi ;;
-# ptx 4.0 does uname -s correctly, with DYNIX/ptx in there.  earlier versions
-# are messed up and put the nodename in both sysname and nodename.
-    i?86:DYNIX/ptx:4*:*)
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^LIBC=`
+	rm -f $dummy.c && rmdir $tmpdir
+	test x"${LIBC}" != x && echo "${UNAME_MACHINE}-pc-linux-${LIBC}" && exit 0
+	test x"${TENTATIVE}" != x && echo "${TENTATIVE}" && exit 0
+	;;
+    i*86:DYNIX/ptx:4*:*)
+	# ptx 4.0 does uname -s correctly, with DYNIX/ptx in there.
+	# earlier versions are messed up and put the nodename in both
+	# sysname and nodename.
 	echo i386-sequent-sysv4
 	exit 0 ;;
-    i?86:UNIX_SV:4.2MP:2.*)
+    i*86:UNIX_SV:4.2MP:2.*)
         # Unixware is an offshoot of SVR4, but it has its own version
         # number series starting with 2...
         # I am not positive that other SVR4 systems won't match this,
@@ -797,33 +966,51 @@
         # Use sysv4.2uw... so that sysv4* matches it.
 	echo ${UNAME_MACHINE}-pc-sysv4.2uw${UNAME_VERSION}
 	exit 0 ;;
-    i?86:*:4.*:* | i?86:SYSTEM_V:4.*:*)
+    i*86:OS/2:*:*)
+	# If we were able to find `uname', then EMX Unix compatibility
+	# is probably installed.
+	echo ${UNAME_MACHINE}-pc-os2-emx
+	exit 0 ;;
+    i*86:XTS-300:*:STOP)
+	echo ${UNAME_MACHINE}-unknown-stop
+	exit 0 ;;
+    i*86:atheos:*:*)
+	echo ${UNAME_MACHINE}-unknown-atheos
+	exit 0 ;;
+    i*86:LynxOS:2.*:* | i*86:LynxOS:3.[01]*:* | i*86:LynxOS:4.0*:*)
+	echo i386-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
+    i*86:*DOS:*:*)
+	echo ${UNAME_MACHINE}-pc-msdosdjgpp
+	exit 0 ;;
+    i*86:*:4.*:* | i*86:SYSTEM_V:4.*:*)
+	UNAME_REL=`echo ${UNAME_RELEASE} | sed 's/\/MP$//'`
 	if grep Novell /usr/include/link.h >/dev/null 2>/dev/null; then
-		echo ${UNAME_MACHINE}-univel-sysv${UNAME_RELEASE}
+		echo ${UNAME_MACHINE}-univel-sysv${UNAME_REL}
 	else
-		echo ${UNAME_MACHINE}-pc-sysv${UNAME_RELEASE}
+		echo ${UNAME_MACHINE}-pc-sysv${UNAME_REL}
 	fi
 	exit 0 ;;
-    i?86:*:5:7*)
-	UNAME_REL=`(/bin/uname -X|egrep Release|sed -e 's/.*= //')`
-	(/bin/uname -X|egrep i80486 >/dev/null) && UNAME_MACHINE=i486
-	(/bin/uname -X|egrep '^Machine.*Pentium' >/dev/null) && UNAME_MACHINE=i586
-	(/bin/uname -X|egrep '^Machine.*Pent.*II' >/dev/null) && UNAME_MACHINE=i686
-	(/bin/uname -X|egrep '^Machine.*Pentium Pro' >/dev/null) && UNAME_MACHINE=i585
-	echo ${UNAME_MACHINE}-${UNAME_SYSTEM}${UNAME_VERSION}-sysv${UNAME_RELEASE}
+    i*86:*:5:[78]*)
+	case `/bin/uname -X | grep "^Machine"` in
+	    *486*)	     UNAME_MACHINE=i486 ;;
+	    *Pentium)	     UNAME_MACHINE=i586 ;;
+	    *Pent*|*Celeron) UNAME_MACHINE=i686 ;;
+	esac
+	echo ${UNAME_MACHINE}-unknown-sysv${UNAME_RELEASE}${UNAME_SYSTEM}${UNAME_VERSION}
 	exit 0 ;;
-    i?86:*:3.2:*)
+    i*86:*:3.2:*)
 	if test -f /usr/options/cb.name; then
 		UNAME_REL=`sed -n 's/.*Version //p' </usr/options/cb.name`
 		echo ${UNAME_MACHINE}-pc-isc$UNAME_REL
 	elif /bin/uname -X 2>/dev/null >/dev/null ; then
-		UNAME_REL=`(/bin/uname -X|egrep Release|sed -e 's/.*= //')`
-		(/bin/uname -X|egrep i80486 >/dev/null) && UNAME_MACHINE=i486
-		(/bin/uname -X|egrep '^Machine.*Pentium' >/dev/null) \
+		UNAME_REL=`(/bin/uname -X|grep Release|sed -e 's/.*= //')`
+		(/bin/uname -X|grep i80486 >/dev/null) && UNAME_MACHINE=i486
+		(/bin/uname -X|grep '^Machine.*Pentium' >/dev/null) \
 			&& UNAME_MACHINE=i586
-		(/bin/uname -X|egrep '^Machine.*Pent ?II' >/dev/null) \
+		(/bin/uname -X|grep '^Machine.*Pent *II' >/dev/null) \
 			&& UNAME_MACHINE=i686
-		(/bin/uname -X|egrep '^Machine.*Pentium Pro' >/dev/null) \
+		(/bin/uname -X|grep '^Machine.*Pentium Pro' >/dev/null) \
 			&& UNAME_MACHINE=i686
 		echo ${UNAME_MACHINE}-pc-sco$UNAME_REL
 	else
@@ -831,6 +1018,7 @@
 	fi
 	exit 0 ;;
     pc:*:*:*)
+	# Left here for compatibility:
         # uname -m prints for DJGPP always 'pc', but it prints nothing about
         # the processor, so we play safe by assuming i386.
 	echo i386-pc-msdosdjgpp
@@ -852,9 +1040,15 @@
 	# "miniframe"
 	echo m68010-convergent-sysv
 	exit 0 ;;
+    mc68k:UNIX:SYSTEM5:3.51m)
+	echo m68k-convergent-sysv
+	exit 0 ;;
+    M680?0:D-NIX:5.3:*)
+	echo m68k-diab-dnix
+	exit 0 ;;
     M68*:*:R3V[567]*:*)
 	test -r /sysV68 && echo 'm68k-motorola-sysv' && exit 0 ;;
-    3[34]??:*:4.0:3.0 | 3[34]??,*:*:4.0:3.0 | 4850:*:4.0:3.0)
+    3[34]??:*:4.0:3.0 | 3[34]??A:*:4.0:3.0 | 3[34]??,*:*:4.0:3.0 | 3[34]??/*:*:4.0:3.0 | 4400:*:4.0:3.0 | 4850:*:4.0:3.0 | SKA40:*:4.0:3.0 | SDS2:*:4.0:3.0)
 	OS_REL=''
 	test -r /etc/.relid \
 	&& OS_REL=.`sed -n 's/[^ ]* [^ ]* \([0-9][0-9]\).*/\1/p' < /etc/.relid`
@@ -865,21 +1059,21 @@
     3[34]??:*:4.0:* | 3[34]??,*:*:4.0:*)
         /bin/uname -p 2>/dev/null | grep 86 >/dev/null \
           && echo i486-ncr-sysv4 && exit 0 ;;
-    m68*:LynxOS:2.*:*)
+    m68*:LynxOS:2.*:* | m68*:LynxOS:3.0*:*)
 	echo m68k-unknown-lynxos${UNAME_RELEASE}
 	exit 0 ;;
     mc68030:UNIX_System_V:4.*:*)
 	echo m68k-atari-sysv4
 	exit 0 ;;
-    i?86:LynxOS:2.*:* | i?86:LynxOS:3.[01]*:*)
-	echo i386-unknown-lynxos${UNAME_RELEASE}
-	exit 0 ;;
     TSUNAMI:LynxOS:2.*:*)
 	echo sparc-unknown-lynxos${UNAME_RELEASE}
 	exit 0 ;;
-    rs6000:LynxOS:2.*:* | PowerPC:LynxOS:2.*:*)
+    rs6000:LynxOS:2.*:*)
 	echo rs6000-unknown-lynxos${UNAME_RELEASE}
 	exit 0 ;;
+    PowerPC:LynxOS:2.*:* | PowerPC:LynxOS:3.[01]*:* | PowerPC:LynxOS:4.0*:*)
+	echo powerpc-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
     SM[BE]S:UNIX_SV:*:*)
 	echo mips-dde-sysv${UNAME_RELEASE}
 	exit 0 ;;
@@ -897,8 +1091,8 @@
 		echo ns32k-sni-sysv
 	fi
 	exit 0 ;;
-    PENTIUM:CPunix:4.0*:*) # Unisys `ClearPath HMP IX 4000' SVR4/MP effort
-                           # says <Richard.M.Bartel@ccMail.Census.GOV>
+    PENTIUM:*:4.0*:*) # Unisys `ClearPath HMP IX 4000' SVR4/MP effort
+                      # says <Richard.M.Bartel@ccMail.Census.GOV>
         echo i586-unisys-sysv4
         exit 0 ;;
     *:UNIX_System_V:4*:FTX*)
@@ -910,10 +1104,14 @@
 	# From seanf@swdc.stratus.com.
 	echo i860-stratus-sysv4
 	exit 0 ;;
+    *:VOS:*:*)
+	# From Paul.Green@stratus.com.
+	echo hppa1.1-stratus-vos
+	exit 0 ;;
     mc68*:A/UX:*:*)
 	echo m68k-apple-aux${UNAME_RELEASE}
 	exit 0 ;;
-    news*:NEWS-OS:*:6*)
+    news*:NEWS-OS:6*:*)
 	echo mips-sony-newsos6
 	exit 0 ;;
     R[34]000:*System_V*:*:* | R4000:UNIX_SYSV:*:* | R*000:UNIX_SV:*:*)
@@ -938,17 +1136,76 @@
     SX-5:SUPER-UX:*:*)
 	echo sx5-nec-superux${UNAME_RELEASE}
 	exit 0 ;;
+    SX-6:SUPER-UX:*:*)
+	echo sx6-nec-superux${UNAME_RELEASE}
+	exit 0 ;;
     Power*:Rhapsody:*:*)
 	echo powerpc-apple-rhapsody${UNAME_RELEASE}
 	exit 0 ;;
     *:Rhapsody:*:*)
 	echo ${UNAME_MACHINE}-apple-rhapsody${UNAME_RELEASE}
 	exit 0 ;;
+    *:Darwin:*:*)
+	echo `uname -p`-apple-darwin${UNAME_RELEASE}
+	exit 0 ;;
+    *:procnto*:*:* | *:QNX:[0123456789]*:*)
+	UNAME_PROCESSOR=`uname -p`
+	if test "$UNAME_PROCESSOR" = "x86"; then
+		UNAME_PROCESSOR=i386
+		UNAME_MACHINE=pc
+	fi
+	echo ${UNAME_PROCESSOR}-${UNAME_MACHINE}-nto-qnx${UNAME_RELEASE}
+	exit 0 ;;
+    *:QNX:*:4*)
+	echo i386-pc-qnx
+	exit 0 ;;
+    NSR-[DGKLNPTVW]:NONSTOP_KERNEL:*:*)
+	echo nsr-tandem-nsk${UNAME_RELEASE}
+	exit 0 ;;
+    *:NonStop-UX:*:*)
+	echo mips-compaq-nonstopux
+	exit 0 ;;
+    BS2000:POSIX*:*:*)
+	echo bs2000-siemens-sysv
+	exit 0 ;;
+    DS/*:UNIX_System_V:*:*)
+	echo ${UNAME_MACHINE}-${UNAME_SYSTEM}-${UNAME_RELEASE}
+	exit 0 ;;
+    *:Plan9:*:*)
+	# "uname -m" is not consistent, so use $cputype instead. 386
+	# is converted to i386 for consistency with other x86
+	# operating systems.
+	if test "$cputype" = "386"; then
+	    UNAME_MACHINE=i386
+	else
+	    UNAME_MACHINE="$cputype"
+	fi
+	echo ${UNAME_MACHINE}-unknown-plan9
+	exit 0 ;;
+    *:TOPS-10:*:*)
+	echo pdp10-unknown-tops10
+	exit 0 ;;
+    *:TENEX:*:*)
+	echo pdp10-unknown-tenex
+	exit 0 ;;
+    KS10:TOPS-20:*:* | KL10:TOPS-20:*:* | TYPE4:TOPS-20:*:*)
+	echo pdp10-dec-tops20
+	exit 0 ;;
+    XKL-1:TOPS-20:*:* | TYPE5:TOPS-20:*:*)
+	echo pdp10-xkl-tops20
+	exit 0 ;;
+    *:TOPS-20:*:*)
+	echo pdp10-unknown-tops20
+	exit 0 ;;
+    *:ITS:*:*)
+	echo pdp10-unknown-its
+	exit 0 ;;
 esac
 
 #echo '(No uname command or uname output not recognized.)' 1>&2
 #echo "${UNAME_MACHINE}:${UNAME_SYSTEM}:${UNAME_RELEASE}:${UNAME_VERSION}" 1>&2
 
+eval $set_cc_for_build
 cat >$dummy.c <<EOF
 #ifdef _SEQUENT_
 # include <sys/types.h>
@@ -1035,11 +1292,24 @@
 #endif
 
 #if defined (vax)
-#if !defined (ultrix)
-  printf ("vax-dec-bsd\n"); exit (0);
-#else
-  printf ("vax-dec-ultrix\n"); exit (0);
-#endif
+# if !defined (ultrix)
+#  include <sys/param.h>
+#  if defined (BSD)
+#   if BSD == 43
+      printf ("vax-dec-bsd4.3\n"); exit (0);
+#   else
+#    if BSD == 199006
+      printf ("vax-dec-bsd4.3reno\n"); exit (0);
+#    else
+      printf ("vax-dec-bsd\n"); exit (0);
+#    endif
+#   endif
+#  else
+    printf ("vax-dec-bsd\n"); exit (0);
+#  endif
+# else
+    printf ("vax-dec-ultrix\n"); exit (0);
+# endif
 #endif
 
 #if defined (alliant) && defined (i860)
@@ -1050,8 +1320,8 @@
 }
 EOF
 
-$CC_FOR_BUILD $dummy.c -o $dummy 2>/dev/null && ./$dummy && rm $dummy.c $dummy && exit 0
-rm -f $dummy.c $dummy
+$CC_FOR_BUILD -o $dummy $dummy.c 2>/dev/null && $dummy && rm -f $dummy.c $dummy && rmdir $tmpdir && exit 0
+rm -f $dummy.c $dummy && rmdir $tmpdir
 
 # Apollos put the system type in the environment.
 
@@ -1083,6 +1353,48 @@
     esac
 fi
 
-#echo '(Unable to guess system type)' 1>&2
+cat >&2 <<EOF
+$0: unable to guess system type
+
+This script, last modified $timestamp, has failed to recognize
+the operating system you are using. It is advised that you
+download the most up to date version of the config scripts from
+
+    ftp://ftp.gnu.org/pub/gnu/config/
+
+If the version you run ($0) is already up to date, please
+send the following data and any information you think might be
+pertinent to <config-patches@gnu.org> in order to provide the needed
+information to handle your system.
+
+config.guess timestamp = $timestamp
+
+uname -m = `(uname -m) 2>/dev/null || echo unknown`
+uname -r = `(uname -r) 2>/dev/null || echo unknown`
+uname -s = `(uname -s) 2>/dev/null || echo unknown`
+uname -v = `(uname -v) 2>/dev/null || echo unknown`
+
+/usr/bin/uname -p = `(/usr/bin/uname -p) 2>/dev/null`
+/bin/uname -X     = `(/bin/uname -X) 2>/dev/null`
+
+hostinfo               = `(hostinfo) 2>/dev/null`
+/bin/universe          = `(/bin/universe) 2>/dev/null`
+/usr/bin/arch -k       = `(/usr/bin/arch -k) 2>/dev/null`
+/bin/arch              = `(/bin/arch) 2>/dev/null`
+/usr/bin/oslevel       = `(/usr/bin/oslevel) 2>/dev/null`
+/usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/dev/null`
+
+UNAME_MACHINE = ${UNAME_MACHINE}
+UNAME_RELEASE = ${UNAME_RELEASE}
+UNAME_SYSTEM  = ${UNAME_SYSTEM}
+UNAME_VERSION = ${UNAME_VERSION}
+EOF
 
 exit 1
+
+# Local variables:
+# eval: (add-hook 'write-file-hooks 'time-stamp)
+# time-stamp-start: "timestamp='"
+# time-stamp-format: "%:y-%02m-%02d"
+# time-stamp-end: "'"
+# End:
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/capi20/config.sub isdn4k-utils-v3.3/capi20/config.sub
--- isdn4k-utils-v3.2p1/capi20/config.sub	2000-06-22 16:54:34.000000000 +0000
+++ isdn4k-utils-v3.3/capi20/config.sub	2003-06-16 12:08:23.000000000 +0000
@@ -1,6 +1,10 @@
 #! /bin/sh
-# Configuration validation subroutine script, version 1.1.
-#   Copyright (C) 1991, 92-97, 1998, 1999 Free Software Foundation, Inc.
+# Configuration validation subroutine script.
+#   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
+#   2000, 2001, 2002 Free Software Foundation, Inc.
+
+timestamp='2002-11-30'
+
 # This file is (in principle) common to ALL GNU software.
 # The presence of a machine in this file suggests that SOME GNU software
 # can handle that machine.  It does not imply ALL GNU software can.
@@ -25,6 +29,9 @@
 # configuration script generated by Autoconf, you may include it under
 # the same distribution terms that you use for the rest of that program.
 
+# Please send patches to <config-patches@gnu.org>.  Submit a context
+# diff and a properly formatted ChangeLog entry.
+#
 # Configuration subroutine to validate and canonicalize a configuration type.
 # Supply the specified configuration type as an argument.
 # If it is invalid, we print an error message on stderr and exit with code 1.
@@ -45,30 +52,73 @@
 #	CPU_TYPE-MANUFACTURER-KERNEL-OPERATING_SYSTEM
 # It is wrong to echo any other type of specification.
 
-if [ x$1 = x ]
-then
-	echo Configuration name missing. 1>&2
-	echo "Usage: $0 CPU-MFR-OPSYS" 1>&2
-	echo "or     $0 ALIAS" 1>&2
-	echo where ALIAS is a recognized configuration type. 1>&2
-	exit 1
-fi
+me=`echo "$0" | sed -e 's,.*/,,'`
 
-# First pass through any local machine types.
-case $1 in
-	*local*)
-		echo $1
-		exit 0
-		;;
-	*)
-	;;
+usage="\
+Usage: $0 [OPTION] CPU-MFR-OPSYS
+       $0 [OPTION] ALIAS
+
+Canonicalize a configuration name.
+
+Operation modes:
+  -h, --help         print this help, then exit
+  -t, --time-stamp   print date of last modification, then exit
+  -v, --version      print version number, then exit
+
+Report bugs and patches to <config-patches@gnu.org>."
+
+version="\
+GNU config.sub ($timestamp)
+
+Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001
+Free Software Foundation, Inc.
+
+This is free software; see the source for copying conditions.  There is NO
+warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."
+
+help="
+Try \`$me --help' for more information."
+
+# Parse command line
+while test $# -gt 0 ; do
+  case $1 in
+    --time-stamp | --time* | -t )
+       echo "$timestamp" ; exit 0 ;;
+    --version | -v )
+       echo "$version" ; exit 0 ;;
+    --help | --h* | -h )
+       echo "$usage"; exit 0 ;;
+    -- )     # Stop option processing
+       shift; break ;;
+    - )	# Use stdin as input.
+       break ;;
+    -* )
+       echo "$me: invalid option $1$help"
+       exit 1 ;;
+
+    *local*)
+       # First pass through any local machine types.
+       echo $1
+       exit 0;;
+
+    * )
+       break ;;
+  esac
+done
+
+case $# in
+ 0) echo "$me: missing argument$help" >&2
+    exit 1;;
+ 1) ;;
+ *) echo "$me: too many arguments$help" >&2
+    exit 1;;
 esac
 
 # Separate what the user gave into CPU-COMPANY and OS or KERNEL-OS (if any).
 # Here we must recognize all the valid KERNEL-OS combinations.
 maybe_os=`echo $1 | sed 's/^\(.*\)-\([^-]*-[^-]*\)$/\2/'`
 case $maybe_os in
-  linux-gnu*)
+  nto-qnx* | linux-gnu* | freebsd*-gnu* | netbsd*-gnu* | storm-chaos* | os2-emx* | rtmk-nova*)
     os=-$maybe_os
     basic_machine=`echo $1 | sed 's/^\(.*\)-\([^-]*-[^-]*\)$/\1/'`
     ;;
@@ -94,7 +144,7 @@
 	-convergent* | -ncr* | -news | -32* | -3600* | -3100* | -hitachi* |\
 	-c[123]* | -convex* | -sun | -crds | -omron* | -dg | -ultra | -tti* | \
 	-harris | -dolphin | -highlevel | -gould | -cbm | -ns | -masscomp | \
-	-apple)
+	-apple | -axis)
 		os=
 		basic_machine=$1
 		;;
@@ -108,6 +158,14 @@
 		os=-vxworks
 		basic_machine=$1
 		;;
+	-chorusos*)
+		os=-chorusos
+		basic_machine=$1
+		;;
+ 	-chorusrdb)
+ 		os=-chorusrdb
+		basic_machine=$1
+ 		;;
 	-hiux*)
 		os=-hiuxwe2
 		;;
@@ -166,65 +224,118 @@
 case $basic_machine in
 	# Recognize the basic CPU types without company name.
 	# Some are omitted here because they have special meanings below.
-	tahoe | i860 | ia64 | m32r | m68k | m68000 | m88k | ns32k | arc | arm \
-		| arme[lb] | pyramid | mn10200 | mn10300 | tron | a29k \
-		| 580 | i960 | h8300 \
-		| hppa | hppa1.0 | hppa1.1 | hppa2.0 | hppa2.0w | hppa2.0n \
-		| alpha | alphaev[4-7] | alphaev56 | alphapca5[67] \
-		| we32k | ns16k | clipper | i370 | sh | powerpc | powerpcle \
-		| 1750a | dsp16xx | pdp11 | mips16 | mips64 | mipsel | mips64el \
-		| mips64orion | mips64orionel | mipstx39 | mipstx39el \
-		| mips64vr4300 | mips64vr4300el | mips64vr4100 | mips64vr4100el \
-		| mips64vr5000 | miprs64vr5000el | mcore \
-		| sparc | sparclet | sparclite | sparc64 | sparcv9 | v850 | c4x \
-		| thumb | d10v | fr30)
+	1750a | 580 \
+	| a29k \
+	| alpha | alphaev[4-8] | alphaev56 | alphaev6[78] | alphapca5[67] \
+	| alpha64 | alpha64ev[4-8] | alpha64ev56 | alpha64ev6[78] | alpha64pca5[67] \
+	| arc | arm | arm[bl]e | arme[lb] | armv[2345] | armv[345][lb] | avr \
+	| clipper \
+	| d10v | d30v | dlx | dsp16xx \
+	| fr30 | frv \
+	| h8300 | h8500 | hppa | hppa1.[01] | hppa2.0 | hppa2.0[nw] | hppa64 \
+	| i370 | i860 | i960 | ia64 \
+	| ip2k \
+	| m32r | m68000 | m68k | m88k | mcore \
+	| mips | mipsbe | mipseb | mipsel | mipsle \
+	| mips16 \
+	| mips64 | mips64el \
+	| mips64vr | mips64vrel \
+	| mips64orion | mips64orionel \
+	| mips64vr4100 | mips64vr4100el \
+	| mips64vr4300 | mips64vr4300el \
+	| mips64vr5000 | mips64vr5000el \
+	| mipsisa32 | mipsisa32el \
+	| mipsisa64 | mipsisa64el \
+	| mipsisa64sb1 | mipsisa64sb1el \
+	| mipsisa64sr71k | mipsisa64sr71kel \
+	| mipstx39 | mipstx39el \
+	| mn10200 | mn10300 \
+	| ns16k | ns32k \
+	| openrisc | or32 \
+	| pdp10 | pdp11 | pj | pjl \
+	| powerpc | powerpc64 | powerpc64le | powerpcle | ppcbe \
+	| pyramid \
+	| sh | sh[1234] | sh3e | sh[34]eb | shbe | shle | sh[1234]le | sh3ele \
+	| sh64 | sh64le \
+	| sparc | sparc64 | sparc86x | sparclet | sparclite | sparcv9 | sparcv9b \
+	| strongarm \
+	| tahoe | thumb | tic80 | tron \
+	| v850 | v850e \
+	| we32k \
+	| x86 | xscale | xstormy16 | xtensa \
+	| z8k)
 		basic_machine=$basic_machine-unknown
 		;;
-	m88110 | m680[12346]0 | m683?2 | m68360 | m5200 | z8k | v70 | h8500 | w65 | pj | pjl)
+	m6811 | m68hc11 | m6812 | m68hc12)
+		# Motorola 68HC11/12.
+		basic_machine=$basic_machine-unknown
+		os=-none
+		;;
+	m88110 | m680[12346]0 | m683?2 | m68360 | m5200 | v70 | w65 | z8k)
 		;;
 
 	# We use `pc' rather than `unknown'
 	# because (1) that's what they normally are, and
 	# (2) the word "unknown" tends to confuse beginning users.
-	i[34567]86)
+	i*86 | x86_64)
 	  basic_machine=$basic_machine-pc
 	  ;;
-        s390 | s390-suse)
-          basic_machine=s390-suse
-          ;;
-        s390-unknown)
-          basic_machine=s390-unknown
-          ;;
-        s390-ibm)
-          basic_machine=s390-ibm
-          ;;
-        s390-redhat)
-          basic_machine=s390-redhat
-          ;;
 	# Object if more than one company name word.
 	*-*-*)
 		echo Invalid configuration \`$1\': machine \`$basic_machine\' not recognized 1>&2
 		exit 1
 		;;
 	# Recognize the basic CPU types with company name.
-	# FIXME: clean up the formatting here.
-	vax-* | tahoe-* | i[34567]86-* | i860-* | ia64-* | m32r-* | m68k-* | m68000-* \
-	      | m88k-* | sparc-* | ns32k-* | fx80-* | arc-* | arm-* | c[123]* \
-	      | mips-* | pyramid-* | tron-* | a29k-* | romp-* | rs6000-* \
-	      | power-* | none-* | 580-* | cray2-* | h8300-* | h8500-* | i960-* \
-	      | xmp-* | ymp-* \
-	      | hppa-* | hppa1.0-* | hppa1.1-* | hppa2.0-* | hppa2.0w-* | hppa2.0n-* \
-	      | alpha-* | alphaev[4-7]-* | alphaev56-* | alphapca5[67]-* \
-	      | we32k-* | cydra-* | ns16k-* | pn-* | np1-* | xps100-* \
-	      | clipper-* | orion-* \
-	      | sparclite-* | pdp11-* | sh-* | powerpc-* | powerpcle-* \
-	      | sparc64-* | sparcv9-* | sparc86x-* | mips16-* | mips64-* | mipsel-* \
-	      | mips64el-* | mips64orion-* | mips64orionel-* \
-	      | mips64vr4100-* | mips64vr4100el-* | mips64vr4300-* | mips64vr4300el-* \
-	      | mipstx39-* | mipstx39el-* | mcore-* \
-	      | f301-* | armv*-* | t3e-* \
-	      | m88110-* | m680[01234]0-* | m683?2-* | m68360-* | z8k-* | d10v-* \
-	      | thumb-* | v850-* | d30v-* | tic30-* | c30-* | fr30-* )
+	580-* \
+	| a29k-* \
+	| alpha-* | alphaev[4-8]-* | alphaev56-* | alphaev6[78]-* \
+	| alpha64-* | alpha64ev[4-8]-* | alpha64ev56-* | alpha64ev6[78]-* \
+	| alphapca5[67]-* | alpha64pca5[67]-* | arc-* \
+	| arm-*  | armbe-* | armle-* | armeb-* | armv*-* \
+	| avr-* \
+	| bs2000-* \
+	| c[123]* | c30-* | [cjt]90-* | c4x-* | c54x-* \
+	| clipper-* | cydra-* \
+	| d10v-* | d30v-* | dlx-* \
+	| elxsi-* \
+	| f30[01]-* | f700-* | fr30-* | frv-* | fx80-* \
+	| h8300-* | h8500-* \
+	| hppa-* | hppa1.[01]-* | hppa2.0-* | hppa2.0[nw]-* | hppa64-* \
+	| i*86-* | i860-* | i960-* | ia64-* \
+	| ip2k-* \
+	| m32r-* \
+	| m68000-* | m680[012346]0-* | m68360-* | m683?2-* | m68k-* \
+	| m88110-* | m88k-* | mcore-* \
+	| mips-* | mipsbe-* | mipseb-* | mipsel-* | mipsle-* \
+	| mips16-* \
+	| mips64-* | mips64el-* \
+	| mips64vr-* | mips64vrel-* \
+	| mips64orion-* | mips64orionel-* \
+	| mips64vr4100-* | mips64vr4100el-* \
+	| mips64vr4300-* | mips64vr4300el-* \
+	| mips64vr5000-* | mips64vr5000el-* \
+	| mipsisa32-* | mipsisa32el-* \
+	| mipsisa64-* | mipsisa64el-* \
+	| mipsisa64sb1-* | mipsisa64sb1el-* \
+	| mipsisa64sr71k-* | mipsisa64sr71kel-* \
+	| mipstx39 | mipstx39el \
+	| none-* | np1-* | ns16k-* | ns32k-* \
+	| orion-* \
+	| pdp10-* | pdp11-* | pj-* | pjl-* | pn-* | power-* \
+	| powerpc-* | powerpc64-* | powerpc64le-* | powerpcle-* | ppcbe-* \
+	| pyramid-* \
+	| romp-* | rs6000-* \
+	| sh-* | sh[1234]-* | sh3e-* | sh[34]eb-* | shbe-* \
+	| shle-* | sh[1234]le-* | sh3ele-* | sh64-* | sh64le-* \
+	| sparc-* | sparc64-* | sparc86x-* | sparclet-* | sparclite-* \
+	| sparcv9-* | sparcv9b-* | strongarm-* | sv1-* | sx?-* \
+	| tahoe-* | thumb-* | tic30-* | tic4x-* | tic54x-* | tic80-* | tron-* \
+	| v850-* | v850e-* | vax-* \
+	| we32k-* \
+	| x86-* | x86_64-* | xps100-* | xscale-* | xstormy16-* \
+	| xtensa-* \
+	| ymp-* \
+	| z8k-*)
 		;;
 	# Recognize the various machine names and aliases which stand
 	# for a CPU type and a company and sometimes even an OS.
@@ -261,14 +372,14 @@
 		os=-sysv
 		;;
 	amiga | amiga-*)
-		basic_machine=m68k-cbm
+		basic_machine=m68k-unknown
 		;;
 	amigaos | amigados)
-		basic_machine=m68k-cbm
+		basic_machine=m68k-unknown
 		os=-amigaos
 		;;
 	amigaunix | amix)
-		basic_machine=m68k-cbm
+		basic_machine=m68k-unknown
 		os=-sysv4
 		;;
 	apollo68)
@@ -287,6 +398,10 @@
 		basic_machine=ns32k-sequent
 		os=-dynix
 		;;
+	c90)
+		basic_machine=c90-cray
+		os=-unicos
+		;;
 	convex-c1)
 		basic_machine=c1-convex
 		os=-bsd
@@ -307,27 +422,30 @@
 		basic_machine=c38-convex
 		os=-bsd
 		;;
-	cray | ymp)
-		basic_machine=ymp-cray
-		os=-unicos
-		;;
-	cray2)
-		basic_machine=cray2-cray
-		os=-unicos
-		;;
-	[ctj]90-cray)
-		basic_machine=c90-cray
+	cray | j90)
+		basic_machine=j90-cray
 		os=-unicos
 		;;
 	crds | unos)
 		basic_machine=m68k-crds
 		;;
+	cris | cris-* | etrax*)
+		basic_machine=cris-axis
+		;;
 	da30 | da30-*)
 		basic_machine=m68k-da30
 		;;
 	decstation | decstation-3100 | pmax | pmax-* | pmin | dec3100 | decstatn)
 		basic_machine=mips-dec
 		;;
+	decsystem10* | dec10*)
+		basic_machine=pdp10-dec
+		os=-tops10
+		;;
+	decsystem20* | dec20*)
+		basic_machine=pdp10-dec
+		os=-tops20
+		;;
 	delta | 3300 | motorola-3300 | motorola-delta \
 	      | 3300-motorola | delta-motorola)
 		basic_machine=m68k-motorola
@@ -369,6 +487,10 @@
 		basic_machine=tron-gmicro
 		os=-sysv
 		;;
+	go32)
+		basic_machine=i386-pc
+		os=-go32
+		;;
 	h3050r* | hiux*)
 		basic_machine=hppa1.1-hitachi
 		os=-hiuxwe2
@@ -444,19 +566,19 @@
 		basic_machine=i370-ibm
 		;;
 # I'm not sure what "Sysv32" means.  Should this be sysv3.2?
-	i[34567]86v32)
+	i*86v32)
 		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
 		os=-sysv32
 		;;
-	i[34567]86v4*)
+	i*86v4*)
 		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
 		os=-sysv4
 		;;
-	i[34567]86v)
+	i*86v)
 		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
 		os=-sysv
 		;;
-	i[34567]86sol2)
+	i*86sol2)
 		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
 		os=-solaris2
 		;;
@@ -468,17 +590,6 @@
 		basic_machine=i386-unknown
 		os=-vsta
 		;;
-	i386-go32 | go32)
-		basic_machine=i386-unknown
-		os=-go32
-		;;
-	i386-mingw32 | mingw32)
-		basic_machine=i386-unknown
-		os=-mingw32
-		;;
-	i386-qnx | qnx)
-		basic_machine=i386-qnx
-		;;
 	iris | iris4d)
 		basic_machine=mips-sgi
 		case $os in
@@ -504,6 +615,10 @@
 		basic_machine=ns32k-utek
 		os=-sysv
 		;;
+	mingw32)
+		basic_machine=i386-pc
+		os=-mingw32
+		;;
 	miniframe)
 		basic_machine=m68000-convergent
 		;;
@@ -511,28 +626,26 @@
 		basic_machine=m68k-atari
 		os=-mint
 		;;
-	mipsel*-linux*)
-		basic_machine=mipsel-unknown
-		test -e /etc/SuSE-release && basic_machine=mipsel-suse
-		os=-linux
-		;;
-	mips*-linux*)
-		basic_machine=mips-unknown
-		test -e /etc/SuSE-release && basic_machine=mips-suse
-		os=-linux
-		;;
 	mips3*-*)
 		basic_machine=`echo $basic_machine | sed -e 's/mips3/mips64/'`
 		;;
 	mips3*)
 		basic_machine=`echo $basic_machine | sed -e 's/mips3/mips64/'`-unknown
 		;;
+	mmix*)
+		basic_machine=mmix-knuth
+		os=-mmixware
+		;;
 	monitor)
 		basic_machine=m68k-rom68k
 		os=-coff
 		;;
+	morphos)
+		basic_machine=powerpc-unknown
+		os=-morphos
+		;;
 	msdos)
-		basic_machine=i386-unknown
+		basic_machine=i386-pc
 		os=-msdos
 		;;
 	mvs)
@@ -596,13 +709,24 @@
 		basic_machine=i960-intel
 		os=-mon960
 		;;
+	nonstopux)
+		basic_machine=mips-compaq
+		os=-nonstopux
+		;;
 	np1)
 		basic_machine=np1-gould
 		;;
+	nsr-tandem)
+		basic_machine=nsr-tandem
+		;;
 	op50n-* | op60c-*)
 		basic_machine=hppa1.1-oki
 		os=-proelf
 		;;
+	or32 | or32-*)
+		basic_machine=or32-unknown
+		os=-coff
+		;;
 	OSE68000 | ose68000)
 		basic_machine=m68000-ericsson
 		os=-ose
@@ -625,45 +749,59 @@
 	pbb)
 		basic_machine=m68k-tti
 		;;
-        pc532 | pc532-*)
+	pc532 | pc532-*)
 		basic_machine=ns32k-pc532
 		;;
-	pentium | p5 | k5 | k6 | nexen)
+	pentium | p5 | k5 | k6 | nexgen | viac3)
 		basic_machine=i586-pc
 		;;
-	pentiumpro | p6 | 6x86)
+	pentiumpro | p6 | 6x86 | athlon | athlon_*)
 		basic_machine=i686-pc
 		;;
 	pentiumii | pentium2)
-		basic_machine=i786-pc
+		basic_machine=i686-pc
 		;;
-	pentium-* | p5-* | k5-* | k6-* | nexen-*)
+	pentium-* | p5-* | k5-* | k6-* | nexgen-* | viac3-*)
 		basic_machine=i586-`echo $basic_machine | sed 's/^[^-]*-//'`
 		;;
-	pentiumpro-* | p6-* | 6x86-*)
+	pentiumpro-* | p6-* | 6x86-* | athlon-*)
 		basic_machine=i686-`echo $basic_machine | sed 's/^[^-]*-//'`
 		;;
 	pentiumii-* | pentium2-*)
-		basic_machine=i786-`echo $basic_machine | sed 's/^[^-]*-//'`
+		basic_machine=i686-`echo $basic_machine | sed 's/^[^-]*-//'`
 		;;
 	pn)
 		basic_machine=pn-gould
 		;;
-	power)	basic_machine=rs6000-ibm
+	power)	basic_machine=power-ibm
 		;;
 	ppc)	basic_machine=powerpc-unknown
-	        ;;
+		;;
 	ppc-*)	basic_machine=powerpc-`echo $basic_machine | sed 's/^[^-]*-//'`
 		;;
 	ppcle | powerpclittle | ppc-le | powerpc-little)
 		basic_machine=powerpcle-unknown
-	        ;;
+		;;
 	ppcle-* | powerpclittle-*)
 		basic_machine=powerpcle-`echo $basic_machine | sed 's/^[^-]*-//'`
 		;;
+	ppc64)	basic_machine=powerpc64-unknown
+		;;
+	ppc64-*) basic_machine=powerpc64-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	ppc64le | powerpc64little | ppc64-le | powerpc64-little)
+		basic_machine=powerpc64le-unknown
+		;;
+	ppc64le-* | powerpc64little-*)
+		basic_machine=powerpc64le-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
 	ps2)
 		basic_machine=i386-ibm
 		;;
+	pw32)
+		basic_machine=i586-unknown
+		os=-pw32
+		;;
 	rom68k)
 		basic_machine=m68k-rom68k
 		os=-coff
@@ -674,10 +812,22 @@
 	rtpc | rtpc-*)
 		basic_machine=romp-ibm
 		;;
+	s390 | s390-*)
+		basic_machine=s390-ibm
+		;;
+	s390x | s390x-*)
+		basic_machine=s390x-ibm
+		;;
 	sa29200)
 		basic_machine=a29k-amd
 		os=-udi
 		;;
+	sb1)
+		basic_machine=mipsisa64sb1-unknown
+		;;
+	sb1el)
+		basic_machine=mipsisa64sb1el-unknown
+		;;
 	sequent)
 		basic_machine=i386-sequent
 		;;
@@ -685,7 +835,7 @@
 		basic_machine=sh-hitachi
 		os=-hms
 		;;
-	sparclite-wrs)
+	sparclite-wrs | simso-wrs)
 		basic_machine=sparclite-wrs
 		os=-vxworks
 		;;
@@ -743,20 +893,44 @@
 	sun386 | sun386i | roadrunner)
 		basic_machine=i386-sun
 		;;
+	sv1)
+		basic_machine=sv1-cray
+		os=-unicos
+		;;
 	symmetry)
 		basic_machine=i386-sequent
 		os=-dynix
 		;;
+	t3d)
+		basic_machine=alpha-cray
+		os=-unicos
+		;;
 	t3e)
-		basic_machine=t3e-cray
+		basic_machine=alphaev5-cray
+		os=-unicos
+		;;
+	t90)
+		basic_machine=t90-cray
 		os=-unicos
 		;;
+        tic4x | c4x*)
+		basic_machine=tic4x-unknown
+		os=-coff
+		;;
+	tic54x | c54x*)
+		basic_machine=tic54x-unknown
+		os=-coff
+		;;
 	tx39)
 		basic_machine=mipstx39-unknown
 		;;
 	tx39el)
 		basic_machine=mipstx39el-unknown
 		;;
+	toad1)
+		basic_machine=pdp10-xkl
+		os=-tops20
+		;;
 	tower | tower-32)
 		basic_machine=m68k-ncr
 		;;
@@ -781,8 +955,8 @@
 		os=-vms
 		;;
 	vpp*|vx|vx-*)
-               basic_machine=f301-fujitsu
-               ;;
+		basic_machine=f301-fujitsu
+		;;
 	vxworks960)
 		basic_machine=i960-wrs
 		os=-vxworks
@@ -803,13 +977,13 @@
 		basic_machine=hppa1.1-winbond
 		os=-proelf
 		;;
-	xmp)
-		basic_machine=xmp-cray
-		os=-unicos
-		;;
-        xps | xps100)
+	xps | xps100)
 		basic_machine=xps100-honeywell
 		;;
+	ymp)
+		basic_machine=ymp-cray
+		os=-unicos
+		;;
 	z8k-*-coff)
 		basic_machine=z8k-unknown
 		os=-sim
@@ -830,14 +1004,6 @@
 	op60c)
 		basic_machine=hppa1.1-oki
 		;;
-	mips)
-		if [ x$os = x-linux ]; then
-			basic_machine=mips-unknown
-			test -e /etc/SuSE-release && mips-suse
-		else
-			basic_machine=mips-mips
-		fi
-		;;
 	romp)
 		basic_machine=romp-ibm
 		;;
@@ -847,16 +1013,26 @@
 	vax)
 		basic_machine=vax-dec
 		;;
+	pdp10)
+		# there are many clones, so DEC is not a safe bet
+		basic_machine=pdp10-unknown
+		;;
 	pdp11)
 		basic_machine=pdp11-dec
 		;;
 	we32k)
 		basic_machine=we32k-att
 		;;
-	sparc | sparcv9)
+	sh3 | sh4 | sh3eb | sh4eb | sh[1234]le | sh3ele)
+		basic_machine=sh-unknown
+		;;
+	sh64)
+		basic_machine=sh64-unknown
+		;;
+	sparc | sparcv9 | sparcv9b)
 		basic_machine=sparc-sun
 		;;
-        cydra)
+	cydra)
 		basic_machine=cydra-cydrome
 		;;
 	orion)
@@ -871,9 +1047,8 @@
 	pmac | pmac-mpw)
 		basic_machine=powerpc-apple
 		;;
-	c4x*)
-		basic_machine=c4x-none
-		os=-coff
+	*-unknown)
+		# Make sure to match an already-canonicalized machine name.
 		;;
 	*)
 		echo Invalid configuration \`$1\': machine \`$basic_machine\' not recognized 1>&2
@@ -914,7 +1089,7 @@
 		os=-sysv4.2uw
 		;;
 	-gnu/linux*)
-		os=`echo $os | sed -e 's|gnu/linux|linux|'`
+		os=`echo $os | sed -e 's|gnu/linux|linux-gnu|'`
 		;;
 	# First accept the basic system types.
 	# The portable systems comes first.
@@ -931,20 +1106,40 @@
 	      | -lynxos* | -bosx* | -nextstep* | -cxux* | -aout* | -elf* | -oabi* \
 	      | -ptx* | -coff* | -ecoff* | -winnt* | -domain* | -vsta* \
 	      | -udi* | -eabi* | -lites* | -ieee* | -go32* | -aux* \
+	      | -chorusos* | -chorusrdb* \
 	      | -cygwin* | -pe* | -psos* | -moss* | -proelf* | -rtems* \
-	      | -mingw32* | -linux* | -uxpv* | -beos* | -mpeix* | -udk* \
-	      | -interix* | -uwin* | -rhapsody* | -opened* | -openstep* | -oskit*)
+	      | -mingw32* | -linux-gnu* | -uxpv* | -beos* | -mpeix* | -udk* \
+	      | -interix* | -uwin* | -mks* | -rhapsody* | -darwin* | -opened* \
+	      | -openstep* | -oskit* | -conix* | -pw32* | -nonstopux* \
+	      | -storm-chaos* | -tops10* | -tenex* | -tops20* | -its* \
+	      | -os2* | -vos* | -palmos* | -uclinux* | -nucleus* \
+	      | -morphos* | -superux* | -rtmk* | -rtmk-nova* | -windiss* \
+	      | -powermax* | -dnix*)
 	# Remember, each alternative MUST END IN *, to match a version number.
 		;;
+	-qnx*)
+		case $basic_machine in
+		    x86-* | i*86-*)
+			;;
+		    *)
+			os=-nto$os
+			;;
+		esac
+		;;
+	-nto-qnx*)
+		;;
+	-nto*)
+		os=`echo $os | sed -e 's|nto|nto-qnx|'`
+		;;
 	-sim | -es1800* | -hms* | -xray | -os68k* | -none* | -v88r* \
 	      | -windows* | -osx | -abug | -netware* | -os9* | -beos* \
-	      | -macos* | -mpw* | -magic* | -mon960* | -lnews*)
+	      | -macos* | -mpw* | -magic* | -mmixware* | -mon960* | -lnews*)
 		;;
 	-mac*)
 		os=`echo $os | sed -e 's|mac|macos|'`
 		;;
 	-linux*)
-		os=`echo $os | sed -e 's|linux-gnu|linux|'`
+		os=`echo $os | sed -e 's|linux|linux-gnu|'`
 		;;
 	-sunos5*)
 		os=`echo $os | sed -e 's|sunos5|solaris2|'`
@@ -955,6 +1150,9 @@
 	-opened*)
 		os=-openedition
 		;;
+	-wince*)
+		os=-wince
+		;;
 	-osfrose*)
 		os=-osfrose
 		;;
@@ -970,14 +1168,23 @@
 	-acis*)
 		os=-aos
 		;;
+	-atheos*)
+		os=-atheos
+		;;
 	-386bsd)
 		os=-bsd
 		;;
 	-ctix* | -uts*)
 		os=-sysv
 		;;
+	-nova*)
+		os=-rtmk-nova
+		;;
 	-ns2 )
-	        os=-nextstep2
+		os=-nextstep2
+		;;
+	-nsk*)
+		os=-nsk
 		;;
 	# Preserve the version number of sinix5.
 	-sinix5.*)
@@ -992,9 +1199,6 @@
 	-oss*)
 		os=-sysv3
 		;;
-        -qnx)
-		os=-qnx4
-		;;
 	-svr4)
 		os=-sysv4
 		;;
@@ -1016,8 +1220,8 @@
 	-xenix)
 		os=-xenix
 		;;
-        -*mint | -*MiNT)
-	        os=-mint
+	-*mint | -mint[0-9]* | -*MiNT | -MiNT[0-9]*)
+		os=-mint
 		;;
 	-none)
 		;;
@@ -1050,7 +1254,11 @@
 	arm*-semi)
 		os=-aout
 		;;
-        pdp11-*)
+	# This must come before the *-dec entry.
+	pdp10-*)
+		os=-tops20
+		;;
+	pdp11-*)
 		os=-none
 		;;
 	*-dec | vax-*)
@@ -1077,6 +1285,9 @@
 	mips*-*)
 		os=-elf
 		;;
+	or32-*)
+		os=-coff
+		;;
 	*-tti)	# must be before sparc entry or we get the wrong os.
 		os=-sysv3
 		;;
@@ -1140,25 +1351,25 @@
 	*-next)
 		os=-nextstep3
 		;;
-        *-gould)
+	*-gould)
 		os=-sysv
 		;;
-        *-highlevel)
+	*-highlevel)
 		os=-bsd
 		;;
 	*-encore)
 		os=-bsd
 		;;
-        *-sgi)
+	*-sgi)
 		os=-irix
 		;;
-        *-siemens)
+	*-siemens)
 		os=-sysv4
 		;;
 	*-masscomp)
 		os=-rtu
 		;;
-	f301-fujitsu)
+	f30[01]-fujitsu | f700-fujitsu)
 		os=-uxpv
 		;;
 	*-rom68k)
@@ -1224,7 +1435,7 @@
 			-ptx*)
 				vendor=sequent
 				;;
-			-vxsim* | -vxworks*)
+			-vxsim* | -vxworks* | -windiss*)
 				vendor=wrs
 				;;
 			-aux*)
@@ -1236,12 +1447,23 @@
 			-mpw* | -macos*)
 				vendor=apple
 				;;
-			-*mint | -*MiNT)
+			-*mint | -mint[0-9]* | -*MiNT | -MiNT[0-9]*)
 				vendor=atari
 				;;
+			-vos*)
+				vendor=stratus
+				;;
 		esac
 		basic_machine=`echo $basic_machine | sed "s/unknown/$vendor/"`
 		;;
 esac
 
 echo $basic_machine$os
+exit 0
+
+# Local variables:
+# eval: (add-hook 'write-file-hooks 'time-stamp)
+# time-stamp-start: "timestamp='"
+# time-stamp-format: "%:y-%02m-%02d"
+# time-stamp-end: "'"
+# End:
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/capi20/configure isdn4k-utils-v3.3/capi20/configure
--- isdn4k-utils-v3.2p1/capi20/configure	2001-06-21 16:34:45.000000000 +0000
+++ isdn4k-utils-v3.3/capi20/configure	2003-06-16 12:08:23.000000000 +0000
@@ -20,8 +20,169 @@
   --enable-fast-install[=PKGS]  optimize for fast installation [default=yes]"
 ac_help="$ac_help
   --with-gnu-ld           assume the C compiler uses GNU ld [default=no]"
+
+# Find the correct PATH separator.  Usually this is `:', but
+# DJGPP uses `;' like DOS.
+if test "X${PATH_SEPARATOR+set}" != Xset; then
+  UNAME=${UNAME-`uname 2>/dev/null`}
+  case X$UNAME in
+    *-DOS) lt_cv_sys_path_separator=';' ;;
+    *)     lt_cv_sys_path_separator=':' ;;
+  esac
+  PATH_SEPARATOR=$lt_cv_sys_path_separator
+fi
+
+
+# Check that we are running under the correct shell.
+SHELL=${CONFIG_SHELL-/bin/sh}
+
+case X$ECHO in
+X*--fallback-echo)
+  # Remove one level of quotation (which was required for Make).
+  ECHO=`echo "$ECHO" | sed 's,\\\\\$\\$0,'$0','`
+  ;;
+esac
+
+echo=${ECHO-echo}
+if test "X$1" = X--no-reexec; then
+  # Discard the --no-reexec flag, and continue.
+  shift
+elif test "X$1" = X--fallback-echo; then
+  # Avoid inline document here, it may be left over
+  :
+elif test "X`($echo '\t') 2>/dev/null`" = 'X\t'; then
+  # Yippee, $echo works!
+  :
+else
+  # Restart under the correct shell.
+  exec $SHELL "$0" --no-reexec ${1+"$@"}
+fi
+
+if test "X$1" = X--fallback-echo; then
+  # used as fallback echo
+  shift
+  cat <<EOF
+
+EOF
+  exit 0
+fi
+
+# The HP-UX ksh and POSIX shell print the target directory to stdout
+# if CDPATH is set.
+if test "X${CDPATH+set}" = Xset; then CDPATH=:; export CDPATH; fi
+
+if test -z "$ECHO"; then
+if test "X${echo_test_string+set}" != Xset; then
+# find a string as large as possible, as long as the shell can cope with it
+  for cmd in 'sed 50q "$0"' 'sed 20q "$0"' 'sed 10q "$0"' 'sed 2q "$0"' 'echo test'; do
+    # expected sizes: less than 2Kb, 1Kb, 512 bytes, 16 bytes, ...
+    if (echo_test_string="`eval $cmd`") 2>/dev/null &&
+       echo_test_string="`eval $cmd`" &&
+       (test "X$echo_test_string" = "X$echo_test_string") 2>/dev/null
+    then
+      break
+    fi
+  done
+fi
+
+if test "X`($echo '\t') 2>/dev/null`" = 'X\t' &&
+   echo_testing_string=`($echo "$echo_test_string") 2>/dev/null` &&
+   test "X$echo_testing_string" = "X$echo_test_string"; then
+  :
+else
+  # The Solaris, AIX, and Digital Unix default echo programs unquote
+  # backslashes.  This makes it impossible to quote backslashes using
+  #   echo "$something" | sed 's/\\/\\\\/g'
+  #
+  # So, first we look for a working echo in the user's PATH.
+
+  IFS="${IFS= 	}"; save_ifs="$IFS"; IFS=$PATH_SEPARATOR
+  for dir in $PATH /usr/ucb; do
+    if (test -f $dir/echo || test -f $dir/echo$ac_exeext) &&
+       test "X`($dir/echo '\t') 2>/dev/null`" = 'X\t' &&
+       echo_testing_string=`($dir/echo "$echo_test_string") 2>/dev/null` &&
+       test "X$echo_testing_string" = "X$echo_test_string"; then
+      echo="$dir/echo"
+      break
+    fi
+  done
+  IFS="$save_ifs"
+
+  if test "X$echo" = Xecho; then
+    # We didn't find a better echo, so look for alternatives.
+    if test "X`(print -r '\t') 2>/dev/null`" = 'X\t' &&
+       echo_testing_string=`(print -r "$echo_test_string") 2>/dev/null` &&
+       test "X$echo_testing_string" = "X$echo_test_string"; then
+      # This shell has a builtin print -r that does the trick.
+      echo='print -r'
+    elif (test -f /bin/ksh || test -f /bin/ksh$ac_exeext) &&
+	 test "X$CONFIG_SHELL" != X/bin/ksh; then
+      # If we have ksh, try running configure again with it.
+      ORIGINAL_CONFIG_SHELL=${CONFIG_SHELL-/bin/sh}
+      export ORIGINAL_CONFIG_SHELL
+      CONFIG_SHELL=/bin/ksh
+      export CONFIG_SHELL
+      exec $CONFIG_SHELL "$0" --no-reexec ${1+"$@"}
+    else
+      # Try using printf.
+      echo='printf %s\n'
+      if test "X`($echo '\t') 2>/dev/null`" = 'X\t' &&
+	 echo_testing_string=`($echo "$echo_test_string") 2>/dev/null` &&
+	 test "X$echo_testing_string" = "X$echo_test_string"; then
+	# Cool, printf works
+	:
+      elif echo_testing_string=`($ORIGINAL_CONFIG_SHELL "$0" --fallback-echo '\t') 2>/dev/null` &&
+	   test "X$echo_testing_string" = 'X\t' &&
+	   echo_testing_string=`($ORIGINAL_CONFIG_SHELL "$0" --fallback-echo "$echo_test_string") 2>/dev/null` &&
+	   test "X$echo_testing_string" = "X$echo_test_string"; then
+	CONFIG_SHELL=$ORIGINAL_CONFIG_SHELL
+	export CONFIG_SHELL
+	SHELL="$CONFIG_SHELL"
+	export SHELL
+	echo="$CONFIG_SHELL $0 --fallback-echo"
+      elif echo_testing_string=`($CONFIG_SHELL "$0" --fallback-echo '\t') 2>/dev/null` &&
+	   test "X$echo_testing_string" = 'X\t' &&
+	   echo_testing_string=`($CONFIG_SHELL "$0" --fallback-echo "$echo_test_string") 2>/dev/null` &&
+	   test "X$echo_testing_string" = "X$echo_test_string"; then
+	echo="$CONFIG_SHELL $0 --fallback-echo"
+      else
+	# maybe with a smaller string...
+	prev=:
+
+	for cmd in 'echo test' 'sed 2q "$0"' 'sed 10q "$0"' 'sed 20q "$0"' 'sed 50q "$0"'; do
+	  if (test "X$echo_test_string" = "X`eval $cmd`") 2>/dev/null
+	  then
+	    break
+	  fi
+	  prev="$cmd"
+	done
+
+	if test "$prev" != 'sed 50q "$0"'; then
+	  echo_test_string=`eval $prev`
+	  export echo_test_string
+	  exec ${ORIGINAL_CONFIG_SHELL-${CONFIG_SHELL-/bin/sh}} "$0" ${1+"$@"}
+	else
+	  # Oops.  We lost completely, so just stick with echo.
+	  echo=echo
+	fi
+      fi
+    fi
+  fi
+fi
+fi
+
+# Copy echo and quote the copy suitably for passing to libtool from
+# the Makefile, instead of quoting the original, which is used later.
+ECHO=$echo
+if test "X$ECHO" = "X$CONFIG_SHELL $0 --fallback-echo"; then
+   ECHO="$CONFIG_SHELL \\\$\$0 --fallback-echo"
+fi
+
+
 ac_help="$ac_help
   --disable-libtool-lock  avoid locking (might break parallel builds)"
+ac_help="$ac_help
+  --with-pic              try to use only PIC/non-PIC objects [default=use both]"
 
 # Initialize some variables set by options.
 # The variables have the same names as the options, with
@@ -563,7 +724,7 @@
 # SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
 # ./install, which can be erroneously created by make from ./install.sh.
 echo $ac_n "checking for a BSD compatible install""... $ac_c" 1>&6
-echo "configure:567: checking for a BSD compatible install" >&5
+echo "configure:728: checking for a BSD compatible install" >&5
 if test -z "$INSTALL"; then
 if eval "test \"`echo '$''{'ac_cv_path_install'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -616,7 +777,7 @@
 test -z "$INSTALL_DATA" && INSTALL_DATA='${INSTALL} -m 644'
 
 echo $ac_n "checking whether build environment is sane""... $ac_c" 1>&6
-echo "configure:620: checking whether build environment is sane" >&5
+echo "configure:781: checking whether build environment is sane" >&5
 # Just in case
 sleep 1
 echo timestamp > conftestfile
@@ -673,7 +834,7 @@
 test "$program_transform_name" = "" && program_transform_name="s,x,x,"
 
 echo $ac_n "checking whether ${MAKE-make} sets \${MAKE}""... $ac_c" 1>&6
-echo "configure:677: checking whether ${MAKE-make} sets \${MAKE}" >&5
+echo "configure:838: checking whether ${MAKE-make} sets \${MAKE}" >&5
 set dummy ${MAKE-make}; ac_make=`echo "$2" | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_prog_make_${ac_make}_set'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -719,7 +880,7 @@
 
 missing_dir=`cd $ac_aux_dir && pwd`
 echo $ac_n "checking for working aclocal""... $ac_c" 1>&6
-echo "configure:723: checking for working aclocal" >&5
+echo "configure:884: checking for working aclocal" >&5
 # Run test in a subshell; some versions of sh will print an error if
 # an executable is not found, even if stderr is redirected.
 # Redirect stdin to placate older versions of autoconf.  Sigh.
@@ -732,7 +893,7 @@
 fi
 
 echo $ac_n "checking for working autoconf""... $ac_c" 1>&6
-echo "configure:736: checking for working autoconf" >&5
+echo "configure:897: checking for working autoconf" >&5
 # Run test in a subshell; some versions of sh will print an error if
 # an executable is not found, even if stderr is redirected.
 # Redirect stdin to placate older versions of autoconf.  Sigh.
@@ -745,7 +906,7 @@
 fi
 
 echo $ac_n "checking for working automake""... $ac_c" 1>&6
-echo "configure:749: checking for working automake" >&5
+echo "configure:910: checking for working automake" >&5
 # Run test in a subshell; some versions of sh will print an error if
 # an executable is not found, even if stderr is redirected.
 # Redirect stdin to placate older versions of autoconf.  Sigh.
@@ -758,7 +919,7 @@
 fi
 
 echo $ac_n "checking for working autoheader""... $ac_c" 1>&6
-echo "configure:762: checking for working autoheader" >&5
+echo "configure:923: checking for working autoheader" >&5
 # Run test in a subshell; some versions of sh will print an error if
 # an executable is not found, even if stderr is redirected.
 # Redirect stdin to placate older versions of autoconf.  Sigh.
@@ -771,7 +932,7 @@
 fi
 
 echo $ac_n "checking for working makeinfo""... $ac_c" 1>&6
-echo "configure:775: checking for working makeinfo" >&5
+echo "configure:936: checking for working makeinfo" >&5
 # Run test in a subshell; some versions of sh will print an error if
 # an executable is not found, even if stderr is redirected.
 # Redirect stdin to placate older versions of autoconf.  Sigh.
@@ -789,7 +950,7 @@
 # Extract the first word of "gcc", so it can be a program name with args.
 set dummy gcc; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:793: checking for $ac_word" >&5
+echo "configure:954: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -819,7 +980,7 @@
   # Extract the first word of "cc", so it can be a program name with args.
 set dummy cc; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:823: checking for $ac_word" >&5
+echo "configure:984: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -870,7 +1031,7 @@
       # Extract the first word of "cl", so it can be a program name with args.
 set dummy cl; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:874: checking for $ac_word" >&5
+echo "configure:1035: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -902,7 +1063,7 @@
 fi
 
 echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works""... $ac_c" 1>&6
-echo "configure:906: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
+echo "configure:1067: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
 
 ac_ext=c
 # CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
@@ -913,12 +1074,12 @@
 
 cat > conftest.$ac_ext << EOF
 
-#line 917 "configure"
+#line 1078 "configure"
 #include "confdefs.h"
 
 main(){return(0);}
 EOF
-if { (eval echo configure:922: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:1083: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   ac_cv_prog_cc_works=yes
   # If we can't run a trivial program, we are probably using a cross compiler.
   if (./conftest; exit) 2>/dev/null; then
@@ -944,12 +1105,12 @@
   { echo "configure: error: installation or configuration problem: C compiler cannot create executables." 1>&2; exit 1; }
 fi
 echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler""... $ac_c" 1>&6
-echo "configure:948: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
+echo "configure:1109: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
 echo "$ac_t""$ac_cv_prog_cc_cross" 1>&6
 cross_compiling=$ac_cv_prog_cc_cross
 
 echo $ac_n "checking whether we are using GNU C""... $ac_c" 1>&6
-echo "configure:953: checking whether we are using GNU C" >&5
+echo "configure:1114: checking whether we are using GNU C" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_gcc'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -958,7 +1119,7 @@
   yes;
 #endif
 EOF
-if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:962: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
+if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:1123: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
   ac_cv_prog_gcc=yes
 else
   ac_cv_prog_gcc=no
@@ -977,7 +1138,7 @@
 ac_save_CFLAGS="$CFLAGS"
 CFLAGS=
 echo $ac_n "checking whether ${CC-cc} accepts -g""... $ac_c" 1>&6
-echo "configure:981: checking whether ${CC-cc} accepts -g" >&5
+echo "configure:1142: checking whether ${CC-cc} accepts -g" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_cc_g'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1020,7 +1181,7 @@
 # SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
 # ./install, which can be erroneously created by make from ./install.sh.
 echo $ac_n "checking for a BSD compatible install""... $ac_c" 1>&6
-echo "configure:1024: checking for a BSD compatible install" >&5
+echo "configure:1185: checking for a BSD compatible install" >&5
 if test -z "$INSTALL"; then
 if eval "test \"`echo '$''{'ac_cv_path_install'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -1072,11 +1233,164 @@
 
 test -z "$INSTALL_DATA" && INSTALL_DATA='${INSTALL} -m 644'
 
+# Find the correct PATH separator.  Usually this is `:', but
+# DJGPP uses `;' like DOS.
+if test "X${PATH_SEPARATOR+set}" != Xset; then
+  UNAME=${UNAME-`uname 2>/dev/null`}
+  case X$UNAME in
+    *-DOS) lt_cv_sys_path_separator=';' ;;
+    *)     lt_cv_sys_path_separator=':' ;;
+  esac
+  PATH_SEPARATOR=$lt_cv_sys_path_separator
+fi
+
+echo $ac_n "checking for Cygwin environment""... $ac_c" 1>&6
+echo "configure:1249: checking for Cygwin environment" >&5
+if eval "test \"`echo '$''{'ac_cv_cygwin'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 1254 "configure"
+#include "confdefs.h"
+
+int main() {
+
+#ifndef __CYGWIN__
+#define __CYGWIN__ __CYGWIN32__
+#endif
+return __CYGWIN__;
+; return 0; }
+EOF
+if { (eval echo configure:1265: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  ac_cv_cygwin=yes
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  ac_cv_cygwin=no
+fi
+rm -f conftest*
+rm -f conftest*
+fi
+
+echo "$ac_t""$ac_cv_cygwin" 1>&6
+CYGWIN=
+test "$ac_cv_cygwin" = yes && CYGWIN=yes
+echo $ac_n "checking for mingw32 environment""... $ac_c" 1>&6
+echo "configure:1282: checking for mingw32 environment" >&5
+if eval "test \"`echo '$''{'ac_cv_mingw32'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 1287 "configure"
+#include "confdefs.h"
+
+int main() {
+return __MINGW32__;
+; return 0; }
+EOF
+if { (eval echo configure:1294: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  ac_cv_mingw32=yes
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  ac_cv_mingw32=no
+fi
+rm -f conftest*
+rm -f conftest*
+fi
+
+echo "$ac_t""$ac_cv_mingw32" 1>&6
+MINGW32=
+test "$ac_cv_mingw32" = yes && MINGW32=yes
+echo $ac_n "checking how to run the C preprocessor""... $ac_c" 1>&6
+echo "configure:1311: checking how to run the C preprocessor" >&5
+# On Suns, sometimes $CPP names a directory.
+if test -n "$CPP" && test -d "$CPP"; then
+  CPP=
+fi
+if test -z "$CPP"; then
+if eval "test \"`echo '$''{'ac_cv_prog_CPP'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+    # This must be in double quotes, not single quotes, because CPP may get
+  # substituted into the Makefile and "${CC-cc}" will confuse make.
+  CPP="${CC-cc} -E"
+  # On the NeXT, cc -E runs the code through the compiler's parser,
+  # not just through cpp.
+  cat > conftest.$ac_ext <<EOF
+#line 1326 "configure"
+#include "confdefs.h"
+#include <assert.h>
+Syntax Error
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:1332: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  :
+else
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  CPP="${CC-cc} -E -traditional-cpp"
+  cat > conftest.$ac_ext <<EOF
+#line 1343 "configure"
+#include "confdefs.h"
+#include <assert.h>
+Syntax Error
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:1349: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  :
+else
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  CPP="${CC-cc} -nologo -E"
+  cat > conftest.$ac_ext <<EOF
+#line 1360 "configure"
+#include "confdefs.h"
+#include <assert.h>
+Syntax Error
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:1366: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  :
+else
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  CPP=/lib/cpp
+fi
+rm -f conftest*
+fi
+rm -f conftest*
+fi
+rm -f conftest*
+  ac_cv_prog_CPP="$CPP"
+fi
+  CPP="$ac_cv_prog_CPP"
+else
+  ac_cv_prog_CPP="$CPP"
+fi
+echo "$ac_t""$CPP" 1>&6
+
 # Check whether --enable-shared or --disable-shared was given.
 if test "${enable_shared+set}" = set; then
   enableval="$enable_shared"
   p=${PACKAGE-default}
-case "$enableval" in
+case $enableval in
 yes) enable_shared=yes ;;
 no) enable_shared=no ;;
 *)
@@ -1099,7 +1413,7 @@
 if test "${enable_static+set}" = set; then
   enableval="$enable_static"
   p=${PACKAGE-default}
-case "$enableval" in
+case $enableval in
 yes) enable_static=yes ;;
 no) enable_static=no ;;
 *)
@@ -1122,7 +1436,7 @@
 if test "${enable_fast_install+set}" = set; then
   enableval="$enable_fast_install"
   p=${PACKAGE-default}
-case "$enableval" in
+case $enableval in
 yes) enable_fast_install=yes ;;
 no) enable_fast_install=no ;;
 *)
@@ -1148,7 +1462,7 @@
 fi
 
 echo $ac_n "checking host system type""... $ac_c" 1>&6
-echo "configure:1152: checking host system type" >&5
+echo "configure:1466: checking host system type" >&5
 
 host_alias=$host
 case "$host_alias" in
@@ -1169,7 +1483,7 @@
 echo "$ac_t""$host" 1>&6
 
 echo $ac_n "checking build system type""... $ac_c" 1>&6
-echo "configure:1173: checking build system type" >&5
+echo "configure:1487: checking build system type" >&5
 
 build_alias=$build
 case "$build_alias" in
@@ -1186,36 +1500,6 @@
 build_os=`echo $build | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\3/'`
 echo "$ac_t""$build" 1>&6
 
-# Extract the first word of "ranlib", so it can be a program name with args.
-set dummy ranlib; ac_word=$2
-echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1193: checking for $ac_word" >&5
-if eval "test \"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\" = set"; then
-  echo $ac_n "(cached) $ac_c" 1>&6
-else
-  if test -n "$RANLIB"; then
-  ac_cv_prog_RANLIB="$RANLIB" # Let the user override the test.
-else
-  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
-  ac_dummy="$PATH"
-  for ac_dir in $ac_dummy; do
-    test -z "$ac_dir" && ac_dir=.
-    if test -f $ac_dir/$ac_word; then
-      ac_cv_prog_RANLIB="ranlib"
-      break
-    fi
-  done
-  IFS="$ac_save_ifs"
-  test -z "$ac_cv_prog_RANLIB" && ac_cv_prog_RANLIB=":"
-fi
-fi
-RANLIB="$ac_cv_prog_RANLIB"
-if test -n "$RANLIB"; then
-  echo "$ac_t""$RANLIB" 1>&6
-else
-  echo "$ac_t""no" 1>&6
-fi
-
 # Check whether --with-gnu-ld or --without-gnu-ld was given.
 if test "${with_gnu_ld+set}" = set; then
   withval="$with_gnu_ld"
@@ -1225,12 +1509,18 @@
 fi
 
 ac_prog=ld
-if test "$ac_cv_prog_gcc" = yes; then
+if test "$GCC" = yes; then
   # Check if gcc -print-prog-name=ld gives a path.
   echo $ac_n "checking for ld used by GCC""... $ac_c" 1>&6
-echo "configure:1232: checking for ld used by GCC" >&5
-  ac_prog=`($CC -print-prog-name=ld) 2>&5`
-  case "$ac_prog" in
+echo "configure:1516: checking for ld used by GCC" >&5
+  case $host in
+  *-*-mingw*)
+    # gcc leaves a trailing carriage return which upsets mingw
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+  *)
+    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+  esac
+  case $ac_prog in
     # Accept absolute paths.
     [\\/]* | [A-Za-z]:[\\/]*)
       re_direlt='/[^/][^/]*/\.\./'
@@ -1252,24 +1542,24 @@
   esac
 elif test "$with_gnu_ld" = yes; then
   echo $ac_n "checking for GNU ld""... $ac_c" 1>&6
-echo "configure:1256: checking for GNU ld" >&5
+echo "configure:1546: checking for GNU ld" >&5
 else
   echo $ac_n "checking for non-GNU ld""... $ac_c" 1>&6
-echo "configure:1259: checking for non-GNU ld" >&5
+echo "configure:1549: checking for non-GNU ld" >&5
 fi
-if eval "test \"`echo '$''{'ac_cv_path_LD'+set}'`\" = set"; then
+if eval "test \"`echo '$''{'lt_cv_path_LD'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   if test -z "$LD"; then
-  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}${PATH_SEPARATOR-:}"
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=$PATH_SEPARATOR
   for ac_dir in $PATH; do
     test -z "$ac_dir" && ac_dir=.
     if test -f "$ac_dir/$ac_prog" || test -f "$ac_dir/$ac_prog$ac_exeext"; then
-      ac_cv_path_LD="$ac_dir/$ac_prog"
+      lt_cv_path_LD="$ac_dir/$ac_prog"
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some GNU ld's only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      if "$ac_cv_path_LD" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then
+      if "$lt_cv_path_LD" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then
 	test "$with_gnu_ld" != no && break
       else
 	test "$with_gnu_ld" != yes && break
@@ -1278,11 +1568,11 @@
   done
   IFS="$ac_save_ifs"
 else
-  ac_cv_path_LD="$LD" # Let the user override the test with a path.
+  lt_cv_path_LD="$LD" # Let the user override the test with a path.
 fi
 fi
 
-LD="$ac_cv_path_LD"
+LD="$lt_cv_path_LD"
 if test -n "$LD"; then
   echo "$ac_t""$LD" 1>&6
 else
@@ -1290,59 +1580,158 @@
 fi
 test -z "$LD" && { echo "configure: error: no acceptable ld found in \$PATH" 1>&2; exit 1; }
 echo $ac_n "checking if the linker ($LD) is GNU ld""... $ac_c" 1>&6
-echo "configure:1294: checking if the linker ($LD) is GNU ld" >&5
-if eval "test \"`echo '$''{'ac_cv_prog_gnu_ld'+set}'`\" = set"; then
+echo "configure:1584: checking if the linker ($LD) is GNU ld" >&5
+if eval "test \"`echo '$''{'lt_cv_prog_gnu_ld'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   # I'd rather use --version here, but apparently some GNU ld's only accept -v.
 if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then
-  ac_cv_prog_gnu_ld=yes
+  lt_cv_prog_gnu_ld=yes
 else
-  ac_cv_prog_gnu_ld=no
+  lt_cv_prog_gnu_ld=no
 fi
 fi
 
-echo "$ac_t""$ac_cv_prog_gnu_ld" 1>&6
+echo "$ac_t""$lt_cv_prog_gnu_ld" 1>&6
+with_gnu_ld=$lt_cv_prog_gnu_ld
+
 
+echo $ac_n "checking for $LD option to reload object files""... $ac_c" 1>&6
+echo "configure:1601: checking for $LD option to reload object files" >&5
+if eval "test \"`echo '$''{'lt_cv_ld_reload_flag'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  lt_cv_ld_reload_flag='-r'
+fi
+
+echo "$ac_t""$lt_cv_ld_reload_flag" 1>&6
+reload_flag=$lt_cv_ld_reload_flag
+test -n "$reload_flag" && reload_flag=" $reload_flag"
 
 echo $ac_n "checking for BSD-compatible nm""... $ac_c" 1>&6
-echo "configure:1310: checking for BSD-compatible nm" >&5
-if eval "test \"`echo '$''{'ac_cv_path_NM'+set}'`\" = set"; then
+echo "configure:1613: checking for BSD-compatible nm" >&5
+if eval "test \"`echo '$''{'lt_cv_path_NM'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   if test -n "$NM"; then
   # Let the user override the test.
-  ac_cv_path_NM="$NM"
+  lt_cv_path_NM="$NM"
 else
-  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}${PATH_SEPARATOR-:}"
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=$PATH_SEPARATOR
   for ac_dir in $PATH /usr/ccs/bin /usr/ucb /bin; do
     test -z "$ac_dir" && ac_dir=.
-    if test -f $ac_dir/nm || test -f $ac_dir/nm$ac_exeext ; then
+    tmp_nm=$ac_dir/${ac_tool_prefix}nm
+    if test -f $tmp_nm || test -f $tmp_nm$ac_exeext ; then
       # Check to see if the nm accepts a BSD-compat flag.
       # Adding the `sed 1q' prevents false positives on HP-UX, which says:
       #   nm: unknown option "B" ignored
-      if ($ac_dir/nm -B /dev/null 2>&1 | sed '1q'; exit 0) | egrep /dev/null >/dev/null; then
-	ac_cv_path_NM="$ac_dir/nm -B"
+      # Tru64's nm complains that /dev/null is an invalid object file
+      if ($tmp_nm -B /dev/null 2>&1 | sed '1q'; exit 0) | egrep '(/dev/null|Invalid file or object type)' >/dev/null; then
+	lt_cv_path_NM="$tmp_nm -B"
 	break
-      elif ($ac_dir/nm -p /dev/null 2>&1 | sed '1q'; exit 0) | egrep /dev/null >/dev/null; then
-	ac_cv_path_NM="$ac_dir/nm -p"
+      elif ($tmp_nm -p /dev/null 2>&1 | sed '1q'; exit 0) | egrep /dev/null >/dev/null; then
+	lt_cv_path_NM="$tmp_nm -p"
 	break
       else
-	ac_cv_path_NM=${ac_cv_path_NM="$ac_dir/nm"} # keep the first match, but
+	lt_cv_path_NM=${lt_cv_path_NM="$tmp_nm"} # keep the first match, but
 	continue # so that we can try to find one that supports BSD flags
       fi
     fi
   done
   IFS="$ac_save_ifs"
-  test -z "$ac_cv_path_NM" && ac_cv_path_NM=nm
+  test -z "$lt_cv_path_NM" && lt_cv_path_NM=nm
 fi
 fi
 
-NM="$ac_cv_path_NM"
+NM="$lt_cv_path_NM"
 echo "$ac_t""$NM" 1>&6
 
+echo $ac_n "checking for a sed that does not truncate output""... $ac_c" 1>&6
+echo "configure:1651: checking for a sed that does not truncate output" >&5
+if eval "test \"`echo '$''{'lt_cv_path_SED'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  # Loop through the user's path and test for sed and gsed.
+# Then use that list of sed's as ones to test for truncation.
+as_executable_p="test -f"
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  for ac_prog in sed gsed; do
+    for ac_exec_ext in '' $ac_executable_extensions; do
+      if $as_executable_p "$as_dir/$ac_prog$ac_exec_ext"; then
+        _sed_list="$_sed_list $as_dir/$ac_prog$ac_exec_ext"
+      fi
+    done
+  done
+done
+
+  # Create a temporary directory, and hook for its removal unless debugging.
+$debug ||
+{
+  trap 'exit_status=$?; rm -rf $tmp && exit $exit_status' 0
+  trap '{ (exit 1); exit 1; }' 1 2 13 15
+}
+
+# Create a (secure) tmp directory for tmp files.
+: ${TMPDIR=/tmp}
+{
+  tmp=`(umask 077 && mktemp -d -q "$TMPDIR/sedXXXXXX") 2>/dev/null` &&
+  test -n "$tmp" && test -d "$tmp"
+}  ||
+{
+  tmp=$TMPDIR/sed$$-$RANDOM
+  (umask 077 && mkdir $tmp)
+} ||
+{
+   echo "$me: cannot create a temporary directory in $TMPDIR" >&2
+   { (exit 1); exit 1; }
+}
+  _max=0
+  _count=0
+  # Add /usr/xpg4/bin/sed as it is typically found on Solaris
+  # along with /bin/sed that truncates output.
+  for _sed in $_sed_list /usr/xpg4/bin/sed; do
+    test ! -f ${_sed} && break
+    cat /dev/null > "$tmp/sed.in"
+    _count=0
+    echo ${ECHO_N-$ac_n} "0123456789${ECHO_C-$ac_c}" >"$tmp/sed.in"
+    # Check for GNU sed and select it if it is found.
+    if "${_sed}" --version 2>&1 < /dev/null | egrep '(GNU)' > /dev/null; then
+      lt_cv_path_SED=${_sed}
+      break
+    fi
+    while true; do
+      cat "$tmp/sed.in" "$tmp/sed.in" >"$tmp/sed.tmp"
+      mv "$tmp/sed.tmp" "$tmp/sed.in"
+      cp "$tmp/sed.in" "$tmp/sed.nl"
+      echo >>"$tmp/sed.nl"
+      ${_sed} -e 's/a$//' < "$tmp/sed.nl" >"$tmp/sed.out" || break
+      cmp -s "$tmp/sed.out" "$tmp/sed.nl" || break
+      # 40000 chars as input seems more than enough
+      test $_count -gt 10 && break
+      _count=`expr $_count + 1`
+      if test $_count -gt $_max; then
+        _max=$_count
+        lt_cv_path_SED=$_sed
+      fi
+    done
+  done
+  rm -rf "$tmp"
+
+fi
+
+if test "X$SED" != "X"; then
+  lt_cv_path_SED=$SED
+else
+  SED=$lt_cv_path_SED
+fi
+echo "$ac_t""$SED" 1>&6
+
 echo $ac_n "checking whether ln -s works""... $ac_c" 1>&6
-echo "configure:1346: checking whether ln -s works" >&5
+echo "configure:1735: checking whether ln -s works" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_LN_S'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1362,20 +1751,759 @@
   echo "$ac_t""no" 1>&6
 fi
 
+echo $ac_n "checking how to recognise dependent libraries""... $ac_c" 1>&6
+echo "configure:1756: checking how to recognise dependent libraries" >&5
+if eval "test \"`echo '$''{'lt_cv_deplibs_check_method'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  lt_cv_file_magic_cmd='$MAGIC_CMD'
+lt_cv_file_magic_test_file=
+lt_cv_deplibs_check_method='unknown'
+# Need to set the preceding variable on all platforms that support
+# interlibrary dependencies.
+# 'none' -- dependencies not supported.
+# `unknown' -- same as none, but documents that we really don't know.
+# 'pass_all' -- all dependencies passed with no checks.
+# 'test_compile' -- check by making test program.
+# 'file_magic [[regex]]' -- check by looking for files in library path
+# which responds to the $file_magic_cmd with a given egrep regex.
+# If you have `file' or equivalent on your system and you're not sure
+# whether `pass_all' will *always* work, you probably want this one.
 
-case "$target" in
-NONE) lt_target="$host" ;;
-*) lt_target="$target" ;;
+case $host_os in
+aix4* | aix5*)
+  lt_cv_deplibs_check_method=pass_all
+  ;;
+
+beos*)
+  lt_cv_deplibs_check_method=pass_all
+  ;;
+
+bsdi4*)
+  lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [ML]SB (shared object|dynamic lib)'
+  lt_cv_file_magic_cmd='/usr/bin/file -L'
+  lt_cv_file_magic_test_file=/shlib/libc.so
+  ;;
+
+cygwin* | mingw* | pw32*)
+  lt_cv_deplibs_check_method='file_magic file format pei*-i386(.*architecture: i386)?'
+  lt_cv_file_magic_cmd='$OBJDUMP -f'
+  ;;
+
+darwin* | rhapsody*)
+  lt_cv_deplibs_check_method='file_magic Mach-O dynamically linked shared library'
+  lt_cv_file_magic_cmd='/usr/bin/file -L'
+  case "$host_os" in
+  rhapsody* | darwin1.[012])
+    lt_cv_file_magic_test_file=`echo /System/Library/Frameworks/System.framework/Versions/*/System | head -1`
+    ;;
+  *) # Darwin 1.3 on
+    lt_cv_file_magic_test_file='/usr/lib/libSystem.dylib'
+    ;;
+  esac
+  ;;
+
+freebsd*)
+  if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then
+    case $host_cpu in
+    i*86 )
+      # Not sure whether the presence of OpenBSD here was a mistake.
+      # Let's accept both of them until this is cleared up.
+      lt_cv_deplibs_check_method='file_magic (FreeBSD|OpenBSD)/i[3-9]86 (compact )?demand paged shared library'
+      lt_cv_file_magic_cmd=/usr/bin/file
+      lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`
+      ;;
+    esac
+  else
+    lt_cv_deplibs_check_method=pass_all
+  fi
+  ;;
+
+gnu*)
+  lt_cv_deplibs_check_method=pass_all
+  ;;
+
+hpux10.20*|hpux11*)
+  lt_cv_deplibs_check_method='file_magic (s[0-9][0-9][0-9]|PA-RISC[0-9].[0-9]) shared library'
+  lt_cv_file_magic_cmd=/usr/bin/file
+  lt_cv_file_magic_test_file=/usr/lib/libc.sl
+  ;;
+
+irix5* | irix6* | nonstopux*)
+  case $host_os in
+  irix5* | nonstopux*)
+    # this will be overridden with pass_all, but let us keep it just in case
+    lt_cv_deplibs_check_method="file_magic ELF 32-bit MSB dynamic lib MIPS - version 1"
+    ;;
+  *)
+    case $LD in
+    *-32|*"-32 ") libmagic=32-bit;;
+    *-n32|*"-n32 ") libmagic=N32;;
+    *-64|*"-64 ") libmagic=64-bit;;
+    *) libmagic=never-match;;
+    esac
+    # this will be overridden with pass_all, but let us keep it just in case
+    lt_cv_deplibs_check_method="file_magic ELF ${libmagic} MSB mips-[1234] dynamic lib MIPS - version 1"
+    ;;
+  esac
+  lt_cv_file_magic_test_file=`echo /lib${libsuff}/libc.so*`
+  lt_cv_deplibs_check_method=pass_all
+  ;;
+
+# This must be Linux ELF.
+linux-gnu*)
+  case $host_cpu in
+  alpha* | hppa* | i*86 | mips | mipsel | powerpc* | sparc* | ia64*)
+    lt_cv_deplibs_check_method=pass_all ;;
+  *)
+    # glibc up to 2.1.1 does not perform some relocations on ARM
+    lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [LM]SB (shared object|dynamic lib )' ;;
+  esac
+  lt_cv_file_magic_test_file=`echo /lib/libc.so* /lib/libc-*.so`
+  ;;
+
+netbsd*)
+  if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then
+    lt_cv_deplibs_check_method='match_pattern /lib[^/\.]+\.so\.[0-9]+\.[0-9]+$'
+  else
+    lt_cv_deplibs_check_method='match_pattern /lib[^/\.]+\.so$'
+  fi
+  ;;
+
+newos6*)
+  lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [ML]SB (executable|dynamic lib)'
+  lt_cv_file_magic_cmd=/usr/bin/file
+  lt_cv_file_magic_test_file=/usr/lib/libnls.so
+  ;;
+
+openbsd*)
+  lt_cv_file_magic_cmd=/usr/bin/file
+  lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`
+  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+    lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [LM]SB shared object'
+  else
+    lt_cv_deplibs_check_method='file_magic OpenBSD.* shared library'
+  fi
+  ;;
+
+osf3* | osf4* | osf5*)
+  # this will be overridden with pass_all, but let us keep it just in case
+  lt_cv_deplibs_check_method='file_magic COFF format alpha shared library'
+  lt_cv_file_magic_test_file=/shlib/libc.so
+  lt_cv_deplibs_check_method=pass_all
+  ;;
+
+sco3.2v5*)
+  lt_cv_deplibs_check_method=pass_all
+  ;;
+
+solaris*)
+  lt_cv_deplibs_check_method=pass_all
+  lt_cv_file_magic_test_file=/lib/libc.so
+  ;;
+
+sysv5uw[78]* | sysv4*uw2*)
+  lt_cv_deplibs_check_method=pass_all
+  ;;
+
+sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)
+  case $host_vendor in
+  motorola)
+    lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [ML]SB (shared object|dynamic lib) M[0-9][0-9]* Version [0-9]'
+    lt_cv_file_magic_test_file=`echo /usr/lib/libc.so*`
+    ;;
+  ncr)
+    lt_cv_deplibs_check_method=pass_all
+    ;;
+  sequent)
+    lt_cv_file_magic_cmd='/bin/file'
+    lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [LM]SB (shared object|dynamic lib )'
+    ;;
+  sni)
+    lt_cv_file_magic_cmd='/bin/file'
+    lt_cv_deplibs_check_method="file_magic ELF [0-9][0-9]*-bit [LM]SB dynamic lib"
+    lt_cv_file_magic_test_file=/lib/libc.so
+    ;;
+  siemens)
+    lt_cv_deplibs_check_method=pass_all
+    ;;
+  esac
+  ;;
 esac
 
-# Check for any special flags to pass to ltconfig.
-libtool_flags="--cache-file=$cache_file"
-test "$enable_shared" = no && libtool_flags="$libtool_flags --disable-shared"
-test "$enable_static" = no && libtool_flags="$libtool_flags --disable-static"
-test "$enable_fast_install" = no && libtool_flags="$libtool_flags --disable-fast-install"
-test "$ac_cv_prog_gcc" = yes && libtool_flags="$libtool_flags --with-gcc"
-test "$ac_cv_prog_gnu_ld" = yes && libtool_flags="$libtool_flags --with-gnu-ld"
+fi
+
+echo "$ac_t""$lt_cv_deplibs_check_method" 1>&6
+file_magic_cmd=$lt_cv_file_magic_cmd
+deplibs_check_method=$lt_cv_deplibs_check_method
+
+echo $ac_n "checking for object suffix""... $ac_c" 1>&6
+echo "configure:1942: checking for object suffix" >&5
+if eval "test \"`echo '$''{'ac_cv_objext'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  rm -f conftest*
+echo 'int i = 1;' > conftest.$ac_ext
+if { (eval echo configure:1948: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  for ac_file in conftest.*; do
+    case $ac_file in
+    *.c) ;;
+    *) ac_cv_objext=`echo $ac_file | sed -e s/conftest.//` ;;
+    esac
+  done
+else
+  { echo "configure: error: installation or configuration problem; compiler does not work" 1>&2; exit 1; }
+fi
+rm -f conftest*
+fi
+
+echo "$ac_t""$ac_cv_objext" 1>&6
+OBJEXT=$ac_cv_objext
+ac_objext=$ac_cv_objext
+
+
+
+echo $ac_n "checking for executable suffix""... $ac_c" 1>&6
+echo "configure:1968: checking for executable suffix" >&5
+if eval "test \"`echo '$''{'ac_cv_exeext'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  if test "$CYGWIN" = yes || test "$MINGW32" = yes; then
+  ac_cv_exeext=.exe
+else
+  rm -f conftest*
+  echo 'int main () { return 0; }' > conftest.$ac_ext
+  ac_cv_exeext=
+  if { (eval echo configure:1978: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; }; then
+    for file in conftest.*; do
+      case $file in
+      *.$ac_ext | *.c | *.o | *.obj) ;;
+      *) ac_cv_exeext=`echo $file | sed -e s/conftest//` ;;
+      esac
+    done
+  else
+    { echo "configure: error: installation or configuration problem: compiler cannot create executables." 1>&2; exit 1; }
+  fi
+  rm -f conftest*
+  test x"${ac_cv_exeext}" = x && ac_cv_exeext=no
+fi
+fi
+
+EXEEXT=""
+test x"${ac_cv_exeext}" != xno && EXEEXT=${ac_cv_exeext}
+echo "$ac_t""${ac_cv_exeext}" 1>&6
+ac_exeext=$EXEEXT
+
+if test $host != $build; then
+  ac_tool_prefix=${host_alias}-
+else
+  ac_tool_prefix=
+fi
+
+
+
+
+# Check for command to grab the raw symbol name followed by C symbol from nm.
+echo $ac_n "checking command to parse $NM output""... $ac_c" 1>&6
+echo "configure:2009: checking command to parse $NM output" >&5
+if eval "test \"`echo '$''{'lt_cv_sys_global_symbol_pipe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  
+# These are sane defaults that work on at least a few old systems.
+# [They come from Ultrix.  What could be older than Ultrix?!! ;)]
+
+# Character class describing NM global symbol codes.
+symcode='[BCDEGRST]'
+
+# Regexp to match symbols that can be accessed directly from C.
+sympat='\([_A-Za-z][_A-Za-z0-9]*\)'
+
+# Transform the above into a raw symbol and a C symbol.
+symxfrm='\1 \2\3 \3'
+
+# Transform an extracted symbol line into a proper C declaration
+lt_cv_global_symbol_to_cdecl="sed -n -e 's/^. .* \(.*\)$/extern char \1;/p'"
+
+# Transform an extracted symbol line into symbol name and symbol address
+lt_cv_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (lt_ptr) 0},/p' -e 's/^$symcode \([^ ]*\) \([^ ]*\)$/  {\"\2\", (lt_ptr) \&\2},/p'"
+
+# Define system-specific variables.
+case $host_os in
+aix*)
+  symcode='[BCDT]'
+  ;;
+cygwin* | mingw* | pw32*)
+  symcode='[ABCDGISTW]'
+  ;;
+hpux*) # Its linker distinguishes data from code symbols
+  lt_cv_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern char \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+  lt_cv_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (lt_ptr) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (lt_ptr) \&\2},/p'"
+  ;;
+irix* | nonstopux*)
+  symcode='[BCDEGRST]'
+  ;;
+osf*)
+  symcode='[BCDEGQRST]'
+  ;;
+solaris* | sysv5*)
+  symcode='[BDT]'
+  ;;
+sysv4)
+  symcode='[DFNSTU]'
+  ;;
+esac
+
+# Handle CRLF in mingw tool chain
+opt_cr=
+case $host_os in
+mingw*)
+  opt_cr=`echo 'x\{0,1\}' | tr x '\015'` # option cr in regexp
+  ;;
+esac
+
+# If we're using GNU nm, then use its standard symbol codes.
+if $NM -V 2>&1 | egrep '(GNU|with BFD)' > /dev/null; then
+  symcode='[ABCDGISTW]'
+fi
+
+# Try without a prefix undercore, then with it.
+for ac_symprfx in "" "_"; do
+
+  # Write the raw and C identifiers.
+lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[ 	]\($symcode$symcode*\)[ 	][ 	]*\($ac_symprfx\)$sympat$opt_cr$/$symxfrm/p'"
+
+  # Check to see that the pipe works correctly.
+  pipe_works=no
+  rm -f conftest*
+  cat > conftest.$ac_ext <<EOF
+#ifdef __cplusplus
+extern "C" {
+#endif
+char nm_test_var;
+void nm_test_func(){}
+#ifdef __cplusplus
+}
+#endif
+int main(){nm_test_var='a';nm_test_func();return(0);}
+EOF
+
+  if { (eval echo configure:2092: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+    # Now try to grab the symbols.
+    nlist=conftest.nm
+    if { (eval echo configure:2095: \"$NM conftest.$ac_objext \| $lt_cv_sys_global_symbol_pipe \> $nlist\") 1>&5; (eval $NM conftest.$ac_objext \| $lt_cv_sys_global_symbol_pipe \> $nlist) 2>&5; } && test -s "$nlist"; then
+      # Try sorting and uniquifying the output.
+      if sort "$nlist" | uniq > "$nlist"T; then
+	mv -f "$nlist"T "$nlist"
+      else
+	rm -f "$nlist"T
+      fi
+
+      # Make sure that we snagged all the symbols we need.
+      if egrep ' nm_test_var$' "$nlist" >/dev/null; then
+	if egrep ' nm_test_func$' "$nlist" >/dev/null; then
+	  cat <<EOF > conftest.$ac_ext
+#ifdef __cplusplus
+extern "C" {
+#endif
+
+EOF
+	  # Now generate the symbol file.
+	  eval "$lt_cv_global_symbol_to_cdecl"' < "$nlist" >> conftest.$ac_ext'
+
+	  cat <<EOF >> conftest.$ac_ext
+#if defined (__STDC__) && __STDC__
+# define lt_ptr void *
+#else
+# define lt_ptr char *
+# define const
+#endif
+
+/* The mapping between symbol names and symbols. */
+const struct {
+  const char *name;
+  lt_ptr address;
+}
+lt_preloaded_symbols[] =
+{
+EOF
+	  sed "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (lt_ptr) \&\2},/" < "$nlist" >> conftest.$ac_ext
+	  cat <<\EOF >> conftest.$ac_ext
+  {0, (lt_ptr) 0}
+};
+
+#ifdef __cplusplus
+}
+#endif
+EOF
+	  # Now try linking the two files.
+	  mv conftest.$ac_objext conftstm.$ac_objext
+	  save_LIBS="$LIBS"
+	  save_CFLAGS="$CFLAGS"
+	  LIBS="conftstm.$ac_objext"
+	  CFLAGS="$CFLAGS$no_builtin_flag"
+	  if { (eval echo configure:2146: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest$ac_exeext; then
+	    pipe_works=yes
+	  fi
+	  LIBS="$save_LIBS"
+	  CFLAGS="$save_CFLAGS"
+	else
+	  echo "cannot find nm_test_func in $nlist" >&5
+	fi
+      else
+	echo "cannot find nm_test_var in $nlist" >&5
+      fi
+    else
+      echo "cannot run $lt_cv_sys_global_symbol_pipe" >&5
+    fi
+  else
+    echo "$progname: failed program was:" >&5
+    cat conftest.$ac_ext >&5
+  fi
+  rm -f conftest* conftst*
+
+  # Do not use the global_symbol_pipe unless it works.
+  if test "$pipe_works" = yes; then
+    break
+  else
+    lt_cv_sys_global_symbol_pipe=
+  fi
+done
+
+fi
+
+global_symbol_pipe="$lt_cv_sys_global_symbol_pipe"
+if test -z "$lt_cv_sys_global_symbol_pipe"; then
+  global_symbol_to_cdecl=
+  global_symbol_to_c_name_address=
+else
+  global_symbol_to_cdecl="$lt_cv_global_symbol_to_cdecl"
+  global_symbol_to_c_name_address="$lt_cv_global_symbol_to_c_name_address"
+fi
+if test -z "$global_symbol_pipe$global_symbol_to_cdec$global_symbol_to_c_name_address";
+then
+  echo "$ac_t""failed" 1>&6
+else
+  echo "$ac_t""ok" 1>&6
+fi
+
+for ac_hdr in dlfcn.h
+do
+ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
+echo "configure:2195: checking for $ac_hdr" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 2200 "configure"
+#include "confdefs.h"
+#include <$ac_hdr>
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:2205: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
+else
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
+fi
+rm -f conftest*
+fi
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_hdr=HAVE_`echo $ac_hdr | sed 'y%abcdefghijklmnopqrstuvwxyz./-%ABCDEFGHIJKLMNOPQRSTUVWXYZ___%'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_hdr 1
+EOF
+ 
+else
+  echo "$ac_t""no" 1>&6
+fi
+done
+
+
+
+
+
+
+# Only perform the check for file, if the check method requires it
+case $deplibs_check_method in
+file_magic*)
+  if test "$file_magic_cmd" = '$MAGIC_CMD'; then
+    echo $ac_n "checking for ${ac_tool_prefix}file""... $ac_c" 1>&6
+echo "configure:2241: checking for ${ac_tool_prefix}file" >&5
+if eval "test \"`echo '$''{'lt_cv_path_MAGIC_CMD'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  case $MAGIC_CMD in
+  /*)
+  lt_cv_path_MAGIC_CMD="$MAGIC_CMD" # Let the user override the test with a path.
+  ;;
+  ?:/*)
+  lt_cv_path_MAGIC_CMD="$MAGIC_CMD" # Let the user override the test with a dos path.
+  ;;
+  *)
+  ac_save_MAGIC_CMD="$MAGIC_CMD"
+  IFS="${IFS=   }"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="/usr/bin:$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/${ac_tool_prefix}file; then
+      lt_cv_path_MAGIC_CMD="$ac_dir/${ac_tool_prefix}file"
+      if test -n "$file_magic_test_file"; then
+	case $deplibs_check_method in
+	"file_magic "*)
+	  file_magic_regex="`expr \"$deplibs_check_method\" : \"file_magic \(.*\)\"`"
+	  MAGIC_CMD="$lt_cv_path_MAGIC_CMD"
+	  if eval $file_magic_cmd \$file_magic_test_file 2> /dev/null |
+	    egrep "$file_magic_regex" > /dev/null; then
+	    :
+	  else
+	    cat <<EOF 1>&2
+
+*** Warning: the command libtool uses to detect shared libraries,
+*** $file_magic_cmd, produces output that libtool cannot recognize.
+*** The result is that libtool may fail to recognize shared libraries
+*** as such.  This will affect the creation of libtool libraries that
+*** depend on shared libraries, but programs linked with such libtool
+*** libraries will work regardless of this problem.  Nevertheless, you
+*** may want to report the problem to your system manager and/or to
+*** bug-libtool@gnu.org
+
+EOF
+	  fi ;;
+	esac
+      fi
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
+  MAGIC_CMD="$ac_save_MAGIC_CMD"
+  ;;
+esac
+fi
 
+MAGIC_CMD="$lt_cv_path_MAGIC_CMD"
+if test -n "$MAGIC_CMD"; then
+  echo "$ac_t""$MAGIC_CMD" 1>&6
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+if test -z "$lt_cv_path_MAGIC_CMD"; then
+  if test -n "$ac_tool_prefix"; then
+    echo $ac_n "checking for file""... $ac_c" 1>&6
+echo "configure:2303: checking for file" >&5
+if eval "test \"`echo '$''{'lt_cv_path_MAGIC_CMD'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  case $MAGIC_CMD in
+  /*)
+  lt_cv_path_MAGIC_CMD="$MAGIC_CMD" # Let the user override the test with a path.
+  ;;
+  ?:/*)
+  lt_cv_path_MAGIC_CMD="$MAGIC_CMD" # Let the user override the test with a dos path.
+  ;;
+  *)
+  ac_save_MAGIC_CMD="$MAGIC_CMD"
+  IFS="${IFS=   }"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="/usr/bin:$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/file; then
+      lt_cv_path_MAGIC_CMD="$ac_dir/file"
+      if test -n "$file_magic_test_file"; then
+	case $deplibs_check_method in
+	"file_magic "*)
+	  file_magic_regex="`expr \"$deplibs_check_method\" : \"file_magic \(.*\)\"`"
+	  MAGIC_CMD="$lt_cv_path_MAGIC_CMD"
+	  if eval $file_magic_cmd \$file_magic_test_file 2> /dev/null |
+	    egrep "$file_magic_regex" > /dev/null; then
+	    :
+	  else
+	    cat <<EOF 1>&2
+
+*** Warning: the command libtool uses to detect shared libraries,
+*** $file_magic_cmd, produces output that libtool cannot recognize.
+*** The result is that libtool may fail to recognize shared libraries
+*** as such.  This will affect the creation of libtool libraries that
+*** depend on shared libraries, but programs linked with such libtool
+*** libraries will work regardless of this problem.  Nevertheless, you
+*** may want to report the problem to your system manager and/or to
+*** bug-libtool@gnu.org
+
+EOF
+	  fi ;;
+	esac
+      fi
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
+  MAGIC_CMD="$ac_save_MAGIC_CMD"
+  ;;
+esac
+fi
+
+MAGIC_CMD="$lt_cv_path_MAGIC_CMD"
+if test -n "$MAGIC_CMD"; then
+  echo "$ac_t""$MAGIC_CMD" 1>&6
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+  else
+    MAGIC_CMD=:
+  fi
+fi
+
+  fi
+  ;;
+esac
+
+# Extract the first word of "${ac_tool_prefix}ranlib", so it can be a program name with args.
+set dummy ${ac_tool_prefix}ranlib; ac_word=$2
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:2374: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  if test -n "$RANLIB"; then
+  ac_cv_prog_RANLIB="$RANLIB" # Let the user override the test.
+else
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_prog_RANLIB="${ac_tool_prefix}ranlib"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
+fi
+fi
+RANLIB="$ac_cv_prog_RANLIB"
+if test -n "$RANLIB"; then
+  echo "$ac_t""$RANLIB" 1>&6
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+
+if test -z "$ac_cv_prog_RANLIB"; then
+if test -n "$ac_tool_prefix"; then
+  # Extract the first word of "ranlib", so it can be a program name with args.
+set dummy ranlib; ac_word=$2
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:2406: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  if test -n "$RANLIB"; then
+  ac_cv_prog_RANLIB="$RANLIB" # Let the user override the test.
+else
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_prog_RANLIB="ranlib"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
+  test -z "$ac_cv_prog_RANLIB" && ac_cv_prog_RANLIB=":"
+fi
+fi
+RANLIB="$ac_cv_prog_RANLIB"
+if test -n "$RANLIB"; then
+  echo "$ac_t""$RANLIB" 1>&6
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+else
+  RANLIB=":"
+fi
+fi
+
+# Extract the first word of "${ac_tool_prefix}strip", so it can be a program name with args.
+set dummy ${ac_tool_prefix}strip; ac_word=$2
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:2441: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_STRIP'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  if test -n "$STRIP"; then
+  ac_cv_prog_STRIP="$STRIP" # Let the user override the test.
+else
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_prog_STRIP="${ac_tool_prefix}strip"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
+fi
+fi
+STRIP="$ac_cv_prog_STRIP"
+if test -n "$STRIP"; then
+  echo "$ac_t""$STRIP" 1>&6
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+
+if test -z "$ac_cv_prog_STRIP"; then
+if test -n "$ac_tool_prefix"; then
+  # Extract the first word of "strip", so it can be a program name with args.
+set dummy strip; ac_word=$2
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:2473: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_STRIP'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  if test -n "$STRIP"; then
+  ac_cv_prog_STRIP="$STRIP" # Let the user override the test.
+else
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_prog_STRIP="strip"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
+  test -z "$ac_cv_prog_STRIP" && ac_cv_prog_STRIP=":"
+fi
+fi
+STRIP="$ac_cv_prog_STRIP"
+if test -n "$STRIP"; then
+  echo "$ac_t""$STRIP" 1>&6
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+else
+  STRIP=":"
+fi
+fi
+
+
+enable_dlopen=no
+enable_win32_dll=no
 
 # Check whether --enable-libtool-lock or --disable-libtool-lock was given.
 if test "${enable_libtool_lock+set}" = set; then
@@ -1383,17 +2511,16 @@
   :
 fi
 
-test "x$enable_libtool_lock" = xno && libtool_flags="$libtool_flags --disable-lock"
-test x"$silent" = xyes && libtool_flags="$libtool_flags --silent"
+test "x$enable_libtool_lock" != xno && enable_libtool_lock=yes
 
 # Some flags need to be propagated to the compiler or linker for good
 # libtool support.
-case "$lt_target" in
+case $host in
 *-*-irix6*)
   # Find out which ABI we are using.
-  echo '#line 1395 "configure"' > conftest.$ac_ext
-  if { (eval echo configure:1396: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
-    case "`/usr/bin/file conftest.o`" in
+  echo '#line 2522 "configure"' > conftest.$ac_ext
+  if { (eval echo configure:2523: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+    case `/usr/bin/file conftest.$ac_objext` in
     *32-bit*)
       LD="${LD-ld} -32"
       ;;
@@ -1413,19 +2540,27 @@
   SAVE_CFLAGS="$CFLAGS"
   CFLAGS="$CFLAGS -belf"
   echo $ac_n "checking whether the C compiler needs -belf""... $ac_c" 1>&6
-echo "configure:1417: checking whether the C compiler needs -belf" >&5
+echo "configure:2544: checking whether the C compiler needs -belf" >&5
 if eval "test \"`echo '$''{'lt_cv_cc_needs_belf'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
-  cat > conftest.$ac_ext <<EOF
-#line 1422 "configure"
+  
+     ac_ext=c
+# CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='${CC-cc} -c $CFLAGS $CPPFLAGS conftest.$ac_ext 1>&5'
+ac_link='${CC-cc} -o conftest${ac_exeext} $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5'
+cross_compiling=$ac_cv_prog_cc_cross
+
+     cat > conftest.$ac_ext <<EOF
+#line 2557 "configure"
 #include "confdefs.h"
 
 int main() {
 
 ; return 0; }
 EOF
-if { (eval echo configure:1429: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2564: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   lt_cv_cc_needs_belf=yes
 else
@@ -1435,6 +2570,13 @@
   lt_cv_cc_needs_belf=no
 fi
 rm -f conftest*
+     ac_ext=c
+# CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='${CC-cc} -c $CFLAGS $CPPFLAGS conftest.$ac_ext 1>&5'
+ac_link='${CC-cc} -o conftest${ac_exeext} $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5'
+cross_compiling=$ac_cv_prog_cc_cross
+
 fi
 
 echo "$ac_t""$lt_cv_cc_needs_belf" 1>&6
@@ -1447,174 +2589,2936 @@
 
 esac
 
+# Sed substitution that helps us do robust quoting.  It backslashifies
+# metacharacters that are still active within double-quoted strings.
+Xsed='sed -e s/^X//'
+sed_quote_subst='s/\([\\"\\`$\\\\]\)/\\\1/g'
 
-# Save cache, so that ltconfig can load it
-cat > confcache <<\EOF
-# This file is a shell script that caches the results of configure
-# tests run on this system so they can be shared between configure
-# scripts and configure runs.  It is not useful on other systems.
-# If it contains results you don't want to keep, you may remove or edit it.
-#
-# By default, configure uses ./config.cache as the cache file,
-# creating it if it does not exist already.  You can give configure
-# the --cache-file=FILE option to use a different cache file; that is
-# what configure does when it calls configure scripts in
-# subdirectories, so they share the cache.
-# Giving --cache-file=/dev/null disables caching, for debugging configure.
-# config.status only pays attention to the cache file if you give it the
-# --recheck option to rerun configure.
-#
-EOF
-# The following way of writing the cache mishandles newlines in values,
-# but we know of no workaround that is simple, portable, and efficient.
-# So, don't put newlines in cache variables' values.
-# Ultrix sh set writes to stderr and can't be redirected directly,
-# and sets the high bit in the cache file unless we assign to the vars.
-(set) 2>&1 |
-  case `(ac_space=' '; set | grep ac_space) 2>&1` in
-  *ac_space=\ *)
-    # `set' does not quote correctly, so add quotes (double-quote substitution
-    # turns \\\\ into \\, and sed turns \\ into \).
-    sed -n \
-      -e "s/'/'\\\\''/g" \
-      -e "s/^\\([a-zA-Z0-9_]*_cv_[a-zA-Z0-9_]*\\)=\\(.*\\)/\\1=\${\\1='\\2'}/p"
+# Same as above, but do not quote variable references.
+double_quote_subst='s/\([\\"\\`\\\\]\)/\\\1/g'
+
+# Sed substitution to delay expansion of an escaped shell variable in a
+# double_quote_subst'ed string.
+delay_variable_subst='s/\\\\\\\\\\\$/\\\\\\$/g'
+
+# Constants:
+rm="rm -f"
+
+# Global variables:
+default_ofile=libtool
+can_build_shared=yes
+
+# All known linkers require a `.a' archive for static linking (except M$VC,
+# which needs '.lib').
+libext=a
+ltmain="$ac_aux_dir/ltmain.sh"
+ofile="$default_ofile"
+with_gnu_ld="$lt_cv_prog_gnu_ld"
+need_locks="$enable_libtool_lock"
+
+old_CC="$CC"
+old_CFLAGS="$CFLAGS"
+
+# Set sane defaults for various variables
+test -z "$AR" && AR=ar
+test -z "$AR_FLAGS" && AR_FLAGS=cru
+test -z "$AS" && AS=as
+test -z "$CC" && CC=cc
+test -z "$DLLTOOL" && DLLTOOL=dlltool
+test -z "$LD" && LD=ld
+test -z "$LN_S" && LN_S="ln -s"
+test -z "$MAGIC_CMD" && MAGIC_CMD=file
+test -z "$NM" && NM=nm
+test -z "$OBJDUMP" && OBJDUMP=objdump
+test -z "$RANLIB" && RANLIB=:
+test -z "$STRIP" && STRIP=:
+test -z "$ac_objext" && ac_objext=o
+
+if test x"$host" != x"$build"; then
+  ac_tool_prefix=${host_alias}-
+else
+  ac_tool_prefix=
+fi
+
+# Transform linux* to *-*-linux-gnu*, to support old configure scripts.
+case $host_os in
+linux-gnu*) ;;
+linux*) host=`echo $host | sed 's/^\(.*-.*-linux\)\(.*\)$/\1-gnu\2/'`
+esac
+
+case $host_os in
+aix3*)
+  # AIX sometimes has problems with the GCC collect2 program.  For some
+  # reason, if we set the COLLECT_NAMES environment variable, the problems
+  # vanish in a puff of smoke.
+  if test "X${COLLECT_NAMES+set}" != Xset; then
+    COLLECT_NAMES=
+    export COLLECT_NAMES
+  fi
+  ;;
+esac
+
+# Determine commands to create old-style static archives.
+old_archive_cmds='$AR $AR_FLAGS $oldlib$oldobjs$old_deplibs'
+old_postinstall_cmds='chmod 644 $oldlib'
+old_postuninstall_cmds=
+
+if test -n "$RANLIB"; then
+  case $host_os in
+  openbsd*)
+    old_postinstall_cmds="\$RANLIB -t \$oldlib~$old_postinstall_cmds"
     ;;
   *)
-    # `set' quotes correctly as required by POSIX, so do not add quotes.
-    sed -n -e 's/^\([a-zA-Z0-9_]*_cv_[a-zA-Z0-9_]*\)=\(.*\)/\1=${\1=\2}/p'
+    old_postinstall_cmds="\$RANLIB \$oldlib~$old_postinstall_cmds"
     ;;
-  esac >> confcache
-if cmp -s $cache_file confcache; then
-  :
+  esac
+  old_archive_cmds="$old_archive_cmds~\$RANLIB \$oldlib"
+fi
+
+# Allow CC to be a program name with arguments.
+set dummy $CC
+compiler="$2"
+
+echo $ac_n "checking for objdir""... $ac_c" 1>&6
+echo "configure:2684: checking for objdir" >&5
+rm -f .libs 2>/dev/null
+mkdir .libs 2>/dev/null
+if test -d .libs; then
+  objdir=.libs
 else
-  if test -w $cache_file; then
-    echo "updating cache $cache_file"
-    cat confcache > $cache_file
+  # MS-DOS does not allow filenames that begin with a dot.
+  objdir=_libs
+fi
+rmdir .libs 2>/dev/null
+echo "$ac_t""$objdir" 1>&6
+
+
+# Check whether --with-pic or --without-pic was given.
+if test "${with_pic+set}" = set; then
+  withval="$with_pic"
+  pic_mode="$withval"
+else
+  pic_mode=default
+fi
+
+test -z "$pic_mode" && pic_mode=default
+
+# We assume here that the value for lt_cv_prog_cc_pic will not be cached
+# in isolation, and that seeing it set (from the cache) indicates that
+# the associated values are set (in the cache) correctly too.
+echo $ac_n "checking for $compiler option to produce PIC""... $ac_c" 1>&6
+echo "configure:2711: checking for $compiler option to produce PIC" >&5
+if eval "test \"`echo '$''{'lt_cv_prog_cc_pic'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+   lt_cv_prog_cc_pic=
+  lt_cv_prog_cc_shlib=
+  lt_cv_prog_cc_wl=
+  lt_cv_prog_cc_static=
+  lt_cv_prog_cc_no_builtin=
+  lt_cv_prog_cc_can_build_shared=$can_build_shared
+
+  if test "$GCC" = yes; then
+    lt_cv_prog_cc_wl='-Wl,'
+    lt_cv_prog_cc_static='-static'
+
+    case $host_os in
+    aix*)
+      # Below there is a dirty hack to force normal static linking with -ldl
+      # The problem is because libdl dynamically linked with both libc and
+      # libC (AIX C++ library), which obviously doesn't included in libraries
+      # list by gcc. This cause undefined symbols with -static flags.
+      # This hack allows C programs to be linked with "-static -ldl", but
+      # not sure about C++ programs.
+      lt_cv_prog_cc_static="$lt_cv_prog_cc_static ${lt_cv_prog_cc_wl}-lC"
+      ;;
+    amigaos*)
+      # FIXME: we need at least 68020 code to build shared libraries, but
+      # adding the `-m68020' flag to GCC prevents building anything better,
+      # like `-m68040'.
+      lt_cv_prog_cc_pic='-m68020 -resident32 -malways-restore-a4'
+      ;;
+    beos* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
+      # PIC is the default for these OSes.
+      ;;
+    darwin* | rhapsody*)
+      # PIC is the default on this platform
+      # Common symbols not allowed in MH_DYLIB files
+      lt_cv_prog_cc_pic='-fno-common'
+      ;;
+    cygwin* | mingw* | pw32* | os2*)
+      # This hack is so that the source file can tell whether it is being
+      # built for inclusion in a dll (and should export symbols for example).
+      lt_cv_prog_cc_pic='-DDLL_EXPORT'
+      ;;
+    sysv4*MP*)
+      if test -d /usr/nec; then
+	 lt_cv_prog_cc_pic=-Kconform_pic
+      fi
+      ;;
+    *)
+      lt_cv_prog_cc_pic='-fPIC'
+      ;;
+    esac
   else
-    echo "not updating unwritable cache $cache_file"
+    # PORTME Check for PIC flags for the system compiler.
+    case $host_os in
+    aix3* | aix4* | aix5*)
+      lt_cv_prog_cc_wl='-Wl,'
+      # All AIX code is PIC.
+      if test "$host_cpu" = ia64; then
+	# AIX 5 now supports IA64 processor
+	lt_cv_prog_cc_static='-Bstatic'
+      else
+	lt_cv_prog_cc_static='-bnso -bI:/lib/syscalls.exp'
+      fi
+      ;;
+
+    hpux9* | hpux10* | hpux11*)
+      # Is there a better lt_cv_prog_cc_static that works with the bundled CC?
+      lt_cv_prog_cc_wl='-Wl,'
+      lt_cv_prog_cc_static="${lt_cv_prog_cc_wl}-a ${lt_cv_prog_cc_wl}archive"
+      lt_cv_prog_cc_pic='+Z'
+      ;;
+
+    irix5* | irix6* | nonstopux*)
+      lt_cv_prog_cc_wl='-Wl,'
+      lt_cv_prog_cc_static='-non_shared'
+      # PIC (with -KPIC) is the default.
+      ;;
+
+    cygwin* | mingw* | pw32* | os2*)
+      # This hack is so that the source file can tell whether it is being
+      # built for inclusion in a dll (and should export symbols for example).
+      lt_cv_prog_cc_pic='-DDLL_EXPORT'
+      ;;
+
+    newsos6)
+      lt_cv_prog_cc_pic='-KPIC'
+      lt_cv_prog_cc_static='-Bstatic'
+      ;;
+
+    osf3* | osf4* | osf5*)
+      # All OSF/1 code is PIC.
+      lt_cv_prog_cc_wl='-Wl,'
+      lt_cv_prog_cc_static='-non_shared'
+      ;;
+
+    sco3.2v5*)
+      lt_cv_prog_cc_pic='-Kpic'
+      lt_cv_prog_cc_static='-dn'
+      lt_cv_prog_cc_shlib='-belf'
+      ;;
+
+    solaris*)
+      lt_cv_prog_cc_pic='-KPIC'
+      lt_cv_prog_cc_static='-Bstatic'
+      lt_cv_prog_cc_wl='-Wl,'
+      ;;
+
+    sunos4*)
+      lt_cv_prog_cc_pic='-PIC'
+      lt_cv_prog_cc_static='-Bstatic'
+      lt_cv_prog_cc_wl='-Qoption ld '
+      ;;
+
+    sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)
+      lt_cv_prog_cc_pic='-KPIC'
+      lt_cv_prog_cc_static='-Bstatic'
+      lt_cv_prog_cc_wl='-Wl,'
+      ;;
+
+    uts4*)
+      lt_cv_prog_cc_pic='-pic'
+      lt_cv_prog_cc_static='-Bstatic'
+      ;;
+
+    sysv4*MP*)
+      if test -d /usr/nec ;then
+	lt_cv_prog_cc_pic='-Kconform_pic'
+	lt_cv_prog_cc_static='-Bstatic'
+      fi
+      ;;
+
+    *)
+      lt_cv_prog_cc_can_build_shared=no
+      ;;
+    esac
   fi
+
 fi
-rm -f confcache
 
+if test -z "$lt_cv_prog_cc_pic"; then
+  echo "$ac_t""none" 1>&6
+else
+  echo "$ac_t""$lt_cv_prog_cc_pic" 1>&6
 
-# Actually configure libtool.  ac_aux_dir is where install-sh is found.
-CC="$CC" CFLAGS="$CFLAGS" CPPFLAGS="$CPPFLAGS" \
-LD="$LD" LDFLAGS="$LDFLAGS" LIBS="$LIBS" \
-LN_S="$LN_S" NM="$NM" RANLIB="$RANLIB" \
-DLLTOOL="$DLLTOOL" AS="$AS" OBJDUMP="$OBJDUMP" \
-${CONFIG_SHELL-/bin/sh} $ac_aux_dir/ltconfig --no-reexec \
-$libtool_flags --no-verify $ac_aux_dir/ltmain.sh $lt_target \
-|| { echo "configure: error: libtool configure failed" 1>&2; exit 1; }
+  # Check to make sure the pic_flag actually works.
+  echo $ac_n "checking if $compiler PIC flag $lt_cv_prog_cc_pic works""... $ac_c" 1>&6
+echo "configure:2859: checking if $compiler PIC flag $lt_cv_prog_cc_pic works" >&5
+  if eval "test \"`echo '$''{'lt_cv_prog_cc_pic_works'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+      save_CFLAGS="$CFLAGS"
+    CFLAGS="$CFLAGS $lt_cv_prog_cc_pic -DPIC"
+    cat > conftest.$ac_ext <<EOF
+#line 2866 "configure"
+#include "confdefs.h"
 
-# Reload cache, that may have been modified by ltconfig
-if test -r "$cache_file"; then
-  echo "loading cache $cache_file"
-  . $cache_file
+int main() {
+
+; return 0; }
+EOF
+if { (eval echo configure:2873: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+        case $host_os in
+      hpux9* | hpux10* | hpux11*)
+	# On HP-UX, both CC and GCC only warn that PIC is supported... then
+	# they create non-PIC objects.  So, if there were any warnings, we
+	# assume that PIC is not supported.
+	if test -s conftest.err; then
+	  lt_cv_prog_cc_pic_works=no
+	else
+	  lt_cv_prog_cc_pic_works=yes
+	fi
+	;;
+      *)
+	lt_cv_prog_cc_pic_works=yes
+	;;
+      esac
+    
 else
-  echo "creating cache $cache_file"
-  > $cache_file
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+        lt_cv_prog_cc_pic_works=no
+    
+fi
+rm -f conftest*
+    CFLAGS="$save_CFLAGS"
+  
 fi
 
 
-# This can be used to rebuild libtool when needed
-LIBTOOL_DEPS="$ac_aux_dir/ltconfig $ac_aux_dir/ltmain.sh"
+  if test "X$lt_cv_prog_cc_pic_works" = Xno; then
+    lt_cv_prog_cc_pic=
+    lt_cv_prog_cc_can_build_shared=no
+  else
+    lt_cv_prog_cc_pic=" $lt_cv_prog_cc_pic"
+  fi
 
-# Always use our own libtool.
-LIBTOOL='$(SHELL) $(top_builddir)/libtool'
+  echo "$ac_t""$lt_cv_prog_cc_pic_works" 1>&6
+fi
 
-# Redirect the config.log output again, so that the ltconfig log is not
-# clobbered by the next message.
-exec 5>>./config.log
+# Check for any special shared library compilation flags.
+if test -n "$lt_cv_prog_cc_shlib"; then
+  echo "configure: warning: \`$CC' requires \`$lt_cv_prog_cc_shlib' to build shared libraries" 1>&2
+  if echo "$old_CC $old_CFLAGS " | egrep -e "[ 	]$lt_cv_prog_cc_shlib[ 	]" >/dev/null; then :
+  else
+   echo "configure: warning: add \`$lt_cv_prog_cc_shlib' to the CC or CFLAGS env variable and reconfigure" 1>&2
+    lt_cv_prog_cc_can_build_shared=no
+  fi
+fi
 
+echo $ac_n "checking if $compiler static flag $lt_cv_prog_cc_static works""... $ac_c" 1>&6
+echo "configure:2925: checking if $compiler static flag $lt_cv_prog_cc_static works" >&5
+if eval "test \"`echo '$''{'lt_cv_prog_cc_static_works'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+    lt_cv_prog_cc_static_works=no
+  save_LDFLAGS="$LDFLAGS"
+  LDFLAGS="$LDFLAGS $lt_cv_prog_cc_static"
+  cat > conftest.$ac_ext <<EOF
+#line 2933 "configure"
+#include "confdefs.h"
 
+int main() {
 
-echo $ac_n "checking how to run the C preprocessor""... $ac_c" 1>&6
-echo "configure:1533: checking how to run the C preprocessor" >&5
-# On Suns, sometimes $CPP names a directory.
-if test -n "$CPP" && test -d "$CPP"; then
-  CPP=
+; return 0; }
+EOF
+if { (eval echo configure:2940: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  lt_cv_prog_cc_static_works=yes
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
 fi
-if test -z "$CPP"; then
-if eval "test \"`echo '$''{'ac_cv_prog_CPP'+set}'`\" = set"; then
+rm -f conftest*
+  LDFLAGS="$save_LDFLAGS"
+
+fi
+
+
+# Belt *and* braces to stop my trousers falling down:
+test "X$lt_cv_prog_cc_static_works" = Xno && lt_cv_prog_cc_static=
+echo "$ac_t""$lt_cv_prog_cc_static_works" 1>&6
+
+pic_flag="$lt_cv_prog_cc_pic"
+special_shlib_compile_flags="$lt_cv_prog_cc_shlib"
+wl="$lt_cv_prog_cc_wl"
+link_static_flag="$lt_cv_prog_cc_static"
+no_builtin_flag="$lt_cv_prog_cc_no_builtin"
+can_build_shared="$lt_cv_prog_cc_can_build_shared"
+
+
+# Check to see if options -o and -c are simultaneously supported by compiler
+echo $ac_n "checking if $compiler supports -c -o file.$ac_objext""... $ac_c" 1>&6
+echo "configure:2967: checking if $compiler supports -c -o file.$ac_objext" >&5
+if eval "test \"`echo '$''{'lt_cv_compiler_c_o'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
-    # This must be in double quotes, not single quotes, because CPP may get
-  # substituted into the Makefile and "${CC-cc}" will confuse make.
-  CPP="${CC-cc} -E"
-  # On the NeXT, cc -E runs the code through the compiler's parser,
-  # not just through cpp.
+  
+$rm -r conftest 2>/dev/null
+mkdir conftest
+cd conftest
+echo "int some_variable = 0;" > conftest.$ac_ext
+mkdir out
+# According to Tom Tromey, Ian Lance Taylor reported there are C compilers
+# that will create temporary files in the current directory regardless of
+# the output directory.  Thus, making CWD read-only will cause this test
+# to fail, enabling locking or at least warning the user not to do parallel
+# builds.
+chmod -w .
+save_CFLAGS="$CFLAGS"
+CFLAGS="$CFLAGS -o out/conftest2.$ac_objext"
+compiler_c_o=no
+if { (eval echo configure:2986: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>out/conftest.err; } && test -s out/conftest2.$ac_objext; then
+  # The compiler can only warn and ignore the option if not recognized
+  # So say no if there are warnings
+  if test -s out/conftest.err; then
+    lt_cv_compiler_c_o=no
+  else
+    lt_cv_compiler_c_o=yes
+  fi
+else
+  # Append any errors to the config.log.
+  cat out/conftest.err 1>&5
+  lt_cv_compiler_c_o=no
+fi
+CFLAGS="$save_CFLAGS"
+chmod u+w .
+$rm conftest* out/*
+rmdir out
+cd ..
+rmdir conftest
+$rm -r conftest 2>/dev/null
+
+fi
+
+compiler_c_o=$lt_cv_compiler_c_o
+echo "$ac_t""$compiler_c_o" 1>&6
+
+if test x"$compiler_c_o" = x"yes"; then
+  # Check to see if we can write to a .lo
+  echo $ac_n "checking if $compiler supports -c -o file.lo""... $ac_c" 1>&6
+echo "configure:3015: checking if $compiler supports -c -o file.lo" >&5
+  if eval "test \"`echo '$''{'lt_cv_compiler_o_lo'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  
+  lt_cv_compiler_o_lo=no
+  save_CFLAGS="$CFLAGS"
+  CFLAGS="$CFLAGS -c -o conftest.lo"
+  save_objext="$ac_objext"
+  ac_objext=lo
   cat > conftest.$ac_ext <<EOF
-#line 1548 "configure"
+#line 3026 "configure"
 #include "confdefs.h"
-#include <assert.h>
-Syntax Error
+
+int main() {
+int some_variable = 0;
+; return 0; }
 EOF
-ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1554: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
-ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
-if test -z "$ac_err"; then
-  :
+if { (eval echo configure:3033: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+      # The compiler can only warn and ignore the option if not recognized
+    # So say no if there are warnings
+    if test -s conftest.err; then
+      lt_cv_compiler_o_lo=no
+    else
+      lt_cv_compiler_o_lo=yes
+    fi
+  
 else
-  echo "$ac_err" >&5
   echo "configure: failed program was:" >&5
   cat conftest.$ac_ext >&5
+fi
+rm -f conftest*
+  ac_objext="$save_objext"
+  CFLAGS="$save_CFLAGS"
+  
+fi
+
+  compiler_o_lo=$lt_cv_compiler_o_lo
+  echo "$ac_t""$compiler_o_lo" 1>&6
+else
+  compiler_o_lo=no
+fi
+
+# Check to see if we can do hard links to lock some files if needed
+hard_links="nottested"
+if test "$compiler_c_o" = no && test "$need_locks" != no; then
+  # do not overwrite the value of need_locks provided by the user
+  echo $ac_n "checking if we can lock with hard links""... $ac_c" 1>&6
+echo "configure:3064: checking if we can lock with hard links" >&5
+  hard_links=yes
+  $rm conftest*
+  ln conftest.a conftest.b 2>/dev/null && hard_links=no
+  touch conftest.a
+  ln conftest.a conftest.b 2>&5 || hard_links=no
+  ln conftest.a conftest.b 2>/dev/null && hard_links=no
+  echo "$ac_t""$hard_links" 1>&6
+  if test "$hard_links" = no; then
+    echo "configure: warning: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" 1>&2
+    need_locks=warn
+  fi
+else
+  need_locks=no
+fi
+
+if test "$GCC" = yes; then
+  # Check to see if options -fno-rtti -fno-exceptions are supported by compiler
+  echo $ac_n "checking if $compiler supports -fno-rtti -fno-exceptions""... $ac_c" 1>&6
+echo "configure:3083: checking if $compiler supports -fno-rtti -fno-exceptions" >&5
+  echo "int some_variable = 0;" > conftest.$ac_ext
+  save_CFLAGS="$CFLAGS"
+  CFLAGS="$CFLAGS -fno-rtti -fno-exceptions -c conftest.$ac_ext"
+  compiler_rtti_exceptions=no
+  cat > conftest.$ac_ext <<EOF
+#line 3089 "configure"
+#include "confdefs.h"
+
+int main() {
+int some_variable = 0;
+; return 0; }
+EOF
+if { (eval echo configure:3096: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
-  CPP="${CC-cc} -E -traditional-cpp"
+      # The compiler can only warn and ignore the option if not recognized
+    # So say no if there are warnings
+    if test -s conftest.err; then
+      compiler_rtti_exceptions=no
+    else
+      compiler_rtti_exceptions=yes
+    fi
+  
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+fi
+rm -f conftest*
+  CFLAGS="$save_CFLAGS"
+  echo "$ac_t""$compiler_rtti_exceptions" 1>&6
+
+  if test "$compiler_rtti_exceptions" = "yes"; then
+    no_builtin_flag=' -fno-builtin -fno-rtti -fno-exceptions'
+  else
+    no_builtin_flag=' -fno-builtin'
+  fi
+fi
+
+# See if the linker supports building shared libraries.
+echo $ac_n "checking whether the linker ($LD) supports shared libraries""... $ac_c" 1>&6
+echo "configure:3123: checking whether the linker ($LD) supports shared libraries" >&5
+
+allow_undefined_flag=
+no_undefined_flag=
+need_lib_prefix=unknown
+need_version=unknown
+# when you set need_version to no, make sure it does not cause -set_version
+# flags to be left without arguments
+archive_cmds=
+archive_expsym_cmds=
+old_archive_from_new_cmds=
+old_archive_from_expsyms_cmds=
+export_dynamic_flag_spec=
+whole_archive_flag_spec=
+thread_safe_flag_spec=
+hardcode_into_libs=no
+hardcode_libdir_flag_spec=
+hardcode_libdir_separator=
+hardcode_direct=no
+hardcode_minus_L=no
+hardcode_shlibpath_var=unsupported
+runpath_var=
+link_all_deplibs=unknown
+always_export_symbols=no
+export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | sed '\''s/.* //'\'' | sort | uniq > $export_symbols'
+# include_expsyms should be a list of space-separated symbols to be *always*
+# included in the symbol list
+include_expsyms=
+# exclude_expsyms can be an egrep regular expression of symbols to exclude
+# it will be wrapped by ` (' and `)$', so one must not match beginning or
+# end of line.  Example: `a|bc|.*d.*' will exclude the symbols `a' and `bc',
+# as well as any symbol that contains `d'.
+exclude_expsyms="_GLOBAL_OFFSET_TABLE_"
+# Although _GLOBAL_OFFSET_TABLE_ is a valid symbol C name, most a.out
+# platforms (ab)use it in PIC code, but their linkers get confused if
+# the symbol is explicitly referenced.  Since portable code cannot
+# rely on this symbol name, it's probably fine to never include it in
+# preloaded symbol tables.
+extract_expsyms_cmds=
+
+case $host_os in
+cygwin* | mingw* | pw32*)
+  # FIXME: the MSVC++ port hasn't been tested in a loooong time
+  # When not using gcc, we currently assume that we are using
+  # Microsoft Visual C++.
+  if test "$GCC" != yes; then
+    with_gnu_ld=no
+  fi
+  ;;
+openbsd*)
+  with_gnu_ld=no
+  ;;
+esac
+
+ld_shlibs=yes
+if test "$with_gnu_ld" = yes; then
+  # If archive_cmds runs LD, not CC, wlarc should be empty
+  wlarc='${wl}'
+
+  # See if GNU ld supports shared libraries.
+  case $host_os in
+  aix3* | aix4* | aix5*)
+    # On AIX, the GNU linker is very broken
+    # Note:Check GNU linker on AIX 5-IA64 when/if it becomes available.
+    ld_shlibs=no
+    cat <<EOF 1>&2
+
+*** Warning: the GNU linker, at least up to release 2.9.1, is reported
+*** to be unable to reliably create shared libraries on AIX.
+*** Therefore, libtool is disabling shared libraries support.  If you
+*** really care for shared libraries, you may want to modify your PATH
+*** so that a non-GNU linker is found, and then restart.
+
+EOF
+    ;;
+
+  amigaos*)
+    archive_cmds='$rm $output_objdir/a2ixlibrary.data~$echo "#define NAME $libname" > $output_objdir/a2ixlibrary.data~$echo "#define LIBRARY_ID 1" >> $output_objdir/a2ixlibrary.data~$echo "#define VERSION $major" >> $output_objdir/a2ixlibrary.data~$echo "#define REVISION $revision" >> $output_objdir/a2ixlibrary.data~$AR $AR_FLAGS $lib $libobjs~$RANLIB $lib~(cd $output_objdir && a2ixlibrary -32)'
+    hardcode_libdir_flag_spec='-L$libdir'
+    hardcode_minus_L=yes
+
+    # Samuel A. Falvo II <kc5tja@dolphin.openprojects.net> reports
+    # that the semantics of dynamic libraries on AmigaOS, at least up
+    # to version 4, is to share data among multiple programs linked
+    # with the same dynamic library.  Since this doesn't match the
+    # behavior of shared libraries on other platforms, we can use
+    # them.
+    ld_shlibs=no
+    ;;
+
+  beos*)
+    if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      allow_undefined_flag=unsupported
+      # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
+      # support --undefined.  This deserves some investigation.  FIXME
+      archive_cmds='$CC -nostart $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+    else
+      ld_shlibs=no
+    fi
+    ;;
+
+  cygwin* | mingw* | pw32*)
+    # hardcode_libdir_flag_spec is actually meaningless, as there is
+    # no search path for DLLs.
+    hardcode_libdir_flag_spec='-L$libdir'
+    allow_undefined_flag=unsupported
+    always_export_symbols=yes
+
+    extract_expsyms_cmds='test -f $output_objdir/impgen.c || \
+      sed -e "/^# \/\* impgen\.c starts here \*\//,/^# \/\* impgen.c ends here \*\// { s/^# //;s/^# *$//; p; }" -e d < $''0 > $output_objdir/impgen.c~
+      test -f $output_objdir/impgen.exe || (cd $output_objdir && \
+      if test "x$HOST_CC" != "x" ; then $HOST_CC -o impgen impgen.c ; \
+      else $CC -o impgen impgen.c ; fi)~
+      $output_objdir/impgen $dir/$soroot > $output_objdir/$soname-def'
+
+    old_archive_from_expsyms_cmds='$DLLTOOL --as=$AS --dllname $soname --def $output_objdir/$soname-def --output-lib $output_objdir/$newlib'
+
+    # cygwin and mingw dlls have different entry points and sets of symbols
+    # to exclude.
+    # FIXME: what about values for MSVC?
+    dll_entry=__cygwin_dll_entry@12
+    dll_exclude_symbols=DllMain@12,_cygwin_dll_entry@12,_cygwin_noncygwin_dll_entry@12~
+    case $host_os in
+    mingw*)
+      # mingw values
+      dll_entry=_DllMainCRTStartup@12
+      dll_exclude_symbols=DllMain@12,DllMainCRTStartup@12,DllEntryPoint@12~
+      ;;
+    esac
+
+    # mingw and cygwin differ, and it's simplest to just exclude the union
+    # of the two symbol sets.
+    dll_exclude_symbols=DllMain@12,_cygwin_dll_entry@12,_cygwin_noncygwin_dll_entry@12,DllMainCRTStartup@12,DllEntryPoint@12
+
+    # recent cygwin and mingw systems supply a stub DllMain which the user
+    # can override, but on older systems we have to supply one (in ltdll.c)
+    if test "x$lt_cv_need_dllmain" = "xyes"; then
+      ltdll_obj='$output_objdir/$soname-ltdll.'"$ac_objext "
+      ltdll_cmds='test -f $output_objdir/$soname-ltdll.c || sed -e "/^# \/\* ltdll\.c starts here \*\//,/^# \/\* ltdll.c ends here \*\// { s/^# //; p; }" -e d < $''0 > $output_objdir/$soname-ltdll.c~
+	test -f $output_objdir/$soname-ltdll.$ac_objext || (cd $output_objdir && $CC -c $soname-ltdll.c)~'
+    else
+      ltdll_obj=
+      ltdll_cmds=
+    fi
+
+    # Extract the symbol export list from an `--export-all' def file,
+    # then regenerate the def file from the symbol export list, so that
+    # the compiled dll only exports the symbol export list.
+    # Be careful not to strip the DATA tag left be newer dlltools.
+    export_symbols_cmds="$ltdll_cmds"'
+      $DLLTOOL --export-all --exclude-symbols '$dll_exclude_symbols' --output-def $output_objdir/$soname-def '$ltdll_obj'$libobjs $convenience~
+      sed -e "1,/EXPORTS/d" -e "s/ @ [0-9]*//" -e "s/ *;.*$//" < $output_objdir/$soname-def > $export_symbols'
+
+    # If the export-symbols file already is a .def file (1st line
+    # is EXPORTS), use it as is.
+    # If DATA tags from a recent dlltool are present, honour them!
+    archive_expsym_cmds='if test "x`sed 1q $export_symbols`" = xEXPORTS; then
+	cp $export_symbols $output_objdir/$soname-def;
+      else
+	echo EXPORTS > $output_objdir/$soname-def;
+	_lt_hint=1;
+	cat $export_symbols | while read symbol; do
+	 set dummy \$symbol;
+	 case \$# in
+	   2) echo "   \$2 @ \$_lt_hint ; " >> $output_objdir/$soname-def;;
+	   4) echo "   \$2 \$3 \$4 ; " >> $output_objdir/$soname-def; _lt_hint=`expr \$_lt_hint - 1`;;
+	   *) echo "     \$2 @ \$_lt_hint \$3 ; " >> $output_objdir/$soname-def;;
+	 esac;
+	 _lt_hint=`expr 1 + \$_lt_hint`;
+	done;
+      fi~
+      '"$ltdll_cmds"'
+      $CC -Wl,--base-file,$output_objdir/$soname-base '$lt_cv_cc_dll_switch' -Wl,-e,'$dll_entry' -o $output_objdir/$soname '$ltdll_obj'$libobjs $deplibs $compiler_flags~
+      $DLLTOOL --as=$AS --dllname $soname --exclude-symbols '$dll_exclude_symbols' --def $output_objdir/$soname-def --base-file $output_objdir/$soname-base --output-exp $output_objdir/$soname-exp~
+      $CC -Wl,--base-file,$output_objdir/$soname-base $output_objdir/$soname-exp '$lt_cv_cc_dll_switch' -Wl,-e,'$dll_entry' -o $output_objdir/$soname '$ltdll_obj'$libobjs $deplibs $compiler_flags~
+      $DLLTOOL --as=$AS --dllname $soname --exclude-symbols '$dll_exclude_symbols' --def $output_objdir/$soname-def --base-file $output_objdir/$soname-base --output-exp $output_objdir/$soname-exp --output-lib $output_objdir/$libname.dll.a~
+      $CC $output_objdir/$soname-exp '$lt_cv_cc_dll_switch' -Wl,-e,'$dll_entry' -o $output_objdir/$soname '$ltdll_obj'$libobjs $deplibs $compiler_flags'
+    ;;
+
+  netbsd*)
+    if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
+      archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
+      wlarc=
+    else
+      archive_cmds='$CC -shared -nodefaultlibs $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+      archive_expsym_cmds='$CC -shared -nodefaultlibs $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
+    fi
+    ;;
+
+  solaris* | sysv5*)
+    if $LD -v 2>&1 | egrep 'BFD 2\.8' > /dev/null; then
+      ld_shlibs=no
+      cat <<EOF 1>&2
+
+*** Warning: The releases 2.8.* of the GNU linker cannot reliably
+*** create shared libraries on Solaris systems.  Therefore, libtool
+*** is disabling shared libraries support.  We urge you to upgrade GNU
+*** binutils to release 2.9.1 or newer.  Another option is to modify
+*** your PATH or compiler configuration so that the native linker is
+*** used, and then restart.
+
+EOF
+    elif $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+      archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
+    else
+      ld_shlibs=no
+    fi
+    ;;
+
+  sunos4*)
+    archive_cmds='$LD -assert pure-text -Bshareable -o $lib $libobjs $deplibs $linker_flags'
+    wlarc=
+    hardcode_direct=yes
+    hardcode_shlibpath_var=no
+    ;;
+
+  *)
+    if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+      archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
+    else
+      ld_shlibs=no
+    fi
+    ;;
+  esac
+
+  if test "$ld_shlibs" = yes; then
+    runpath_var=LD_RUN_PATH
+    hardcode_libdir_flag_spec='${wl}--rpath ${wl}$libdir'
+    export_dynamic_flag_spec='${wl}--export-dynamic'
+    case $host_os in
+    cygwin* | mingw* | pw32*)
+      # dlltool doesn't understand --whole-archive et. al.
+      whole_archive_flag_spec=
+      ;;
+    *)
+      # ancient GNU ld didn't support --whole-archive et. al.
+      if $LD --help 2>&1 | egrep 'no-whole-archive' > /dev/null; then
+	whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
+      else
+	whole_archive_flag_spec=
+      fi
+      ;;
+    esac
+  fi
+else
+  # PORTME fill in a description of your system's linker (not GNU ld)
+  case $host_os in
+  aix3*)
+    allow_undefined_flag=unsupported
+    always_export_symbols=yes
+    archive_expsym_cmds='$LD -o $output_objdir/$soname $libobjs $deplibs $linker_flags -bE:$export_symbols -T512 -H512 -bM:SRE~$AR $AR_FLAGS $lib $output_objdir/$soname'
+    # Note: this linker hardcodes the directories in LIBPATH if there
+    # are no directories specified by -L.
+    hardcode_minus_L=yes
+    if test "$GCC" = yes && test -z "$link_static_flag"; then
+      # Neither direct hardcoding nor static linking is supported with a
+      # broken collect2.
+      hardcode_direct=unsupported
+    fi
+    ;;
+
+  aix4* | aix5*)
+    if test "$host_cpu" = ia64; then
+      # On IA64, the linker does run time linking by default, so we don't
+      # have to do anything special.
+      aix_use_runtimelinking=no
+      exp_sym_flag='-Bexport'
+      no_entry_flag=""
+    else
+      aix_use_runtimelinking=no
+
+      # Test if we are trying to use run time linking or normal
+      # AIX style linking. If -brtl is somewhere in LDFLAGS, we
+      # need to do runtime linking.
+      case $host_os in aix4.[23]|aix4.[23].*|aix5*)
+	for ld_flag in $LDFLAGS; do
+	  case $ld_flag in
+	  *-brtl*)
+	    aix_use_runtimelinking=yes
+	    break
+	  ;;
+	  esac
+	done
+      esac
+
+      exp_sym_flag='-bexport'
+      no_entry_flag='-bnoentry'
+    fi
+
+    # When large executables or shared objects are built, AIX ld can
+    # have problems creating the table of contents.  If linking a library
+    # or program results in "error TOC overflow" add -mminimal-toc to
+    # CXXFLAGS/CFLAGS for g++/gcc.  In the cases where that is not
+    # enough to fix the problem, add -Wl,-bbigtoc to LDFLAGS.
+
+    hardcode_direct=yes
+    archive_cmds=''
+    hardcode_libdir_separator=':'
+    if test "$GCC" = yes; then
+      case $host_os in aix4.[012]|aix4.[012].*)
+	collect2name=`${CC} -print-prog-name=collect2`
+	if test -f "$collect2name" && \
+	  strings "$collect2name" | grep resolve_lib_name >/dev/null
+	then
+	  # We have reworked collect2
+	  hardcode_direct=yes
+	else
+	  # We have old collect2
+	  hardcode_direct=unsupported
+	  # It fails to find uninstalled libraries when the uninstalled
+	  # path is not listed in the libpath.  Setting hardcode_minus_L
+	  # to unsupported forces relinking
+	  hardcode_minus_L=yes
+	  hardcode_libdir_flag_spec='-L$libdir'
+	  hardcode_libdir_separator=
+	fi
+      esac
+
+      shared_flag='-shared'
+    else
+      # not using gcc
+      if test "$host_cpu" = ia64; then
+	shared_flag='${wl}-G'
+      else
+	if test "$aix_use_runtimelinking" = yes; then
+	  shared_flag='${wl}-G'
+	else
+	  shared_flag='${wl}-bM:SRE'
+	fi
+      fi
+    fi
+
+    # It seems that -bexpall can do strange things, so it is better to
+    # generate a list of symbols to export.
+    always_export_symbols=yes
+    if test "$aix_use_runtimelinking" = yes; then
+      # Warning - without using the other runtime loading flags (-brtl),
+      # -berok will link without error, but may produce a broken library.
+      allow_undefined_flag='-berok'
+      hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:/usr/lib:/lib'
+      archive_expsym_cmds="\$CC"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags `if test "x${allow_undefined_flag}" != "x"; then echo "${wl}${allow_undefined_flag}"; else :; fi` '"\${wl}$no_entry_flag \${wl}$exp_sym_flag:\$export_symbols $shared_flag"
+    else
+      if test "$host_cpu" = ia64; then
+	hardcode_libdir_flag_spec='${wl}-R $libdir:/usr/lib:/lib'
+	allow_undefined_flag="-z nodefs"
+	archive_expsym_cmds="\$CC $shared_flag"' -o $output_objdir/$soname ${wl}-h$soname $libobjs $deplibs $compiler_flags ${wl}${allow_undefined_flag} '"\${wl}$no_entry_flag \${wl}$exp_sym_flag:\$export_symbols"
+      else
+	hardcode_libdir_flag_spec='${wl}-bnolibpath ${wl}-blibpath:$libdir:/usr/lib:/lib'
+	# Warning - without using the other run time loading flags,
+	# -berok will link without error, but may produce a broken library.
+	allow_undefined_flag='${wl}-berok'
+	# This is a bit strange, but is similar to how AIX traditionally builds
+	# it's shared libraries.
+	archive_expsym_cmds="\$CC $shared_flag"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${allow_undefined_flag} '"\${wl}$no_entry_flag \${wl}$exp_sym_flag:\$export_symbols"' ~$AR -crlo $objdir/$libname$release.a $objdir/$soname'
+      fi
+    fi
+    ;;
+
+  amigaos*)
+    archive_cmds='$rm $output_objdir/a2ixlibrary.data~$echo "#define NAME $libname" > $output_objdir/a2ixlibrary.data~$echo "#define LIBRARY_ID 1" >> $output_objdir/a2ixlibrary.data~$echo "#define VERSION $major" >> $output_objdir/a2ixlibrary.data~$echo "#define REVISION $revision" >> $output_objdir/a2ixlibrary.data~$AR $AR_FLAGS $lib $libobjs~$RANLIB $lib~(cd $output_objdir && a2ixlibrary -32)'
+    hardcode_libdir_flag_spec='-L$libdir'
+    hardcode_minus_L=yes
+    # see comment about different semantics on the GNU ld section
+    ld_shlibs=no
+    ;;
+
+  cygwin* | mingw* | pw32*)
+    # When not using gcc, we currently assume that we are using
+    # Microsoft Visual C++.
+    # hardcode_libdir_flag_spec is actually meaningless, as there is
+    # no search path for DLLs.
+    hardcode_libdir_flag_spec=' '
+    allow_undefined_flag=unsupported
+    # Tell ltmain to make .lib files, not .a files.
+    libext=lib
+    # FIXME: Setting linknames here is a bad hack.
+    archive_cmds='$CC -o $lib $libobjs $compiler_flags `echo "$deplibs" | sed -e '\''s/ -lc$//'\''` -link -dll~linknames='
+    # The linker will automatically build a .lib file if we build a DLL.
+    old_archive_from_new_cmds='true'
+    # FIXME: Should let the user specify the lib program.
+    old_archive_cmds='lib /OUT:$oldlib$oldobjs$old_deplibs'
+    fix_srcfile_path='`cygpath -w "$srcfile"`'
+    ;;
+
+  darwin* | rhapsody*)
+    case "$host_os" in
+    rhapsody* | darwin1.[012])
+      allow_undefined_flag='-undefined suppress'
+      ;;
+    *) # Darwin 1.3 on
+      allow_undefined_flag='-flat_namespace -undefined suppress'
+      ;;
+    esac
+    # FIXME: Relying on posixy $() will cause problems for
+    #        cross-compilation, but unfortunately the echo tests do not
+    #        yet detect zsh echo's removal of \ escapes.  Also zsh mangles
+    #	     `"' quotes if we put them in here... so don't!
+    archive_cmds='$CC -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs && $CC $(test .$module = .yes && echo -bundle || echo -dynamiclib) $allow_undefined_flag -o $lib ${lib}-master.o $deplibs$linker_flags $(test .$module != .yes && echo -install_name $rpath/$soname $verstring)'
+    # We need to add '_' to the symbols in $export_symbols first
+    #archive_expsym_cmds="$archive_cmds"' && strip -s $export_symbols'
+    hardcode_direct=yes
+    hardcode_shlibpath_var=no
+    whole_archive_flag_spec='-all_load $convenience'
+    ;;
+
+  freebsd1*)
+    ld_shlibs=no
+    ;;
+
+  # FreeBSD 2.2.[012] allows us to include c++rt0.o to get C++ constructor
+  # support.  Future versions do this automatically, but an explicit c++rt0.o
+  # does not break anything, and helps significantly (at the cost of a little
+  # extra space).
+  freebsd2.2*)
+    archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags /usr/lib/c++rt0.o'
+    hardcode_libdir_flag_spec='-R$libdir'
+    hardcode_direct=yes
+    hardcode_shlibpath_var=no
+    ;;
+
+  # Unfortunately, older versions of FreeBSD 2 do not have this feature.
+  freebsd2*)
+    archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
+    hardcode_direct=yes
+    hardcode_minus_L=yes
+    hardcode_shlibpath_var=no
+    ;;
+
+  # FreeBSD 3 and greater uses gcc -shared to do shared libraries.
+  freebsd*)
+    archive_cmds='$CC -shared -o $lib $libobjs $deplibs $compiler_flags'
+    hardcode_libdir_flag_spec='-R$libdir'
+    hardcode_direct=yes
+    hardcode_shlibpath_var=no
+    ;;
+
+  hpux9* | hpux10* | hpux11*)
+    case $host_os in
+    hpux9*) archive_cmds='$rm $output_objdir/$soname~$LD -b +b $install_libdir -o $output_objdir/$soname $libobjs $deplibs $linker_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib' ;;
+    *) archive_cmds='$LD -b +h $soname +b $install_libdir -o $lib $libobjs $deplibs $linker_flags' ;;
+    esac
+    hardcode_libdir_flag_spec='${wl}+b ${wl}$libdir'
+    hardcode_libdir_separator=:
+    hardcode_direct=yes
+    hardcode_minus_L=yes # Not in the search PATH, but as the default
+			 # location of the library.
+    export_dynamic_flag_spec='${wl}-E'
+    ;;
+
+  irix5* | irix6* | nonstopux*)
+    if test "$GCC" = yes; then
+      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
+      hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
+    else
+      archive_cmds='$LD -shared $libobjs $deplibs $linker_flags -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
+      hardcode_libdir_flag_spec='-rpath $libdir'
+    fi
+    hardcode_libdir_separator=:
+    link_all_deplibs=yes
+    ;;
+
+  netbsd*)
+    if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
+      archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
+    else
+      archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
+    fi
+    hardcode_libdir_flag_spec='-R$libdir'
+    hardcode_direct=yes
+    hardcode_shlibpath_var=no
+    ;;
+
+  newsos6)
+    archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+    hardcode_direct=yes
+    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
+    hardcode_libdir_separator=:
+    hardcode_shlibpath_var=no
+    ;;
+
+  openbsd*)
+    hardcode_direct=yes
+    hardcode_shlibpath_var=no
+    if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+      archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+      hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
+      export_dynamic_flag_spec='${wl}-E'
+    else
+      case "$host_os" in
+      openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
+	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
+	hardcode_libdir_flag_spec='-R$libdir'
+        ;;
+      *)
+        archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+        hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
+        ;;
+      esac
+    fi
+    ;;
+
+  os2*)
+    hardcode_libdir_flag_spec='-L$libdir'
+    hardcode_minus_L=yes
+    allow_undefined_flag=unsupported
+    archive_cmds='$echo "LIBRARY $libname INITINSTANCE" > $output_objdir/$libname.def~$echo "DESCRIPTION \"$libname\"" >> $output_objdir/$libname.def~$echo DATA >> $output_objdir/$libname.def~$echo " SINGLE NONSHARED" >> $output_objdir/$libname.def~$echo EXPORTS >> $output_objdir/$libname.def~emxexp $libobjs >> $output_objdir/$libname.def~$CC -Zdll -Zcrtdll -o $lib $libobjs $deplibs $compiler_flags $output_objdir/$libname.def'
+    old_archive_from_new_cmds='emximp -o $output_objdir/$libname.a $output_objdir/$libname.def'
+    ;;
+
+  osf3*)
+    if test "$GCC" = yes; then
+      allow_undefined_flag=' ${wl}-expect_unresolved ${wl}\*'
+      archive_cmds='$CC -shared${allow_undefined_flag} $libobjs $deplibs $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
+    else
+      allow_undefined_flag=' -expect_unresolved \*'
+      archive_cmds='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
+    fi
+    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
+    hardcode_libdir_separator=:
+    ;;
+
+  osf4* | osf5*)	# as osf3* with the addition of -msym flag
+    if test "$GCC" = yes; then
+      allow_undefined_flag=' ${wl}-expect_unresolved ${wl}\*'
+      archive_cmds='$CC -shared${allow_undefined_flag} $libobjs $deplibs $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
+      hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
+    else
+      allow_undefined_flag=' -expect_unresolved \*'
+      archive_cmds='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -msym -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
+      archive_expsym_cmds='for i in `cat $export_symbols`; do printf "-exported_symbol " >> $lib.exp; echo "\$i" >> $lib.exp; done; echo "-hidden">> $lib.exp~
+      $LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib~$rm $lib.exp'
+
+      #Both c and cxx compiler support -rpath directly
+      hardcode_libdir_flag_spec='-rpath $libdir'
+    fi
+    hardcode_libdir_separator=:
+    ;;
+
+  sco3.2v5*)
+    archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+    hardcode_shlibpath_var=no
+    runpath_var=LD_RUN_PATH
+    hardcode_runpath_var=yes
+    export_dynamic_flag_spec='${wl}-Bexport'
+    ;;
+
+  solaris*)
+    # gcc --version < 3.0 without binutils cannot create self contained
+    # shared libraries reliably, requiring libgcc.a to resolve some of
+    # the object symbols generated in some cases.  Libraries that use
+    # assert need libgcc.a to resolve __eprintf, for example.  Linking
+    # a copy of libgcc.a into every shared library to guarantee resolving
+    # such symbols causes other problems:  According to Tim Van Holder
+    # <tim.van.holder@pandora.be>, C++ libraries end up with a separate
+    # (to the application) exception stack for one thing.
+    no_undefined_flag=' -z defs'
+    if test "$GCC" = yes; then
+      case `$CC --version 2>/dev/null` in
+      [12].*)
+	cat <<EOF 1>&2
+
+*** Warning: Releases of GCC earlier than version 3.0 cannot reliably
+*** create self contained shared libraries on Solaris systems, without
+*** introducing a dependency on libgcc.a.  Therefore, libtool is disabling
+*** -no-undefined support, which will at least allow you to build shared
+*** libraries.  However, you may find that when you link such libraries
+*** into an application without using GCC, you have to manually add
+*** \`gcc --print-libgcc-file-name\` to the link command.  We urge you to
+*** upgrade to a newer version of GCC.  Another option is to rebuild your
+*** current GCC to use the GNU linker from GNU binutils 2.9.1 or newer.
+
+EOF
+        no_undefined_flag=
+	;;
+      esac
+    fi
+    # $CC -shared without GNU ld will not create a library from C++
+    # object files and a static libstdc++, better avoid it by now
+    archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
+    archive_expsym_cmds='$echo "{ global:" > $lib.exp~cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
+		$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
+    hardcode_libdir_flag_spec='-R$libdir'
+    hardcode_shlibpath_var=no
+    case $host_os in
+    solaris2.[0-5] | solaris2.[0-5].*) ;;
+    *) # Supported since Solaris 2.6 (maybe 2.5.1?)
+      whole_archive_flag_spec='-z allextract$convenience -z defaultextract' ;;
+    esac
+    link_all_deplibs=yes
+    ;;
+
+  sunos4*)
+    if test "x$host_vendor" = xsequent; then
+      # Use $CC to link under sequent, because it throws in some extra .o
+      # files that make .init and .fini sections work.
+      archive_cmds='$CC -G ${wl}-h $soname -o $lib $libobjs $deplibs $compiler_flags'
+    else
+      archive_cmds='$LD -assert pure-text -Bstatic -o $lib $libobjs $deplibs $linker_flags'
+    fi
+    hardcode_libdir_flag_spec='-L$libdir'
+    hardcode_direct=yes
+    hardcode_minus_L=yes
+    hardcode_shlibpath_var=no
+    ;;
+
+  sysv4)
+    case $host_vendor in
+      sni)
+        archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+        hardcode_direct=yes # is this really true???
+        ;;
+      siemens)
+        ## LD is ld it makes a PLAMLIB
+        ## CC just makes a GrossModule.
+        archive_cmds='$LD -G -o $lib $libobjs $deplibs $linker_flags'
+        reload_cmds='$CC -r -o $output$reload_objs'
+        hardcode_direct=no
+        ;;
+      motorola)
+        archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+        hardcode_direct=no #Motorola manual says yes, but my tests say they lie
+        ;;
+    esac
+    runpath_var='LD_RUN_PATH'
+    hardcode_shlibpath_var=no
+    ;;
+
+  sysv4.3*)
+    archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+    hardcode_shlibpath_var=no
+    export_dynamic_flag_spec='-Bexport'
+    ;;
+
+  sysv5*)
+    no_undefined_flag=' -z text'
+    # $CC -shared without GNU ld will not create a library from C++
+    # object files and a static libstdc++, better avoid it by now
+    archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
+    archive_expsym_cmds='$echo "{ global:" > $lib.exp~cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
+		$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
+    hardcode_libdir_flag_spec=
+    hardcode_shlibpath_var=no
+    runpath_var='LD_RUN_PATH'
+    ;;
+
+  uts4*)
+    archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+    hardcode_libdir_flag_spec='-L$libdir'
+    hardcode_shlibpath_var=no
+    ;;
+
+  dgux*)
+    archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+    hardcode_libdir_flag_spec='-L$libdir'
+    hardcode_shlibpath_var=no
+    ;;
+
+  sysv4*MP*)
+    if test -d /usr/nec; then
+      archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
+      hardcode_shlibpath_var=no
+      runpath_var=LD_RUN_PATH
+      hardcode_runpath_var=yes
+      ld_shlibs=yes
+    fi
+    ;;
+
+  sysv4.2uw2*)
+    archive_cmds='$LD -G -o $lib $libobjs $deplibs $linker_flags'
+    hardcode_direct=yes
+    hardcode_minus_L=no
+    hardcode_shlibpath_var=no
+    hardcode_runpath_var=yes
+    runpath_var=LD_RUN_PATH
+    ;;
+
+  sysv5uw7* | unixware7*)
+    no_undefined_flag='${wl}-z ${wl}text'
+    if test "$GCC" = yes; then
+      archive_cmds='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
+    else
+      archive_cmds='$CC -G ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
+    fi
+    runpath_var='LD_RUN_PATH'
+    hardcode_shlibpath_var=no
+    ;;
+
+  *)
+    ld_shlibs=no
+    ;;
+  esac
+fi
+echo "$ac_t""$ld_shlibs" 1>&6
+test "$ld_shlibs" = no && can_build_shared=no
+
+# Check hardcoding attributes.
+echo $ac_n "checking how to hardcode library paths into programs""... $ac_c" 1>&6
+echo "configure:3822: checking how to hardcode library paths into programs" >&5
+hardcode_action=
+if test -n "$hardcode_libdir_flag_spec" || \
+   test -n "$runpath_var"; then
+
+  # We can hardcode non-existant directories.
+  if test "$hardcode_direct" != no &&
+     # If the only mechanism to avoid hardcoding is shlibpath_var, we
+     # have to relink, otherwise we might link with an installed library
+     # when we should be linking with a yet-to-be-installed one
+     ## test "$hardcode_shlibpath_var" != no &&
+     test "$hardcode_minus_L" != no; then
+    # Linking always hardcodes the temporary library directory.
+    hardcode_action=relink
+  else
+    # We can link without hardcoding, and we can hardcode nonexisting dirs.
+    hardcode_action=immediate
+  fi
+else
+  # We cannot hardcode anything, or else we can only hardcode existing
+  # directories.
+  hardcode_action=unsupported
+fi
+echo "$ac_t""$hardcode_action" 1>&6
+
+striplib=
+old_striplib=
+echo $ac_n "checking whether stripping libraries is possible""... $ac_c" 1>&6
+echo "configure:3850: checking whether stripping libraries is possible" >&5
+if test -n "$STRIP" && $STRIP -V 2>&1 | grep "GNU strip" >/dev/null; then
+  test -z "$old_striplib" && old_striplib="$STRIP --strip-debug"
+  test -z "$striplib" && striplib="$STRIP --strip-unneeded"
+  echo "$ac_t""yes" 1>&6
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+reload_cmds='$LD$reload_flag -o $output$reload_objs'
+test -z "$deplibs_check_method" && deplibs_check_method=unknown
+
+# PORTME Fill in your ld.so characteristics
+echo $ac_n "checking dynamic linker characteristics""... $ac_c" 1>&6
+echo "configure:3864: checking dynamic linker characteristics" >&5
+library_names_spec=
+libname_spec='lib$name'
+soname_spec=
+postinstall_cmds=
+postuninstall_cmds=
+finish_cmds=
+finish_eval=
+shlibpath_var=
+shlibpath_overrides_runpath=unknown
+version_type=none
+dynamic_linker="$host_os ld.so"
+sys_lib_dlsearch_path_spec="/lib /usr/lib"
+sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
+
+case $host_os in
+aix3*)
+  version_type=linux
+  library_names_spec='${libname}${release}.so$versuffix $libname.a'
+  shlibpath_var=LIBPATH
+
+  # AIX has no versioning support, so we append a major version to the name.
+  soname_spec='${libname}${release}.so$major'
+  ;;
+
+aix4* | aix5*)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  hardcode_into_libs=yes
+  if test "$host_cpu" = ia64; then
+    # AIX 5 supports IA64
+    library_names_spec='${libname}${release}.so$major ${libname}${release}.so$versuffix $libname.so'
+    shlibpath_var=LD_LIBRARY_PATH
+  else
+    # With GCC up to 2.95.x, collect2 would create an import file
+    # for dependence libraries.  The import file would start with
+    # the line `#! .'.  This would cause the generated library to
+    # depend on `.', always an invalid library.  This was fixed in
+    # development snapshots of GCC prior to 3.0.
+    case $host_os in
+      aix4 | aix4.[01] | aix4.[01].*)
+	if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
+	     echo ' yes '
+	     echo '#endif'; } | ${CC} -E - | grep yes > /dev/null; then
+	  :
+	else
+	  can_build_shared=no
+	fi
+	;;
+    esac
+    # AIX (on Power*) has no versioning support, so currently we can
+    # not hardcode correct soname into executable. Probably we can
+    # add versioning support to collect2, so additional links can
+    # be useful in future.
+    if test "$aix_use_runtimelinking" = yes; then
+      # If using run time linking (on AIX 4.2 or later) use lib<name>.so
+      # instead of lib<name>.a to let people know that these are not
+      # typical AIX shared libraries.
+      library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+    else
+      # We preserve .a as extension for shared libraries through AIX4.2
+      # and later when we are not doing run time linking.
+      library_names_spec='${libname}${release}.a $libname.a'
+      soname_spec='${libname}${release}.so$major'
+    fi
+    shlibpath_var=LIBPATH
+  fi
+  hardcode_into_libs=yes
+  ;;
+
+amigaos*)
+  library_names_spec='$libname.ixlibrary $libname.a'
+  # Create ${libname}_ixlibrary.a entries in /sys/libs.
+  finish_eval='for lib in `ls $libdir/*.ixlibrary 2>/dev/null`; do libname=`$echo "X$lib" | $Xsed -e '\''s%^.*/\([^/]*\)\.ixlibrary$%\1%'\''`; test $rm /sys/libs/${libname}_ixlibrary.a; $show "(cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a)"; (cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a) || exit 1; done'
+  ;;
+
+beos*)
+  library_names_spec='${libname}.so'
+  dynamic_linker="$host_os ld.so"
+  shlibpath_var=LIBRARY_PATH
+  ;;
+
+bsdi4*)
+  version_type=linux
+  need_version=no
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  soname_spec='${libname}${release}.so$major'
+  finish_cmds='PATH="\$PATH:/sbin" ldconfig $libdir'
+  shlibpath_var=LD_LIBRARY_PATH
+  sys_lib_search_path_spec="/shlib /usr/lib /usr/X11/lib /usr/contrib/lib /lib /usr/local/lib"
+  sys_lib_dlsearch_path_spec="/shlib /usr/lib /usr/local/lib"
+  export_dynamic_flag_spec=-rdynamic
+  # the default ld.so.conf also contains /usr/contrib/lib and
+  # /usr/X11R6/lib (/usr/X11 is a link to /usr/X11R6), but let us allow
+  # libtool to hard-code these into programs
+  ;;
+
+cygwin* | mingw* | pw32*)
+  version_type=windows
+  need_version=no
+  need_lib_prefix=no
+  case $GCC,$host_os in
+  yes,cygwin*)
+    library_names_spec='$libname.dll.a'
+    soname_spec='`echo ${libname} | sed -e 's/^lib/cyg/'``echo ${release} | sed -e 's/[.]/-/g'`${versuffix}.dll'
+    postinstall_cmds='dlpath=`bash 2>&1 -c '\''. $dir/${file}i;echo \$dlname'\''`~
+      dldir=$destdir/`dirname \$dlpath`~
+      test -d \$dldir || mkdir -p \$dldir~
+      $install_prog .libs/$dlname \$dldir/$dlname'
+    postuninstall_cmds='dldll=`bash 2>&1 -c '\''. $file; echo \$dlname'\''`~
+      dlpath=$dir/\$dldll~
+       $rm \$dlpath'
+    ;;
+  yes,mingw*)
+    library_names_spec='${libname}`echo ${release} | sed -e 's/[.]/-/g'`${versuffix}.dll'
+    sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | sed -e "s/^libraries://" -e "s/;/ /g" -e "s,=/,/,g"`
+    ;;
+  yes,pw32*)
+    library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | sed -e 's/./-/g'`${versuffix}.dll'
+    ;;
+  *)
+    library_names_spec='${libname}`echo ${release} | sed -e 's/[.]/-/g'`${versuffix}.dll $libname.lib'
+    ;;
+  esac
+  dynamic_linker='Win32 ld.exe'
+  # FIXME: first we should search . and the directory the executable is in
+  shlibpath_var=PATH
+  ;;
+
+darwin* | rhapsody*)
+  dynamic_linker="$host_os dyld"
+  version_type=darwin
+  need_lib_prefix=no
+  need_version=no
+  # FIXME: Relying on posixy $() will cause problems for
+  #        cross-compilation, but unfortunately the echo tests do not
+  #        yet detect zsh echo's removal of \ escapes.
+  library_names_spec='${libname}${release}${versuffix}.$(test .$module = .yes && echo so || echo dylib) ${libname}${release}${major}.$(test .$module = .yes && echo so || echo dylib) ${libname}.$(test .$module = .yes && echo so || echo dylib)'
+  soname_spec='${libname}${release}${major}.$(test .$module = .yes && echo so || echo dylib)'
+  shlibpath_overrides_runpath=yes
+  shlibpath_var=DYLD_LIBRARY_PATH
+  ;;
+
+freebsd1*)
+  dynamic_linker=no
+  ;;
+
+freebsd*-gnu*)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  soname_spec='${libname}${release}.so$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=no
+  hardcode_into_libs=yes
+  dynamic_linker='GNU/FreeBSD ld.so'
+  ;;
+
+freebsd*)
+  objformat=`test -x /usr/bin/objformat && /usr/bin/objformat || echo aout`
+  version_type=freebsd-$objformat
+  case $version_type in
+    freebsd-elf*)
+      library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so $libname.so'
+      need_version=no
+      need_lib_prefix=no
+      ;;
+    freebsd-*)
+      library_names_spec='${libname}${release}.so$versuffix $libname.so$versuffix'
+      need_version=yes
+      ;;
+  esac
+  shlibpath_var=LD_LIBRARY_PATH
+  case $host_os in
+  freebsd2*)
+    shlibpath_overrides_runpath=yes
+    ;;
+  *)
+    shlibpath_overrides_runpath=no
+    hardcode_into_libs=yes
+    ;;
+  esac
+  ;;
+
+gnu*)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so${major} ${libname}.so'
+  soname_spec='${libname}${release}.so$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  hardcode_into_libs=yes
+  ;;
+
+hpux9* | hpux10* | hpux11*)
+  # Give a soname corresponding to the major version so that dld.sl refuses to
+  # link against other versions.
+  dynamic_linker="$host_os dld.sl"
+  version_type=sunos
+  need_lib_prefix=no
+  need_version=no
+  shlibpath_var=SHLIB_PATH
+  shlibpath_overrides_runpath=no # +s is required to enable SHLIB_PATH
+  library_names_spec='${libname}${release}.sl$versuffix ${libname}${release}.sl$major $libname.sl'
+  soname_spec='${libname}${release}.sl$major'
+  # HP-UX runs *really* slowly unless shared libraries are mode 555.
+  postinstall_cmds='chmod 555 $lib'
+  ;;
+
+irix5* | irix6* | nonstopux*)
+  case $host_os in
+    nonstopux*) version_type=nonstopux ;;
+    *)          version_type=irix ;;
+  esac
+  need_lib_prefix=no
+  need_version=no
+  soname_spec='${libname}${release}.so$major'
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major ${libname}${release}.so $libname.so'
+  case $host_os in
+  irix5* | nonstopux*)
+    libsuff= shlibsuff=
+    ;;
+  *)
+    case $LD in # libtool.m4 will add one of these switches to LD
+    *-32|*"-32 ") libsuff= shlibsuff= libmagic=32-bit;;
+    *-n32|*"-n32 ") libsuff=32 shlibsuff=N32 libmagic=N32;;
+    *-64|*"-64 ") libsuff=64 shlibsuff=64 libmagic=64-bit;;
+    *) libsuff= shlibsuff= libmagic=never-match;;
+    esac
+    ;;
+  esac
+  shlibpath_var=LD_LIBRARY${shlibsuff}_PATH
+  shlibpath_overrides_runpath=no
+  sys_lib_search_path_spec="/usr/lib${libsuff} /lib${libsuff} /usr/local/lib${libsuff}"
+  sys_lib_dlsearch_path_spec="/usr/lib${libsuff} /lib${libsuff}"
+  ;;
+
+# No shared lib support for Linux oldld, aout, or coff.
+linux-gnuoldld* | linux-gnuaout* | linux-gnucoff*)
+  dynamic_linker=no
+  ;;
+
+# This must be Linux ELF.
+linux-gnu*)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  soname_spec='${libname}${release}.so$major'
+  finish_cmds='PATH="\$PATH:/sbin" ldconfig -n $libdir'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=no
+  # This implies no fast_install, which is unacceptable.
+  # Some rework will be needed to allow for fast_install
+  # before this can be enabled.
+  hardcode_into_libs=yes
+
+  # We used to test for /lib/ld.so.1 and disable shared libraries on
+  # powerpc, because MkLinux only supported shared libraries with the
+  # GNU dynamic linker.  Since this was broken with cross compilers,
+  # most powerpc-linux boxes support dynamic linking these days and
+  # people can always --disable-shared, the test was removed, and we
+  # assume the GNU/Linux dynamic linker is in use.
+  dynamic_linker='GNU/Linux ld.so'
+  ;;
+
+netbsd*)
+  version_type=sunos
+  need_lib_prefix=no
+  need_version=no
+  if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
+    library_names_spec='${libname}${release}.so$versuffix ${libname}.so$versuffix'
+    finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
+    dynamic_linker='NetBSD (a.out) ld.so'
+  else
+    library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major ${libname}${release}.so ${libname}.so'
+    soname_spec='${libname}${release}.so$major'
+    dynamic_linker='NetBSD ld.elf_so'
+  fi
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=yes
+  hardcode_into_libs=yes
+  ;;
+
+newsos6)
+  version_type=linux
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=yes
+  ;;
+
+openbsd*)
+  version_type=sunos
+  need_lib_prefix=no
+  need_version=no
+  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+    case "$host_os" in
+    openbsd2.[89] | openbsd2.[89].*)
+      shlibpath_overrides_runpath=no
+      ;;
+    *)
+      shlibpath_overrides_runpath=yes
+      ;;
+    esac
+  else
+    shlibpath_overrides_runpath=yes
+  fi
+  library_names_spec='${libname}${release}.so$versuffix ${libname}.so$versuffix'
+  finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
+  shlibpath_var=LD_LIBRARY_PATH
+  ;;
+
+os2*)
+  libname_spec='$name'
+  need_lib_prefix=no
+  library_names_spec='$libname.dll $libname.a'
+  dynamic_linker='OS/2 ld.exe'
+  shlibpath_var=LIBPATH
+  ;;
+
+osf3* | osf4* | osf5*)
+  version_type=osf
+  need_version=no
+  need_lib_prefix=no
+  soname_spec='${libname}${release}.so$major'
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  shlibpath_var=LD_LIBRARY_PATH
+  sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
+  sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
+  hardcode_into_libs=yes
+  ;;
+
+sco3.2v5*)
+  version_type=osf
+  soname_spec='${libname}${release}.so$major'
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  shlibpath_var=LD_LIBRARY_PATH
+  ;;
+
+solaris*)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  soname_spec='${libname}${release}.so$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=yes
+  hardcode_into_libs=yes
+  # ldd complains unless libraries are executable
+  postinstall_cmds='chmod +x $lib'
+  ;;
+
+sunos4*)
+  version_type=sunos
+  library_names_spec='${libname}${release}.so$versuffix ${libname}.so$versuffix'
+  finish_cmds='PATH="\$PATH:/usr/etc" ldconfig $libdir'
+  shlibpath_var=LD_LIBRARY_PATH
+  shlibpath_overrides_runpath=yes
+  if test "$with_gnu_ld" = yes; then
+    need_lib_prefix=no
+  fi
+  need_version=yes
+  ;;
+
+sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)
+  version_type=linux
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  soname_spec='${libname}${release}.so$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  case $host_vendor in
+    sni)
+      shlibpath_overrides_runpath=no
+      need_lib_prefix=no
+      export_dynamic_flag_spec='${wl}-Blargedynsym'
+      runpath_var=LD_RUN_PATH
+      ;;
+    siemens)
+      need_lib_prefix=no
+      ;;
+    motorola)
+      need_lib_prefix=no
+      need_version=no
+      shlibpath_overrides_runpath=no
+      sys_lib_search_path_spec='/lib /usr/lib /usr/ccs/lib'
+      ;;
+  esac
+  ;;
+
+uts4*)
+  version_type=linux
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  soname_spec='${libname}${release}.so$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  ;;
+
+dgux*)
+  version_type=linux
+  need_lib_prefix=no
+  need_version=no
+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'
+  soname_spec='${libname}${release}.so$major'
+  shlibpath_var=LD_LIBRARY_PATH
+  ;;
+
+sysv4*MP*)
+  if test -d /usr/nec ;then
+    version_type=linux
+    library_names_spec='$libname.so.$versuffix $libname.so.$major $libname.so'
+    soname_spec='$libname.so.$major'
+    shlibpath_var=LD_LIBRARY_PATH
+  fi
+  ;;
+
+*)
+  dynamic_linker=no
+  ;;
+esac
+echo "$ac_t""$dynamic_linker" 1>&6
+test "$dynamic_linker" = no && can_build_shared=no
+
+# Report the final consequences.
+echo $ac_n "checking if libtool supports shared libraries""... $ac_c" 1>&6
+echo "configure:4288: checking if libtool supports shared libraries" >&5
+echo "$ac_t""$can_build_shared" 1>&6
+
+echo $ac_n "checking whether to build shared libraries""... $ac_c" 1>&6
+echo "configure:4292: checking whether to build shared libraries" >&5
+test "$can_build_shared" = "no" && enable_shared=no
+
+# On AIX, shared libraries and static libraries use the same namespace, and
+# are all built from PIC.
+case "$host_os" in
+aix3*)
+  test "$enable_shared" = yes && enable_static=no
+  if test -n "$RANLIB"; then
+    archive_cmds="$archive_cmds~\$RANLIB \$lib"
+    postinstall_cmds='$RANLIB $lib'
+  fi
+  ;;
+
+aix4*)
+  if test "$host_cpu" != ia64 && test "$aix_use_runtimelinking" = no ; then
+    test "$enable_shared" = yes && enable_static=no
+  fi
+  ;;
+esac
+echo "$ac_t""$enable_shared" 1>&6
+
+echo $ac_n "checking whether to build static libraries""... $ac_c" 1>&6
+echo "configure:4315: checking whether to build static libraries" >&5
+# Make sure either enable_shared or enable_static is yes.
+test "$enable_shared" = yes || enable_static=yes
+echo "$ac_t""$enable_static" 1>&6
+
+if test "$hardcode_action" = relink; then
+  # Fast installation is not supported
+  enable_fast_install=no
+elif test "$shlibpath_overrides_runpath" = yes ||
+     test "$enable_shared" = no; then
+  # Fast installation is not necessary
+  enable_fast_install=needless
+fi
+
+variables_saved_for_relink="PATH $shlibpath_var $runpath_var"
+if test "$GCC" = yes; then
+  variables_saved_for_relink="$variables_saved_for_relink GCC_EXEC_PREFIX COMPILER_PATH LIBRARY_PATH"
+fi
+
+if test "x$enable_dlopen" != xyes; then
+  enable_dlopen=unknown
+  enable_dlopen_self=unknown
+  enable_dlopen_self_static=unknown
+else
+  lt_cv_dlopen=no
+  lt_cv_dlopen_libs=
+
+  case $host_os in
+  beos*)
+    lt_cv_dlopen="load_add_on"
+    lt_cv_dlopen_libs=
+    lt_cv_dlopen_self=yes
+    ;;
+
+  cygwin* | mingw* | pw32*)
+    lt_cv_dlopen="LoadLibrary"
+    lt_cv_dlopen_libs=
+   ;;
+
+  *)
+    echo $ac_n "checking for shl_load""... $ac_c" 1>&6
+echo "configure:4356: checking for shl_load" >&5
+if eval "test \"`echo '$''{'ac_cv_func_shl_load'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
   cat > conftest.$ac_ext <<EOF
-#line 1565 "configure"
+#line 4361 "configure"
 #include "confdefs.h"
+/* System header to define __stub macros and hopefully few prototypes,
+    which can conflict with char shl_load(); below.  */
 #include <assert.h>
-Syntax Error
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char shl_load();
+
+int main() {
+
+/* The GNU C library defines this for functions which it implements
+    to always fail with ENOSYS.  Some functions are actually named
+    something starting with __ and the normal name is an alias.  */
+#if defined (__stub_shl_load) || defined (__stub___shl_load)
+choke me
+#else
+shl_load();
+#endif
+
+; return 0; }
 EOF
-ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1571: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
-ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
-if test -z "$ac_err"; then
-  :
+if { (eval echo configure:4384: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_func_shl_load=yes"
 else
-  echo "$ac_err" >&5
   echo "configure: failed program was:" >&5
   cat conftest.$ac_ext >&5
   rm -rf conftest*
-  CPP="${CC-cc} -nologo -E"
+  eval "ac_cv_func_shl_load=no"
+fi
+rm -f conftest*
+fi
+
+if eval "test \"`echo '$ac_cv_func_'shl_load`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  lt_cv_dlopen="shl_load"
+else
+  echo "$ac_t""no" 1>&6
+echo $ac_n "checking for shl_load in -ldld""... $ac_c" 1>&6
+echo "configure:4402: checking for shl_load in -ldld" >&5
+ac_lib_var=`echo dld'_'shl_load | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-ldld  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 4410 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char shl_load();
+
+int main() {
+shl_load()
+; return 0; }
+EOF
+if { (eval echo configure:4421: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  lt_cv_dlopen="shl_load" lt_cv_dlopen_libs="-dld"
+else
+  echo "$ac_t""no" 1>&6
+echo $ac_n "checking for dlopen""... $ac_c" 1>&6
+echo "configure:4440: checking for dlopen" >&5
+if eval "test \"`echo '$''{'ac_cv_func_dlopen'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
   cat > conftest.$ac_ext <<EOF
-#line 1582 "configure"
+#line 4445 "configure"
 #include "confdefs.h"
+/* System header to define __stub macros and hopefully few prototypes,
+    which can conflict with char dlopen(); below.  */
 #include <assert.h>
-Syntax Error
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char dlopen();
+
+int main() {
+
+/* The GNU C library defines this for functions which it implements
+    to always fail with ENOSYS.  Some functions are actually named
+    something starting with __ and the normal name is an alias.  */
+#if defined (__stub_dlopen) || defined (__stub___dlopen)
+choke me
+#else
+dlopen();
+#endif
+
+; return 0; }
 EOF
-ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1588: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
-ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
-if test -z "$ac_err"; then
-  :
+if { (eval echo configure:4468: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_func_dlopen=yes"
 else
-  echo "$ac_err" >&5
   echo "configure: failed program was:" >&5
   cat conftest.$ac_ext >&5
   rm -rf conftest*
-  CPP=/lib/cpp
+  eval "ac_cv_func_dlopen=no"
 fi
 rm -f conftest*
 fi
+
+if eval "test \"`echo '$ac_cv_func_'dlopen`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  lt_cv_dlopen="dlopen"
+else
+  echo "$ac_t""no" 1>&6
+echo $ac_n "checking for dlopen in -ldl""... $ac_c" 1>&6
+echo "configure:4486: checking for dlopen in -ldl" >&5
+ac_lib_var=`echo dl'_'dlopen | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-ldl  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 4494 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char dlopen();
+
+int main() {
+dlopen()
+; return 0; }
+EOF
+if { (eval echo configure:4505: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
 rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-ldl"
+else
+  echo "$ac_t""no" 1>&6
+echo $ac_n "checking for dlopen in -lsvld""... $ac_c" 1>&6
+echo "configure:4524: checking for dlopen in -lsvld" >&5
+ac_lib_var=`echo svld'_'dlopen | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-lsvld  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 4532 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char dlopen();
+
+int main() {
+dlopen()
+; return 0; }
+EOF
+if { (eval echo configure:4543: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
 fi
 rm -f conftest*
-  ac_cv_prog_CPP="$CPP"
+LIBS="$ac_save_LIBS"
+
 fi
-  CPP="$ac_cv_prog_CPP"
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-lsvld"
 else
-  ac_cv_prog_CPP="$CPP"
+  echo "$ac_t""no" 1>&6
+echo $ac_n "checking for dld_link in -ldld""... $ac_c" 1>&6
+echo "configure:4562: checking for dld_link in -ldld" >&5
+ac_lib_var=`echo dld'_'dld_link | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-ldld  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 4570 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char dld_link();
+
+int main() {
+dld_link()
+; return 0; }
+EOF
+if { (eval echo configure:4581: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
 fi
-echo "$ac_t""$CPP" 1>&6
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  lt_cv_dlopen="dld_link" lt_cv_dlopen_libs="-dld"
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+	      
+fi
+
+	    
+fi
+
+	  
+fi
+
+	
+fi
+
+      
+fi
+
+    ;;
+  esac
+
+  if test "x$lt_cv_dlopen" != xno; then
+    enable_dlopen=yes
+  else
+    enable_dlopen=no
+  fi
+
+  case $lt_cv_dlopen in
+  dlopen)
+    save_CPPFLAGS="$CPPFLAGS"
+        test "x$ac_cv_header_dlfcn_h" = xyes && CPPFLAGS="$CPPFLAGS -DHAVE_DLFCN_H"
+
+    save_LDFLAGS="$LDFLAGS"
+    eval LDFLAGS=\"\$LDFLAGS $export_dynamic_flag_spec\"
+
+    save_LIBS="$LIBS"
+    LIBS="$lt_cv_dlopen_libs $LIBS"
+
+    echo $ac_n "checking whether a program can dlopen itself""... $ac_c" 1>&6
+echo "configure:4637: checking whether a program can dlopen itself" >&5
+if eval "test \"`echo '$''{'lt_cv_dlopen_self'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  	  if test "$cross_compiling" = yes; then :
+  lt_cv_dlopen_self=cross
+else
+    lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
+  lt_status=$lt_dlunknown
+  cat > conftest.$ac_ext <<EOF
+#line 4647 "configure"
+#include "confdefs.h"
+
+#if HAVE_DLFCN_H
+#include <dlfcn.h>
+#endif
+
+#include <stdio.h>
+
+#ifdef RTLD_GLOBAL
+#  define LT_DLGLOBAL		RTLD_GLOBAL
+#else
+#  ifdef DL_GLOBAL
+#    define LT_DLGLOBAL		DL_GLOBAL
+#  else
+#    define LT_DLGLOBAL		0
+#  endif
+#endif
+
+/* We may have to define LT_DLLAZY_OR_NOW in the command line if we
+   find out it does not work in some platform. */
+#ifndef LT_DLLAZY_OR_NOW
+#  ifdef RTLD_LAZY
+#    define LT_DLLAZY_OR_NOW		RTLD_LAZY
+#  else
+#    ifdef DL_LAZY
+#      define LT_DLLAZY_OR_NOW		DL_LAZY
+#    else
+#      ifdef RTLD_NOW
+#        define LT_DLLAZY_OR_NOW	RTLD_NOW
+#      else
+#        ifdef DL_NOW
+#          define LT_DLLAZY_OR_NOW	DL_NOW
+#        else
+#          define LT_DLLAZY_OR_NOW	0
+#        endif
+#      endif
+#    endif
+#  endif
+#endif
+
+#ifdef __cplusplus
+extern "C" void exit (int);
+#endif
+
+void fnord() { int i=42;}
+int main ()
+{
+  void *self = dlopen (0, LT_DLGLOBAL|LT_DLLAZY_OR_NOW);
+  int status = $lt_dlunknown;
+
+  if (self)
+    {
+      if (dlsym (self,"fnord"))       status = $lt_dlno_uscore;
+      else if (dlsym( self,"_fnord")) status = $lt_dlneed_uscore;
+      /* dlclose (self); */
+    }
+
+    exit (status);
+}
+EOF
+  if { (eval echo configure:4708: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} 2>/dev/null; then
+    (./conftest; exit; ) 2>/dev/null
+    lt_status=$?
+    case x$lt_status in
+      x$lt_dlno_uscore) lt_cv_dlopen_self=yes ;;
+      x$lt_dlneed_uscore) lt_cv_dlopen_self=yes ;;
+      x$lt_unknown|x*) lt_cv_dlopen_self=no ;;
+    esac
+  else :
+    # compilation failed
+    lt_cv_dlopen_self=no
+  fi
+fi
+rm -fr conftest*
+
+    
+fi
+
+echo "$ac_t""$lt_cv_dlopen_self" 1>&6
+
+    if test "x$lt_cv_dlopen_self" = xyes; then
+      LDFLAGS="$LDFLAGS $link_static_flag"
+      echo $ac_n "checking whether a statically linked program can dlopen itself""... $ac_c" 1>&6
+echo "configure:4731: checking whether a statically linked program can dlopen itself" >&5
+if eval "test \"`echo '$''{'lt_cv_dlopen_self_static'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  	  if test "$cross_compiling" = yes; then :
+  lt_cv_dlopen_self_static=cross
+else
+    lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
+  lt_status=$lt_dlunknown
+  cat > conftest.$ac_ext <<EOF
+#line 4741 "configure"
+#include "confdefs.h"
+
+#if HAVE_DLFCN_H
+#include <dlfcn.h>
+#endif
+
+#include <stdio.h>
+
+#ifdef RTLD_GLOBAL
+#  define LT_DLGLOBAL		RTLD_GLOBAL
+#else
+#  ifdef DL_GLOBAL
+#    define LT_DLGLOBAL		DL_GLOBAL
+#  else
+#    define LT_DLGLOBAL		0
+#  endif
+#endif
+
+/* We may have to define LT_DLLAZY_OR_NOW in the command line if we
+   find out it does not work in some platform. */
+#ifndef LT_DLLAZY_OR_NOW
+#  ifdef RTLD_LAZY
+#    define LT_DLLAZY_OR_NOW		RTLD_LAZY
+#  else
+#    ifdef DL_LAZY
+#      define LT_DLLAZY_OR_NOW		DL_LAZY
+#    else
+#      ifdef RTLD_NOW
+#        define LT_DLLAZY_OR_NOW	RTLD_NOW
+#      else
+#        ifdef DL_NOW
+#          define LT_DLLAZY_OR_NOW	DL_NOW
+#        else
+#          define LT_DLLAZY_OR_NOW	0
+#        endif
+#      endif
+#    endif
+#  endif
+#endif
+
+#ifdef __cplusplus
+extern "C" void exit (int);
+#endif
+
+void fnord() { int i=42;}
+int main ()
+{
+  void *self = dlopen (0, LT_DLGLOBAL|LT_DLLAZY_OR_NOW);
+  int status = $lt_dlunknown;
+
+  if (self)
+    {
+      if (dlsym (self,"fnord"))       status = $lt_dlno_uscore;
+      else if (dlsym( self,"_fnord")) status = $lt_dlneed_uscore;
+      /* dlclose (self); */
+    }
+
+    exit (status);
+}
+EOF
+  if { (eval echo configure:4802: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} 2>/dev/null; then
+    (./conftest; exit; ) 2>/dev/null
+    lt_status=$?
+    case x$lt_status in
+      x$lt_dlno_uscore) lt_cv_dlopen_self_static=yes ;;
+      x$lt_dlneed_uscore) lt_cv_dlopen_self_static=yes ;;
+      x$lt_unknown|x*) lt_cv_dlopen_self_static=no ;;
+    esac
+  else :
+    # compilation failed
+    lt_cv_dlopen_self_static=no
+  fi
+fi
+rm -fr conftest*
+
+      
+fi
+
+echo "$ac_t""$lt_cv_dlopen_self_static" 1>&6
+    fi
+
+    CPPFLAGS="$save_CPPFLAGS"
+    LDFLAGS="$save_LDFLAGS"
+    LIBS="$save_LIBS"
+    ;;
+  esac
+
+  case $lt_cv_dlopen_self in
+  yes|no) enable_dlopen_self=$lt_cv_dlopen_self ;;
+  *) enable_dlopen_self=unknown ;;
+  esac
+
+  case $lt_cv_dlopen_self_static in
+  yes|no) enable_dlopen_self_static=$lt_cv_dlopen_self_static ;;
+  *) enable_dlopen_self_static=unknown ;;
+  esac
+fi
+
+
+if test "$enable_shared" = yes && test "$GCC" = yes; then
+  case $archive_cmds in
+  *'~'*)
+    # FIXME: we may have to deal with multi-command sequences.
+    ;;
+  '$CC '*)
+    # Test whether the compiler implicitly links with -lc since on some
+    # systems, -lgcc has to come before -lc. If gcc already passes -lc
+    # to ld, don't add -lc before -lgcc.
+    echo $ac_n "checking whether -lc should be explicitly linked in""... $ac_c" 1>&6
+echo "configure:4851: checking whether -lc should be explicitly linked in" >&5
+    if eval "test \"`echo '$''{'lt_cv_archive_cmds_need_lc'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  $rm conftest*
+    echo 'static int dummy;' > conftest.$ac_ext
+
+    if { (eval echo configure:4858: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+      soname=conftest
+      lib=conftest
+      libobjs=conftest.$ac_objext
+      deplibs=
+      wl=$lt_cv_prog_cc_wl
+      compiler_flags=-v
+      linker_flags=-v
+      verstring=
+      output_objdir=.
+      libname=conftest
+      save_allow_undefined_flag=$allow_undefined_flag
+      allow_undefined_flag=
+      if { (eval echo configure:4871: \"$archive_cmds 2\>\&1 \| grep \" -lc \" \>/dev/null 2\>\&1\") 1>&5; (eval $archive_cmds 2\>\&1 \| grep \" -lc \" \>/dev/null 2\>\&1) 2>&5; }
+      then
+	lt_cv_archive_cmds_need_lc=no
+      else
+	lt_cv_archive_cmds_need_lc=yes
+      fi
+      allow_undefined_flag=$save_allow_undefined_flag
+    else
+      cat conftest.err 1>&5
+    fi
+fi
+
+    echo "$ac_t""$lt_cv_archive_cmds_need_lc" 1>&6
+    ;;
+  esac
+fi
+need_lc=${lt_cv_archive_cmds_need_lc-yes}
+
+# The second clause should only fire when bootstrapping the
+# libtool distribution, otherwise you forgot to ship ltmain.sh
+# with your package, and you will get complaints that there are
+# no rules to generate ltmain.sh.
+if test -f "$ltmain"; then
+  :
+else
+  # If there is no Makefile yet, we rely on a make rule to execute
+  # `config.status --recheck' to rerun these tests and create the
+  # libtool script then.
+  test -f Makefile && make "$ltmain"
+fi
+
+if test -f "$ltmain"; then
+  trap "$rm \"${ofile}T\"; exit 1" 1 2 15
+  $rm -f "${ofile}T"
+
+  echo creating $ofile
+
+  # Now quote all the things that may contain metacharacters while being
+  # careful not to overquote the AC_SUBSTed values.  We take copies of the
+  # variables and quote the copies for generation of the libtool script.
+  for var in echo old_CC old_CFLAGS SED \
+    AR AR_FLAGS CC LD LN_S NM SHELL \
+    reload_flag reload_cmds wl \
+    pic_flag link_static_flag no_builtin_flag export_dynamic_flag_spec \
+    thread_safe_flag_spec whole_archive_flag_spec libname_spec \
+    library_names_spec soname_spec \
+    RANLIB old_archive_cmds old_archive_from_new_cmds old_postinstall_cmds \
+    old_postuninstall_cmds archive_cmds archive_expsym_cmds postinstall_cmds \
+    postuninstall_cmds extract_expsyms_cmds old_archive_from_expsyms_cmds \
+    old_striplib striplib file_magic_cmd export_symbols_cmds \
+    deplibs_check_method allow_undefined_flag no_undefined_flag \
+    finish_cmds finish_eval global_symbol_pipe global_symbol_to_cdecl \
+    global_symbol_to_c_name_address \
+    hardcode_libdir_flag_spec hardcode_libdir_separator  \
+    sys_lib_search_path_spec sys_lib_dlsearch_path_spec \
+    compiler_c_o compiler_o_lo need_locks exclude_expsyms include_expsyms; do
+
+    case $var in
+    reload_cmds | old_archive_cmds | old_archive_from_new_cmds | \
+    old_postinstall_cmds | old_postuninstall_cmds | \
+    export_symbols_cmds | archive_cmds | archive_expsym_cmds | \
+    extract_expsyms_cmds | old_archive_from_expsyms_cmds | \
+    postinstall_cmds | postuninstall_cmds | \
+    finish_cmds | sys_lib_search_path_spec | sys_lib_dlsearch_path_spec)
+      # Double-quote double-evaled strings.
+      eval "lt_$var=\\\"\`\$echo \"X\$$var\" | \$Xsed -e \"\$double_quote_subst\" -e \"\$sed_quote_subst\" -e \"\$delay_variable_subst\"\`\\\""
+      ;;
+    *)
+      eval "lt_$var=\\\"\`\$echo \"X\$$var\" | \$Xsed -e \"\$sed_quote_subst\"\`\\\""
+      ;;
+    esac
+  done
+
+  cat <<__EOF__ > "${ofile}T"
+#! $SHELL
+
+# `$echo "$ofile" | sed 's%^.*/%%'` - Provide generalized library-building support services.
+# Generated automatically by $PROGRAM (GNU $PACKAGE $VERSION$TIMESTAMP)
+# NOTE: Changes made to this file will be lost: look at ltmain.sh.
+#
+# Copyright (C) 1996-2000 Free Software Foundation, Inc.
+# Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996
+#
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful, but
+# WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+# General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+#
+# As a special exception to the GNU General Public License, if you
+# distribute this file as part of a program that contains a
+# configuration script generated by Autoconf, you may include it under
+# the same distribution terms that you use for the rest of that program.
+
+# A sed that does not truncate output.
+SED=$lt_SED
+
+# Sed that helps us avoid accidentally triggering echo(1) options like -n.
+Xsed="${SED} -e s/^X//"
+
+# The HP-UX ksh and POSIX shell print the target directory to stdout
+# if CDPATH is set.
+if test "X\${CDPATH+set}" = Xset; then CDPATH=:; export CDPATH; fi
+
+# ### BEGIN LIBTOOL CONFIG
+
+# Libtool was configured on host `(hostname || uname -n) 2>/dev/null | sed 1q`:
+
+# Shell to use when invoking shell scripts.
+SHELL=$lt_SHELL
+
+# Whether or not to build shared libraries.
+build_libtool_libs=$enable_shared
+
+# Whether or not to build static libraries.
+build_old_libs=$enable_static
+
+# Whether or not to add -lc for building shared libraries.
+build_libtool_need_lc=$need_lc
+
+# Whether or not to optimize for fast installation.
+fast_install=$enable_fast_install
+
+# The host system.
+host_alias=$host_alias
+host=$host
+
+# An echo program that does not interpret backslashes.
+echo=$lt_echo
+
+# The archiver.
+AR=$lt_AR
+AR_FLAGS=$lt_AR_FLAGS
+
+# The default C compiler.
+CC=$lt_CC
+
+# Is the compiler the GNU C compiler?
+with_gcc=$GCC
+
+# The linker used to build libraries.
+LD=$lt_LD
+
+# Whether we need hard or soft links.
+LN_S=$lt_LN_S
+
+# A BSD-compatible nm program.
+NM=$lt_NM
+
+# A symbol stripping program
+STRIP=$STRIP
+
+# Used to examine libraries when file_magic_cmd begins "file"
+MAGIC_CMD=$MAGIC_CMD
+
+# Used on cygwin: DLL creation program.
+DLLTOOL="$DLLTOOL"
+
+# Used on cygwin: object dumper.
+OBJDUMP="$OBJDUMP"
+
+# Used on cygwin: assembler.
+AS="$AS"
+
+# The name of the directory that contains temporary libtool files.
+objdir=$objdir
+
+# How to create reloadable object files.
+reload_flag=$lt_reload_flag
+reload_cmds=$lt_reload_cmds
+
+# How to pass a linker flag through the compiler.
+wl=$lt_wl
+
+# Object file suffix (normally "o").
+objext="$ac_objext"
+
+# Old archive suffix (normally "a").
+libext="$libext"
+
+# Executable file suffix (normally "").
+exeext="$exeext"
+
+# Additional compiler flags for building library objects.
+pic_flag=$lt_pic_flag
+pic_mode=$pic_mode
+
+# Does compiler simultaneously support -c and -o options?
+compiler_c_o=$lt_compiler_c_o
+
+# Can we write directly to a .lo ?
+compiler_o_lo=$lt_compiler_o_lo
+
+# Must we lock files when doing compilation ?
+need_locks=$lt_need_locks
+
+# Do we need the lib prefix for modules?
+need_lib_prefix=$need_lib_prefix
+
+# Do we need a version for libraries?
+need_version=$need_version
+
+# Whether dlopen is supported.
+dlopen_support=$enable_dlopen
+
+# Whether dlopen of programs is supported.
+dlopen_self=$enable_dlopen_self
+
+# Whether dlopen of statically linked programs is supported.
+dlopen_self_static=$enable_dlopen_self_static
+
+# Compiler flag to prevent dynamic linking.
+link_static_flag=$lt_link_static_flag
+
+# Compiler flag to turn off builtin functions.
+no_builtin_flag=$lt_no_builtin_flag
+
+# Compiler flag to allow reflexive dlopens.
+export_dynamic_flag_spec=$lt_export_dynamic_flag_spec
+
+# Compiler flag to generate shared objects directly from archives.
+whole_archive_flag_spec=$lt_whole_archive_flag_spec
+
+# Compiler flag to generate thread-safe objects.
+thread_safe_flag_spec=$lt_thread_safe_flag_spec
+
+# Library versioning type.
+version_type=$version_type
+
+# Format of library name prefix.
+libname_spec=$lt_libname_spec
+
+# List of archive names.  First name is the real one, the rest are links.
+# The last name is the one that the linker finds with -lNAME.
+library_names_spec=$lt_library_names_spec
+
+# The coded name of the library, if different from the real name.
+soname_spec=$lt_soname_spec
+
+# Commands used to build and install an old-style archive.
+RANLIB=$lt_RANLIB
+old_archive_cmds=$lt_old_archive_cmds
+old_postinstall_cmds=$lt_old_postinstall_cmds
+old_postuninstall_cmds=$lt_old_postuninstall_cmds
+
+# Create an old-style archive from a shared archive.
+old_archive_from_new_cmds=$lt_old_archive_from_new_cmds
+
+# Create a temporary old-style archive to link instead of a shared archive.
+old_archive_from_expsyms_cmds=$lt_old_archive_from_expsyms_cmds
+
+# Commands used to build and install a shared archive.
+archive_cmds=$lt_archive_cmds
+archive_expsym_cmds=$lt_archive_expsym_cmds
+postinstall_cmds=$lt_postinstall_cmds
+postuninstall_cmds=$lt_postuninstall_cmds
+
+# Commands to strip libraries.
+old_striplib=$lt_old_striplib
+striplib=$lt_striplib
+
+# Method to check whether dependent libraries are shared objects.
+deplibs_check_method=$lt_deplibs_check_method
+
+# Command to use when deplibs_check_method == file_magic.
+file_magic_cmd=$lt_file_magic_cmd
+
+# Flag that allows shared libraries with undefined symbols to be built.
+allow_undefined_flag=$lt_allow_undefined_flag
+
+# Flag that forces no undefined symbols.
+no_undefined_flag=$lt_no_undefined_flag
+
+# Commands used to finish a libtool library installation in a directory.
+finish_cmds=$lt_finish_cmds
+
+# Same as above, but a single script fragment to be evaled but not shown.
+finish_eval=$lt_finish_eval
+
+# Take the output of nm and produce a listing of raw symbols and C names.
+global_symbol_pipe=$lt_global_symbol_pipe
+
+# Transform the output of nm in a proper C declaration
+global_symbol_to_cdecl=$lt_global_symbol_to_cdecl
+
+# Transform the output of nm in a C name address pair
+global_symbol_to_c_name_address=$lt_global_symbol_to_c_name_address
+
+# This is the shared library runtime path variable.
+runpath_var=$runpath_var
+
+# This is the shared library path variable.
+shlibpath_var=$shlibpath_var
+
+# Is shlibpath searched before the hard-coded library search path?
+shlibpath_overrides_runpath=$shlibpath_overrides_runpath
+
+# How to hardcode a shared library path into an executable.
+hardcode_action=$hardcode_action
+
+# Whether we should hardcode library paths into libraries.
+hardcode_into_libs=$hardcode_into_libs
+
+# Flag to hardcode \$libdir into a binary during linking.
+# This must work even if \$libdir does not exist.
+hardcode_libdir_flag_spec=$lt_hardcode_libdir_flag_spec
+
+# Whether we need a single -rpath flag with a separated argument.
+hardcode_libdir_separator=$lt_hardcode_libdir_separator
+
+# Set to yes if using DIR/libNAME.so during linking hardcodes DIR into the
+# resulting binary.
+hardcode_direct=$hardcode_direct
+
+# Set to yes if using the -LDIR flag during linking hardcodes DIR into the
+# resulting binary.
+hardcode_minus_L=$hardcode_minus_L
+
+# Set to yes if using SHLIBPATH_VAR=DIR during linking hardcodes DIR into
+# the resulting binary.
+hardcode_shlibpath_var=$hardcode_shlibpath_var
+
+# Variables whose values should be saved in libtool wrapper scripts and
+# restored at relink time.
+variables_saved_for_relink="$variables_saved_for_relink"
+
+# Whether libtool must link a program against all its dependency libraries.
+link_all_deplibs=$link_all_deplibs
+
+# Compile-time system search path for libraries
+sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
+
+# Run-time system search path for libraries
+sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
+
+# Fix the shell variable \$srcfile for the compiler.
+fix_srcfile_path="$fix_srcfile_path"
+
+# Set to yes if exported symbols are required.
+always_export_symbols=$always_export_symbols
+
+# The commands to list exported symbols.
+export_symbols_cmds=$lt_export_symbols_cmds
+
+# The commands to extract the exported symbol list from a shared archive.
+extract_expsyms_cmds=$lt_extract_expsyms_cmds
+
+# Symbols that should not be listed in the preloaded symbols.
+exclude_expsyms=$lt_exclude_expsyms
+
+# Symbols that must always be exported.
+include_expsyms=$lt_include_expsyms
+
+# ### END LIBTOOL CONFIG
+
+__EOF__
+
+  case $host_os in
+  aix3*)
+    cat <<\EOF >> "${ofile}T"
+
+# AIX sometimes has problems with the GCC collect2 program.  For some
+# reason, if we set the COLLECT_NAMES environment variable, the problems
+# vanish in a puff of smoke.
+if test "X${COLLECT_NAMES+set}" != Xset; then
+  COLLECT_NAMES=
+  export COLLECT_NAMES
+fi
+EOF
+    ;;
+  esac
+
+  case $host_os in
+  cygwin* | mingw* | pw32* | os2*)
+    cat <<'EOF' >> "${ofile}T"
+      # This is a source program that is used to create dlls on Windows
+      # Don't remove nor modify the starting and closing comments
+# /* ltdll.c starts here */
+# #define WIN32_LEAN_AND_MEAN
+# #include <windows.h>
+# #undef WIN32_LEAN_AND_MEAN
+# #include <stdio.h>
+#
+# #ifndef __CYGWIN__
+# #  ifdef __CYGWIN32__
+# #    define __CYGWIN__ __CYGWIN32__
+# #  endif
+# #endif
+#
+# #ifdef __cplusplus
+# extern "C" {
+# #endif
+# BOOL APIENTRY DllMain (HINSTANCE hInst, DWORD reason, LPVOID reserved);
+# #ifdef __cplusplus
+# }
+# #endif
+#
+# #ifdef __CYGWIN__
+# #include <cygwin/cygwin_dll.h>
+# DECLARE_CYGWIN_DLL( DllMain );
+# #endif
+# HINSTANCE __hDllInstance_base;
+#
+# BOOL APIENTRY
+# DllMain (HINSTANCE hInst, DWORD reason, LPVOID reserved)
+# {
+#   __hDllInstance_base = hInst;
+#   return TRUE;
+# }
+# /* ltdll.c ends here */
+	# This is a source program that is used to create import libraries
+	# on Windows for dlls which lack them. Don't remove nor modify the
+	# starting and closing comments
+# /* impgen.c starts here */
+# /*   Copyright (C) 1999-2000 Free Software Foundation, Inc.
+#
+#  This file is part of GNU libtool.
+#
+#  This program is free software; you can redistribute it and/or modify
+#  it under the terms of the GNU General Public License as published by
+#  the Free Software Foundation; either version 2 of the License, or
+#  (at your option) any later version.
+#
+#  This program is distributed in the hope that it will be useful,
+#  but WITHOUT ANY WARRANTY; without even the implied warranty of
+#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+#  GNU General Public License for more details.
+#
+#  You should have received a copy of the GNU General Public License
+#  along with this program; if not, write to the Free Software
+#  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+#  */
+#
+# #include <stdio.h>		/* for printf() */
+# #include <unistd.h>		/* for open(), lseek(), read() */
+# #include <fcntl.h>		/* for O_RDONLY, O_BINARY */
+# #include <string.h>		/* for strdup() */
+#
+# /* O_BINARY isn't required (or even defined sometimes) under Unix */
+# #ifndef O_BINARY
+# #define O_BINARY 0
+# #endif
+#
+# static unsigned int
+# pe_get16 (fd, offset)
+#      int fd;
+#      int offset;
+# {
+#   unsigned char b[2];
+#   lseek (fd, offset, SEEK_SET);
+#   read (fd, b, 2);
+#   return b[0] + (b[1]<<8);
+# }
+#
+# static unsigned int
+# pe_get32 (fd, offset)
+#     int fd;
+#     int offset;
+# {
+#   unsigned char b[4];
+#   lseek (fd, offset, SEEK_SET);
+#   read (fd, b, 4);
+#   return b[0] + (b[1]<<8) + (b[2]<<16) + (b[3]<<24);
+# }
+#
+# static unsigned int
+# pe_as32 (ptr)
+#      void *ptr;
+# {
+#   unsigned char *b = ptr;
+#   return b[0] + (b[1]<<8) + (b[2]<<16) + (b[3]<<24);
+# }
+#
+# int
+# main (argc, argv)
+#     int argc;
+#     char *argv[];
+# {
+#     int dll;
+#     unsigned long pe_header_offset, opthdr_ofs, num_entries, i;
+#     unsigned long export_rva, export_size, nsections, secptr, expptr;
+#     unsigned long name_rvas, nexp;
+#     unsigned char *expdata, *erva;
+#     char *filename, *dll_name;
+#
+#     filename = argv[1];
+#
+#     dll = open(filename, O_RDONLY|O_BINARY);
+#     if (dll < 1)
+# 	return 1;
+#
+#     dll_name = filename;
+#
+#     for (i=0; filename[i]; i++)
+# 	if (filename[i] == '/' || filename[i] == '\\'  || filename[i] == ':')
+# 	    dll_name = filename + i +1;
+#
+#     pe_header_offset = pe_get32 (dll, 0x3c);
+#     opthdr_ofs = pe_header_offset + 4 + 20;
+#     num_entries = pe_get32 (dll, opthdr_ofs + 92);
+#
+#     if (num_entries < 1) /* no exports */
+# 	return 1;
+#
+#     export_rva = pe_get32 (dll, opthdr_ofs + 96);
+#     export_size = pe_get32 (dll, opthdr_ofs + 100);
+#     nsections = pe_get16 (dll, pe_header_offset + 4 +2);
+#     secptr = (pe_header_offset + 4 + 20 +
+# 	      pe_get16 (dll, pe_header_offset + 4 + 16));
+#
+#     expptr = 0;
+#     for (i = 0; i < nsections; i++)
+#     {
+# 	char sname[8];
+# 	unsigned long secptr1 = secptr + 40 * i;
+# 	unsigned long vaddr = pe_get32 (dll, secptr1 + 12);
+# 	unsigned long vsize = pe_get32 (dll, secptr1 + 16);
+# 	unsigned long fptr = pe_get32 (dll, secptr1 + 20);
+# 	lseek(dll, secptr1, SEEK_SET);
+# 	read(dll, sname, 8);
+# 	if (vaddr <= export_rva && vaddr+vsize > export_rva)
+# 	{
+# 	    expptr = fptr + (export_rva - vaddr);
+# 	    if (export_rva + export_size > vaddr + vsize)
+# 		export_size = vsize - (export_rva - vaddr);
+# 	    break;
+# 	}
+#     }
+#
+#     expdata = (unsigned char*)malloc(export_size);
+#     lseek (dll, expptr, SEEK_SET);
+#     read (dll, expdata, export_size);
+#     erva = expdata - export_rva;
+#
+#     nexp = pe_as32 (expdata+24);
+#     name_rvas = pe_as32 (expdata+32);
+#
+#     printf ("EXPORTS\n");
+#     for (i = 0; i<nexp; i++)
+#     {
+# 	unsigned long name_rva = pe_as32 (erva+name_rvas+i*4);
+# 	printf ("\t%s @ %ld ;\n", erva+name_rva, 1+ i);
+#     }
+#
+#     return 0;
+# }
+# /* impgen.c ends here */
+
+EOF
+    ;;
+  esac
+
+  # We use sed instead of cat because bash on DJGPP gets confused if
+  # if finds mixed CR/LF and LF-only lines.  Since sed operates in
+  # text mode, it properly converts lines to CR/LF.  This bash problem
+  # is reportedly fixed, but why not run on old versions too?
+  sed '$q' "$ltmain" >> "${ofile}T" || (rm -f "${ofile}T"; exit 1)
+
+  mv -f "${ofile}T" "$ofile" || \
+    (rm -f "$ofile" && cp "${ofile}T" "$ofile" && rm -f "${ofile}T")
+  chmod +x "$ofile"
+fi
+
+
+
+
+
+# This can be used to rebuild libtool when needed
+LIBTOOL_DEPS="$ac_aux_dir/ltmain.sh"
+
+# Always use our own libtool.
+LIBTOOL='$(SHELL) $(top_builddir)/libtool'
+
+# Prevent multiple expansion
+
+
+
+echo $ac_n "checking for object suffix""... $ac_c" 1>&6
+echo "configure:5457: checking for object suffix" >&5
+if eval "test \"`echo '$''{'ac_cv_objext'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  rm -f conftest*
+echo 'int i = 1;' > conftest.$ac_ext
+if { (eval echo configure:5463: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  for ac_file in conftest.*; do
+    case $ac_file in
+    *.c) ;;
+    *) ac_cv_objext=`echo $ac_file | sed -e s/conftest.//` ;;
+    esac
+  done
+else
+  { echo "configure: error: installation or configuration problem; compiler does not work" 1>&2; exit 1; }
+fi
+rm -f conftest*
+fi
+
+echo "$ac_t""$ac_cv_objext" 1>&6
+OBJEXT=$ac_cv_objext
+ac_objext=$ac_cv_objext
+
+# Extract the first word of "sed", so it can be a program name with args.
+set dummy sed; ac_word=$2
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:5483: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_path_SED'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  case "$SED" in
+  /*)
+  ac_cv_path_SED="$SED" # Let the user override the test with a path.
+  ;;
+  ?:/*)			 
+  ac_cv_path_SED="$SED" # Let the user override the test with a dos path.
+  ;;
+  *)
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do 
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_path_SED="$ac_dir/$ac_word"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
+  ;;
+esac
+fi
+SED="$ac_cv_path_SED"
+if test -n "$SED"; then
+  echo "$ac_t""$SED" 1>&6
+else
+  echo "$ac_t""no" 1>&6
+fi
+
 
 echo $ac_n "checking for ANSI C header files""... $ac_c" 1>&6
-echo "configure:1613: checking for ANSI C header files" >&5
+echo "configure:5517: checking for ANSI C header files" >&5
 if eval "test \"`echo '$''{'ac_cv_header_stdc'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1618 "configure"
+#line 5522 "configure"
 #include "confdefs.h"
 #include <stdlib.h>
 #include <stdarg.h>
@@ -1622,7 +5526,7 @@
 #include <float.h>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1626: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:5530: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -1639,7 +5543,7 @@
 if test $ac_cv_header_stdc = yes; then
   # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
 cat > conftest.$ac_ext <<EOF
-#line 1643 "configure"
+#line 5547 "configure"
 #include "confdefs.h"
 #include <string.h>
 EOF
@@ -1657,7 +5561,7 @@
 if test $ac_cv_header_stdc = yes; then
   # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
 cat > conftest.$ac_ext <<EOF
-#line 1661 "configure"
+#line 5565 "configure"
 #include "confdefs.h"
 #include <stdlib.h>
 EOF
@@ -1678,7 +5582,7 @@
   :
 else
   cat > conftest.$ac_ext <<EOF
-#line 1682 "configure"
+#line 5586 "configure"
 #include "confdefs.h"
 #include <ctype.h>
 #define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
@@ -1689,7 +5593,7 @@
 exit (0); }
 
 EOF
-if { (eval echo configure:1693: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:5597: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   :
 else
@@ -1716,17 +5620,17 @@
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
-echo "configure:1720: checking for $ac_hdr" >&5
+echo "configure:5624: checking for $ac_hdr" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1725 "configure"
+#line 5629 "configure"
 #include "confdefs.h"
 #include <$ac_hdr>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1730: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:5634: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -1756,17 +5660,17 @@
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
-echo "configure:1760: checking for $ac_hdr" >&5
+echo "configure:5664: checking for $ac_hdr" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1765 "configure"
+#line 5669 "configure"
 #include "confdefs.h"
 #include <$ac_hdr>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1770: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:5674: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -1796,12 +5700,12 @@
 for ac_func in select
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:1800: checking for $ac_func" >&5
+echo "configure:5704: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1805 "configure"
+#line 5709 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -1824,7 +5728,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:1828: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:5732: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -1849,6 +5753,7 @@
 done
 
 
+export SED
 rm -f conftest
 ./libtool --config > conftest
 . ./conftest
@@ -2021,11 +5926,16 @@
 s%@build_cpu@%$build_cpu%g
 s%@build_vendor@%$build_vendor%g
 s%@build_os@%$build_os%g
-s%@RANLIB@%$RANLIB%g
 s%@LN_S@%$LN_S%g
+s%@OBJEXT@%$OBJEXT%g
+s%@EXEEXT@%$EXEEXT%g
+s%@ECHO@%$ECHO%g
+s%@RANLIB@%$RANLIB%g
+s%@STRIP@%$STRIP%g
+s%@CPP@%$CPP%g
 s%@LIBTOOL@%$LIBTOOL%g
 s%@LIBTOOL_DEPS@%$LIBTOOL_DEPS%g
-s%@CPP@%$CPP%g
+s%@SED@%$SED%g
 s%@INSTALL@%$INSTALL%g
 
 CEOF
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/capi20/configure.in isdn4k-utils-v3.3/capi20/configure.in
--- isdn4k-utils-v3.2p1/capi20/configure.in	2001-06-21 16:34:45.000000000 +0000
+++ isdn4k-utils-v3.3/capi20/configure.in	2003-06-16 12:08:23.000000000 +0000
@@ -9,6 +9,8 @@
 AC_PROG_INSTALL
 AM_PROG_LIBTOOL
 AC_SUBST(LIBTOOL_DEPS)
+AC_OBJEXT
+AC_PATH_PROG(SED,sed)
 
 dnl Checks for header files.
 AC_HEADER_STDC
@@ -18,6 +20,7 @@
 dnl Checks for library functions.
 AC_CHECK_FUNCS(select)
 
+export SED
 dnl Read the libtool configuration
 rm -f conftest
 ./libtool --config > conftest
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/capi20/ltmain.sh isdn4k-utils-v3.3/capi20/ltmain.sh
--- isdn4k-utils-v3.2p1/capi20/ltmain.sh	2000-10-05 20:45:24.000000000 +0000
+++ isdn4k-utils-v3.3/capi20/ltmain.sh	2003-06-16 12:08:23.000000000 +0000
@@ -1,7 +1,8 @@
 # ltmain.sh - Provide generalized library-building support services.
-# NOTE: Changing this file will not affect anything until you rerun ltconfig.
+# NOTE: Changing this file will not affect anything until you rerun configure.
 #
-# Copyright (C) 1996-1999 Free Software Foundation, Inc.
+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001
+# Free Software Foundation, Inc.
 # Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996
 #
 # This program is free software; you can redistribute it and/or modify
@@ -48,14 +49,14 @@
 fi
 
 # The name of this program.
-progname=`$echo "$0" | sed 's%^.*/%%'`
+progname=`$echo "$0" | ${SED} 's%^.*/%%'`
 modename="$progname"
 
 # Constants.
 PROGRAM=ltmain.sh
 PACKAGE=libtool
-VERSION=1.3.5
-TIMESTAMP=" (1.385.2.206 2000/05/27 11:12:27)"
+VERSION=1.4.3
+TIMESTAMP=" (1.922.2.111 2002/10/23 02:54:36)"
 
 default_mode=
 help="Try \`$progname --help' for more information."
@@ -66,10 +67,19 @@
 
 # Sed substitution that helps us do robust quoting.  It backslashifies
 # metacharacters that are still active within double-quoted strings.
-Xsed='sed -e 1s/^X//'
+Xsed="${SED}"' -e 1s/^X//'
 sed_quote_subst='s/\([\\`\\"$\\\\]\)/\\\1/g'
-SP2NL='tr \040 \012'
-NL2SP='tr \015\012 \040\040'
+# test EBCDIC or ASCII                                                         
+case `echo A|od -x` in                                                         
+ *[Cc]1*) # EBCDIC based system                                                
+  SP2NL="tr '\100' '\n'"                                                       
+  NL2SP="tr '\r\n' '\100\100'"                                                 
+  ;;                                                                           
+ *) # Assume ASCII based system                                                
+  SP2NL="tr '\040' '\012'"                                                     
+  NL2SP="tr '\015\012' '\040\040'"                                             
+  ;;                                                                           
+esac                                                                           
 
 # NLS nuisances.
 # Only set LANG and LC_ALL to C if already set.
@@ -83,11 +93,8 @@
   save_LANG="$LANG"; LANG=C; export LANG
 fi
 
-if test "$LTCONFIG_VERSION" != "$VERSION"; then
-  echo "$modename: ltconfig version \`$LTCONFIG_VERSION' does not match $PROGRAM version \`$VERSION'" 1>&2
-  echo "Fatal configuration error.  See the $PACKAGE docs for more information." 1>&2
-  exit 1
-fi
+# Make sure IFS has a sensible default
+: ${IFS=" 	"}
 
 if test "$build_libtool_libs" != yes && test "$build_old_libs" != yes; then
   echo "$modename: not configured to build any kind of library" 1>&2
@@ -113,16 +120,16 @@
   arg="$1"
   shift
 
-  case "$arg" in
+  case $arg in
   -*=*) optarg=`$echo "X$arg" | $Xsed -e 's/[-_a-zA-Z0-9]*=//'` ;;
   *) optarg= ;;
   esac
 
   # If the previous option needs an argument, assign it.
   if test -n "$prev"; then
-    case "$prev" in
+    case $prev in
     execute_dlfiles)
-      eval "$prev=\"\$$prev \$arg\""
+      execute_dlfiles="$execute_dlfiles $arg"
       ;;
     *)
       eval "$prev=\$arg"
@@ -135,7 +142,7 @@
   fi
 
   # Have we seen a non-optional argument yet?
-  case "$arg" in
+  case $arg in
   --help)
     show_help=yes
     ;;
@@ -146,7 +153,7 @@
     ;;
 
   --config)
-    sed -e '1,/^### BEGIN LIBTOOL CONFIG/d' -e '/^### END LIBTOOL CONFIG/,$d' $0
+    ${SED} -e '1,/^# ### BEGIN LIBTOOL CONFIG/d' -e '/^# ### END LIBTOOL CONFIG/,$d' $0
     exit 0
     ;;
 
@@ -179,6 +186,8 @@
   --mode) prevopt="--mode" prev=mode ;;
   --mode=*) mode="$optarg" ;;
 
+  --preserve-dup-deps) duplicate_deps="yes" ;;
+
   --quiet | --silent)
     show=:
     ;;
@@ -207,16 +216,21 @@
   exit 1
 fi
 
+# If this variable is set in any of the actions, the command in it
+# will be execed at the end.  This prevents here-documents from being
+# left over by shells.
+exec_cmd=
+
 if test -z "$show_help"; then
 
   # Infer the operation mode.
   if test -z "$mode"; then
-    case "$nonopt" in
-    *cc | *++ | gcc* | *-gcc*)
+    case $nonopt in
+    *cc | *++ | gcc* | *-gcc* | g++* | xlc*)
       mode=link
       for arg
       do
-	case "$arg" in
+	case $arg in
 	-c)
 	   mode=compile
 	   break
@@ -261,12 +275,13 @@
   help="Try \`$modename --help --mode=$mode' for more information."
 
   # These modes are in order of execution frequency so that they run quickly.
-  case "$mode" in
+  case $mode in
   # libtool compile mode
   compile)
     modename="$modename: compile"
     # Get the compilation command and the source file.
     base_compile=
+    prev=
     lastarg=
     srcfile="$nonopt"
     suppress_output=
@@ -274,8 +289,34 @@
     user_target=no
     for arg
     do
+      case $prev in
+      "") ;;
+      xcompiler)
+	# Aesthetically quote the previous argument.
+	prev=
+	lastarg=`$echo "X$arg" | $Xsed -e "$sed_quote_subst"`
+
+	case $arg in
+	# Double-quote args containing other shell metacharacters.
+	# Many Bourne shells cannot handle close brackets correctly
+	# in scan sets, so we specify it separately.
+	*[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+	  arg="\"$arg\""
+	  ;;
+	esac
+
+	# Add the previous argument to base_compile.
+	if test -z "$base_compile"; then
+	  base_compile="$lastarg"
+	else
+	  base_compile="$base_compile $lastarg"
+	fi
+	continue
+	;;
+      esac
+
       # Accept any command-line options.
-      case "$arg" in
+      case $arg in
       -o)
 	if test "$user_target" != "no"; then
 	  $echo "$modename: you cannot specify \`-o' more than once" 1>&2
@@ -288,9 +329,53 @@
 	build_old_libs=yes
 	continue
 	;;
+
+      -prefer-pic)
+	pic_mode=yes
+	continue
+	;;
+
+      -prefer-non-pic)
+	pic_mode=no
+	continue
+	;;
+
+      -Xcompiler)
+	prev=xcompiler
+	continue
+	;;
+
+      -Wc,*)
+	args=`$echo "X$arg" | $Xsed -e "s/^-Wc,//"`
+	lastarg=
+	save_ifs="$IFS"; IFS=','
+	for arg in $args; do
+	  IFS="$save_ifs"
+
+	  # Double-quote args containing other shell metacharacters.
+	  # Many Bourne shells cannot handle close brackets correctly
+	  # in scan sets, so we specify it separately.
+	  case $arg in
+	    *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+	    arg="\"$arg\""
+	    ;;
+	  esac
+	  lastarg="$lastarg $arg"
+	done
+	IFS="$save_ifs"
+	lastarg=`$echo "X$lastarg" | $Xsed -e "s/^ //"`
+
+	# Add the arguments to base_compile.
+	if test -z "$base_compile"; then
+	  base_compile="$lastarg"
+	else
+	  base_compile="$base_compile $lastarg"
+	fi
+	continue
+	;;
       esac
 
-      case "$user_target" in
+      case $user_target in
       next)
 	# The next one is the -o target name
 	user_target=yes
@@ -316,10 +401,10 @@
       lastarg=`$echo "X$lastarg" | $Xsed -e "$sed_quote_subst"`
 
       # Double-quote args containing other shell metacharacters.
-      # Many Bourne shells cannot handle close brackets correctly in scan
-      # sets, so we specify it separately.
-      case "$lastarg" in
-      *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*)
+      # Many Bourne shells cannot handle close brackets correctly
+      # in scan sets, so we specify it separately.
+      case $lastarg in
+      *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
 	lastarg="\"$lastarg\""
 	;;
       esac
@@ -332,7 +417,7 @@
       fi
     done
 
-    case "$user_target" in
+    case $user_target in
     set)
       ;;
     no)
@@ -348,7 +433,7 @@
     # Recognize several different file suffixes.
     # If the user specifies -o file.o, it is replaced with file.lo
     xform='[cCFSfmso]'
-    case "$libobj" in
+    case $libobj in
     *.ada) xform=ada ;;
     *.adb) xform=adb ;;
     *.ads) xform=ads ;;
@@ -363,7 +448,7 @@
 
     libobj=`$echo "X$libobj" | $Xsed -e "s/\.$xform$/.lo/"`
 
-    case "$libobj" in
+    case $libobj in
     *.lo) obj=`$echo "X$libobj" | $Xsed -e "$lo2o"` ;;
     *)
       $echo "$modename: cannot determine name of library object from \`$libobj'" 1>&2
@@ -387,10 +472,21 @@
     $run $rm $removelist
     trap "$run $rm $removelist; exit 1" 1 2 15
 
+    # On Cygwin there's no "real" PIC flag so we must build both object types
+    case $host_os in
+    cygwin* | mingw* | pw32* | os2*)
+      pic_mode=default
+      ;;
+    esac
+    if test "$pic_mode" = no && test "$deplibs_check_method" != pass_all; then
+      # non-PIC code in shared libraries is not supported
+      pic_mode=default
+    fi
+
     # Calculate the filename of the output object if compiler does
     # not support -o with -c
     if test "$compiler_c_o" = no; then
-      output_obj=`$echo "X$srcfile" | $Xsed -e 's%^.*/%%' -e 's%\..*$%%'`.${objext}
+      output_obj=`$echo "X$srcfile" | $Xsed -e 's%^.*/%%' -e 's%\.[^.]*$%%'`.${objext}
       lockfile="$output_obj.lock"
       removelist="$removelist $output_obj $lockfile"
       trap "$run $rm $removelist; exit 1" 1 2 15
@@ -402,7 +498,7 @@
     # Lock this critical section if it is needed
     # We use this script file to make the link, it avoids creating a new file
     if test "$need_locks" = yes; then
-      until ln "$0" "$lockfile" 2>/dev/null; do
+      until $run ln "$0" "$lockfile" 2>/dev/null; do
 	$show "Waiting for $lockfile to be removed"
 	sleep 2
       done
@@ -434,8 +530,13 @@
       # Without this assignment, base_compile gets emptied.
       fbsd_hideous_sh_bug=$base_compile
 
-      # All platforms use -DPIC, to notify preprocessed assembler code.
-      command="$base_compile $srcfile $pic_flag -DPIC"
+      if test "$pic_mode" != no; then
+	# All platforms use -DPIC, to notify preprocessed assembler code.
+	command="$base_compile $srcfile $pic_flag -DPIC"
+      else
+	# Don't build PIC code
+	command="$base_compile $srcfile"
+      fi
       if test "$build_old_libs" = yes; then
 	lo_libobj="$libobj"
 	dir=`$echo "X$libobj" | $Xsed -e 's%/[^/]*$%%'`
@@ -506,7 +607,8 @@
       fi
 
       # If we have no pic_flag, then copy the object into place and finish.
-      if test -z "$pic_flag" && test "$build_old_libs" = yes; then
+      if (test -z "$pic_flag" || test "$pic_mode" != default) &&
+	 test "$build_old_libs" = yes; then
 	# Rename the .lo from within objdir to obj
 	if test -f $obj; then
 	  $show $rm $obj
@@ -532,6 +634,10 @@
 	# Now arrange that obj and lo_libobj become the same file
 	$show "(cd $xdir && $LN_S $baseobj $libobj)"
 	if $run eval '(cd $xdir && $LN_S $baseobj $libobj)'; then
+	  # Unlock the critical section if it was locked
+	  if test "$need_locks" != no; then
+	    $run $rm "$lockfile"
+	  fi
 	  exit 0
 	else
 	  error=$?
@@ -546,7 +652,13 @@
 
     # Only build a position-dependent object if we build old libraries.
     if test "$build_old_libs" = yes; then
-      command="$base_compile $srcfile"
+      if test "$pic_mode" != yes; then
+	# Don't build PIC code
+	command="$base_compile $srcfile"
+      else
+	# All platforms use -DPIC, to notify preprocessed assembler code.
+	command="$base_compile $srcfile $pic_flag -DPIC"
+      fi
       if test "$compiler_c_o" = yes; then
 	command="$command -o $obj"
 	output_obj="$obj"
@@ -612,17 +724,17 @@
 
     # Unlock the critical section if it was locked
     if test "$need_locks" != no; then
-      $rm "$lockfile"
+      $run $rm "$lockfile"
     fi
 
     exit 0
     ;;
 
   # libtool link mode
-  link)
+  link | relink)
     modename="$modename: link"
-    case "$host" in
-    *-*-cygwin* | *-*-mingw* | *-*-os2*)
+    case $host in
+    *-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2*)
       # It is impossible to link a dll without this setting, and
       # we shouldn't force the makefile maintainer to figure out
       # which system we are compiling for in order to pass an extra
@@ -635,179 +747,12 @@
       # -no-undefined on the libtool link line when we can be certain
       # that all symbols are satisfied, otherwise we get a static library.
       allow_undefined=yes
-
-      # This is a source program that is used to create dlls on Windows
-      # Don't remove nor modify the starting and closing comments
-# /* ltdll.c starts here */
-# #define WIN32_LEAN_AND_MEAN
-# #include <windows.h>
-# #undef WIN32_LEAN_AND_MEAN
-# #include <stdio.h>
-#
-# #ifndef __CYGWIN__
-# #  ifdef __CYGWIN32__
-# #    define __CYGWIN__ __CYGWIN32__
-# #  endif
-# #endif
-#
-# #ifdef __cplusplus
-# extern "C" {
-# #endif
-# BOOL APIENTRY DllMain (HINSTANCE hInst, DWORD reason, LPVOID reserved);
-# #ifdef __cplusplus
-# }
-# #endif
-#
-# #ifdef __CYGWIN__
-# #include <cygwin/cygwin_dll.h>
-# DECLARE_CYGWIN_DLL( DllMain );
-# #endif
-# HINSTANCE __hDllInstance_base;
-#
-# BOOL APIENTRY
-# DllMain (HINSTANCE hInst, DWORD reason, LPVOID reserved)
-# {
-#   __hDllInstance_base = hInst;
-#   return TRUE;
-# }
-# /* ltdll.c ends here */
-      # This is a source program that is used to create import libraries
-      # on Windows for dlls which lack them. Don't remove nor modify the
-      # starting and closing comments
-# /* impgen.c starts here */
-# /*   Copyright (C) 1999 Free Software Foundation, Inc.
-# 
-#  This file is part of GNU libtool.
-# 
-#  This program is free software; you can redistribute it and/or modify
-#  it under the terms of the GNU General Public License as published by
-#  the Free Software Foundation; either version 2 of the License, or
-#  (at your option) any later version.
-# 
-#  This program is distributed in the hope that it will be useful,
-#  but WITHOUT ANY WARRANTY; without even the implied warranty of
-#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#  GNU General Public License for more details.
-# 
-#  You should have received a copy of the GNU General Public License
-#  along with this program; if not, write to the Free Software
-#  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
-#  */
-# 
-#  #include <stdio.h>		/* for printf() */
-#  #include <unistd.h>		/* for open(), lseek(), read() */
-#  #include <fcntl.h>		/* for O_RDONLY, O_BINARY */
-#  #include <string.h>		/* for strdup() */
-# 
-#  static unsigned int
-#  pe_get16 (fd, offset)
-#       int fd;
-#       int offset;
-#  {
-#    unsigned char b[2];
-#    lseek (fd, offset, SEEK_SET);
-#    read (fd, b, 2);
-#    return b[0] + (b[1]<<8);
-#  }
-# 
-#  static unsigned int
-#  pe_get32 (fd, offset)
-#      int fd;
-#      int offset;
-#  {
-#    unsigned char b[4];
-#    lseek (fd, offset, SEEK_SET);
-#    read (fd, b, 4);
-#    return b[0] + (b[1]<<8) + (b[2]<<16) + (b[3]<<24);
-#  }
-# 
-#  static unsigned int
-#  pe_as32 (ptr)
-#       void *ptr;
-#  {
-#    unsigned char *b = ptr;
-#    return b[0] + (b[1]<<8) + (b[2]<<16) + (b[3]<<24);
-#  }
-# 
-#  int
-#  main (argc, argv)
-#      int argc;
-#      char *argv[];
-#  {
-#      int dll;
-#      unsigned long pe_header_offset, opthdr_ofs, num_entries, i;
-#      unsigned long export_rva, export_size, nsections, secptr, expptr;
-#      unsigned long name_rvas, nexp;
-#      unsigned char *expdata, *erva;
-#      char *filename, *dll_name;
-# 
-#      filename = argv[1];
-# 
-#      dll = open(filename, O_RDONLY|O_BINARY);
-#      if (!dll)
-#  	return 1;
-# 
-#      dll_name = filename;
-#    
-#      for (i=0; filename[i]; i++)
-#  	if (filename[i] == '/' || filename[i] == '\\'  || filename[i] == ':')
-#  	    dll_name = filename + i +1;
-# 
-#      pe_header_offset = pe_get32 (dll, 0x3c);
-#      opthdr_ofs = pe_header_offset + 4 + 20;
-#      num_entries = pe_get32 (dll, opthdr_ofs + 92);
-# 
-#      if (num_entries < 1) /* no exports */
-#  	return 1;
-# 
-#      export_rva = pe_get32 (dll, opthdr_ofs + 96);
-#      export_size = pe_get32 (dll, opthdr_ofs + 100);
-#      nsections = pe_get16 (dll, pe_header_offset + 4 +2);
-#      secptr = (pe_header_offset + 4 + 20 +
-#  	      pe_get16 (dll, pe_header_offset + 4 + 16));
-# 
-#      expptr = 0;
-#      for (i = 0; i < nsections; i++)
-#      {
-#  	char sname[8];
-#  	unsigned long secptr1 = secptr + 40 * i;
-#  	unsigned long vaddr = pe_get32 (dll, secptr1 + 12);
-#  	unsigned long vsize = pe_get32 (dll, secptr1 + 16);
-#  	unsigned long fptr = pe_get32 (dll, secptr1 + 20);
-#  	lseek(dll, secptr1, SEEK_SET);
-#  	read(dll, sname, 8);
-#  	if (vaddr <= export_rva && vaddr+vsize > export_rva)
-#  	{
-#  	    expptr = fptr + (export_rva - vaddr);
-#  	    if (export_rva + export_size > vaddr + vsize)
-#  		export_size = vsize - (export_rva - vaddr);
-#  	    break;
-#  	}
-#      }
-# 
-#      expdata = (unsigned char*)malloc(export_size);
-#      lseek (dll, expptr, SEEK_SET);
-#      read (dll, expdata, export_size);
-#      erva = expdata - export_rva;
-# 
-#      nexp = pe_as32 (expdata+24);
-#      name_rvas = pe_as32 (expdata+32);
-# 
-#      printf ("EXPORTS\n");
-#      for (i = 0; i<nexp; i++)
-#      {
-#  	unsigned long name_rva = pe_as32 (erva+name_rvas+i*4);
-#  	printf ("\t%s @ %ld ;\n", erva+name_rva, 1+ i);
-#      }
-# 
-#      return 0;
-#  }
-# /* impgen.c ends here */
       ;;
     *)
       allow_undefined=yes
       ;;
     esac
+    libtool_args="$nonopt"
     compile_command="$nonopt"
     finalize_command="$nonopt"
 
@@ -818,18 +763,13 @@
     convenience=
     old_convenience=
     deplibs=
-    linkopts=
+    old_deplibs=
+    compiler_flags=
+    linker_flags=
+    dllsearchpath=
+    lib_search_path=`pwd`
+    inst_prefix_dir=
 
-    if test -n "$shlibpath_var"; then
-      # get the directories listed in $shlibpath_var
-      eval lib_search_path=\`\$echo \"X \${$shlibpath_var}\" \| \$Xsed -e \'s/:/ /g\'\`
-    else
-      lib_search_path=
-    fi
-    # now prepend the system-specific ones
-    eval lib_search_path=\"$sys_lib_search_path_spec\$lib_search_path\"
-    eval sys_lib_dlsearch_path=\"$sys_lib_dlsearch_path_spec\"
-    
     avoid_version=no
     dlfiles=
     dlprefiles=
@@ -839,9 +779,9 @@
     export_symbols_regex=
     generated=
     libobjs=
-    link_against_libtool_libs=
     ltlibs=
     module=no
+    no_install=no
     objs=
     prefer_static_libs=no
     preload=no
@@ -858,7 +798,7 @@
     # We need to know -static, to get the right output filenames.
     for arg
     do
-      case "$arg" in
+      case $arg in
       -all-static | -static)
 	if test "X$arg" = "X-all-static"; then
 	  if test "$build_libtool_libs" = yes && test -z "$link_static_flag"; then
@@ -887,17 +827,24 @@
     while test $# -gt 0; do
       arg="$1"
       shift
+      case $arg in
+      *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+	qarg=\"`$echo "X$arg" | $Xsed -e "$sed_quote_subst"`\" ### testsuite: skip nested quoting test
+	;;
+      *) qarg=$arg ;;
+      esac
+      libtool_args="$libtool_args $qarg"
 
       # If the previous option needs an argument, assign it.
       if test -n "$prev"; then
-	case "$prev" in
+	case $prev in
 	output)
 	  compile_command="$compile_command @OUTPUT@"
 	  finalize_command="$finalize_command @OUTPUT@"
 	  ;;
 	esac
 
-	case "$prev" in
+	case $prev in
 	dlfiles|dlprefiles)
 	  if test "$preload" = no; then
 	    # Add the symbol object into the linking commands.
@@ -905,7 +852,7 @@
 	    finalize_command="$finalize_command @SYMFILE@"
 	    preload=yes
 	  fi
-	  case "$arg" in
+	  case $arg in
 	  *.la | *.lo) ;;  # We handle these cases below.
 	  force)
 	    if test "$dlself" = no; then
@@ -934,6 +881,7 @@
 	      dlprefiles="$dlprefiles $arg"
 	    fi
 	    prev=
+	    continue
 	    ;;
 	  esac
 	  ;;
@@ -951,6 +899,11 @@
 	  prev=
 	  continue
 	  ;;
+	inst_prefix)
+	  inst_prefix_dir="$arg"
+	  prev=
+	  continue
+	  ;;
 	release)
 	  release="-$arg"
 	  prev=
@@ -958,7 +911,7 @@
 	  ;;
 	rpath | xrpath)
 	  # We need an absolute path.
-	  case "$arg" in
+	  case $arg in
 	  [\\/]* | [A-Za-z]:[\\/]*) ;;
 	  *)
 	    $echo "$modename: only absolute run-paths are allowed" 1>&2
@@ -979,17 +932,32 @@
 	  prev=
 	  continue
 	  ;;
+	xcompiler)
+	  compiler_flags="$compiler_flags $qarg"
+	  prev=
+	  compile_command="$compile_command $qarg"
+	  finalize_command="$finalize_command $qarg"
+	  continue
+	  ;;
+	xlinker)
+	  linker_flags="$linker_flags $qarg"
+	  compiler_flags="$compiler_flags $wl$qarg"
+	  prev=
+	  compile_command="$compile_command $wl$qarg"
+	  finalize_command="$finalize_command $wl$qarg"
+	  continue
+	  ;;
 	*)
 	  eval "$prev=\"\$arg\""
 	  prev=
 	  continue
 	  ;;
 	esac
-      fi
+      fi # test -n $prev
 
       prevarg="$arg"
 
-      case "$arg" in
+      case $arg in
       -all-static)
 	if test -n "$link_static_flag"; then
 	  compile_command="$compile_command $link_static_flag"
@@ -1026,7 +994,7 @@
 
       -export-symbols | -export-symbols-regex)
 	if test -n "$export_symbols" || test -n "$export_symbols_regex"; then
-	  $echo "$modename: not more than one -exported-symbols argument allowed"
+	  $echo "$modename: more than one -exported-symbols argument is not allowed"
 	  exit 1
 	fi
 	if test "X$arg" = "X-export-symbols"; then
@@ -1037,58 +1005,81 @@
 	continue
 	;;
 
+      -inst-prefix-dir)
+       prev=inst_prefix
+       continue
+       ;;
+
+      # The native IRIX linker understands -LANG:*, -LIST:* and -LNO:*
+      # so, if we see these flags be careful not to treat them like -L
+      -L[A-Z][A-Z]*:*)
+	case $with_gcc/$host in
+	no/*-*-irix* | no/*-*-nonstopux*)
+	  compile_command="$compile_command $arg"
+	  finalize_command="$finalize_command $arg"
+	  ;;
+	esac
+	continue
+	;;
+
       -L*)
 	dir=`$echo "X$arg" | $Xsed -e 's/^-L//'`
 	# We need an absolute path.
-	case "$dir" in
+	case $dir in
 	[\\/]* | [A-Za-z]:[\\/]*) ;;
 	*)
 	  absdir=`cd "$dir" && pwd`
 	  if test -z "$absdir"; then
-	    $echo "$modename: warning: cannot determine absolute directory name of \`$dir'" 1>&2
-	    $echo "$modename: passing it literally to the linker, although it might fail" 1>&2
-	    absdir="$dir"
+	    $echo "$modename: cannot determine absolute directory name of \`$dir'" 1>&2
+	    exit 1
 	  fi
 	  dir="$absdir"
 	  ;;
 	esac
-	case " $deplibs " in
-	*" $arg "*) ;;
-	*) deplibs="$deplibs $arg";;
-	esac
-	case " $lib_search_path " in
-	*" $dir "*) ;;
-	*) lib_search_path="$lib_search_path $dir";;
+	case "$deplibs " in
+	*" -L$dir "*) ;;
+	*)
+	  deplibs="$deplibs -L$dir"
+	  lib_search_path="$lib_search_path $dir"
+	  ;;
 	esac
-	case "$host" in
-	*-*-cygwin* | *-*-mingw* | *-*-os2*)
-	  dllsearchdir=`cd "$dir" && pwd || echo "$dir"`
-	  case ":$dllsearchpath:" in
-	  ::) dllsearchpath="$dllsearchdir";;
-	  *":$dllsearchdir:"*) ;;
-	  *) dllsearchpath="$dllsearchpath:$dllsearchdir";;
+	case $host in
+	*-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2*)
+	  case :$dllsearchpath: in
+	  *":$dir:"*) ;;
+	  *) dllsearchpath="$dllsearchpath:$dir";;
 	  esac
 	  ;;
 	esac
+	continue
 	;;
 
       -l*)
-	if test "$arg" = "-lc"; then
-	  case "$host" in
-	  *-*-cygwin* | *-*-mingw* | *-*-os2* | *-*-beos*)
-	    # These systems don't actually have c library (as such)
+	if test "X$arg" = "X-lc" || test "X$arg" = "X-lm"; then
+	  case $host in
+	  *-*-cygwin* | *-*-pw32* | *-*-beos*)
+	    # These systems don't actually have a C or math library (as such)
 	    continue
 	    ;;
+	  *-*-mingw* | *-*-os2*)
+	    # These systems don't actually have a C library (as such)
+	    test "X$arg" = "X-lc" && continue
+	    ;;
+	  *-*-openbsd* | *-*-freebsd*)
+	    # Do not include libc due to us having libc/libc_r.
+	    test "X$arg" = "X-lc" && continue
+	    ;;
 	  esac
-	elif test "$arg" = "-lm"; then
-	  case "$host" in
-	  *-*-cygwin* | *-*-beos*)
-	    # These systems don't actually have math library (as such)
+	 elif test "X$arg" = "X-lc_r"; then
+	  case $host in
+	 *-*-openbsd* | *-*-freebsd*)
+	    # Do not include libc_r directly, use -pthread flag.
 	    continue
 	    ;;
 	  esac
 	fi
 	deplibs="$deplibs $arg"
+	continue
 	;;
 
       -module)
@@ -1096,6 +1087,25 @@
 	continue
 	;;
 
+      -no-fast-install)
+	fast_install=no
+	continue
+	;;
+
+      -no-install)
+	case $host in
+	*-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2*)
+	  # The PATH hackery in wrapper scripts is required on Windows
+	  # in order for the loader to find any dlls it needs.
+	  $echo "$modename: warning: \`-no-install' is ignored for $host" 1>&2
+	  $echo "$modename: warning: assuming \`-no-fast-install' instead" 1>&2
+	  fast_install=no
+	  ;;
+	*) no_install=yes ;;
+	esac
+	continue
+	;;
+
       -no-undefined)
 	allow_undefined=no
 	continue
@@ -1121,7 +1131,7 @@
       -R*)
 	dir=`$echo "X$arg" | $Xsed -e 's/^-R//'`
 	# We need an absolute path.
-	case "$dir" in
+	case $dir in
 	[\\/]* | [A-Za-z]:[\\/]*) ;;
 	*)
 	  $echo "$modename: only absolute run-paths are allowed" 1>&2
@@ -1136,11 +1146,11 @@
 	;;
 
       -static)
-	# If we have no pic_flag, then this is the same as -all-static.
-	if test -z "$pic_flag" && test -n "$link_static_flag"; then
-	  compile_command="$compile_command $link_static_flag"
-	  finalize_command="$finalize_command $link_static_flag"
-	fi
+	# The effects of -static are defined in a previous loop.
+	# We used to do the same as -all-static on platforms that
+	# didn't have a PIC flag, but the assumption that the effects
+	# would be equivalent was wrong.  It would break on at least
+	# Digital Unix and AIX.
 	continue
 	;;
 
@@ -1154,28 +1164,71 @@
 	continue
 	;;
 
+      -Wc,*)
+	args=`$echo "X$arg" | $Xsed -e "$sed_quote_subst" -e 's/^-Wc,//'`
+	arg=
+	save_ifs="$IFS"; IFS=','
+	for flag in $args; do
+	  IFS="$save_ifs"
+	  case $flag in
+	    *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+	    flag="\"$flag\""
+	    ;;
+	  esac
+	  arg="$arg $wl$flag"
+	  compiler_flags="$compiler_flags $flag"
+	done
+	IFS="$save_ifs"
+	arg=`$echo "X$arg" | $Xsed -e "s/^ //"`
+	;;
+
+      -Wl,*)
+	args=`$echo "X$arg" | $Xsed -e "$sed_quote_subst" -e 's/^-Wl,//'`
+	arg=
+	save_ifs="$IFS"; IFS=','
+	for flag in $args; do
+	  IFS="$save_ifs"
+	  case $flag in
+	    *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+	    flag="\"$flag\""
+	    ;;
+	  esac
+	  arg="$arg $wl$flag"
+	  compiler_flags="$compiler_flags $wl$flag"
+	  linker_flags="$linker_flags $flag"
+	done
+	IFS="$save_ifs"
+	arg=`$echo "X$arg" | $Xsed -e "s/^ //"`
+	;;
+
+      -Xcompiler)
+	prev=xcompiler
+	continue
+	;;
+
+      -Xlinker)
+	prev=xlinker
+	continue
+	;;
+
       # Some other compiler flag.
       -* | +*)
 	# Unknown arguments in both finalize_command and compile_command need
 	# to be aesthetically quoted because they are evaled later.
 	arg=`$echo "X$arg" | $Xsed -e "$sed_quote_subst"`
-	case "$arg" in
-	*[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*)
+	case $arg in
+	*[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
 	  arg="\"$arg\""
 	  ;;
 	esac
 	;;
 
-      *.o | *.obj | *.a | *.lib)
-	# A standard object.
-	objs="$objs $arg"
-	;;
-
-      *.lo)
-	# A library object.
+      *.lo | *.$objext)
+	# A library or standard object.
 	if test "$prev" = dlfiles; then
-	  dlfiles="$dlfiles $arg"
-	  if test "$build_libtool_libs" = yes && test "$dlopen" = yes; then
+	  # This file was specified with -dlopen.
+	  if test "$build_libtool_libs" = yes && test "$dlopen_support" = yes; then
+	    dlfiles="$dlfiles $arg"
 	    prev=
 	    continue
 	  else
@@ -1188,357 +1241,917 @@
 	  # Preload the old-style object.
 	  dlprefiles="$dlprefiles "`$echo "X$arg" | $Xsed -e "$lo2o"`
 	  prev=
+	else
+	  case $arg in
+	  *.lo) libobjs="$libobjs $arg" ;;
+	  *) objs="$objs $arg" ;;
+	  esac
 	fi
-	libobjs="$libobjs $arg"
+	;;
+
+      *.$libext)
+	# An archive.
+	deplibs="$deplibs $arg"
+	old_deplibs="$old_deplibs $arg"
+	continue
 	;;
 
       *.la)
 	# A libtool-controlled library.
 
-	dlname=
-	libdir=
-	library_names=
-	old_library=
+	if test "$prev" = dlfiles; then
+	  # This library was specified with -dlopen.
+	  dlfiles="$dlfiles $arg"
+	  prev=
+	elif test "$prev" = dlprefiles; then
+	  # The library was specified with -dlpreopen.
+	  dlprefiles="$dlprefiles $arg"
+	  prev=
+	else
+	  deplibs="$deplibs $arg"
+	fi
+	continue
+	;;
+
+      # Some other compiler argument.
+      *)
+	# Unknown arguments in both finalize_command and compile_command need
+	# to be aesthetically quoted because they are evaled later.
+	arg=`$echo "X$arg" | $Xsed -e "$sed_quote_subst"`
+	case $arg in
+	*[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
+	  arg="\"$arg\""
+	  ;;
+	esac
+	;;
+      esac # arg
+
+      # Now actually substitute the argument into the commands.
+      if test -n "$arg"; then
+	compile_command="$compile_command $arg"
+	finalize_command="$finalize_command $arg"
+      fi
+    done # argument parsing loop
+
+    if test -n "$prev"; then
+      $echo "$modename: the \`$prevarg' option requires an argument" 1>&2
+      $echo "$help" 1>&2
+      exit 1
+    fi
+
+    if test "$export_dynamic" = yes && test -n "$export_dynamic_flag_spec"; then
+      eval arg=\"$export_dynamic_flag_spec\"
+      compile_command="$compile_command $arg"
+      finalize_command="$finalize_command $arg"
+    fi
+
+    # calculate the name of the file, without its directory
+    outputname=`$echo "X$output" | $Xsed -e 's%^.*/%%'`
+    libobjs_save="$libobjs"
+
+    if test -n "$shlibpath_var"; then
+      # get the directories listed in $shlibpath_var
+      eval shlib_search_path=\`\$echo \"X\${$shlibpath_var}\" \| \$Xsed -e \'s/:/ /g\'\`
+    else
+      shlib_search_path=
+    fi
+    eval sys_lib_search_path=\"$sys_lib_search_path_spec\"
+    eval sys_lib_dlsearch_path=\"$sys_lib_dlsearch_path_spec\"
+
+    output_objdir=`$echo "X$output" | $Xsed -e 's%/[^/]*$%%'`
+    if test "X$output_objdir" = "X$output"; then
+      output_objdir="$objdir"
+    else
+      output_objdir="$output_objdir/$objdir"
+    fi
+    # Create the object directory.
+    if test ! -d $output_objdir; then
+      $show "$mkdir $output_objdir"
+      $run $mkdir $output_objdir
+      status=$?
+      if test $status -ne 0 && test ! -d $output_objdir; then
+	exit $status
+      fi
+    fi
+
+    # Determine the type of output
+    case $output in
+    "")
+      $echo "$modename: you must specify an output file" 1>&2
+      $echo "$help" 1>&2
+      exit 1
+      ;;
+    *.$libext) linkmode=oldlib ;;
+    *.lo | *.$objext) linkmode=obj ;;
+    *.la) linkmode=lib ;;
+    *) linkmode=prog ;; # Anything else should be a program.
+    esac
+
+    specialdeplibs=
+    libs=
+    # Find all interdependent deplibs by searching for libraries
+    # that are linked more than once (e.g. -la -lb -la)
+    for deplib in $deplibs; do
+      if test "X$duplicate_deps" = "Xyes" ; then
+	case "$libs " in
+	*" $deplib "*) specialdeplibs="$specialdeplibs $deplib" ;;
+	esac
+      fi
+      libs="$libs $deplib"
+    done
+    deplibs=
+    newdependency_libs=
+    newlib_search_path=
+    need_relink=no # whether we're linking any uninstalled libtool libraries
+    notinst_deplibs= # not-installed libtool libraries
+    notinst_path= # paths that contain not-installed libtool libraries
+    case $linkmode in
+    lib)
+	passes="conv link"
+	for file in $dlfiles $dlprefiles; do
+	  case $file in
+	  *.la) ;;
+	  *)
+	    $echo "$modename: libraries can \`-dlopen' only libtool libraries: $file" 1>&2
+	    exit 1
+	    ;;
+	  esac
+	done
+	;;
+    prog)
+	compile_deplibs=
+	finalize_deplibs=
+	alldeplibs=no
+	newdlfiles=
+	newdlprefiles=
+	passes="conv scan dlopen dlpreopen link"
+	;;
+    *)  passes="conv"
+	;;
+    esac
+    for pass in $passes; do
+      if test $linkmode = prog; then
+	# Determine which files to process
+	case $pass in
+	dlopen)
+	  libs="$dlfiles"
+	  save_deplibs="$deplibs" # Collect dlpreopened libraries
+	  deplibs=
+	  ;;
+	dlpreopen) libs="$dlprefiles" ;;
+	link) libs="$deplibs %DEPLIBS% $dependency_libs" ;;
+	esac
+      fi
+      for deplib in $libs; do
+	lib=
+	found=no
+	case $deplib in
+	-l*)
+	  if test $linkmode = oldlib && test $linkmode = obj; then
+	    $echo "$modename: warning: \`-l' is ignored for archives/objects: $deplib" 1>&2
+	    continue
+	  fi
+	  if test $pass = conv; then
+	    deplibs="$deplib $deplibs"
+	    continue
+	  fi
+	  name=`$echo "X$deplib" | $Xsed -e 's/^-l//'`
+	  for searchdir in $newlib_search_path $lib_search_path $sys_lib_search_path $shlib_search_path; do
+	    # Search the libtool library
+	    lib="$searchdir/lib${name}.la"
+	    if test -f "$lib"; then
+	      found=yes
+	      break
+	    fi
+	  done
+	  if test "$found" != yes; then
+	    # deplib doesn't seem to be a libtool library
+	    if test "$linkmode,$pass" = "prog,link"; then
+	      compile_deplibs="$deplib $compile_deplibs"
+	      finalize_deplibs="$deplib $finalize_deplibs"
+	    else
+	      deplibs="$deplib $deplibs"
+	      test $linkmode = lib && newdependency_libs="$deplib $newdependency_libs"
+	    fi
+	    continue
+	  fi
+	  ;; # -l
+	-L*)
+	  case $linkmode in
+	  lib)
+	    deplibs="$deplib $deplibs"
+	    test $pass = conv && continue
+	    newdependency_libs="$deplib $newdependency_libs"
+	    newlib_search_path="$newlib_search_path "`$echo "X$deplib" | $Xsed -e 's/^-L//'`
+	    ;;
+	  prog)
+	    if test $pass = conv; then
+	      deplibs="$deplib $deplibs"
+	      continue
+	    fi
+	    if test $pass = scan; then
+	      deplibs="$deplib $deplibs"
+	      newlib_search_path="$newlib_search_path "`$echo "X$deplib" | $Xsed -e 's/^-L//'`
+	    else
+	      compile_deplibs="$deplib $compile_deplibs"
+	      finalize_deplibs="$deplib $finalize_deplibs"
+	    fi
+	    ;;
+	  *)
+	    $echo "$modename: warning: \`-L' is ignored for archives/objects: $deplib" 1>&2
+	    ;;
+	  esac # linkmode
+	  continue
+	  ;; # -L
+	-R*)
+	  if test $pass = link; then
+	    dir=`$echo "X$deplib" | $Xsed -e 's/^-R//'`
+	    # Make sure the xrpath contains only unique directories.
+	    case "$xrpath " in
+	    *" $dir "*) ;;
+	    *) xrpath="$xrpath $dir" ;;
+	    esac
+	  fi
+	  deplibs="$deplib $deplibs"
+	  continue
+	  ;;
+	*.la) lib="$deplib" ;;
+	*.$libext)
+	  if test $pass = conv; then
+	    deplibs="$deplib $deplibs"
+	    continue
+	  fi
+	  case $linkmode in
+	  lib)
+	    if test "$deplibs_check_method" != pass_all; then
+	      echo
+	      echo "*** Warning: Trying to link with static lib archive $deplib."
+	      echo "*** I have the capability to make that library automatically link in when"
+	      echo "*** you link to this library.  But I can only do this if you have a"
+	      echo "*** shared version of the library, which you do not appear to have"
+	      echo "*** because the file extensions .$libext of this argument makes me believe"
+	      echo "*** that it is just a static archive that I should not used here."
+	    else
+	      echo
+	      echo "*** Warning: Linking the shared library $output against the"
+	      echo "*** static library $deplib is not portable!"
+	      deplibs="$deplib $deplibs"
+	    fi
+	    continue
+	    ;;
+	  prog)
+	    if test $pass != link; then
+	      deplibs="$deplib $deplibs"
+	    else
+	      compile_deplibs="$deplib $compile_deplibs"
+	      finalize_deplibs="$deplib $finalize_deplibs"
+	    fi
+	    continue
+	    ;;
+	  esac # linkmode
+	  ;; # *.$libext
+	*.lo | *.$objext)
+	  if test $pass = dlpreopen || test "$dlopen_support" != yes || test "$build_libtool_libs" = no; then
+	    # If there is no dlopen support or we're linking statically,
+	    # we need to preload.
+	    newdlprefiles="$newdlprefiles $deplib"
+	    compile_deplibs="$deplib $compile_deplibs"
+	    finalize_deplibs="$deplib $finalize_deplibs"
+	  else
+	    newdlfiles="$newdlfiles $deplib"
+	  fi
+	  continue
+	  ;;
+	%DEPLIBS%)
+	  alldeplibs=yes
+	  continue
+	  ;;
+	esac # case $deplib
+	if test $found = yes || test -f "$lib"; then :
+	else
+	  $echo "$modename: cannot find the library \`$lib'" 1>&2
+	  exit 1
+	fi
 
 	# Check to see that this really is a libtool archive.
-	if (sed -e '2q' $arg | egrep "^# Generated by .*$PACKAGE") >/dev/null 2>&1; then :
+	if (${SED} -e '2q' $lib | egrep "^# Generated by .*$PACKAGE") >/dev/null 2>&1; then :
 	else
-	  $echo "$modename: \`$arg' is not a valid libtool archive" 1>&2
+	  $echo "$modename: \`$lib' is not a valid libtool archive" 1>&2
 	  exit 1
 	fi
 
+	ladir=`$echo "X$lib" | $Xsed -e 's%/[^/]*$%%'`
+	test "X$ladir" = "X$lib" && ladir="."
+
+	dlname=
+	dlopen=
+	dlpreopen=
+	libdir=
+	library_names=
+	old_library=
 	# If the library was installed with an old release of libtool,
 	# it will not redefine variable installed.
 	installed=yes
 
 	# Read the .la file
-	# If there is no directory component, then add one.
-	case "$arg" in
-	*/* | *\\*) . $arg ;;
-	*) . ./$arg ;;
+	case $lib in
+	*/* | *\\*) . $lib ;;
+	*) . ./$lib ;;
 	esac
 
+	if test "$linkmode,$pass" = "lib,link" ||
+	   test "$linkmode,$pass" = "prog,scan" ||
+	   { test $linkmode = oldlib && test $linkmode = obj; }; then
+	   # Add dl[pre]opened files of deplib
+	  test -n "$dlopen" && dlfiles="$dlfiles $dlopen"
+	  test -n "$dlpreopen" && dlprefiles="$dlprefiles $dlpreopen"
+	fi
+
+	if test $pass = conv; then
+	  # Only check for convenience libraries
+	  deplibs="$lib $deplibs"
+	  if test -z "$libdir"; then
+	    if test -z "$old_library"; then
+	      $echo "$modename: cannot find name of link library for \`$lib'" 1>&2
+	      exit 1
+	    fi
+	    # It is a libtool convenience library, so add in its objects.
+	    convenience="$convenience $ladir/$objdir/$old_library"
+	    old_convenience="$old_convenience $ladir/$objdir/$old_library"
+	    tmp_libs=
+	    for deplib in $dependency_libs; do
+	      deplibs="$deplib $deplibs"
+              if test "X$duplicate_deps" = "Xyes" ; then
+	        case "$tmp_libs " in
+	        *" $deplib "*) specialdeplibs="$specialdeplibs $deplib" ;;
+	        esac
+              fi
+	      tmp_libs="$tmp_libs $deplib"
+	    done
+	  elif test $linkmode != prog && test $linkmode != lib; then
+	    $echo "$modename: \`$lib' is not a convenience library" 1>&2
+	    exit 1
+	  fi
+	  continue
+	fi # $pass = conv
+
 	# Get the name of the library we link against.
 	linklib=
 	for l in $old_library $library_names; do
 	  linklib="$l"
 	done
-
 	if test -z "$linklib"; then
-	  $echo "$modename: cannot find name of link library for \`$arg'" 1>&2
+	  $echo "$modename: cannot find name of link library for \`$lib'" 1>&2
 	  exit 1
 	fi
 
-	# Find the relevant object directory and library name.
-	name=`$echo "X$arg" | $Xsed -e 's%^.*/%%' -e 's/\.la$//' -e 's/^lib//'`
-
-	if test "X$installed" = Xyes; then
-	  dir="$libdir"
-	else
-	  dir=`$echo "X$arg" | $Xsed -e 's%/[^/]*$%%'`
-	  if test "X$dir" = "X$arg"; then
-	    dir="$objdir"
+	# This library was specified with -dlopen.
+	if test $pass = dlopen; then
+	  if test -z "$libdir"; then
+	    $echo "$modename: cannot -dlopen a convenience library: \`$lib'" 1>&2
+	    exit 1
+	  fi
+	  if test -z "$dlname" || test "$dlopen_support" != yes || test "$build_libtool_libs" = no; then
+	    # If there is no dlname, no dlopen support or we're linking
+	    # statically, we need to preload.
+	    dlprefiles="$dlprefiles $lib"
 	  else
-	    dir="$dir/$objdir"
+	    newdlfiles="$newdlfiles $lib"
 	  fi
-	fi
-
-	if test -n "$dependency_libs"; then
-	  # Extract -R and -L from dependency_libs
-	  temp_deplibs=
-	  for deplib in $dependency_libs; do
-	    case "$deplib" in
-	    -R*) temp_xrpath=`$echo "X$deplib" | $Xsed -e 's/^-R//'`
-		 case " $rpath $xrpath " in
-		 *" $temp_xrpath "*) ;;
-		 *) xrpath="$xrpath $temp_xrpath";;
-		 esac;;
-	    -L*) case "$compile_command $temp_deplibs " in
-		 *" $deplib "*) ;;
-		 *) temp_deplibs="$temp_deplibs $deplib";;
-		 esac
-		 temp_dir=`$echo "X$deplib" | $Xsed -e 's/^-L//'`
-		 case " $lib_search_path " in
-		 *" $temp_dir "*) ;;
-		 *) lib_search_path="$lib_search_path $temp_dir";;
-		 esac
-		 ;;
-	    *) temp_deplibs="$temp_deplibs $deplib";;
-	    esac
-	  done
-	  dependency_libs="$temp_deplibs"
-	fi
-
-	if test -z "$libdir"; then
-	  # It is a libtool convenience library, so add in its objects.
-	  convenience="$convenience $dir/$old_library"
-	  old_convenience="$old_convenience $dir/$old_library"
-	  deplibs="$deplibs$dependency_libs"
-	  compile_command="$compile_command $dir/$old_library$dependency_libs"
-	  finalize_command="$finalize_command $dir/$old_library$dependency_libs"
 	  continue
-	fi
+	fi # $pass = dlopen
 
-	# This library was specified with -dlopen.
-	if test "$prev" = dlfiles; then
-	  dlfiles="$dlfiles $arg"
-	  if test -z "$dlname" || test "$dlopen" != yes || test "$build_libtool_libs" = no; then
-	    # If there is no dlname, no dlopen support or we're linking statically,
-	    # we need to preload.
-	    prev=dlprefiles
+	# We need an absolute path.
+	case $ladir in
+	[\\/]* | [A-Za-z]:[\\/]*) abs_ladir="$ladir" ;;
+	*)
+	  abs_ladir=`cd "$ladir" && pwd`
+	  if test -z "$abs_ladir"; then
+	    $echo "$modename: warning: cannot determine absolute directory name of \`$ladir'" 1>&2
+	    $echo "$modename: passing it literally to the linker, although it might fail" 1>&2
+	    abs_ladir="$ladir"
+	  fi
+	  ;;
+	esac
+	laname=`$echo "X$lib" | $Xsed -e 's%^.*/%%'`
+
+	# Find the relevant object directory and library name.
+	if test "X$installed" = Xyes; then
+	  if test ! -f "$libdir/$linklib" && test -f "$abs_ladir/$linklib"; then
+	    $echo "$modename: warning: library \`$lib' was moved." 1>&2
+	    dir="$ladir"
+	    absdir="$abs_ladir"
+	    libdir="$abs_ladir"
 	  else
-	    # We should not create a dependency on this library, but we
-	    # may need any libraries it requires.
-	    compile_command="$compile_command$dependency_libs"
-	    finalize_command="$finalize_command$dependency_libs"
-	    prev=
-	    continue
+	    dir="$libdir"
+	    absdir="$libdir"
 	  fi
-	fi
+	else
+	  dir="$ladir/$objdir"
+	  absdir="$abs_ladir/$objdir"
+	  # Remove this search path later
+	  notinst_path="$notinst_path $abs_ladir"
+	fi # $installed = yes
+	name=`$echo "X$laname" | $Xsed -e 's/\.la$//' -e 's/^lib//'`
 
-	# The library was specified with -dlpreopen.
-	if test "$prev" = dlprefiles; then
+	# This library was specified with -dlpreopen.
+	if test $pass = dlpreopen; then
+	  if test -z "$libdir"; then
+	    $echo "$modename: cannot -dlpreopen a convenience library: \`$lib'" 1>&2
+	    exit 1
+	  fi
 	  # Prefer using a static library (so that no silly _DYNAMIC symbols
 	  # are required to link).
 	  if test -n "$old_library"; then
-	    dlprefiles="$dlprefiles $dir/$old_library"
+	    newdlprefiles="$newdlprefiles $dir/$old_library"
+	  # Otherwise, use the dlname, so that lt_dlopen finds it.
+	  elif test -n "$dlname"; then
+	    newdlprefiles="$newdlprefiles $dir/$dlname"
 	  else
-	    dlprefiles="$dlprefiles $dir/$linklib"
+	    newdlprefiles="$newdlprefiles $dir/$linklib"
 	  fi
-	  prev=
+	fi # $pass = dlpreopen
+
+	if test -z "$libdir"; then
+	  # Link the convenience library
+	  if test $linkmode = lib; then
+	    deplibs="$dir/$old_library $deplibs"
+	  elif test "$linkmode,$pass" = "prog,link"; then
+	    compile_deplibs="$dir/$old_library $compile_deplibs"
+	    finalize_deplibs="$dir/$old_library $finalize_deplibs"
+	  else
+	    deplibs="$lib $deplibs"
+	  fi
+	  continue
 	fi
 
-	if test -n "$library_names" &&
-	   { test "$prefer_static_libs" = no || test -z "$old_library"; }; then
-	  link_against_libtool_libs="$link_against_libtool_libs $arg"
-	  if test -n "$shlibpath_var"; then
-	    # Make sure the rpath contains only unique directories.
-	    case "$temp_rpath " in
-	    *" $dir "*) ;;
-	    *) temp_rpath="$temp_rpath $dir" ;;
-	    esac
+	if test $linkmode = prog && test $pass != link; then
+	  newlib_search_path="$newlib_search_path $ladir"
+	  deplibs="$lib $deplibs"
+
+	  linkalldeplibs=no
+	  if test "$link_all_deplibs" != no || test -z "$library_names" ||
+	     test "$build_libtool_libs" = no; then
+	    linkalldeplibs=yes
 	  fi
 
-	  # We need an absolute path.
-	  case "$dir" in
-	  [\\/] | [A-Za-z]:[\\/]*) absdir="$dir" ;;
-	  *)
-	    absdir=`cd "$dir" && pwd`
-	    if test -z "$absdir"; then
-	      $echo "$modename: warning: cannot determine absolute directory name of \`$dir'" 1>&2
-	      $echo "$modename: passing it literally to the linker, although it might fail" 1>&2
-	      absdir="$dir"
+	  tmp_libs=
+	  for deplib in $dependency_libs; do
+	    case $deplib in
+	    -L*) newlib_search_path="$newlib_search_path "`$echo "X$deplib" | $Xsed -e 's/^-L//'`;; ### testsuite: skip nested quoting test
+	    esac
+	    # Need to link against all dependency_libs?
+	    if test $linkalldeplibs = yes; then
+	      deplibs="$deplib $deplibs"
+	    else
+	      # Need to hardcode shared library paths
+	      # or/and link against static libraries
+	      newdependency_libs="$deplib $newdependency_libs"
 	    fi
-	    ;;
-	  esac
-	  
-	  # This is the magic to use -rpath.
-	  # Skip directories that are in the system default run-time
-	  # search path, unless they have been requested with -R.
-	  case " $sys_lib_dlsearch_path " in
-	  *" $absdir "*) ;;
-	  *)
-	    case "$compile_rpath " in
+	    if test "X$duplicate_deps" = "Xyes" ; then
+	      case "$tmp_libs " in
+	      *" $deplib "*) specialdeplibs="$specialdeplibs $deplib" ;;
+	      esac
+	    fi
+	    tmp_libs="$tmp_libs $deplib"
+	  done # for deplib
+	  continue
+	fi # $linkmode = prog...
+
+	link_static=no # Whether the deplib will be linked statically
+	if test -n "$library_names" &&
+	   { test "$prefer_static_libs" = no || test -z "$old_library"; }; then
+	  # Link against this shared library
+
+	  if test "$linkmode,$pass" = "prog,link" ||
+	   { test $linkmode = lib && test $hardcode_into_libs = yes; }; then
+	    # Hardcode the library path.
+	    # Skip directories that are in the system default run-time
+	    # search path.
+	    case " $sys_lib_dlsearch_path " in
 	    *" $absdir "*) ;;
-	    *) compile_rpath="$compile_rpath $absdir" 
+	    *)
+	      case "$compile_rpath " in
+	      *" $absdir "*) ;;
+	      *) compile_rpath="$compile_rpath $absdir"
+	      esac
+	      ;;
 	    esac
-	    ;;
-	  esac
-
-	  case " $sys_lib_dlsearch_path " in
-	  *" $libdir "*) ;;
-	  *)
-	    case "$finalize_rpath " in
+	    case " $sys_lib_dlsearch_path " in
 	    *" $libdir "*) ;;
-	    *) finalize_rpath="$finalize_rpath $libdir"
+	    *)
+	      case "$finalize_rpath " in
+	      *" $libdir "*) ;;
+	      *) finalize_rpath="$finalize_rpath $libdir"
+	      esac
+	      ;;
 	    esac
-	    ;;
-	  esac
+	    if test $linkmode = prog; then
+	      # We need to hardcode the library path
+	      if test -n "$shlibpath_var"; then
+		# Make sure the rpath contains only unique directories.
+		case "$temp_rpath " in
+		*" $dir "*) ;;
+		*" $absdir "*) ;;
+		*) temp_rpath="$temp_rpath $dir" ;;
+		esac
+	      fi
+	    fi
+	  fi # $linkmode,$pass = prog,link...
 
-	  lib_linked=yes
-	  case "$hardcode_action" in
-	  immediate | unsupported)
-	    if test "$hardcode_direct" = no; then
-	      compile_command="$compile_command $dir/$linklib"
-	      deplibs="$deplibs $dir/$linklib"
-	      case "$host" in
-	      *-*-cygwin* | *-*-mingw* | *-*-os2*)
-		dllsearchdir=`cd "$dir" && pwd || echo "$dir"`
-		if test -n "$dllsearchpath"; then
-		  dllsearchpath="$dllsearchpath:$dllsearchdir"
-		else
-		  dllsearchpath="$dllsearchdir"
-		fi
-		;;
-	      esac
-	    elif test "$hardcode_minus_L" = no; then
-	      case "$host" in
-	      *-*-sunos*)
-		compile_shlibpath="$compile_shlibpath$dir:"
+	  if test "$alldeplibs" = yes &&
+	     { test "$deplibs_check_method" = pass_all ||
+	       { test "$build_libtool_libs" = yes &&
+		 test -n "$library_names"; }; }; then
+	    # We only need to search for static libraries
+	    continue
+	  fi
+
+	  if test "$installed" = no; then
+	    notinst_deplibs="$notinst_deplibs $lib"
+	    need_relink=yes
+	  fi
+
+	  if test -n "$old_archive_from_expsyms_cmds"; then
+	    # figure out the soname
+	    set dummy $library_names
+	    realname="$2"
+	    shift; shift
+	    libname=`eval \\$echo \"$libname_spec\"`
+	    # use dlname if we got it. it's perfectly good, no?
+	    if test -n "$dlname"; then
+	      soname="$dlname"
+	    elif test -n "$soname_spec"; then
+	      # bleh windows
+	      case $host in
+	      *cygwin*)
+		major=`expr $current - $age`
+		versuffix="-$major"
 		;;
 	      esac
-	      case "$compile_command " in
-	      *" -L$dir "*) ;;
-	      *) compile_command="$compile_command -L$dir";;
-	      esac
-	      compile_command="$compile_command -l$name"
-	      deplibs="$deplibs -L$dir -l$name"
-	    elif test "$hardcode_shlibpath_var" = no; then
-	      case ":$compile_shlibpath:" in
-	      *":$dir:"*) ;;
-	      *) compile_shlibpath="$compile_shlibpath$dir:";;
+	      eval soname=\"$soname_spec\"
+	    else
+	      soname="$realname"
+	    fi
+
+	    # Make a new name for the extract_expsyms_cmds to use
+	    soroot="$soname"
+	    soname=`echo $soroot | ${SED} -e 's/^.*\///'`
+	    newlib="libimp-`echo $soname | ${SED} 's/^lib//;s/\.dll$//'`.a"
+
+	    # If the library has no export list, then create one now
+	    if test -f "$output_objdir/$soname-def"; then :
+	    else
+	      $show "extracting exported symbol list from \`$soname'"
+	      save_ifs="$IFS"; IFS='~'
+	      eval cmds=\"$extract_expsyms_cmds\"
+	      for cmd in $cmds; do
+		IFS="$save_ifs"
+		$show "$cmd"
+		$run eval "$cmd" || exit $?
+	      done
+	      IFS="$save_ifs"
+	    fi
+
+	    # Create $newlib
+	    if test -f "$output_objdir/$newlib"; then :; else
+	      $show "generating import library for \`$soname'"
+	      save_ifs="$IFS"; IFS='~'
+	      eval cmds=\"$old_archive_from_expsyms_cmds\"
+	      for cmd in $cmds; do
+		IFS="$save_ifs"
+		$show "$cmd"
+		$run eval "$cmd" || exit $?
+	      done
+	      IFS="$save_ifs"
+	    fi
+	    # make sure the library variables are pointing to the new library
+	    dir=$output_objdir
+	    linklib=$newlib
+	  fi # test -n $old_archive_from_expsyms_cmds
+
+	  if test $linkmode = prog || test "$mode" != relink; then
+	    add_shlibpath=
+	    add_dir=
+	    add=
+	    lib_linked=yes
+	    case $hardcode_action in
+	    immediate | unsupported)
+	      if test "$hardcode_direct" = no; then
+		add="$dir/$linklib"
+	      elif test "$hardcode_minus_L" = no; then
+		case $host in
+		*-*-sunos*) add_shlibpath="$dir" ;;
+		esac
+		add_dir="-L$dir"
+		add="-l$name"
+	      elif test "$hardcode_shlibpath_var" = no; then
+		add_shlibpath="$dir"
+		add="-l$name"
+	      else
+		lib_linked=no
+	      fi
+	      ;;
+	    relink)
+	      if test "$hardcode_direct" = yes; then
+		add="$dir/$linklib"
+	      elif test "$hardcode_minus_L" = yes; then
+		add_dir="-L$dir"
+		# Try looking first in the location we're being installed to.
+		if test -n "$inst_prefix_dir"; then
+		  case "$libdir" in
+		  [\/]*)
+		    add_dir="-L$inst_prefix_dir$libdir $add_dir"
+		    ;;
+		  esac
+		fi
+		add="-l$name"
+	      elif test "$hardcode_shlibpath_var" = yes; then
+		add_shlibpath="$dir"
+		add="-l$name"
+	      else
+		lib_linked=no
+	      fi
+	      ;;
+	    *) lib_linked=no ;;
+	    esac
+
+	    if test "$lib_linked" != yes; then
+	      $echo "$modename: configuration error: unsupported hardcode properties"
+	      exit 1
+	    fi
+
+	    if test -n "$add_shlibpath"; then
+	      case :$compile_shlibpath: in
+	      *":$add_shlibpath:"*) ;;
+	      *) compile_shlibpath="$compile_shlibpath$add_shlibpath:" ;;
 	      esac
-	      compile_command="$compile_command -l$name"
-	      deplibs="$deplibs -l$name"
+	    fi
+	    if test $linkmode = prog; then
+	      test -n "$add_dir" && compile_deplibs="$add_dir $compile_deplibs"
+	      test -n "$add" && compile_deplibs="$add $compile_deplibs"
 	    else
-	      lib_linked=no
+	      test -n "$add_dir" && deplibs="$add_dir $deplibs"
+	      test -n "$add" && deplibs="$add $deplibs"
+	      if test "$hardcode_direct" != yes && \
+		 test "$hardcode_minus_L" != yes && \
+		 test "$hardcode_shlibpath_var" = yes; then
+		case :$finalize_shlibpath: in
+		*":$libdir:"*) ;;
+		*) finalize_shlibpath="$finalize_shlibpath$libdir:" ;;
+		esac
+	      fi
 	    fi
-	    ;;
+	  fi
 
-	  relink)
+	  if test $linkmode = prog || test "$mode" = relink; then
+	    add_shlibpath=
+	    add_dir=
+	    add=
+	    # Finalize command for both is simple: just hardcode it.
 	    if test "$hardcode_direct" = yes; then
-	      compile_command="$compile_command $absdir/$linklib"
-	      deplibs="$deplibs $absdir/$linklib"
+	      add="$libdir/$linklib"
 	    elif test "$hardcode_minus_L" = yes; then
-	      case "$compile_command " in
-	      *" -L$absdir "*) ;;
-	      *) compile_command="$compile_command -L$absdir";;
-	      esac
-	      compile_command="$compile_command -l$name"
-	      deplibs="$deplibs -L$absdir -l$name"
+	      add_dir="-L$libdir"
+	      add="-l$name"
 	    elif test "$hardcode_shlibpath_var" = yes; then
-	      case ":$compile_shlibpath:" in
-	      *":$absdir:"*) ;;
-	      *) compile_shlibpath="$compile_shlibpath$absdir:";;
+	      case :$finalize_shlibpath: in
+	      *":$libdir:"*) ;;
+	      *) finalize_shlibpath="$finalize_shlibpath$libdir:" ;;
 	      esac
-	      compile_command="$compile_command -l$name"
-	      deplibs="$deplibs -l$name"
+	      add="-l$name"
 	    else
-	      lib_linked=no
+	      # We cannot seem to hardcode it, guess we'll fake it.
+	      add_dir="-L$libdir"
+	      # Try looking first in the location we're being installed to.
+	      if test -n "$inst_prefix_dir"; then
+		case "$libdir" in
+		[\/]*)
+		  add_dir="-L$inst_prefix_dir$libdir $add_dir"
+		  ;;
+		esac
+	      fi
+	      add="-l$name"
 	    fi
-	    ;;
 
-	  *)
-	    lib_linked=no
-	    ;;
-	  esac
-
-	  if test "$lib_linked" != yes; then
-	    $echo "$modename: configuration error: unsupported hardcode properties"
-	    exit 1
-	  fi
-
-	  # Finalize command for both is simple: just hardcode it.
-	  if test "$hardcode_direct" = yes; then
-	    finalize_command="$finalize_command $libdir/$linklib"
-	  elif test "$hardcode_minus_L" = yes; then
-	    case "$finalize_command " in
-	    *" -L$libdir "*) ;;
-	    *) finalize_command="$finalize_command -L$libdir";;
-	    esac
-	    finalize_command="$finalize_command -l$name"
-	  elif test "$hardcode_shlibpath_var" = yes; then
-	    case ":$finalize_shlibpath:" in
-	    *":$libdir:"*) ;;
-	    *) finalize_shlibpath="$finalize_shlibpath$libdir:";;
-	    esac
-	    finalize_command="$finalize_command -l$name"
-	  else
-	    # We cannot seem to hardcode it, guess we'll fake it.
-	    case "$finalize_command " in
-	    *" -L$dir "*) ;;
-	    *) finalize_command="$finalize_command -L$libdir";;
-	    esac
-	    finalize_command="$finalize_command -l$name"
+	    if test $linkmode = prog; then
+	      test -n "$add_dir" && finalize_deplibs="$add_dir $finalize_deplibs"
+	      test -n "$add" && finalize_deplibs="$add $finalize_deplibs"
+	    else
+	      test -n "$add_dir" && deplibs="$add_dir $deplibs"
+	      test -n "$add" && deplibs="$add $deplibs"
+	    fi
 	  fi
-	else
-	  # Transform directly to old archives if we don't build new libraries.
-	  if test -n "$pic_flag" && test -z "$old_library"; then
-	    $echo "$modename: cannot find static library for \`$arg'" 1>&2
-	    exit 1
+	elif test $linkmode = prog; then
+	  if test "$alldeplibs" = yes &&
+	     { test "$deplibs_check_method" = pass_all ||
+	       { test "$build_libtool_libs" = yes &&
+		 test -n "$library_names"; }; }; then
+	    # We only need to search for static libraries
+	    continue
 	  fi
 
+	  # Try to link the static library
 	  # Here we assume that one of hardcode_direct or hardcode_minus_L
 	  # is not unsupported.  This is valid on all known static and
 	  # shared platforms.
 	  if test "$hardcode_direct" != unsupported; then
 	    test -n "$old_library" && linklib="$old_library"
-	    compile_command="$compile_command $dir/$linklib"
-	    finalize_command="$finalize_command $dir/$linklib"
+	    compile_deplibs="$dir/$linklib $compile_deplibs"
+	    finalize_deplibs="$dir/$linklib $finalize_deplibs"
 	  else
-	    case "$compile_command " in
-	    *" -L$dir "*) ;;
-	    *) compile_command="$compile_command -L$dir";;
-	    esac
-	    compile_command="$compile_command -l$name"
-	    case "$finalize_command " in
-	    *" -L$dir "*) ;;
-	    *) finalize_command="$finalize_command -L$dir";;
-	    esac
-	    finalize_command="$finalize_command -l$name"
+	    compile_deplibs="-l$name -L$dir $compile_deplibs"
+	    finalize_deplibs="-l$name -L$dir $finalize_deplibs"
 	  fi
-	fi
-
-	# Add in any libraries that this one depends upon.
-	compile_command="$compile_command$dependency_libs"
-	finalize_command="$finalize_command$dependency_libs"
-	continue
-	;;
-
-      # Some other compiler argument.
-      *)
-	# Unknown arguments in both finalize_command and compile_command need
-	# to be aesthetically quoted because they are evaled later.
-	arg=`$echo "X$arg" | $Xsed -e "$sed_quote_subst"`
-	case "$arg" in
-	*[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*)
-	  arg="\"$arg\""
-	  ;;
-	esac
-	;;
-      esac
-
-      # Now actually substitute the argument into the commands.
-      if test -n "$arg"; then
-	compile_command="$compile_command $arg"
-	finalize_command="$finalize_command $arg"
-      fi
-    done
-
-    if test -n "$prev"; then
-      $echo "$modename: the \`$prevarg' option requires an argument" 1>&2
-      $echo "$help" 1>&2
-      exit 1
-    fi
+	elif test "$build_libtool_libs" = yes; then
+	  # Not a shared library
+	  if test "$deplibs_check_method" != pass_all; then
+	    # We're trying link a shared library against a static one
+	    # but the system doesn't support it.
 
-    if test "$export_dynamic" = yes && test -n "$export_dynamic_flag_spec"; then
-      eval arg=\"$export_dynamic_flag_spec\"
-      compile_command="$compile_command $arg"
-      finalize_command="$finalize_command $arg"
-    fi
+	    # Just print a warning and add the library to dependency_libs so
+	    # that the program can be linked against the static library.
+	    echo
+	    echo "*** Warning: This system can not link to static lib archive $lib."
+	    echo "*** I have the capability to make that library automatically link in when"
+	    echo "*** you link to this library.  But I can only do this if you have a"
+	    echo "*** shared version of the library, which you do not appear to have."
+	    if test "$module" = yes; then
+	      echo "*** But as you try to build a module library, libtool will still create "
+	      echo "*** a static module, that should work as long as the dlopening application"
+	      echo "*** is linked with the -dlopen flag to resolve symbols at runtime."
+	      if test -z "$global_symbol_pipe"; then
+		echo
+		echo "*** However, this would only work if libtool was able to extract symbol"
+		echo "*** lists from a program, using \`nm' or equivalent, but libtool could"
+		echo "*** not find such a program.  So, this module is probably useless."
+		echo "*** \`nm' from GNU binutils and a full rebuild may help."
+	      fi
+	      if test "$build_old_libs" = no; then
+		build_libtool_libs=module
+		build_old_libs=yes
+	      else
+		build_libtool_libs=no
+	      fi
+	    fi
+	  else
+	    convenience="$convenience $dir/$old_library"
+	    old_convenience="$old_convenience $dir/$old_library"
+	    deplibs="$dir/$old_library $deplibs"
+	    link_static=yes
+	  fi
+	fi # link shared/static library?
 
-    oldlibs=
-    # calculate the name of the file, without its directory
-    outputname=`$echo "X$output" | $Xsed -e 's%^.*/%%'`
-    libobjs_save="$libobjs"
+	if test $linkmode = lib; then
+	  if test -n "$dependency_libs" &&
+	     { test $hardcode_into_libs != yes || test $build_old_libs = yes ||
+	       test $link_static = yes; }; then
+	    # Extract -R from dependency_libs
+	    temp_deplibs=
+	    for libdir in $dependency_libs; do
+	      case $libdir in
+	      -R*) temp_xrpath=`$echo "X$libdir" | $Xsed -e 's/^-R//'`
+		   case " $xrpath " in
+		   *" $temp_xrpath "*) ;;
+		   *) xrpath="$xrpath $temp_xrpath";;
+		   esac;;
+	      *) temp_deplibs="$temp_deplibs $libdir";;
+	      esac
+	    done
+	    dependency_libs="$temp_deplibs"
+	  fi
 
-    case "$output" in
-    "")
-      $echo "$modename: you must specify an output file" 1>&2
-      $echo "$help" 1>&2
-      exit 1
-      ;;
+	  newlib_search_path="$newlib_search_path $absdir"
+	  # Link against this library
+	  test "$link_static" = no && newdependency_libs="$abs_ladir/$laname $newdependency_libs"
+	  # ... and its dependency_libs
+	  tmp_libs=
+	  for deplib in $dependency_libs; do
+	    newdependency_libs="$deplib $newdependency_libs"
+	    if test "X$duplicate_deps" = "Xyes" ; then
+	      case "$tmp_libs " in
+	      *" $deplib "*) specialdeplibs="$specialdeplibs $deplib" ;;
+	      esac
+	    fi
+	    tmp_libs="$tmp_libs $deplib"
+	  done
 
-    *.a | *.lib)
-      if test -n "$link_against_libtool_libs"; then
-	$echo "$modename: error: cannot link libtool libraries into archives" 1>&2
-	exit 1
+	  if test $link_all_deplibs != no; then
+	    # Add the search paths of all dependency libraries
+	    for deplib in $dependency_libs; do
+	      case $deplib in
+	      -L*) path="$deplib" ;;
+	      *.la)
+		dir=`$echo "X$deplib" | $Xsed -e 's%/[^/]*$%%'`
+		test "X$dir" = "X$deplib" && dir="."
+		# We need an absolute path.
+		case $dir in
+		[\\/]* | [A-Za-z]:[\\/]*) absdir="$dir" ;;
+		*)
+		  absdir=`cd "$dir" && pwd`
+		  if test -z "$absdir"; then
+		    $echo "$modename: warning: cannot determine absolute directory name of \`$dir'" 1>&2
+		    absdir="$dir"
+		  fi
+		  ;;
+		esac
+		if grep "^installed=no" $deplib > /dev/null; then
+		  path="-L$absdir/$objdir"
+		else
+		  eval libdir=`${SED} -n -e 's/^libdir=\(.*\)$/\1/p' $deplib`
+		  if test -z "$libdir"; then
+		    $echo "$modename: \`$deplib' is not a valid libtool archive" 1>&2
+		    exit 1
+		  fi
+		  if test "$absdir" != "$libdir"; then
+		    $echo "$modename: warning: \`$deplib' seems to be moved" 1>&2
+		  fi
+		  path="-L$absdir"
+		fi
+		;;
+	      *) continue ;;
+	      esac
+	      case " $deplibs " in
+	      *" $path "*) ;;
+	      *) deplibs="$deplibs $path" ;;
+	      esac
+	    done
+	  fi # link_all_deplibs != no
+	fi # linkmode = lib
+      done # for deplib in $libs
+      if test $pass = dlpreopen; then
+	# Link the dlpreopened libraries before other libraries
+	for deplib in $save_deplibs; do
+	  deplibs="$deplib $deplibs"
+	done
       fi
+      if test $pass != dlopen; then
+	test $pass != scan && dependency_libs="$newdependency_libs"
+	if test $pass != conv; then
+	  # Make sure lib_search_path contains only unique directories.
+	  lib_search_path=
+	  for dir in $newlib_search_path; do
+	    case "$lib_search_path " in
+	    *" $dir "*) ;;
+	    *) lib_search_path="$lib_search_path $dir" ;;
+	    esac
+	  done
+	  newlib_search_path=
+	fi
 
-      if test -n "$deplibs"; then
-	$echo "$modename: warning: \`-l' and \`-L' are ignored for archives" 1>&2
+	if test "$linkmode,$pass" != "prog,link"; then
+	  vars="deplibs"
+	else
+	  vars="compile_deplibs finalize_deplibs"
+	fi
+	for var in $vars dependency_libs; do
+	  # Add libraries to $var in reverse order
+	  eval tmp_libs=\"\$$var\"
+	  new_libs=
+	  for deplib in $tmp_libs; do
+	    case $deplib in
+	    -L*) new_libs="$deplib $new_libs" ;;
+	    *)
+	      case " $specialdeplibs " in
+	      *" $deplib "*) new_libs="$deplib $new_libs" ;;
+	      *)
+		case " $new_libs " in
+		*" $deplib "*) ;;
+		*) new_libs="$deplib $new_libs" ;;
+		esac
+		;;
+	      esac
+	      ;;
+	    esac
+	  done
+	  tmp_libs=
+	  for deplib in $new_libs; do
+	    case $deplib in
+	    -L*)
+	      case " $tmp_libs " in
+	      *" $deplib "*) ;;
+	      *) tmp_libs="$tmp_libs $deplib" ;;
+	      esac
+	      ;;
+	    *) tmp_libs="$tmp_libs $deplib" ;;
+	    esac
+	  done
+	  eval $var=\"$tmp_libs\"
+	done # for var
+      fi
+      if test "$pass" = "conv" &&
+       { test "$linkmode" = "lib" || test "$linkmode" = "prog"; }; then
+	libs="$deplibs" # reset libs
+	deplibs=
       fi
+    done # for pass
+    if test $linkmode = prog; then
+      dlfiles="$newdlfiles"
+      dlprefiles="$newdlprefiles"
+    fi
 
+    case $linkmode in
+    oldlib)
       if test -n "$dlfiles$dlprefiles" || test "$dlself" != no; then
 	$echo "$modename: warning: \`-dlopen' is ignored for archives" 1>&2
       fi
@@ -1566,11 +2179,12 @@
       # Now set the variables for building old libraries.
       build_libtool_libs=no
       oldlibs="$output"
+      objs="$objs$old_deplibs"
       ;;
 
-    *.la)
+    lib)
       # Make sure we only generate libraries of the form `libNAME.la'.
-      case "$outputname" in
+      case $outputname in
       lib*)
 	name=`$echo "X$outputname" | $Xsed -e 's/\.la$//' -e 's/^lib//'`
 	eval libname=\"$libname_spec\"
@@ -1591,26 +2205,20 @@
 	;;
       esac
 
-      output_objdir=`$echo "X$output" | $Xsed -e 's%/[^/]*$%%'`
-      if test "X$output_objdir" = "X$output"; then
-	output_objdir="$objdir"
-      else
-	output_objdir="$output_objdir/$objdir"
-      fi
-
       if test -n "$objs"; then
-	$echo "$modename: cannot build libtool library \`$output' from non-libtool objects:$objs" 2>&1
-	exit 1
-      fi
-
-      # How the heck are we supposed to write a wrapper for a shared library?
-      if test -n "$link_against_libtool_libs"; then
-	 $echo "$modename: error: cannot link shared libraries into libtool libraries" 1>&2
-	 exit 1
+	if test "$deplibs_check_method" != pass_all; then
+	  $echo "$modename: cannot build libtool library \`$output' from non-libtool objects on this host:$objs" 2>&1
+	  exit 1
+	else
+	  echo
+	  echo "*** Warning: Linking the shared library $output against the non-libtool"
+	  echo "*** objects $objs is not portable!"
+	  libobjs="$libobjs $objs"
+	fi
       fi
 
-      if test -n "$dlfiles$dlprefiles" || test "$dlself" != no; then
-	$echo "$modename: warning: \`-dlopen' is ignored for libtool libraries" 1>&2
+      if test "$dlself" != no; then
+	$echo "$modename: warning: \`-dlopen self' is ignored for libtool libraries" 1>&2
       fi
 
       set dummy $rpath
@@ -1628,7 +2236,6 @@
 	  build_libtool_libs=convenience
 	  build_old_libs=yes
 	fi
-	dependency_libs="$deplibs"
 
 	if test -n "$vinfo"; then
 	  $echo "$modename: warning: \`-version-info' is ignored for convenience libraries" 1>&2
@@ -1640,7 +2247,7 @@
       else
 
 	# Parse the version information argument.
-	IFS="${IFS= 	}"; save_ifs="$IFS"; IFS=':'
+	save_ifs="$IFS"; IFS=':'
 	set dummy $vinfo 0 0 0
 	IFS="$save_ifs"
 
@@ -1655,8 +2262,8 @@
 	age="$4"
 
 	# Check that each of the things are valid numbers.
-	case "$current" in
-	0 | [1-9] | [1-9][0-9]*) ;;
+	case $current in
+	0 | [1-9] | [1-9][0-9] | [1-9][0-9][0-9]) ;;
 	*)
 	  $echo "$modename: CURRENT \`$current' is not a nonnegative integer" 1>&2
 	  $echo "$modename: \`$vinfo' is not valid version information" 1>&2
@@ -1664,8 +2271,8 @@
 	  ;;
 	esac
 
-	case "$revision" in
-	0 | [1-9] | [1-9][0-9]*) ;;
+	case $revision in
+	0 | [1-9] | [1-9][0-9] | [1-9][0-9][0-9]) ;;
 	*)
 	  $echo "$modename: REVISION \`$revision' is not a nonnegative integer" 1>&2
 	  $echo "$modename: \`$vinfo' is not valid version information" 1>&2
@@ -1673,8 +2280,8 @@
 	  ;;
 	esac
 
-	case "$age" in
-	0 | [1-9] | [1-9][0-9]*) ;;
+	case $age in
+	0 | [1-9] | [1-9][0-9] | [1-9][0-9][0-9]) ;;
 	*)
 	  $echo "$modename: AGE \`$age' is not a nonnegative integer" 1>&2
 	  $echo "$modename: \`$vinfo' is not valid version information" 1>&2
@@ -1692,21 +2299,49 @@
 	major=
 	versuffix=
 	verstring=
-	case "$version_type" in
+	case $version_type in
 	none) ;;
 
-	irix)
+	darwin)
+	  # Like Linux, but with the current version available in
+	  # verstring for coding it into the library header
+	  major=.`expr $current - $age`
+	  versuffix="$major.$age.$revision"
+	  # Darwin ld doesn't like 0 for these options...
+	  minor_current=`expr $current + 1`
+	  verstring="-compatibility_version $minor_current -current_version $minor_current.$revision"
+	  ;;
+
+	freebsd-aout)
+	  major=".$current"
+	  versuffix=".$current.$revision";
+	  ;;
+
+	freebsd-elf)
+	  major=".$current"
+	  versuffix=".$current";
+	  ;;
+
+	irix | nonstopux)
 	  major=`expr $current - $age + 1`
-	  versuffix="$major.$revision"
-	  verstring="sgi$major.$revision"
+
+	  case $version_type in
+	    nonstopux) verstring_prefix=nonstopux ;;
+	    *)         verstring_prefix=sgi ;;
+	  esac
+	  verstring="$verstring_prefix$major.$revision"
 
 	  # Add in all the interfaces that we are compatible with.
 	  loop=$revision
 	  while test $loop != 0; do
 	    iface=`expr $revision - $loop`
 	    loop=`expr $loop - 1`
-	    verstring="sgi$major.$iface:$verstring"
+	    verstring="$verstring_prefix$major.$iface:$verstring"
 	  done
+
+	  # Before this point, $major must not contain `.'.
+	  major=.$major
+	  versuffix="$major.$revision"
 	  ;;
 
 	linux)
@@ -1715,7 +2350,7 @@
 	  ;;
 
 	osf)
-	  major=`expr $current - $age`
+	  major=.`expr $current - $age`
 	  versuffix=".$current.$age.$revision"
 	  verstring="$current.$age.$revision"
 
@@ -1736,21 +2371,11 @@
 	  versuffix=".$current.$revision"
 	  ;;
 
-	freebsd-aout)
-	  major=".$current"
-	  versuffix=".$current.$revision";
-	  ;;
-
-	freebsd-elf)
-	  major=".$current"
-	  versuffix=".$current";
-	  ;;
-
 	windows)
-	  # Like Linux, but with '-' rather than '.', since we only
-	  # want one extension on Windows 95.
+	  # Use '-' rather than '.', since we only want one
+	  # extension on DOS 8.3 filesystems.
 	  major=`expr $current - $age`
-	  versuffix="-$major-$age-$revision"
+	  versuffix="-$major"
 	  ;;
 
 	*)
@@ -1764,6 +2389,16 @@
 	if test -z "$vinfo" && test -n "$release"; then
 	  major=
 	  verstring="0.0"
+	  case $version_type in
+	  darwin)
+	    # we can't check for "0.0" in archive_cmds due to quoting
+	    # problems, so we reset it completely
+	    verstring=""
+	    ;;
+	  *)
+	    verstring="0.0"
+	    ;;
+	  esac
 	  if test "$need_version" = no; then
 	    versuffix=
 	  else
@@ -1777,7 +2412,7 @@
 	  versuffix=
 	  verstring=""
 	fi
-	
+
 	# Check to see if the archive will have undefined symbols.
 	if test "$allow_undefined" = yes; then
 	  if test "$allow_undefined_flag" = unsupported; then
@@ -1789,34 +2424,12 @@
 	  # Don't allow undefined symbols.
 	  allow_undefined_flag="$no_undefined_flag"
 	fi
-
-	dependency_libs="$deplibs"
-	case "$host" in
-	*-*-cygwin* | *-*-mingw* | *-*-os2* | *-*-beos*)
-	  # these systems don't actually have a c library (as such)!
-	  ;;
-        *-*-rhapsody*)
-	  # rhapsody is a little odd...
-	  deplibs="$deplibs -framework System"
-	  ;;
-	*)
-	  # Add libc to deplibs on all other systems.
-	  deplibs="$deplibs -lc"
-	  ;;
-	esac
       fi
 
-      # Create the output directory, or remove our outputs if we need to.
-      if test -d $output_objdir; then
+      if test "$mode" != relink; then
+	# Remove our outputs.
 	$show "${rm}r $output_objdir/$outputname $output_objdir/$libname.* $output_objdir/${libname}${release}.*"
 	$run ${rm}r $output_objdir/$outputname $output_objdir/$libname.* $output_objdir/${libname}${release}.*
-      else
-	$show "$mkdir $output_objdir"
-	$run $mkdir $output_objdir
-	status=$?
-	if test $status -ne 0 && test ! -d $output_objdir; then
-	  exit $status
-	fi
       fi
 
       # Now set the variables for building old libraries.
@@ -1827,7 +2440,73 @@
 	oldobjs="$objs "`$echo "X$libobjs" | $SP2NL | $Xsed -e '/\.'${libext}'$/d' -e "$lo2o" | $NL2SP`
       fi
 
+      # Eliminate all temporary directories.
+      for path in $notinst_path; do
+	lib_search_path=`echo "$lib_search_path " | ${SED} -e 's% $path % %g'`
+	deplibs=`echo "$deplibs " | ${SED} -e 's% -L$path % %g'`
+	dependency_libs=`echo "$dependency_libs " | ${SED} -e 's% -L$path % %g'`
+      done
+
+      if test -n "$xrpath"; then
+	# If the user specified any rpath flags, then add them.
+	temp_xrpath=
+	for libdir in $xrpath; do
+	  temp_xrpath="$temp_xrpath -R$libdir"
+	  case "$finalize_rpath " in
+	  *" $libdir "*) ;;
+	  *) finalize_rpath="$finalize_rpath $libdir" ;;
+	  esac
+	done
+	if test $hardcode_into_libs != yes || test $build_old_libs = yes; then
+	  dependency_libs="$temp_xrpath $dependency_libs"
+	fi
+      fi
+
+      # Make sure dlfiles contains only unique files that won't be dlpreopened
+      old_dlfiles="$dlfiles"
+      dlfiles=
+      for lib in $old_dlfiles; do
+	case " $dlprefiles $dlfiles " in
+	*" $lib "*) ;;
+	*) dlfiles="$dlfiles $lib" ;;
+	esac
+      done
+
+      # Make sure dlprefiles contains only unique files
+      old_dlprefiles="$dlprefiles"
+      dlprefiles=
+      for lib in $old_dlprefiles; do
+	case "$dlprefiles " in
+	*" $lib "*) ;;
+	*) dlprefiles="$dlprefiles $lib" ;;
+	esac
+      done
+
       if test "$build_libtool_libs" = yes; then
+	if test -n "$rpath"; then
+	  case $host in
+	  *-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2* | *-*-beos*)
+	    # these systems don't actually have a c library (as such)!
+	    ;;
+	  *-*-rhapsody* | *-*-darwin1.[012])
+	    # Rhapsody C library is in the System framework
+	    deplibs="$deplibs -framework System"
+	    ;;
+	  *-*-netbsd*)
+	    # Don't link with libc until the a.out ld.so is fixed.
+	    ;;
+	  *-*-openbsd* | *-*-freebsd*)
+	    # Do not include libc due to us having libc/libc_r.
+	    ;;
+	  *)
+	    # Add libc to deplibs on all other systems if necessary.
+	    if test $build_libtool_need_lc = "yes"; then
+	      deplibs="$deplibs -lc"
+	    fi
+	    ;;
+	  esac
+	fi
+
 	# Transform deplibs into only deplibs that can be linked in shared.
 	name_save=$name
 	libname_save=$libname
@@ -1842,7 +2521,7 @@
 	major=""
 	newdeplibs=
 	droppeddeps=no
-	case "$deplibs_check_method" in
+	case $deplibs_check_method in
 	pass_all)
 	  # Don't check for shared/static.  Everything works.
 	  # This might be a little naive.  We might want to check
@@ -1867,7 +2546,7 @@
 	    for i in $deplibs; do
 	      name="`expr $i : '-l\(.*\)'`"
 	      # If $name is empty we are operating on a -L argument.
-	      if test "$name" != "" ; then
+	      if test -n "$name" && test "$name" != "0"; then
 		libname=`eval \\$echo \"$libname_spec\"`
 		deplib_matches=`eval \\$echo \"$library_names_spec\"`
 		set dummy $deplib_matches
@@ -1877,22 +2556,24 @@
 		else
 		  droppeddeps=yes
 		  echo
-		  echo "*** Warning: This library needs some functionality provided by $i."
+		  echo "*** Warning: dynamic linker does not accept needed library $i."
 		  echo "*** I have the capability to make that library automatically link in when"
 		  echo "*** you link to this library.  But I can only do this if you have a"
-		  echo "*** shared version of the library, which you do not appear to have."
+		  echo "*** shared version of the library, which I believe you do not have"
+		  echo "*** because a test_compile did reveal that the linker did not use it for"
+		  echo "*** its dynamic dependency list that programs get resolved with at runtime."
 		fi
 	      else
 		newdeplibs="$newdeplibs $i"
 	      fi
 	    done
 	  else
-	    # Error occured in the first compile.  Let's try to salvage the situation:
-	    # Compile a seperate program for each library.
+	    # Error occured in the first compile.  Let's try to salvage
+	    # the situation: Compile a separate program for each library.
 	    for i in $deplibs; do
 	      name="`expr $i : '-l\(.*\)'`"
 	     # If $name is empty we are operating on a -L argument.
-	      if test "$name" != "" ; then
+	      if test -n "$name" && test "$name" != "0"; then
 		$rm conftest
 		$CC -o conftest conftest.c $i
 		# Did it work?
@@ -1907,10 +2588,12 @@
 		  else
 		    droppeddeps=yes
 		    echo
-		    echo "*** Warning: This library needs some functionality provided by $i."
+		    echo "*** Warning: dynamic linker does not accept needed library $i."
 		    echo "*** I have the capability to make that library automatically link in when"
 		    echo "*** you link to this library.  But I can only do this if you have a"
-		    echo "*** shared version of the library, which you do not appear to have."
+		    echo "*** shared version of the library, which you do not appear to have"
+		    echo "*** because a test_compile did reveal that the linker did not use this one"
+		    echo "*** as a dynamic dependency that programs can get resolved with at runtime."
 		  fi
 		else
 		  droppeddeps=yes
@@ -1928,19 +2611,19 @@
 	  ;;
 	file_magic*)
 	  set dummy $deplibs_check_method
-	  file_magic_regex="`expr \"$deplibs_check_method\" : \"$2 \(.*\)\"`"
+	  file_magic_regex=`expr "$deplibs_check_method" : "$2 \(.*\)"`
 	  for a_deplib in $deplibs; do
 	    name="`expr $a_deplib : '-l\(.*\)'`"
 	    # If $name is empty we are operating on a -L argument.
-	    if test "$name" != "" ; then
+	    if test -n "$name" && test "$name" != "0"; then
 	      libname=`eval \\$echo \"$libname_spec\"`
-	      for i in $lib_search_path; do
+	      for i in $lib_search_path $sys_lib_search_path $shlib_search_path; do
 		    potential_libs=`ls $i/$libname[.-]* 2>/dev/null`
 		    for potent_lib in $potential_libs; do
 		      # Follow soft links.
 		      if ls -lLd "$potent_lib" 2>/dev/null \
 			 | grep " -> " >/dev/null; then
-			continue 
+			continue
 		      fi
 		      # The statement above tries to avoid entering an
 		      # endless loop below, in case of cyclic links.
@@ -1949,14 +2632,14 @@
 		      # but so what?
 		      potlib="$potent_lib"
 		      while test -h "$potlib" 2>/dev/null; do
-			potliblink=`ls -ld $potlib | sed 's/.* -> //'`
-			case "$potliblink" in
+			potliblink=`ls -ld $potlib | ${SED} 's/.* -> //'`
+			case $potliblink in
 			[\\/]* | [A-Za-z]:[\\/]*) potlib="$potliblink";;
 			*) potlib=`$echo "X$potlib" | $Xsed -e 's,[^/]*$,,'`"$potliblink";;
 			esac
 		      done
 		      if eval $file_magic_cmd \"\$potlib\" 2>/dev/null \
-			 | sed 10q \
+			 | ${SED} 10q \
 			 | egrep "$file_magic_regex" > /dev/null; then
 			newdeplibs="$newdeplibs $a_deplib"
 			a_deplib=""
@@ -1967,10 +2650,59 @@
 	      if test -n "$a_deplib" ; then
 		droppeddeps=yes
 		echo
-		echo "*** Warning: This library needs some functionality provided by $a_deplib."
+		echo "*** Warning: linker path does not have real file for library $a_deplib."
 		echo "*** I have the capability to make that library automatically link in when"
 		echo "*** you link to this library.  But I can only do this if you have a"
-		echo "*** shared version of the library, which you do not appear to have."
+		echo "*** shared version of the library, which you do not appear to have"
+		echo "*** because I did check the linker path looking for a file starting"
+		if test -z "$potlib" ; then
+		  echo "*** with $libname but no candidates were found. (...for file magic test)"
+		else
+		  echo "*** with $libname and none of the candidates passed a file format test"
+		  echo "*** using a file magic. Last file checked: $potlib"
+		fi
+	      fi
+	    else
+	      # Add a -L argument.
+	      newdeplibs="$newdeplibs $a_deplib"
+	    fi
+	  done # Gone through all deplibs.
+	  ;;
+	match_pattern*)
+	  set dummy $deplibs_check_method
+	  match_pattern_regex=`expr "$deplibs_check_method" : "$2 \(.*\)"`
+	  for a_deplib in $deplibs; do
+	    name="`expr $a_deplib : '-l\(.*\)'`"
+	    # If $name is empty we are operating on a -L argument.
+	    if test -n "$name" && test "$name" != "0"; then
+	      libname=`eval \\$echo \"$libname_spec\"`
+	      for i in $lib_search_path $sys_lib_search_path $shlib_search_path; do
+		potential_libs=`ls $i/$libname[.-]* 2>/dev/null`
+		for potent_lib in $potential_libs; do
+		  potlib="$potent_lib" # see symlink-check below in file_magic test
+		  if eval echo \"$potent_lib\" 2>/dev/null \
+		      | ${SED} 10q \
+		      | egrep "$match_pattern_regex" > /dev/null; then
+		    newdeplibs="$newdeplibs $a_deplib"
+		    a_deplib=""
+		    break 2
+		  fi
+		done
+	      done
+	      if test -n "$a_deplib" ; then
+		droppeddeps=yes
+		echo
+		echo "*** Warning: linker path does not have real file for library $a_deplib."
+		echo "*** I have the capability to make that library automatically link in when"
+		echo "*** you link to this library.  But I can only do this if you have a"
+		echo "*** shared version of the library, which you do not appear to have"
+		echo "*** because I did check the linker path looking for a file starting"
+		if test -z "$potlib" ; then
+		  echo "*** with $libname but no candidates were found. (...for regex pattern test)"
+		else
+		  echo "*** with $libname and none of the candidates passed a file format test"
+		  echo "*** using a regex pattern. Last file checked: $potlib"
+		fi
 	      fi
 	    else
 	      # Add a -L argument.
@@ -2000,6 +2732,13 @@
 	libname=$libname_save
 	name=$name_save
 
+	case $host in
+	*-*-rhapsody* | *-*-darwin1.[012])
+	  # On Rhapsody replace the C library is the System framework
+	  newdeplibs=`$echo "X $newdeplibs" | $Xsed -e 's/ -lc / -framework System /'`
+	  ;;
+	esac
+
 	if test "$droppeddeps" = yes; then
 	  if test "$module" = yes; then
 	    echo
@@ -2025,6 +2764,21 @@
 	    echo "*** The inter-library dependencies that have been dropped here will be"
 	    echo "*** automatically added whenever a program is linked with this library"
 	    echo "*** or is declared to -dlopen it."
+
+	    if test $allow_undefined = no; then
+	      echo
+	      echo "*** Since this library must not contain undefined symbols,"
+	      echo "*** because either the platform does not support them or"
+	      echo "*** it was explicitly requested with -no-undefined,"
+	      echo "*** libtool will only create a static version of it."
+	      if test "$build_old_libs" = no; then
+		oldlibs="$output_objdir/$libname.$libext"
+		build_libtool_libs=module
+		build_old_libs=yes
+	      else
+		build_libtool_libs=no
+	      fi
+	    fi
 	  fi
 	fi
 	# Done checking deplibs!
@@ -2035,9 +2789,64 @@
       library_names=
       old_library=
       dlname=
-      
+
       # Test again, we may have decided not to build it any more
       if test "$build_libtool_libs" = yes; then
+	if test $hardcode_into_libs = yes; then
+	  # Hardcode the library paths
+	  hardcode_libdirs=
+	  dep_rpath=
+	  rpath="$finalize_rpath"
+	  test "$mode" != relink && rpath="$compile_rpath$rpath"
+	  for libdir in $rpath; do
+	    if test -n "$hardcode_libdir_flag_spec"; then
+	      if test -n "$hardcode_libdir_separator"; then
+		if test -z "$hardcode_libdirs"; then
+		  hardcode_libdirs="$libdir"
+		else
+		  # Just accumulate the unique libdirs.
+		  case $hardcode_libdir_separator$hardcode_libdirs$hardcode_libdir_separator in
+		  *"$hardcode_libdir_separator$libdir$hardcode_libdir_separator"*)
+		    ;;
+		  *)
+		    hardcode_libdirs="$hardcode_libdirs$hardcode_libdir_separator$libdir"
+		    ;;
+		  esac
+		fi
+	      else
+		eval flag=\"$hardcode_libdir_flag_spec\"
+		dep_rpath="$dep_rpath $flag"
+	      fi
+	    elif test -n "$runpath_var"; then
+	      case "$perm_rpath " in
+	      *" $libdir "*) ;;
+	      *) perm_rpath="$perm_rpath $libdir" ;;
+	      esac
+	    fi
+	  done
+	  # Substitute the hardcoded libdirs into the rpath.
+	  if test -n "$hardcode_libdir_separator" &&
+	     test -n "$hardcode_libdirs"; then
+	    libdir="$hardcode_libdirs"
+	    eval dep_rpath=\"$hardcode_libdir_flag_spec\"
+	  fi
+	  if test -n "$runpath_var" && test -n "$perm_rpath"; then
+	    # We should set the runpath_var.
+	    rpath=
+	    for dir in $perm_rpath; do
+	      rpath="$rpath$dir:"
+	    done
+	    eval "$runpath_var='$rpath\$$runpath_var'; export $runpath_var"
+	  fi
+	  test -n "$dep_rpath" && deplibs="$dep_rpath $deplibs"
+	fi
+
+	shlibpath="$finalize_shlibpath"
+	test "$mode" != relink && shlibpath="$compile_shlibpath$shlibpath"
+	if test -n "$shlibpath"; then
+	  eval "$shlibpath_var='$shlibpath\$$shlibpath_var'; export $shlibpath_var"
+	fi
+
 	# Get the real and link names of the library.
 	eval library_names=\"$library_names_spec\"
 	set dummy $library_names
@@ -2049,6 +2858,7 @@
 	else
 	  soname="$realname"
 	fi
+	test -z "$dlname" && dlname=$soname
 
 	lib="$output_objdir/$realname"
 	for link
@@ -2083,7 +2893,7 @@
 	    export_symbols="$output_objdir/$libname.exp"
 	    $run $rm $export_symbols
 	    eval cmds=\"$export_symbols_cmds\"
-	    IFS="${IFS= 	}"; save_ifs="$IFS"; IFS='~'
+	    save_ifs="$IFS"; IFS='~'
 	    for cmd in $cmds; do
 	      IFS="$save_ifs"
 	      $show "$cmd"
@@ -2120,7 +2930,7 @@
 
 	    for xlib in $convenience; do
 	      # Extract the objects.
-	      case "$xlib" in
+	      case $xlib in
 	      [\\/]* | [A-Za-z]:[\\/]*) xabs="$xlib" ;;
 	      *) xabs=`pwd`"/$xlib" ;;
 	      esac
@@ -2145,16 +2955,32 @@
 
 	if test "$thread_safe" = yes && test -n "$thread_safe_flag_spec"; then
 	  eval flag=\"$thread_safe_flag_spec\"
-	  linkopts="$linkopts $flag"
+	  linker_flags="$linker_flags $flag"
+	fi
+
+	# Make a backup of the uninstalled library when relinking
+	if test "$mode" = relink; then
+	  $run eval '(cd $output_objdir && $rm ${realname}U && $mv $realname ${realname}U)' || exit $?
 	fi
 
 	# Do each of the archive commands.
 	if test -n "$export_symbols" && test -n "$archive_expsym_cmds"; then
 	  eval cmds=\"$archive_expsym_cmds\"
 	else
+	  save_deplibs="$deplibs"
+	  for conv in $convenience; do
+	    tmp_deplibs=
+	    for test_deplib in $deplibs; do
+	      if test "$test_deplib" != "$conv"; then
+		tmp_deplibs="$tmp_deplibs $test_deplib"
+	      fi
+	    done
+	    deplibs="$tmp_deplibs"
+	  done
 	  eval cmds=\"$archive_cmds\"
+	  deplibs="$save_deplibs"
 	fi
-	IFS="${IFS= 	}"; save_ifs="$IFS"; IFS='~'
+	save_ifs="$IFS"; IFS='~'
 	for cmd in $cmds; do
 	  IFS="$save_ifs"
 	  $show "$cmd"
@@ -2162,6 +2988,12 @@
 	done
 	IFS="$save_ifs"
 
+	# Restore the uninstalled library and exit
+	if test "$mode" = relink; then
+	  $run eval '(cd $output_objdir && $rm ${realname}T && $mv $realname ${realname}T && $mv "$realname"U $realname)' || exit $?
+	  exit 0
+	fi
+
 	# Create links to the real library.
 	for linkname in $linknames; do
 	  if test "$realname" != "$linkname"; then
@@ -2178,12 +3010,7 @@
       fi
       ;;
 
-    *.lo | *.o | *.obj)
-      if test -n "$link_against_libtool_libs"; then
-	$echo "$modename: error: cannot link libtool libraries into objects" 1>&2
-	exit 1
-      fi
-
+    obj)
       if test -n "$deplibs"; then
 	$echo "$modename: warning: \`-l' and \`-L' are ignored for objects" 1>&2
       fi
@@ -2208,9 +3035,9 @@
 	$echo "$modename: warning: \`-release' is ignored for objects" 1>&2
       fi
 
-      case "$output" in
+      case $output in
       *.lo)
-	if test -n "$objs"; then
+	if test -n "$objs$old_deplibs"; then
 	  $echo "$modename: cannot build library object \`$output' from non-libtool objects" 1>&2
 	  exit 1
 	fi
@@ -2234,7 +3061,7 @@
       gentop=
       # reload_cmds runs $LD directly, so let us get rid of
       # -Wl from whole_archive_flag_spec
-      wl= 
+      wl=
 
       if test -n "$convenience"; then
 	if test -n "$whole_archive_flag_spec"; then
@@ -2253,7 +3080,7 @@
 
 	  for xlib in $convenience; do
 	    # Extract the objects.
-	    case "$xlib" in
+	    case $xlib in
 	    [\\/]* | [A-Za-z]:[\\/]*) xabs="$xlib" ;;
 	    *) xabs=`pwd`"/$xlib" ;;
 	    esac
@@ -2277,11 +3104,11 @@
       fi
 
       # Create the old-style object.
-      reload_objs="$objs "`$echo "X$libobjs" | $SP2NL | $Xsed -e '/\.'${libext}$'/d' -e '/\.lib$/d' -e "$lo2o" | $NL2SP`" $reload_conv_objs"
+      reload_objs="$objs$old_deplibs "`$echo "X$libobjs" | $SP2NL | $Xsed -e '/\.'${libext}$'/d' -e '/\.lib$/d' -e "$lo2o" | $NL2SP`" $reload_conv_objs" ### testsuite: skip nested quoting test
 
       output="$obj"
       eval cmds=\"$reload_cmds\"
-      IFS="${IFS= 	}"; save_ifs="$IFS"; IFS='~'
+      save_ifs="$IFS"; IFS='~'
       for cmd in $cmds; do
 	IFS="$save_ifs"
 	$show "$cmd"
@@ -2312,12 +3139,12 @@
 	exit 0
       fi
 
-      if test -n "$pic_flag"; then
+      if test -n "$pic_flag" || test "$pic_mode" != default; then
 	# Only do commands if we really have different PIC objects.
 	reload_objs="$libobjs $reload_conv_objs"
 	output="$libobj"
 	eval cmds=\"$reload_cmds\"
-	IFS="${IFS= 	}"; save_ifs="$IFS"; IFS='~'
+	save_ifs="$IFS"; IFS='~'
 	for cmd in $cmds; do
 	  IFS="$save_ifs"
 	  $show "$cmd"
@@ -2348,8 +3175,10 @@
       exit 0
       ;;
 
-    # Anything else should be a program.
-    *)
+    prog)
+      case $host in
+	*cygwin*) output=`echo $output | ${SED} -e 's,.exe$,,;s,$,.exe,'` ;;
+      esac
       if test -n "$vinfo"; then
 	$echo "$modename: warning: \`-version-info' is ignored for programs" 1>&2
       fi
@@ -2359,20 +3188,34 @@
       fi
 
       if test "$preload" = yes; then
-	if test "$dlopen" = unknown && test "$dlopen_self" = unknown &&
+	if test "$dlopen_support" = unknown && test "$dlopen_self" = unknown &&
 	   test "$dlopen_self_static" = unknown; then
 	  $echo "$modename: warning: \`AC_LIBTOOL_DLOPEN' not used. Assuming no dlopen support."
-	fi 
+	fi
       fi
-    
+
+      case $host in
+      *-*-rhapsody* | *-*-darwin1.[012])
+	# On Rhapsody replace the C library is the System framework
+	compile_deplibs=`$echo "X $compile_deplibs" | $Xsed -e 's/ -lc / -framework System /'`
+	finalize_deplibs=`$echo "X $finalize_deplibs" | $Xsed -e 's/ -lc / -framework System /'`
+	case $host in
+	*darwin*)
+	  # Don't allow lazy linking, it breaks C++ global constructors
+	  compile_command="$compile_command ${wl}-bind_at_load"
+	  finalize_command="$finalize_command ${wl}-bind_at_load"
+	  ;;
+	esac
+	;;
+      esac
+
+      compile_command="$compile_command $compile_deplibs"
+      finalize_command="$finalize_command $finalize_deplibs"
+
       if test -n "$rpath$xrpath"; then
 	# If the user specified any rpath flags, then add them.
 	for libdir in $rpath $xrpath; do
 	  # This is the magic to use -rpath.
-	  case "$compile_rpath " in
-	  *" $libdir "*) ;;
-	  *) compile_rpath="$compile_rpath $libdir" ;;
-	  esac
 	  case "$finalize_rpath " in
 	  *" $libdir "*) ;;
 	  *) finalize_rpath="$finalize_rpath $libdir" ;;
@@ -2390,7 +3233,7 @@
 	      hardcode_libdirs="$libdir"
 	    else
 	      # Just accumulate the unique libdirs.
-	      case "$hardcode_libdir_separator$hardcode_libdirs$hardcode_libdir_separator" in
+	      case $hardcode_libdir_separator$hardcode_libdirs$hardcode_libdir_separator in
 	      *"$hardcode_libdir_separator$libdir$hardcode_libdir_separator"*)
 		;;
 	      *)
@@ -2408,6 +3251,14 @@
 	  *) perm_rpath="$perm_rpath $libdir" ;;
 	  esac
 	fi
+	case $host in
+	*-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2*)
+	  case :$dllsearchpath: in
+	  *":$libdir:"*) ;;
+	  *) dllsearchpath="$dllsearchpath:$libdir";;
+	  esac
+	  ;;
+	esac
       done
       # Substitute the hardcoded libdirs into the rpath.
       if test -n "$hardcode_libdir_separator" &&
@@ -2426,7 +3277,7 @@
 	      hardcode_libdirs="$libdir"
 	    else
 	      # Just accumulate the unique libdirs.
-	      case "$hardcode_libdir_separator$hardcode_libdirs$hardcode_libdir_separator" in
+	      case $hardcode_libdir_separator$hardcode_libdirs$hardcode_libdir_separator in
 	      *"$hardcode_libdir_separator$libdir$hardcode_libdir_separator"*)
 		;;
 	      *)
@@ -2453,23 +3304,6 @@
       fi
       finalize_rpath="$rpath"
 
-      output_objdir=`$echo "X$output" | $Xsed -e 's%/[^/]*$%%'`
-      if test "X$output_objdir" = "X$output"; then
-	output_objdir="$objdir"
-      else
-	output_objdir="$output_objdir/$objdir"
-      fi
-
-      # Create the binary in the object directory, then wrap it.
-      if test ! -d $output_objdir; then
-	$show "$mkdir $output_objdir"
-	$run $mkdir $output_objdir
-	status=$?
-	if test $status -ne 0 && test ! -d $output_objdir; then
-	  exit $status
-	fi
-      fi
-
       if test -n "$libobjs" && test "$build_old_libs" = yes; then
 	# Transform all the library objects into standard objects.
 	compile_command=`$echo "X$compile_command" | $SP2NL | $Xsed -e "$lo2o" | $NL2SP`
@@ -2486,7 +3320,7 @@
       fi
 
       if test -n "$dlsyms"; then
-	case "$dlsyms" in
+	case $dlsyms in
 	"") ;;
 	*.c)
 	  # Discover the nlist of each of the dlfiles.
@@ -2518,7 +3352,7 @@
 	    test -z "$run" && $echo ': @PROGRAM@ ' > "$nlist"
 
 	    # Add our own program objects to the symbol list.
-	    progfiles=`$echo "X$objs" | $SP2NL | $Xsed -e "$lo2o" | $NL2SP`
+	    progfiles=`$echo "X$objs$old_deplibs" | $SP2NL | $Xsed -e "$lo2o" | $NL2SP`
 	    for arg in $progfiles; do
 	      $show "extracting global C symbols from \`$arg'"
 	      $run eval "$NM $arg | $global_symbol_pipe >> '$nlist'"
@@ -2528,7 +3362,7 @@
 	      $run eval 'egrep -v " ($exclude_expsyms)$" "$nlist" > "$nlist"T'
 	      $run eval '$mv "$nlist"T "$nlist"'
 	    fi
-	    
+
 	    if test -n "$export_symbols_regex"; then
 	      $run eval 'egrep -e "$export_symbols_regex" "$nlist" > "$nlist"T'
 	      $run eval '$mv "$nlist"T "$nlist"'
@@ -2538,9 +3372,9 @@
 	    if test -z "$export_symbols"; then
 	      export_symbols="$output_objdir/$output.exp"
 	      $run $rm $export_symbols
-	      $run eval "sed -n -e '/^: @PROGRAM@$/d' -e 's/^.* \(.*\)$/\1/p' "'< "$nlist" > "$export_symbols"'
+	      $run eval "${SED} -n -e '/^: @PROGRAM@$/d' -e 's/^.* \(.*\)$/\1/p' "'< "$nlist" > "$export_symbols"'
 	    else
-	      $run eval "sed -e 's/\([][.*^$]\)/\\\1/g' -e 's/^/ /' -e 's/$/$/'"' < "$export_symbols" > "$output_objdir/$output.exp"'
+	      $run eval "${SED} -e 's/\([][.*^$]\)/\\\1/g' -e 's/^/ /' -e 's/$/$/'"' < "$export_symbols" > "$output_objdir/$output.exp"'
 	      $run eval 'grep -f "$output_objdir/$output.exp" < "$nlist" > "$nlist"T'
 	      $run eval 'mv "$nlist"T "$nlist"'
 	    fi
@@ -2548,7 +3382,7 @@
 
 	  for arg in $dlprefiles; do
 	    $show "extracting global C symbols from \`$arg'"
-	    name=`echo "$arg" | sed -e 's%^.*/%%'`
+	    name=`echo "$arg" | ${SED} -e 's%^.*/%%'`
 	    $run eval 'echo ": $name " >> "$nlist"'
 	    $run eval "$NM $arg | $global_symbol_pipe >> '$nlist'"
 	  done
@@ -2563,7 +3397,13 @@
 	    fi
 
 	    # Try sorting and uniquifying the output.
-	    if grep -v "^: " < "$nlist" | sort +2 | uniq > "$nlist"S; then
+	    if grep -v "^: " < "$nlist" |
+		if sort -k 3 </dev/null >/dev/null 2>&1; then
+		  sort -k 3
+		else
+		  sort +2
+		fi |
+		uniq > "$nlist"S; then
 	      :
 	    else
 	      grep -v "^: " < "$nlist" > "$nlist"S
@@ -2580,27 +3420,25 @@
 #undef lt_preloaded_symbols
 
 #if defined (__STDC__) && __STDC__
-# define lt_ptr_t void *
+# define lt_ptr void *
 #else
-# define lt_ptr_t char *
+# define lt_ptr char *
 # define const
 #endif
 
 /* The mapping between symbol names and symbols. */
 const struct {
   const char *name;
-  lt_ptr_t address;
+  lt_ptr address;
 }
 lt_preloaded_symbols[] =
 {\
 "
 
-	    sed -n -e 's/^: \([^ ]*\) $/  {\"\1\", (lt_ptr_t) 0},/p' \
-		-e 's/^. \([^ ]*\) \([^ ]*\)$/  {"\2", (lt_ptr_t) \&\2},/p' \
-		  < "$nlist" >> "$output_objdir/$dlsyms"
+	    eval "$global_symbol_to_c_name_address" < "$nlist" >> "$output_objdir/$dlsyms"
 
 	    $echo >> "$output_objdir/$dlsyms" "\
-  {0, (lt_ptr_t) 0}
+  {0, (lt_ptr) 0}
 };
 
 /* This works around a problem in FreeBSD linker */
@@ -2617,13 +3455,13 @@
 	  fi
 
 	  pic_flag_for_symtable=
-	  case "$host" in
+	  case $host in
 	  # compiling the symbol table file with pic_flag works around
 	  # a FreeBSD bug that causes programs to crash when -lm is
 	  # linked before any other PIC object.  But we must not use
 	  # pic_flag when linking with -static.  The problem exists in
 	  # FreeBSD 2.2.6 and is fixed in FreeBSD 3.1.
-	  *-*-freebsd2*|*-*-freebsd3.0*|*-*-freebsdelf3.0*)
+	  *-*-freebsd2*|*-*-freebsd3.0*|*-*-freebsdelf3.0*)
 	    case "$compile_command " in
 	    *" -static "*) ;;
 	    *) pic_flag_for_symtable=" $pic_flag -DPIC -DFREEBSD_WORKAROUND";;
@@ -2662,7 +3500,7 @@
 	finalize_command=`$echo "X$finalize_command" | $Xsed -e "s% @SYMFILE@%%"`
       fi
 
-      if test -z "$link_against_libtool_libs" || test "$build_libtool_libs" != yes; then
+      if test $need_relink = no || test "$build_libtool_libs" != yes; then
 	# Replace the output file specification.
 	compile_command=`$echo "X$compile_command" | $Xsed -e 's%@OUTPUT@%'"$output"'%g'`
 	link_command="$compile_command$compile_rpath"
@@ -2671,7 +3509,7 @@
 	$show "$link_command"
 	$run eval "$link_command"
 	status=$?
-	
+
 	# Delete the generated files.
 	if test -n "$dlsyms"; then
 	  $show "$rm $output_objdir/${outputname}S.${objext}"
@@ -2685,7 +3523,7 @@
 	# We should set the shlibpath_var
 	rpath=
 	for dir in $temp_rpath; do
-	  case "$dir" in
+	  case $dir in
 	  [\\/]* | [A-Za-z]:[\\/]*)
 	    # Absolute path.
 	    rpath="$rpath$dir:"
@@ -2727,11 +3565,24 @@
 	fi
       fi
 
+      if test "$no_install" = yes; then
+	# We don't need to create a wrapper script.
+	link_command="$compile_var$compile_command$compile_rpath"
+	# Replace the output file specification.
+	link_command=`$echo "X$link_command" | $Xsed -e 's%@OUTPUT@%'"$output"'%g'`
+	# Delete the old output file.
+	$run $rm $output
+	# Link the executable and exit
+	$show "$link_command"
+	$run eval "$link_command" || exit $?
+	exit 0
+      fi
+
       if test "$hardcode_action" = relink; then
 	# Fast installation is not supported
 	link_command="$compile_var$compile_command$compile_rpath"
 	relink_command="$finalize_var$finalize_command$finalize_rpath"
-	
+
 	$echo "$modename: warning: this platform does not like uninstalled shared libraries" 1>&2
 	$echo "$modename: \`$output' will be relinked during installation" 1>&2
       else
@@ -2751,7 +3602,7 @@
 
       # Replace the output file specification.
       link_command=`$echo "X$link_command" | $Xsed -e 's%@OUTPUT@%'"$output_objdir/$outputname"'%g'`
-      
+
       # Delete the old output files.
       $run $rm $output $output_objdir/$outputname $output_objdir/lt-$outputname
 
@@ -2763,12 +3614,24 @@
 
       # Quote the relink command for shipping.
       if test -n "$relink_command"; then
+	# Preserve any variables that may affect compiler behavior
+	for var in $variables_saved_for_relink; do
+	  if eval test -z \"\${$var+set}\"; then
+	    relink_command="{ test -z \"\${$var+set}\" || unset $var || { $var=; export $var; }; }; $relink_command"
+	  elif eval var_value=\$$var; test -z "$var_value"; then
+	    relink_command="$var=; export $var; $relink_command"
+	  else
+	    var_value=`$echo "X$var_value" | $Xsed -e "$sed_quote_subst"`
+	    relink_command="$var=\"$var_value\"; export $var; $relink_command"
+	  fi
+	done
+	relink_command="(cd `pwd`; $relink_command)"
 	relink_command=`$echo "X$relink_command" | $Xsed -e "$sed_quote_subst"`
       fi
 
       # Quote $echo for shipping.
       if test "X$echo" = "X$SHELL $0 --fallback-echo"; then
-	case "$0" in
+	case $0 in
 	[\\/]* | [A-Za-z]:[\\/]*) qecho="$SHELL $0 --fallback-echo";;
 	*) qecho="$SHELL `pwd`/$0 --fallback-echo";;
 	esac
@@ -2782,7 +3645,12 @@
 	# win32 will think the script is a binary if it has
 	# a .exe suffix, so we strip it off here.
 	case $output in
-	  *.exe) output=`echo $output|sed 's,.exe$,,'` ;;
+	  *.exe) output=`echo $output|${SED} 's,.exe$,,'` ;;
+	esac
+	# test for cygwin because mv fails w/o .exe extensions
+	case $host in
+	  *cygwin*) exeext=.exe ;;
+	  *) exeext= ;;
 	esac
 	$rm $output
 	trap "$rm $output; exit 1" 1 2 15
@@ -2801,7 +3669,7 @@
 
 # Sed substitution that helps us do robust quoting.  It backslashifies
 # metacharacters that are still active within double-quoted strings.
-Xsed='sed -e 1s/^X//'
+Xsed="${SED}"' -e 1s/^X//'
 sed_quote_subst='$sed_quote_subst'
 
 # The HP-UX ksh and POSIX shell print the target directory to stdout
@@ -2813,7 +3681,7 @@
 # This environment variable determines our operation mode.
 if test \"\$libtool_install_magic\" = \"$magic\"; then
   # install mode needs the following variable:
-  link_against_libtool_libs='$link_against_libtool_libs'
+  notinst_deplibs='$notinst_deplibs'
 else
   # When we are sourced in execute mode, \$file and \$echo are already set.
   if test \"\$libtool_execute_magic\" != \"$magic\"; then
@@ -2839,20 +3707,20 @@
   test \"x\$thisdir\" = \"x\$file\" && thisdir=.
 
   # Follow symbolic links until we get to the real thisdir.
-  file=\`ls -ld \"\$file\" | sed -n 's/.*-> //p'\`
+  file=\`ls -ld \"\$file\" | ${SED} -n 's/.*-> //p'\`
   while test -n \"\$file\"; do
     destdir=\`\$echo \"X\$file\" | \$Xsed -e 's%/[^/]*\$%%'\`
 
     # If there was a directory component, then change thisdir.
     if test \"x\$destdir\" != \"x\$file\"; then
       case \"\$destdir\" in
-      [\\/]* | [A-Za-z]:[\\/]*) thisdir=\"\$destdir\" ;;
+      [\\\\/]* | [A-Za-z]:[\\\\/]*) thisdir=\"\$destdir\" ;;
       *) thisdir=\"\$thisdir/\$destdir\" ;;
       esac
     fi
 
     file=\`\$echo \"X\$file\" | \$Xsed -e 's%^.*/%%'\`
-    file=\`ls -ld \"\$thisdir/\$file\" | sed -n 's/.*-> //p'\`
+    file=\`ls -ld \"\$thisdir/\$file\" | ${SED} -n 's/.*-> //p'\`
   done
 
   # Try to get the absolute directory name.
@@ -2862,11 +3730,11 @@
 
 	if test "$fast_install" = yes; then
 	  echo >> $output "\
-  program=lt-'$outputname'
+  program=lt-'$outputname'$exeext
   progdir=\"\$thisdir/$objdir\"
-  
+
   if test ! -f \"\$progdir/\$program\" || \\
-     { file=\`ls -1dt \"\$progdir/\$program\" \"\$progdir/../\$program\" 2>/dev/null | sed 1q\`; \\
+     { file=\`ls -1dt \"\$progdir/\$program\" \"\$progdir/../\$program\" 2>/dev/null | ${SED} 1q\`; \\
        test \"X\$file\" != \"X\$progdir/\$program\"; }; then
 
     file=\"\$\$-\$program\"
@@ -2881,8 +3749,9 @@
 
     # relink executable if necessary
     if test -n \"\$relink_command\"; then
-      if (cd \"\$thisdir\" && eval \$relink_command); then :
+      if relink_command_output=\`eval \$relink_command 2>&1\`; then :
       else
+	$echo \"\$relink_command_output\" >&2
 	$rm \"\$progdir/\$file\"
 	exit 1
       fi
@@ -2911,7 +3780,7 @@
     $shlibpath_var=\"$temp_rpath\$$shlibpath_var\"
 
     # Some systems cannot cope with colon-terminated $shlibpath_var
-    # The second colon is a workaround for a bug in BeOS R4 sed
+    # The second colon is a workaround for a bug in BeOS R4 ${SED}
     $shlibpath_var=\`\$echo \"X\$$shlibpath_var\" | \$Xsed -e 's/::*\$//'\`
 
     export $shlibpath_var
@@ -2931,9 +3800,9 @@
       # Run the actual program with our arguments.
 "
 	case $host in
-	  # win32 systems need to use the prog path for dll
-	  # lookup to work
-	*-*-cygwin*)
+	# win32 systems need to use the prog path for dll
+	# lookup to work
+	*-*-cygwin* | *-*-pw32*)
 	  $echo >> $output "\
       exec \$progdir/\$program \${1+\"\$@\"}
 "
@@ -2987,7 +3856,7 @@
 	  oldobjs="$libobjs_save"
 	  build_libtool_libs=no
 	else
-	  oldobjs="$objs "`$echo "X$libobjs_save" | $SP2NL | $Xsed -e '/\.'${libext}'$/d' -e '/\.lib$/d' -e "$lo2o" | $NL2SP`
+	  oldobjs="$objs$old_deplibs "`$echo "X$libobjs_save" | $SP2NL | $Xsed -e '/\.'${libext}'$/d' -e '/\.lib$/d' -e "$lo2o" | $NL2SP`
 	fi
 	addlibs="$old_convenience"
       fi
@@ -3003,11 +3872,11 @@
 	  exit $status
 	fi
 	generated="$generated $gentop"
-	  
+
 	# Add in members from convenience archives.
 	for xlib in $addlibs; do
 	  # Extract the objects.
-	  case "$xlib" in
+	  case $xlib in
 	  [\\/]* | [A-Za-z]:[\\/]*) xabs="$xlib" ;;
 	  *) xabs=`pwd`"/$xlib" ;;
 	  esac
@@ -3053,7 +3922,7 @@
 
 	eval cmds=\"$old_archive_cmds\"
       fi
-      IFS="${IFS= 	}"; save_ifs="$IFS"; IFS='~'
+      save_ifs="$IFS"; IFS='~'
       for cmd in $cmds; do
 	IFS="$save_ifs"
 	$show "$cmd"
@@ -3068,19 +3937,26 @@
     fi
 
     # Now create the libtool archive.
-    case "$output" in
+    case $output in
     *.la)
       old_library=
       test "$build_old_libs" = yes && old_library="$libname.$libext"
       $show "creating $output"
 
-      if test -n "$xrpath"; then
-	temp_xrpath=
-	for libdir in $xrpath; do
-	  temp_xrpath="$temp_xrpath -R$libdir"
-	done
-	dependency_libs="$temp_xrpath $dependency_libs"
-      fi
+      # Preserve any variables that may affect compiler behavior
+      for var in $variables_saved_for_relink; do
+	if eval test -z \"\${$var+set}\"; then
+	  relink_command="{ test -z \"\${$var+set}\" || unset $var || { $var=; export $var; }; }; $relink_command"
+	elif eval var_value=\$$var; test -z "$var_value"; then
+	  relink_command="$var=; export $var; $relink_command"
+	else
+	  var_value=`$echo "X$var_value" | $Xsed -e "$sed_quote_subst"`
+	  relink_command="$var=\"$var_value\"; export $var; $relink_command"
+	fi
+      done
+      # Quote the link command for shipping.
+      relink_command="(cd `pwd`; $SHELL $0 --mode=relink $libtool_args @inst_prefix_dir@)"
+      relink_command=`$echo "X$relink_command" | $Xsed -e "$sed_quote_subst"`
 
       # Only create the output if not a dry run.
       if test -z "$run"; then
@@ -3090,8 +3966,52 @@
 	      break
 	    fi
 	    output="$output_objdir/$outputname"i
+	    # Replace all uninstalled libtool libraries with the installed ones
+	    newdependency_libs=
+	    for deplib in $dependency_libs; do
+	      case $deplib in
+	      *.la)
+		name=`$echo "X$deplib" | $Xsed -e 's%^.*/%%'`
+		eval libdir=`${SED} -n -e 's/^libdir=\(.*\)$/\1/p' $deplib`
+		if test -z "$libdir"; then
+		  $echo "$modename: \`$deplib' is not a valid libtool archive" 1>&2
+		  exit 1
+		fi
+		newdependency_libs="$newdependency_libs $libdir/$name"
+		;;
+	      *) newdependency_libs="$newdependency_libs $deplib" ;;
+	      esac
+	    done
+	    dependency_libs="$newdependency_libs"
+	    newdlfiles=
+	    for lib in $dlfiles; do
+	      name=`$echo "X$lib" | $Xsed -e 's%^.*/%%'`
+	      eval libdir=`${SED} -n -e 's/^libdir=\(.*\)$/\1/p' $lib`
+	      if test -z "$libdir"; then
+		$echo "$modename: \`$lib' is not a valid libtool archive" 1>&2
+		exit 1
+	      fi
+	      newdlfiles="$newdlfiles $libdir/$name"
+	    done
+	    dlfiles="$newdlfiles"
+	    newdlprefiles=
+	    for lib in $dlprefiles; do
+	      name=`$echo "X$lib" | $Xsed -e 's%^.*/%%'`
+	      eval libdir=`${SED} -n -e 's/^libdir=\(.*\)$/\1/p' $lib`
+	      if test -z "$libdir"; then
+		$echo "$modename: \`$lib' is not a valid libtool archive" 1>&2
+		exit 1
+	      fi
+	      newdlprefiles="$newdlprefiles $libdir/$name"
+	    done
+	    dlprefiles="$newdlprefiles"
 	  fi
 	  $rm $output
+	  # place dlname in correct position for cygwin
+	  tdlname=$dlname
+	  case $host,$output,$installed,$module,$dlname in
+	    *cygwin*,*lai,yes,no,*.dll) tdlname=../bin/$dlname ;;
+	  esac
 	  $echo > $output "\
 # $outputname - a libtool library file
 # Generated by $PROGRAM - GNU $PACKAGE $VERSION$TIMESTAMP
@@ -3100,7 +4020,7 @@
 # It is necessary for linking the library.
 
 # The name that we can dlopen(3).
-dlname='$dlname'
+dlname='$tdlname'
 
 # Names of this library.
 library_names='$library_names'
@@ -3119,16 +4039,23 @@
 # Is this an already installed library?
 installed=$installed
 
+# Files to dlopen/dlpreopen
+dlopen='$dlfiles'
+dlpreopen='$dlprefiles'
+
 # Directory that this library needs to be installed in:
-libdir='$install_libdir'\
-"
+libdir='$install_libdir'"
+	  if test "$installed" = no && test $need_relink = yes; then
+	    $echo >> $output "\
+relink_command=\"$relink_command\""
+	  fi
 	done
       fi
 
       # Do a symbolic link so that the libtool archive can be found in
       # LD_LIBRARY_PATH before the program is installed.
       $show "(cd $output_objdir && $rm $outputname && $LN_S ../$outputname $outputname)"
-      $run eval "(cd $output_objdir && $rm $outputname && $LN_S ../$outputname $outputname)" || exit $?
+      $run eval '(cd $output_objdir && $rm $outputname && $LN_S ../$outputname $outputname)' || exit $?
       ;;
     esac
     exit 0
@@ -3140,10 +4067,12 @@
 
     # There may be an optional sh(1) argument at the beginning of
     # install_prog (especially on Windows NT).
-    if test "$nonopt" = "$SHELL" || test "$nonopt" = /bin/sh; then
+    if test "$nonopt" = "$SHELL" || test "$nonopt" = /bin/sh ||
+       # Allow the use of GNU shtool's install command.
+       $echo "X$nonopt" | $Xsed | grep shtool > /dev/null; then
       # Aesthetically quote it.
       arg=`$echo "X$nonopt" | $Xsed -e "$sed_quote_subst"`
-      case "$arg" in
+      case $arg in
       *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*)
 	arg="\"$arg\""
 	;;
@@ -3159,7 +4088,7 @@
     # The real first argument should be the name of the installation program.
     # Aesthetically quote it.
     arg=`$echo "X$arg" | $Xsed -e "$sed_quote_subst"`
-    case "$arg" in
+    case $arg in
     *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*)
       arg="\"$arg\""
       ;;
@@ -3182,7 +4111,7 @@
 	continue
       fi
 
-      case "$arg" in
+      case $arg in
       -d) isdir=yes ;;
       -f) prev="-f" ;;
       -g) prev="-g" ;;
@@ -3207,7 +4136,7 @@
 
       # Aesthetically quote the argument.
       arg=`$echo "X$arg" | $Xsed -e "$sed_quote_subst"`
-      case "$arg" in
+      case $arg in
       *[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*)
 	arg="\"$arg\""
 	;;
@@ -3258,11 +4187,11 @@
 	exit 1
       fi
     fi
-    case "$destdir" in
+    case $destdir in
     [\\/]* | [A-Za-z]:[\\/]*) ;;
     *)
       for file in $files; do
-	case "$file" in
+	case $file in
 	*.lo) ;;
 	*)
 	  $echo "$modename: \`$destdir' must be an absolute directory name" 1>&2
@@ -3284,15 +4213,15 @@
     for file in $files; do
 
       # Do each installation.
-      case "$file" in
-      *.a | *.lib)
+      case $file in
+      *.$libext)
 	# Do the static libraries later.
 	staticlibs="$staticlibs $file"
 	;;
 
       *.la)
 	# Check to see that this really is a libtool archive.
-	if (sed -e '2q' $file | egrep "^# Generated by .*$PACKAGE") >/dev/null 2>&1; then :
+	if (${SED} -e '2q' $file | egrep "^# Generated by .*$PACKAGE") >/dev/null 2>&1; then :
 	else
 	  $echo "$modename: \`$file' is not a valid libtool archive" 1>&2
 	  $echo "$help" 1>&2
@@ -3301,8 +4230,9 @@
 
 	library_names=
 	old_library=
+	relink_command=
 	# If there is no directory component, then add one.
-	case "$file" in
+	case $file in
 	*/* | *\\*) . $file ;;
 	*) . ./$file ;;
 	esac
@@ -3321,10 +4251,38 @@
 	  esac
 	fi
 
-	dir="`$echo "X$file" | $Xsed -e 's%/[^/]*$%%'`/"
+	dir=`$echo "X$file" | $Xsed -e 's%/[^/]*$%%'`/
 	test "X$dir" = "X$file/" && dir=
 	dir="$dir$objdir"
 
+	if test -n "$relink_command"; then
+          # Determine the prefix the user has applied to our future dir.
+          inst_prefix_dir=`$echo "$destdir" | sed "s%$libdir\$%%"`
+ 
+          # Don't allow the user to place us outside of our expected
+          # location b/c this prevents finding dependent libraries that
+          # are installed to the same prefix.
+          if test "$inst_prefix_dir" = "$destdir"; then
+            $echo "$modename: error: cannot install \`$file' to a directory not ending in $libdir" 1>&2
+            exit 1
+          fi
+ 
+          if test -n "$inst_prefix_dir"; then
+            # Stick the inst_prefix_dir data into the link command.
+            relink_command=`$echo "$relink_command" | sed "s%@inst_prefix_dir@%-inst-prefix-dir $inst_prefix_dir%"`
+          else
+            relink_command=`$echo "$relink_command" | sed "s%@inst_prefix_dir@%%"`
+          fi
+
+	  $echo "$modename: warning: relinking \`$file'" 1>&2
+	  $show "$relink_command"
+	  if $run eval "$relink_command"; then :
+	  else
+	    $echo "$modename: error: relink \`$file' with the above command before installing it" 1>&2
+	    exit 1
+	  fi
+	fi
+
 	# See the names of the shared library.
 	set dummy $library_names
 	if test -n "$2"; then
@@ -3332,9 +4290,16 @@
 	  shift
 	  shift
 
+	  srcname="$realname"
+	  test -n "$relink_command" && srcname="$realname"T
+
 	  # Install the shared library and build the symlinks.
-	  $show "$install_prog $dir/$realname $destdir/$realname"
-	  $run eval "$install_prog $dir/$realname $destdir/$realname" || exit $?
+	  $show "$install_prog $dir/$srcname $destdir/$realname"
+	  $run eval "$install_prog $dir/$srcname $destdir/$realname" || exit $?
+	  if test -n "$stripme" && test -n "$striplib"; then
+	    $show "$striplib $destdir/$realname"
+	    $run eval "$striplib $destdir/$realname" || exit $?
+	  fi
 
 	  if test $# -gt 0; then
 	    # Delete the old symlinks, and create new ones.
@@ -3350,7 +4315,7 @@
 	  # Do each command in the postinstall commands.
 	  lib="$destdir/$realname"
 	  eval cmds=\"$postinstall_cmds\"
-	  IFS="${IFS= 	}"; save_ifs="$IFS"; IFS='~'
+	  save_ifs="$IFS"; IFS='~'
 	  for cmd in $cmds; do
 	    IFS="$save_ifs"
 	    $show "$cmd"
@@ -3381,11 +4346,11 @@
 	fi
 
 	# Deduce the name of the destination old-style object file.
-	case "$destfile" in
+	case $destfile in
 	*.lo)
 	  staticdest=`$echo "X$destfile" | $Xsed -e "$lo2o"`
 	  ;;
-	*.o | *.obj)
+	*.$objext)
 	  staticdest="$destfile"
 	  destfile=
 	  ;;
@@ -3423,40 +4388,55 @@
 	fi
 
 	# Do a test to see if this is really a libtool program.
-	if (sed -e '4q' $file | egrep "^# Generated by .*$PACKAGE") >/dev/null 2>&1; then
-	  link_against_libtool_libs=
+	case $host in
+	*cygwin*|*mingw*)
+	    wrapper=`echo $file | ${SED} -e 's,.exe$,,'`
+	    ;;
+	*)
+	    wrapper=$file
+	    ;;
+	esac
+	if (${SED} -e '4q' $wrapper | egrep "^# Generated by .*$PACKAGE")>/dev/null 2>&1; then
+	  notinst_deplibs=
 	  relink_command=
 
 	  # If there is no directory component, then add one.
-	  case "$file" in
-	  */* | *\\*) . $file ;;
-	  *) . ./$file ;;
+	  case $file in
+	  */* | *\\*) . $wrapper ;;
+	  *) . ./$wrapper ;;
 	  esac
 
 	  # Check the variables that should have been set.
-	  if test -z "$link_against_libtool_libs"; then
-	    $echo "$modename: invalid libtool wrapper script \`$file'" 1>&2
+	  if test -z "$notinst_deplibs"; then
+	    $echo "$modename: invalid libtool wrapper script \`$wrapper'" 1>&2
 	    exit 1
 	  fi
 
 	  finalize=yes
-	  for lib in $link_against_libtool_libs; do
+	  for lib in $notinst_deplibs; do
 	    # Check to see that each library is installed.
 	    libdir=
 	    if test -f "$lib"; then
 	      # If there is no directory component, then add one.
-	      case "$lib" in
+	      case $lib in
 	      */* | *\\*) . $lib ;;
 	      *) . ./$lib ;;
 	      esac
 	    fi
-	    libfile="$libdir/`$echo "X$lib" | $Xsed -e 's%^.*/%%g'`"
+	    libfile="$libdir/"`$echo "X$lib" | $Xsed -e 's%^.*/%%g'` ### testsuite: skip nested quoting test
 	    if test -n "$libdir" && test ! -f "$libfile"; then
 	      $echo "$modename: warning: \`$lib' has not been installed in \`$libdir'" 1>&2
 	      finalize=no
 	    fi
 	  done
 
+	  relink_command=
+	  # If there is no directory component, then add one.
+	  case $file in
+	  */* | *\\*) . $wrapper ;;
+	  *) . ./$wrapper ;;
+	  esac
+
 	  outputname=
 	  if test "$fast_install" = no && test -n "$relink_command"; then
 	    if test "$finalize" = yes && test -z "$run"; then
@@ -3468,6 +4448,7 @@
 		$echo "$modename: error: cannot create temporary directory \`$tmpdir'" 1>&2
 		continue
 	      fi
+	      file=`$echo "X$file" | $Xsed -e 's%^.*/%%'`
 	      outputname="$tmpdir/$file"
 	      # Replace the output file specification.
 	      relink_command=`$echo "X$relink_command" | $Xsed -e 's%@OUTPUT@%'"$outputname"'%g'`
@@ -3489,6 +4470,23 @@
 	  fi
 	fi
 
+	# remove .exe since cygwin /usr/bin/install will append another
+	# one anyways
+	case $install_prog,$host in
+	/usr/bin/install*,*cygwin*)
+	  case $file:$destfile in
+	  *.exe:*.exe)
+	    # this is ok
+	    ;;
+	  *.exe:*)
+	    destfile=$destfile.exe
+	    ;;
+	  *:*.exe)
+	    destfile=`echo $destfile | ${SED} -e 's,.exe$,,'`
+	    ;;
+	  esac
+	  ;;
+	esac
 	$show "$install_prog$stripme $file $destfile"
 	$run eval "$install_prog\$stripme \$file \$destfile" || exit $?
 	test -n "$outputname" && ${rm}r "$tmpdir"
@@ -3505,9 +4503,14 @@
       $show "$install_prog $file $oldlib"
       $run eval "$install_prog \$file \$oldlib" || exit $?
 
+      if test -n "$stripme" && test -n "$striplib"; then
+	$show "$old_striplib $oldlib"
+	$run eval "$old_striplib $oldlib" || exit $?
+      fi
+
       # Do each command in the postinstall commands.
       eval cmds=\"$old_postinstall_cmds\"
-      IFS="${IFS= 	}"; save_ifs="$IFS"; IFS='~'
+      save_ifs="$IFS"; IFS='~'
       for cmd in $cmds; do
 	IFS="$save_ifs"
 	$show "$cmd"
@@ -3523,11 +4526,10 @@
     if test -n "$current_libdirs"; then
       # Maybe just do a dry run.
       test -n "$run" && current_libdirs=" -n$current_libdirs"
-      exec $SHELL $0 --finish$current_libdirs
-      exit 1
+      exec_cmd='$SHELL $0 --finish$current_libdirs'
+    else
+      exit 0
     fi
-
-    exit 0
     ;;
 
   # libtool finish mode
@@ -3546,7 +4548,7 @@
 	if test -n "$finish_cmds"; then
 	  # Do each command in the finish commands.
 	  eval cmds=\"$finish_cmds\"
-	  IFS="${IFS= 	}"; save_ifs="$IFS"; IFS='~'
+	  save_ifs="$IFS"; IFS='~'
 	  for cmd in $cmds; do
 	    IFS="$save_ifs"
 	    $show "$cmd"
@@ -3565,7 +4567,7 @@
     fi
 
     # Exit here if they wanted silent mode.
-    test "$show" = : && exit 0
+    test "$show" = ":" && exit 0
 
     echo "----------------------------------------------------------------------"
     echo "Libraries have been installed in:"
@@ -3575,7 +4577,7 @@
     echo
     echo "If you ever happen to want to link against installed libraries"
     echo "in a given directory, LIBDIR, you must either use libtool, and"
-    echo "specify the full pathname of the library, or use \`-LLIBDIR'"
+    echo "specify the full pathname of the library, or use the \`-LLIBDIR'"
     echo "flag during linking and do at least one of the following:"
     if test -n "$shlibpath_var"; then
       echo "   - add LIBDIR to the \`$shlibpath_var' environment variable"
@@ -3625,10 +4627,10 @@
       fi
 
       dir=
-      case "$file" in
+      case $file in
       *.la)
 	# Check to see that this really is a libtool archive.
-	if (sed -e '2q' $file | egrep "^# Generated by .*$PACKAGE") >/dev/null 2>&1; then :
+	if (${SED} -e '2q' $file | egrep "^# Generated by .*$PACKAGE") >/dev/null 2>&1; then :
 	else
 	  $echo "$modename: \`$lib' is not a valid libtool archive" 1>&2
 	  $echo "$help" 1>&2
@@ -3640,7 +4642,7 @@
 	library_names=
 
 	# If there is no directory component, then add one.
-	case "$file" in
+	case $file in
 	*/* | *\\*) . $file ;;
 	*) . ./$file ;;
 	esac
@@ -3695,13 +4697,13 @@
     args=
     for file
     do
-      case "$file" in
+      case $file in
       -*) ;;
       *)
 	# Do a test to see if this is really a libtool program.
-	if (sed -e '4q' $file | egrep "^# Generated by .*$PACKAGE") >/dev/null 2>&1; then
+	if (${SED} -e '4q' $file | egrep "^# Generated by .*$PACKAGE") >/dev/null 2>&1; then
 	  # If there is no directory component, then add one.
-	  case "$file" in
+	  case $file in
 	  */* | *\\*) . $file ;;
 	  *) . ./$file ;;
 	  esac
@@ -3718,8 +4720,8 @@
 
     if test -z "$run"; then
       if test -n "$shlibpath_var"; then
-        # Export the shlibpath_var.
-        eval "export $shlibpath_var"
+	# Export the shlibpath_var.
+	eval "export $shlibpath_var"
       fi
 
       # Restore saved enviroment variables
@@ -3730,31 +4732,35 @@
 	LANG="$save_LANG"; export LANG
       fi
 
-      # Now actually exec the command.
-      eval "exec \$cmd$args"
-
-      $echo "$modename: cannot exec \$cmd$args"
-      exit 1
+      # Now prepare to actually exec the command.
+      exec_cmd="\$cmd$args"
     else
       # Display what would be done.
       if test -n "$shlibpath_var"; then
-        eval "\$echo \"\$shlibpath_var=\$$shlibpath_var\""
-        $echo "export $shlibpath_var"
+	eval "\$echo \"\$shlibpath_var=\$$shlibpath_var\""
+	$echo "export $shlibpath_var"
       fi
       $echo "$cmd$args"
       exit 0
     fi
     ;;
 
-  # libtool uninstall mode
-  uninstall)
-    modename="$modename: uninstall"
+  # libtool clean and uninstall mode
+  clean | uninstall)
+    modename="$modename: $mode"
     rm="$nonopt"
     files=
+    rmforce=
+    exit_status=0
+
+    # This variable tells wrapper scripts just to set variables rather
+    # than running their programs.
+    libtool_install_magic="$magic"
 
     for arg
     do
-      case "$arg" in
+      case $arg in
+      -f) rm="$rm $arg"; rmforce=yes ;;
       -*) rm="$rm $arg" ;;
       *) files="$files $arg" ;;
       esac
@@ -3766,53 +4772,86 @@
       exit 1
     fi
 
+    rmdirs=
+
     for file in $files; do
       dir=`$echo "X$file" | $Xsed -e 's%/[^/]*$%%'`
-      test "X$dir" = "X$file" && dir=.
+      if test "X$dir" = "X$file"; then
+	dir=.
+	objdir="$objdir"
+      else
+	objdir="$dir/$objdir"
+      fi
       name=`$echo "X$file" | $Xsed -e 's%^.*/%%'`
+      test $mode = uninstall && objdir="$dir"
+
+      # Remember objdir for removal later, being careful to avoid duplicates
+      if test $mode = clean; then
+	case " $rmdirs " in
+	  *" $objdir "*) ;;
+	  *) rmdirs="$rmdirs $objdir" ;;
+	esac
+      fi
+
+      # Don't error if the file doesn't exist and rm -f was used.
+      if (test -L "$file") >/dev/null 2>&1 \
+	|| (test -h "$file") >/dev/null 2>&1 \
+	|| test -f "$file"; then
+	:
+      elif test -d "$file"; then
+	exit_status=1
+	continue
+      elif test "$rmforce" = yes; then
+	continue
+      fi
 
       rmfiles="$file"
 
-      case "$name" in
+      case $name in
       *.la)
 	# Possibly a libtool archive, so verify it.
-	if (sed -e '2q' $file | egrep "^# Generated by .*$PACKAGE") >/dev/null 2>&1; then
+	if (${SED} -e '2q' $file | egrep "^# Generated by .*$PACKAGE") >/dev/null 2>&1; then
 	  . $dir/$name
 
 	  # Delete the libtool libraries and symlinks.
 	  for n in $library_names; do
-	    rmfiles="$rmfiles $dir/$n"
+	    rmfiles="$rmfiles $objdir/$n"
 	  done
-	  test -n "$old_library" && rmfiles="$rmfiles $dir/$old_library"
-
-	  $show "$rm $rmfiles"
-	  $run $rm $rmfiles
+	  test -n "$old_library" && rmfiles="$rmfiles $objdir/$old_library"
+	  test $mode = clean && rmfiles="$rmfiles $objdir/$name $objdir/${name}i"
 
-	  if test -n "$library_names"; then
-	    # Do each command in the postuninstall commands.
-	    eval cmds=\"$postuninstall_cmds\"
-	    IFS="${IFS= 	}"; save_ifs="$IFS"; IFS='~'
-	    for cmd in $cmds; do
+	  if test $mode = uninstall; then
+	    if test -n "$library_names"; then
+	      # Do each command in the postuninstall commands.
+	      eval cmds=\"$postuninstall_cmds\"
+	      save_ifs="$IFS"; IFS='~'
+	      for cmd in $cmds; do
+		IFS="$save_ifs"
+		$show "$cmd"
+		$run eval "$cmd"
+		if test $? != 0 && test "$rmforce" != yes; then
+		  exit_status=1
+		fi
+	      done
 	      IFS="$save_ifs"
-	      $show "$cmd"
-	      $run eval "$cmd"
-	    done
-	    IFS="$save_ifs"
-	  fi
+	    fi
 
-	  if test -n "$old_library"; then
-	    # Do each command in the old_postuninstall commands.
-	    eval cmds=\"$old_postuninstall_cmds\"
-	    IFS="${IFS= 	}"; save_ifs="$IFS"; IFS='~'
-	    for cmd in $cmds; do
+	    if test -n "$old_library"; then
+	      # Do each command in the old_postuninstall commands.
+	      eval cmds=\"$old_postuninstall_cmds\"
+	      save_ifs="$IFS"; IFS='~'
+	      for cmd in $cmds; do
+		IFS="$save_ifs"
+		$show "$cmd"
+		$run eval "$cmd"
+		if test $? != 0 && test "$rmforce" != yes; then
+		  exit_status=1
+		fi
+	      done
 	      IFS="$save_ifs"
-	      $show "$cmd"
-	      $run eval "$cmd"
-	    done
-	    IFS="$save_ifs"
+	    fi
+	    # FIXME: should reinstall the best remaining shared library.
 	  fi
-
-	  # FIXME: should reinstall the best remaining shared library.
 	fi
 	;;
 
@@ -3821,17 +4860,35 @@
 	  oldobj=`$echo "X$name" | $Xsed -e "$lo2o"`
 	  rmfiles="$rmfiles $dir/$oldobj"
 	fi
-	$show "$rm $rmfiles"
-	$run $rm $rmfiles
 	;;
 
       *)
-	$show "$rm $rmfiles"
-	$run $rm $rmfiles
+	# Do a test to see if this is a libtool program.
+	if test $mode = clean &&
+	   (${SED} -e '4q' $file | egrep "^# Generated by .*$PACKAGE") >/dev/null 2>&1; then
+	  relink_command=
+	  . $dir/$file
+
+	  rmfiles="$rmfiles $objdir/$name $objdir/${name}S.${objext}"
+	  if test "$fast_install" = yes && test -n "$relink_command"; then
+	    rmfiles="$rmfiles $objdir/lt-$name"
+	  fi
+	fi
 	;;
       esac
+      $show "$rm $rmfiles"
+      $run $rm $rmfiles || exit_status=1
     done
-    exit 0
+
+    # Try to remove the ${objdir}s in the directories where we deleted files
+    for dir in $rmdirs; do
+      if test -d "$dir"; then
+	$show "rmdir $dir"
+	$run rmdir $dir >/dev/null 2>&1
+      fi
+    done
+
+    exit $exit_status
     ;;
 
   "")
@@ -3841,13 +4898,20 @@
     ;;
   esac
 
-  $echo "$modename: invalid operation mode \`$mode'" 1>&2
-  $echo "$generic_help" 1>&2
-  exit 1
+  if test -z "$exec_cmd"; then
+    $echo "$modename: invalid operation mode \`$mode'" 1>&2
+    $echo "$generic_help" 1>&2
+    exit 1
+  fi
 fi # test -z "$show_help"
 
+if test -n "$exec_cmd"; then
+  eval exec $exec_cmd
+  exit 1
+fi
+
 # We need to display help for each of the modes.
-case "$mode" in
+case $mode in
 "") $echo \
 "Usage: $modename [OPTION]... [MODE-ARG]...
 
@@ -3866,6 +4930,7 @@
 
 MODE must be one of the following:
 
+      clean           remove files from the build directory
       compile         compile a source file into a libtool object
       execute         automatically set library path, then run a program
       finish          complete the installation of libtool libraries
@@ -3878,6 +4943,20 @@
   exit 0
   ;;
 
+clean)
+  $echo \
+"Usage: $modename [OPTION]... --mode=clean RM [RM-OPTION]... FILE...
+
+Remove files from the build directory.
+
+RM is the name of the program to use to delete files associated with each FILE
+(typically \`/bin/rm').  RM-OPTIONS are options (such as \`-f') to be passed
+to RM.
+
+If FILE is a libtool library, object or program, all the files associated
+with it are deleted. Otherwise, only FILE itself is deleted using RM."
+  ;;
+
 compile)
   $echo \
 "Usage: $modename [OPTION]... --mode=compile COMPILE-COMMAND... SOURCEFILE
@@ -3887,6 +4966,8 @@
 This mode accepts the following additional options:
 
   -o OUTPUT-FILE    set the output file name to OUTPUT-FILE
+  -prefer-pic       try to building PIC objects only
+  -prefer-non-pic   try to building non-PIC objects only
   -static           always build a \`.o' file suitable for static linking
 
 COMPILE-COMMAND is a command to be used in creating a \`standard' object file
@@ -3966,6 +5047,8 @@
   -LLIBDIR          search LIBDIR for required installed libraries
   -lNAME            OUTPUT-FILE requires the installed library libNAME
   -module           build a library that can dlopened
+  -no-fast-install  disable the fast-install mode
+  -no-install       link a not-installable executable
   -no-undefined     declare that a library does not refer to external symbols
   -o OUTPUT-FILE    create OUTPUT-FILE from the specified objects
   -release RELEASE  specify package release information
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/capiinfo/capiinfo.c isdn4k-utils-v3.3/capiinfo/capiinfo.c
--- isdn4k-utils-v3.2p1/capiinfo/capiinfo.c	2002-07-18 00:00:27.000000000 +0000
+++ isdn4k-utils-v3.3/capiinfo/capiinfo.c	2003-08-16 16:56:02.000000000 +0000
@@ -1,10 +1,13 @@
-/* $Id: capiinfo.c,v 1.6 2002/07/11 09:29:53 armin Exp $
+/* $Id: capiinfo.c,v 1.10 2003/08/16 16:56:02 keil Exp $
  *
  * A CAPI application to get infomation about installed controllers
  *
- * This program is free software; you can redistribute it and/or modify          * it under the terms of the GNU General Public License as published by          * the Free Software Foundation; either version 2, or (at your option)
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
  * any later version.
- *                                                                               * This program is distributed in the hope that it will be useful,
+ *
+ * This program is distributed in the hope that it will be useful,
  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  * GNU General Public License for more details.
@@ -14,6 +17,18 @@
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
  * $Log: capiinfo.c,v $
+ * Revision 1.10  2003/08/16 16:56:02  keil
+ * fix some typos
+ *
+ * Revision 1.9  2003/08/02 14:50:21  keil
+ * fix wrong b3support bits
+ *
+ * Revision 1.8  2003/03/11 13:36:27  paul
+ * Fixed wrapping of GNU license (only obvious on tty > 80 columns).
+ *
+ * Revision 1.7  2003/01/14 13:56:47  calle
+ * bugfix in output of manufacturer version.
+ *
  * Revision 1.6  2002/07/11 09:29:53  armin
  * sync with new cvs server.
  *
@@ -75,9 +90,9 @@
 /*  1 */ { 0x0002, "Transparent" },
 /*  2 */ { 0x0004, "SDLC" },
 /*  3 */ { 0x0008, "LAPD with Q.921 for D channel X.25 (SAPI 16)" },
-/*  4 */ { 0x0010, "T.30 fro fax group 3" },
+/*  4 */ { 0x0010, "T.30 for fax group 3" },
 /*  5 */ { 0x0020, "Point-to-Point Protocol (PPP)" },
-/*  6 */ { 0x0040, "Tranparent (ignoring framing errors of B1 protocol)" },
+/*  6 */ { 0x0040, "Transparent (ignoring framing errors of B1 protocol)" },
 /*  7 */ { 0x0080, "Modem error correction and compression (V.42bis or MNP5)" },
 /*  8 */ { 0x0100, "ISO 7776 (X.75 SLP) with V.42bis compression" },
 /*  9 */ { 0x0200, "V.120 asyncronous mode" },
@@ -90,11 +105,11 @@
 /*  0 */ { 0x0001, "Transparent" },
 /*  1 */ { 0x0002, "T.90NL, T.70NL, T.90" },
 /*  2 */ { 0x0004, "ISO 8208 (X.25 DTE-DTE)" },
-/*  3 */ { 0x0010, "X.25 DCE" },
-/*  4 */ { 0x0020, "T.30 for fax group 3" },
-/*  5 */ { 0x0040, "T.30 for fax group 3 with extensions" },
-/*  6 */ { 0x0080, "reserved" },
-/*  7 */ { 0x0100, "Modem" },
+/*  3 */ { 0x0008, "X.25 DCE" },
+/*  4 */ { 0x0010, "T.30 for fax group 3" },
+/*  5 */ { 0x0020, "T.30 for fax group 3 with extensions" },
+/*  6 */ { 0x0040, "reserved" },
+/*  7 */ { 0x0080, "Modem" },
  { 0, 0 }
 };
 
@@ -138,7 +153,7 @@
    CAPI20_GET_PROFILE(0, (CAPI_MESSAGE)&cprofile);
    ncontr = cprofile.ncontroller;
    printf("Number of Controllers : %d\n", ncontr);
- 
+
    err = CAPI20_REGISTER(1, 1, 2048, &ApplId);
    if (err != CapiNoError) {
        fprintf(stderr, "could not register - %s (%#x)\n", capi_info2str(err), err);
@@ -155,10 +170,11 @@
        vbuf = (unsigned long *)buf;
        printf("CAPI Version: %lu.%lu\n",vbuf[0], vbuf[1]);
        if (isAVM) {
-          printf("Manufacturer Version: %lu.%02lu-%02lu  (%lu.%lu)\n",
+          printf("Manufacturer Version: %lu.%01lx%01lx-%02lu  (%lu.%lu)\n",
                   (vbuf[2]>>4) & 0x0f,
-                  (((vbuf[2]<<4) & 0xf0) | ((vbuf[3]>>4) & 0x0f)),
-                  vbuf[3] & 0x0f,
+                  ((vbuf[2]<<4) & 0xf0),
+		  ((vbuf[3]>>4) & 0x0f),
+                  (vbuf[3] & 0x0f),
                   vbuf[2], vbuf[3] );
        } else {
           printf("Manufacturer Version: %lu.%lu\n",vbuf[2], vbuf[3]);
@@ -227,7 +243,7 @@
        SuppServices |= cmsg.FacilityConfirmationParameter[7] << 8;
        SuppServices |= cmsg.FacilityConfirmationParameter[8] << 16;
        SuppServices |= cmsg.FacilityConfirmationParameter[9] << 24;
-       
+
        printf("\nSupplementary services support: 0x%08x\n", SuppServices);
        showbitvalues(SupportedServices, SuppServices);
        printf("\n");
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/capiinit/capiinit.c isdn4k-utils-v3.3/capiinit/capiinit.c
--- isdn4k-utils-v3.2p1/capiinit/capiinit.c	2002-07-05 23:22:30.000000000 +0000
+++ isdn4k-utils-v3.3/capiinit/capiinit.c	2003-03-31 09:50:52.000000000 +0000
@@ -1,7 +1,22 @@
 /*
- * $Id: capiinit.c,v 1.9 2002/05/23 12:52:36 calle Exp $
+ * $Id: capiinit.c,v 1.13 2003/03/31 09:50:52 calle Exp $
  *
  * $Log: capiinit.c,v $
+ * Revision 1.13  2003/03/31 09:50:52  calle
+ * Bugfix: fixed problems with activate and deactivate subcommands, when
+ *         AVM B1 PCI V4 is used.
+ *
+ * Revision 1.12  2003/03/11 13:39:07  paul
+ * Also search for firmware in /usr/share/isdn, which is more in line with LSB
+ *
+ * Revision 1.11  2003/01/14 13:47:15  calle
+ * New Commands to only load modules, only initialize cards,
+ * only reset cards, inititialize a single card or reset a single card.
+ *
+ * Revision 1.10  2002/10/25 13:50:44  calle
+ * The protocol value was not tranfered to the patchinfo. Because of
+ * this for example NI1 did not work ...
+ *
  * Revision 1.9  2002/05/23 12:52:36  calle
  * - Uaah. Bugfix for c2 patchvalues.
  *
@@ -64,6 +79,7 @@
 static char *capidevname = capidevnameold;
 
 static char *firmwarepath[] = {
+	"/usr/share/isdn",
 	"/usr/lib/isdn",
 	"/lib/isdn",
 	0
@@ -74,6 +90,7 @@
 static int capifd = -1;
 
 static int patchdebug = 0;	/* -d || -debug */
+static int silent = 0;		/* -s || -silent */
 char *configfilename = "/etc/capi.conf";
 
 /* ---------------- utils -------------------------------------------- */
@@ -259,10 +276,12 @@
 	return p;
 }
 
-static void show_contrprocinfo(struct contrprocinfo *cpinfo)
+static void show_contrprocinfo(struct contrprocinfo *cpinfo, char *cardname)
 {
 	struct contrprocinfo *p;
 	for (p = cpinfo; p; p = p->next) {
+		if (cardname && strcmp(cardname, p->name) != 0)
+			continue;
 		printf("%d %-10s %-8s %-16s %s\n", 
 			p->contr, p->driver, cardstate2str(p->state),
 			p->name, p->driverinfo);
@@ -588,6 +607,7 @@
 		p->protoname = strdup(t);
 		if (!p->protoname) goto nomem;
 		p->proto = dchan_protocol(t);
+		p->patchinfo.protocol = p->proto;
 		s = skip_whitespace(s);
 
 		/* ioaddr */
@@ -1203,6 +1223,18 @@
 
 /* ------------------------------------------------------------------- */
 
+static int is_card_of_driver(char *cardname, struct contrprocinfo *p)
+{
+	if (strcmp(cardname, p->driver) == 0)
+		return 1;
+	if (   strcmp(cardname, "b1pci") == 0
+	    && strcmp(p->driver, "b1pciv4") == 0)
+		return 1;
+	if (strcmp(cardname, p->name) == 0)
+	   return 1;
+	return 0;
+}
+
 static int card_exists(const char * driver, int ioaddr)
 {
 	static char buf[64];
@@ -1219,16 +1251,19 @@
 }
 
 
-int main_start(void)
+int main_start(int activate, char *cardname, int number)
 {
 	struct capicard *cards, *card;
 	struct contrprocinfo *cpinfo, *p;
 	int contr, lastcontr;
 	int ret = 0;
+	char cname[32];
 
 	if (prestartcheck() < 0)
 		return -1;
 
+	cname[0] = 0;
+
 	/* could not fail, tested by check_for_capi() */
 	capifd = open(capidevname, O_RDWR);
 
@@ -1246,43 +1281,78 @@
 	}
 
 	mark_unfound(cards); 
-	cpinfo = load_contrprocinfo(&lastcontr);
-	for (contr = 1; contr <= lastcontr; contr++) {
-		struct capicard *thiscard;
-		cpinfo = load_contrprocinfo(0);
-		p = find_contrprocinfo(cpinfo, contr);
-		thiscard = find_config(cards, p->driver);
-		if (p->state ==	CARD_LOADING)
-			reset_controller(contr);
-		if (p->state == CARD_DETECTED) {
-			if (thiscard) {
-				card = load_firmware(contr, thiscard);
-			} else {
-				fprintf(stderr,"ERROR: missing config entry for controller %d driver %s name %s\n",
-					p->contr, p->driver, p->name);
+	if (activate) {
+		int act;
+		act = 0;
+		cpinfo = load_contrprocinfo(&lastcontr);
+		for (contr = 1; contr <= lastcontr; contr++) {
+			struct capicard *thiscard;
+			cpinfo = load_contrprocinfo(0);
+			p = find_contrprocinfo(cpinfo, contr);
+			thiscard = find_config(cards, p->driver);
+			if (cardname) {
+				if (number == 0) {
+					if (strcmp(cardname, p->name) != 0) {
+						free_contrprocinfo(&cpinfo);
+						continue;
+				   	}
+				} else if (is_card_of_driver(cardname, p)) {
+					if (++act != number) {
+			        		free_contrprocinfo(&cpinfo);
+			           		continue;
+					}
+				} else {
+					free_contrprocinfo(&cpinfo);
+					continue;
+				}
+				strncpy(cname, p->name, sizeof(cname));
+			}
+			if (p->state ==	CARD_LOADING)
+				reset_controller(contr);
+			if (p->state == CARD_DETECTED) {
+				if (thiscard) {
+					card = load_firmware(contr, thiscard);
+				} else {
+					fprintf(stderr,"ERROR: missing config entry for controller %d driver %s name %s\n",
+						p->contr, p->driver, p->name);
+				}
 			}
+			free_contrprocinfo(&cpinfo);
+		}
+		mark_unfound(cards); 
+		act = 0;
+		cpinfo = load_contrprocinfo(&lastcontr);
+		for (contr = 1; contr <= lastcontr; contr++) {
+			struct capicard *thiscard;
+			cpinfo = load_contrprocinfo(0);
+			p = find_contrprocinfo(cpinfo, contr);
+			thiscard = find_config(cards, p->driver);
+			if (cardname && cname[0]) {
+				if (strcmp(cname, p->name) != 0) {
+					free_contrprocinfo(&cpinfo);
+					continue;
+				}
+			}
+			if (p->state == CARD_DETECTED && thiscard) {
+				fprintf(stderr,"ERROR: failed to load firmware for controller %d driver %s name %s\n",
+						p->contr, p->driver, p->name);
+				ret = 3;
+			}
+			free_contrprocinfo(&cpinfo);
 		}
-		free_contrprocinfo(&cpinfo);
 	}
-	mark_unfound(cards); 
-	cpinfo = load_contrprocinfo(&lastcontr);
-	for (contr = 1; contr <= lastcontr; contr++) {
-		struct capicard *thiscard;
+
+	if (cardname && cname[0] == 0) {
+		fprintf(stderr,"ERROR: card \"%s\"  not found\n", cardname);
+		ret = 4;
+	}
+
+	if (!silent) {
 		cpinfo = load_contrprocinfo(0);
-		p = find_contrprocinfo(cpinfo, contr);
-		thiscard = find_config(cards, p->driver);
-		if (p->state == CARD_DETECTED && thiscard) {
-			fprintf(stderr,"ERROR: failed to load firmware for controller %d driver %s name %s\n",
-					p->contr, p->driver, p->name);
-			ret = 3;
-		}
+		show_contrprocinfo(cpinfo, cardname ? cname: "");
 		free_contrprocinfo(&cpinfo);
 	}
 
-	cpinfo = load_contrprocinfo(0);
-	show_contrprocinfo(cpinfo);
-
-	free_contrprocinfo(&cpinfo);
 	free_config(&cards);
 	close(capifd);
 
@@ -1291,59 +1361,98 @@
 
 /* ------------------------------------------------------------------- */
 
-int main_stop(void)
+int main_stop(int unload, char *cardname, int number)
 {
 	struct capicard *cards, *card;
 	struct contrprocinfo *cpinfo, *p;
 	int contr, lastcontr;
 	char *mp;
+	int act;
+	char cname[32];
 
 	if (prestopcheck() < 0)
 		return -1;
 
+	cname[0] = 0;
+
 	/* could not fail, tested by check_for_capi() */
 	capifd = open(capidevname, O_RDWR);
 
+	act = 0;
 	cpinfo = load_contrprocinfo(&lastcontr);
-	for (contr = lastcontr; contr > 0; contr--) {
-		cpinfo = load_contrprocinfo(0);
-		p = find_contrprocinfo(cpinfo, contr);
-		if (p && p->state == CARD_RUNNING)
-			reset_controller(contr);
-		free_contrprocinfo(&cpinfo);
+	if (cardname) {
+		for (contr = 1; contr <= lastcontr; contr++) {
+			cpinfo = load_contrprocinfo(0);
+			p = find_contrprocinfo(cpinfo, contr);
+			if (number == 0) {
+				if (strcmp(cardname, p->name) != 0) {
+					free_contrprocinfo(&cpinfo);
+					continue;
+				}
+			} else if (is_card_of_driver(cardname, p)) {
+				if (++act != number) {
+					free_contrprocinfo(&cpinfo);
+					continue;
+				}
+			} else {
+				free_contrprocinfo(&cpinfo);
+				continue;
+			}
+			strncpy(cname, p->name, sizeof(cname));
+			if (p && p->state != CARD_DETECTED)
+				reset_controller(contr);
+			free_contrprocinfo(&cpinfo);
+		}
+	} else {
+		for (contr = lastcontr; contr > 0; contr--) {
+			cpinfo = load_contrprocinfo(0);
+			p = find_contrprocinfo(cpinfo, contr);
+			if (p && p->state != CARD_DETECTED)
+				reset_controller(contr);
+			free_contrprocinfo(&cpinfo);
+		}
 	}
-	cpinfo = load_contrprocinfo(&lastcontr);
-	for (contr = lastcontr; contr > 0; contr--) {
+	if (unload) {
+		cpinfo = load_contrprocinfo(&lastcontr);
+		for (contr = lastcontr; contr > 0; contr--) {
+			cpinfo = load_contrprocinfo(0);
+			p = find_contrprocinfo(cpinfo, contr);
+			if (p)
+				remove_controller(contr);
+			free_contrprocinfo(&cpinfo);
+		}
+	}
+	if (!silent) {
 		cpinfo = load_contrprocinfo(0);
-		p = find_contrprocinfo(cpinfo, contr);
-		if (p)
-			remove_controller(contr);
+		show_contrprocinfo(cpinfo, cardname ? cname: 0);
 		free_contrprocinfo(&cpinfo);
 	}
-
-	cpinfo = load_contrprocinfo(0);
-	show_contrprocinfo(cpinfo);
-	free_contrprocinfo(&cpinfo);
 	close(capifd);
 
-	cards = load_config(configfilename);
-	for (card = cards; card; card = card->next) {
-		if (driver_loaded(card->driver))
-			unload_driver(card->driver);
+	if (unload && !cardname) {
+		cards = load_config(configfilename);
+		for (card = cards; card; card = card->next) {
+			if (driver_loaded(card->driver))
+				unload_driver(card->driver);
+		}
+		for (card = cards; card; card = card->next) {
+			if (driver_loaded(card->driver))
+				unload_driver(card->driver);
+		}
+
+		unload_module("capi");
+		unload_module("capidrv");
+		unload_module("kernelcapi");
+		unload_module("capiutil");
+		if ((mp = mounted("capifs")) != 0 && strcmp(mp, "/dev/capi") == 0)
+			system("umount /dev/capi");
+		if (filesystem_available("capifs"))
+			unload_filesystem("capifs");
 	}
-	for (card = cards; card; card = card->next) {
-		if (driver_loaded(card->driver))
-			unload_driver(card->driver);
+	if (cardname && cname[0] == 0) {
+		fprintf(stderr,"ERROR: card \"%s\"  not found\n", cardname);
+		return 4;
 	}
-
-	unload_module("capi");
-	unload_module("capidrv");
-	unload_module("kernelcapi");
-	unload_module("capiutil");
-	if ((mp = mounted("capifs")) != 0 && strcmp(mp, "/dev/capi") == 0)
-		system("umount /dev/capi");
-	if (filesystem_available("capifs"))
-		unload_filesystem("capifs");
 	return 0;
 }
 
@@ -1362,15 +1471,49 @@
 
 /* ------------------------------------------------------------------- */
 
+int main_status(void)
+{
+	struct contrprocinfo *cpinfo;
+
+	cpinfo = load_contrprocinfo(0);
+	show_contrprocinfo(cpinfo, 0);
+	free_contrprocinfo(&cpinfo);
+	return 0;
+}
+
+/* ------------------------------------------------------------------- */
+
 static void usage(void)
 {
     fprintf(stderr, "Usage: capiinit [OPTION]\n");
     fprintf(stderr, "   or: capiinit [OPTION] start\n");
+    fprintf(stderr, "       - load all modules and inititialize all cards\n");
     fprintf(stderr, "   or: capiinit [OPTION] stop\n");
+    fprintf(stderr, "       - reset all cards and unload modules\n");
     fprintf(stderr, "   or: capiinit [OPTION] show\n");
+    fprintf(stderr, "       - show current config\n");
+    fprintf(stderr, "   or: capiinit [OPTION] status\n");
+    fprintf(stderr, "       - show current status\n");
+    fprintf(stderr, "   or: capiinit [OPTION] prepare\n");
+    fprintf(stderr, "       - load all modules\n");
+    fprintf(stderr, "   or: capiinit [OPTION] activate\n");
+    fprintf(stderr, "       - inititialize all cards \n");
+    fprintf(stderr, "   or: capiinit [OPTION] activate cardname\n");
+    fprintf(stderr, "       - inititialize one cards (i.e.: c4-ec00) \n");
+    fprintf(stderr, "   or: capiinit [OPTION] activate driver [cardnumber]\n");
+    fprintf(stderr, "       - inititialize one card \n");
+    fprintf(stderr, "   or: capiinit [OPTION] deactivate\n");
+    fprintf(stderr, "       - reset all cards \n");
+    fprintf(stderr, "   or: capiinit [OPTION] deactivate cardname\n");
+    fprintf(stderr, "       - reset one card (i.e.: c4-ec00) \n");
+    fprintf(stderr, "   or: capiinit [OPTION] deactivate driver [cardnumber]\n");
+    fprintf(stderr, "       - reset one cards \n");
+    fprintf(stderr, "   or: capiinit [OPTION] reload\n");
+    fprintf(stderr, "       - reset all cards and initialize them again\n");
     fprintf(stderr, "Setup or unsetup CAPI2.0 Controllers\n");
     fprintf(stderr, "   -c, --config filename  (default %s)\n", configfilename);
     fprintf(stderr, "   -d, --debug            save patchvalues for debugging\n");
+    fprintf(stderr, "   -s, --silent           don't show status\n");
 }
 
 int main(int ac, char *av[])
@@ -1382,10 +1525,11 @@
 		static struct option long_options[] = {
 			{"config", 1, 0, 'c'},
 			{"debug", 1, 0, 'd'},
+			{"silent", 1, 0, 's'},
 			{0, 0, 0, 0}
 		};
 
-		c = getopt_long (ac, av, "c:d",
+		c = getopt_long (ac, av, "c:ds",
 				long_options, &option_index);
              	if (c == -1)
             		break;
@@ -1405,6 +1549,9 @@
 			case 'd':
  				patchdebug = 1;
  				break;
+			case 's':
+ 				silent = 1;
+ 				break;
 			case '?':
 				usage();
 				return 1;
@@ -1412,14 +1559,37 @@
 	}
 
  	if (optind == ac) {
-		return main_start();
+		return main_start(1, 0, 0);
 	} else if (optind+1 == ac) {
-		if (strcmp(av[optind], "start") == 0)
-			return main_start();
-		else if (strcmp(av[optind], "stop") == 0)
-			return main_stop();
-		else if (strcmp(av[optind], "show") == 0)
+		if (strcmp(av[optind], "start") == 0) {
+			return main_start(1, 0, 0);
+		} else if (strcmp(av[optind], "activate") == 0) {
+			return main_start(1, 0, 0);
+		} else if (strcmp(av[optind], "prepare") == 0) {
+			return main_start(0, 0, 0);
+		} else if (strcmp(av[optind], "stop") == 0) {
+			return main_stop(1, 0, 0);
+		} else if (strcmp(av[optind], "deactivate") == 0) {
+			return main_stop(0, 0, 0);
+		} else if (strcmp(av[optind], "show") == 0) {
 			return main_show();
+		} else if (strcmp(av[optind], "status") == 0) {
+			return main_status();
+		} else if (strcmp(av[optind], "reload") == 0) {
+			if (main_stop(0, 0, 0) == 0)
+			   return main_start(1, 0, 0);
+		}
+	} else if (optind+2 == ac) {
+		int number = strchr(av[optind+1], '-') == 0 ? 1 : 0;
+		if (strcmp(av[optind], "activate") == 0)
+			return main_start(1, av[optind+1], number);
+		else if (strcmp(av[optind], "deactivate") == 0)
+			return main_stop(0, av[optind+1], number);
+	} else if (optind+3 == ac) {
+		if (strcmp(av[optind], "activate") == 0)
+			return main_start(1, av[optind+1], atoi(av[optind+2]));
+		else if (strcmp(av[optind], "deactivate") == 0)
+			return main_stop(0, av[optind+1], atoi(av[optind+2]));
 	}
 	usage();
 	return 1;
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/ipppd/.Config.in isdn4k-utils-v3.3/ipppd/.Config.in
--- isdn4k-utils-v3.2p1/ipppd/.Config.in	1998-11-18 13:48:51.000000000 +0000
+++ isdn4k-utils-v3.3/ipppd/.Config.in	2003-06-30 22:30:57.000000000 +0000
@@ -1,6 +1,7 @@
 mainmenu_option next_comment
 comment 'Options for ipppd'
 bool 'Support for MS chap secrets' CONFIG_IPPPD_MSCHAP
+bool 'Support for PPP filtering (need kernel patch)' CONFIG_IPPP_FILTER
 bool 'Support for RADIUS protocol' CONFIG_IPPPD_RADIUS
 bool 'Support for RADIUS wtmp logging' CONFIG_RADIUS_WTMP_LOGGING
 string 'radiusclient config file path' RADIUS_CLIENT_CONFIG_FILE
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/ipppd/Makefile.in isdn4k-utils-v3.3/ipppd/Makefile.in
--- isdn4k-utils-v3.2p1/ipppd/Makefile.in	2002-07-19 19:03:53.000000000 +0000
+++ isdn4k-utils-v3.3/ipppd/Makefile.in	2003-06-30 22:30:57.000000000 +0000
@@ -1,12 +1,13 @@
 #
 # ipppd makefile for Linux
-# $Id: Makefile.in,v 1.16 2002/07/19 19:03:53 keil Exp $
+# $Id: Makefile.in,v 1.17 2003/06/30 22:30:57 keil Exp $
 #
 
 HAVE_LIBDES   := @HAVE_LIBDES@
 HAVE_LIBCRYPT := @HAVE_LIBCRYPT@
 HAVE_SHADOW_H := @HAVE_SHADOW_H@
 HAVE_LZSCOMP_H:= @HAVE_LZSCOMP_H@
+IPPP_FILTER   := @CONFIG_IPPP_FILTER@
 SBINDIR       := @CONFIG_SBINDIR@
 MANDIR        := @CONFIG_MANDIR@
 CC            := @CC@
@@ -77,6 +78,10 @@
 LIBS        = -lcrypt -lutil
 endif
 
+ifeq ($(IPPP_FILTER),y)
+CFLAGS     += -DIPPP_FILTER
+LIBS       += -lpcap
+endif
 
 SOURCE = RELNOTES configure *.in $(PPPDSRCS) $(HEADERS) $(MANPAGES)
 
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/ipppd/configure.in isdn4k-utils-v3.3/ipppd/configure.in
--- isdn4k-utils-v3.2p1/ipppd/configure.in	2002-07-19 18:51:41.000000000 +0000
+++ isdn4k-utils-v3.3/ipppd/configure.in	2003-06-30 22:30:57.000000000 +0000
@@ -9,6 +9,7 @@
 CONFIG_RUNDIR=`eval echo ${CONFIG_RUNDIR:-"/var/run"}`
 CONFIG_IPPPD_MSCHAP=${CONFIG_IPPPD_MSCHAP:-"n"}
 CONFIG_IPPPD_RADIUS=${CONFIG_IPPPD_RADIUS:-"n"}
+CONFIG_IPPP_FILTER=${CONFIG_IPPP_FILTER:-"n"}
 CONFIG_RADIUS_WTMP_LOGGING=${CONFIG_RADIUS_WTMP_LOGGING:-"n"}
 RADIUS_CLIENT_CONFIG_FILE=`eval echo ${RADIUS_CLIENT_CONFIG_FILE:-"/usr/local/lib/radiusclient/radiusclient.conf"}`
 dnl Checks for programs.
@@ -98,6 +99,12 @@
 	AC_DEFINE(CONFIG_IPPPD_DEBUGFLAGS,"-DDEBUGALL"),
 )
 
+AC_ARG_ENABLE(ippp-filter,
+	[  --enable-ippp-filter    Enable IPPP Filters (needs kernel supports) [no]],
+	CONFIG_IPPP_FILTER="y"
+	AC_DEFINE(CONFIG_IPPP_FILTER,"y"),
+)
+
 AC_SUBST(I4LVERSION)
 AC_SUBST(MANDATE)
 AC_SUBST(HAVE_LIBDES)
@@ -113,4 +120,5 @@
 AC_SUBST(RADIUS_CLIENT_CONFIG_FILE)
 AC_SUBST(CONFIG_RADIUS_WTMP_LOGGING)
 AC_SUBST(CONFIG_IPPPD_DEBUGFLAGS)
+AC_SUBST(CONFIG_IPPP_FILTER)
 AC_OUTPUT(Makefile ipppd.man pathnames.h)
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/ipppd/ippp-filter-compat.h isdn4k-utils-v3.3/ipppd/ippp-filter-compat.h
--- isdn4k-utils-v3.2p1/ipppd/ippp-filter-compat.h	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/ipppd/ippp-filter-compat.h	2003-07-01 09:05:38.000000000 +0000
@@ -0,0 +1,11 @@
+#ifndef _IPPP_FILTER_COMPAT_H
+#define _IPPP_FILTER_COMPAT_H
+
+#ifndef PPPIOCSPASS
+#define PPPIOCSPASS	_IOW('t', 71, struct sock_fprog) /* set pass filter */
+#endif
+#ifndef PPPIOCSACTIVE
+#define PPPIOCSACTIVE	_IOW('t', 70, struct sock_fprog) /* set active filt */
+#endif
+                                                                                
+#endif /* _IPPP_FILTER_COMPAT_H */
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/ipppd/ipppd.h isdn4k-utils-v3.3/ipppd/ipppd.h
--- isdn4k-utils-v3.2p1/ipppd/ipppd.h	2002-07-06 00:34:08.000000000 +0000
+++ isdn4k-utils-v3.3/ipppd/ipppd.h	2003-06-30 22:30:57.000000000 +0000
@@ -18,7 +18,7 @@
  * IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED
  * WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.
  *
- * $Id: ipppd.h,v 1.22 2002/07/06 00:34:08 keil Exp $
+ * $Id: ipppd.h,v 1.23 2003/06/30 22:30:57 keil Exp $
  */
 
 /*
@@ -215,6 +215,11 @@
 #ifdef __linux__
 extern int      hostroute;      /* Add a route to the host at the other end? */
 #endif
+#ifdef IPPP_FILTER
+#include <net/bpf.h>
+extern struct   bpf_program pass_filter;   /* Filter for pkts to pass */
+extern struct   bpf_program active_filter; /* Filter for link-active pkts */
+#endif /* IPPP_FILTER */
 
 /*
  * Values for phase.
@@ -288,6 +293,9 @@
 void link_terminated(int);
 void link_down(int);
 void link_established(int unit);
+#ifdef IPPP_FILTER
+int set_filters(int, struct bpf_program *, struct bpf_program *);
+#endif /* IPPP_FILTER */
 int device_script(char *program,int in,int out);
 void check_auth_options(void);
 void setipdefault(void);
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/ipppd/ipppd.man.in isdn4k-utils-v3.3/ipppd/ipppd.man.in
--- isdn4k-utils-v3.2p1/ipppd/ipppd.man.in	2000-10-05 20:45:25.000000000 +0000
+++ isdn4k-utils-v3.3/ipppd/ipppd.man.in	2003-07-01 09:03:45.000000000 +0000
@@ -1,6 +1,6 @@
 .\" manual page [] for ipppd 2.0
-.\" $Id: ipppd.man.in,v 1.10 2000/07/25 20:23:51 kai Exp $
-.\" CHECKIN $Date: 2000/07/25 20:23:51 $
+.\" $Id: ipppd.man.in,v 1.11 2003/07/01 09:03:45 keil Exp $
+.\" CHECKIN $Date: 2003/07/01 09:03:45 $
 .\" SH section heading
 .\" SS subsection heading
 .\" LP paragraph
@@ -88,6 +88,22 @@
 .B ipcp-accept-remote
 options are given, respectively.
 .TP
+.B active-filter \fIfilter-expression
+Specifies a packet filter to be applied to data packets to determine
+which packets are to be regarded as link activity, and therefore reset
+the idle timer, or cause the link to be brought up in demand-dialling
+mode. This option is useful in conjunction with the
+\fBidle\fR option if there are packets being sent or received
+regularly over the link (for example, routing information packets)
+which would otherwise prevent the link from ever appearing to be idle.
+The \fIfilter-expression\fR syntax is as described for tcpdump(1),
+except that qualifiers which are inappropriate for a PPP link, such as
+\fBether\fR and \fBarp\fR, are not permitted. Generally the filter
+expression should be enclosed in single-quotes to prevent whitespace
+in the expression from being interpreted by the shell. This option
+is currently only available if both the kernel and ipppd were compiled
+with IPPP_FILTER defined.
+.TP
 .B -ac
 Disable Address/Control compression negotiation (use default, i.e.
 address/control field compression disabled).
@@ -515,6 +531,23 @@
 will wait for the peer to authenticate itself with PAP to
 <n> seconds (0 means no limit).
 .TP
+.B pass-filter \fIfilter-expression
+Specifies a packet filter to applied to data packets being sent or
+received to determine which packets should be allowed to pass.
+Packets which are rejected by the filter are silently discarded. This
+option can be used to prevent specific network daemons (such as
+routed) using up link bandwidth, or to provide a basic firewall
+capability.
+The \fIfilter-expression\fR syntax is as described for tcpdump(1),
+except that qualifiers which are inappropriate for a PPP link, such as
+\fBether\fR and \fBarp\fR, are not permitted. Generally the filter
+expression should be enclosed in single-quotes to prevent whitespace
+in the expression from being interpreted by the shell. Note that it
+is possible to apply different constraints to incoming and outgoing
+packets using the \fBinbound\fR and \fBoutbound\fR qualifiers. This
+option is currently only available if both the kernel and ipppd were
+compiled with IPPP_FILTER defined.
+.TP
 .B -pc
 Disable protocol field compression negotiation (use default, i.e.
 protocol field compression disabled).
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/ipppd/main.c isdn4k-utils-v3.3/ipppd/main.c
--- isdn4k-utils-v3.2p1/ipppd/main.c	2002-07-18 00:06:21.000000000 +0000
+++ isdn4k-utils-v3.3/ipppd/main.c	2003-06-30 22:30:57.000000000 +0000
@@ -25,7 +25,7 @@
  * PATCHLEVEL 9
  */
 
-char main_rcsid[] = "$Id: main.c,v 1.24 2002/07/18 00:06:21 keil Exp $";
+char main_rcsid[] = "$Id: main.c,v 1.25 2003/06/30 22:30:57 keil Exp $";
 
 #include <stdio.h>
 #include <stdarg.h>
@@ -564,6 +564,9 @@
 	lns[linkunit].upap_unit = lns[linkunit].chap_unit = lns[linkunit].lcp_unit;
 	upap[lns[linkunit].upap_unit].us_unit = chap[lns[linkunit].chap_unit].unit = linkunit;
 	lcp_lowerup(lns[linkunit].lcp_unit);
+#ifdef IPPP_FILTER
+	set_filters(linkunit, &pass_filter, &active_filter);
+#endif /* IPPP_FILTER */
 
 	return 0;
 }
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/ipppd/options.c isdn4k-utils-v3.3/ipppd/options.c
--- isdn4k-utils-v3.2p1/ipppd/options.c	2002-07-06 00:34:08.000000000 +0000
+++ isdn4k-utils-v3.3/ipppd/options.c	2003-06-30 22:30:57.000000000 +0000
@@ -17,7 +17,7 @@
  * WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.
  */
 
-char options_rcsid[] = "$Id: options.c,v 1.22 2002/07/06 00:34:08 keil Exp $";
+char options_rcsid[] = "$Id: options.c,v 1.24 2003/06/30 22:30:57 keil Exp $";
 
 #include <stdio.h>
 #include <errno.h>
@@ -39,6 +39,10 @@
 #include <radiusclient.h>
 #endif
 
+#ifdef IPPP_FILTER
+#include <pcap.h>
+#endif /* IPPP_FILTER */
+
 #include "fsm.h"
 #include "ipppd.h"
 #include "pathnames.h"
@@ -140,6 +144,10 @@
 struct option_info auth_req_info;
 struct option_info devnam_info;
 
+#ifdef IPPP_FILTER
+struct  bpf_program pass_filter;/* Filter program for packets to pass */
+struct  bpf_program active_filter; /* Filter program for link-active pkts */
+#endif /* IPPP_FILTER */
 
 /*
  * Prototypes
@@ -292,6 +300,11 @@
 int __P (radius_init ( void ));
 #endif
 
+#ifdef IPPP_FILTER
+static int setpassfilter __P((int,char **));
+static int setactivefilter __P((int,char **));
+#endif /* IPPP_FILTER */
+
 /*
  * Valid arguments.
  */
@@ -470,7 +483,10 @@
     {"nohostroute", 0, setnohostroute}, /* Don't add host route */
 #endif
     {"+force-driver",0,setforcedriver},
-
+#ifdef IPPP_FILTER
+    { "pass-filter", 1, setpassfilter},		/* pass filter */
+    { "active-filter", 1, setactivefilter},	/* link-active filter */
+#endif /* IPPP_FILTER */
     {NULL, 0, NULL}
 };
 
@@ -479,26 +495,25 @@
 #define IMPLEMENTATION ""
 #endif
 
-static char *usage_string = "\
-ipppd version %s patch level %d%s\n\
-Usage: %s [ options ], where options are:\n\
-\t<device>	Communicate over the named device\n\
+static char *usage_string = "ipppd version %s patch level %d%s\n"
+"Usage: %s [ options ], where options are:\n"
+"\t<device>	Communicate over the named device\n"
 #ifdef INCLUDE_OBSOLETE_FEATURES
-\tcrtscts		Use hardware RTS/CTS flow control\n\
-\t<speed>		Set the baud rate to <speed>\n\
-\tmodem		Use modem control lines\n\
+"\tcrtscts		Use hardware RTS/CTS flow control\n"
+"\t<speed>		Set the baud rate to <speed>\n"
+"\tmodem		Use modem control lines\n"
 #endif
-\t<loc>:<rem>	Set the local and/or remote interface IP\n\
-\t\taddresses.  (you also may use the option 'useifip' to get IPs).\n\
-\tasyncmap <n>	Set the desired async map to hex <n>\n\
-\tauth		Require authentication from peer\n\
-\tconnect <p>     Invoke shell command <p> to set up the serial line\n\
-\tdefaultroute	Add default route through interface\n\
-\tfile <f>	Take options from file <f>\n\
-\tmru <n>		Set MRU value to <n> for negotiation\n\
-\tnetmask <n>	Set interface netmask to <n>\n\
-See ipppd(8) for more options.\n\
-";
+"\t<loc>:<rem>	Set the local and/or remote interface IP\n"
+"\t\taddresses.  (you also may use the option 'useifip' to get IPs).\n"
+"\tasyncmap <n>	Set the desired async map to hex <n>\n"
+"\tauth		Require authentication from peer\n"
+"\tconnect <p>     Invoke shell command <p> to set up the serial line\n"
+"\tdefaultroute	Add default route through interface\n"
+"\tfile <f>	Take options from file <f>\n"
+"\tmru <n>		Set MRU value to <n> for negotiation\n"
+"\tnetmask <n>	Set interface netmask to <n>\n"
+"See ipppd(8) for more options.\n"
+;
 
 static char *current_option;   /* the name of the option being parsed */
 
@@ -2615,3 +2630,33 @@
     force_driver = 1;
     return 1;
 }
+
+#ifdef IPPP_FILTER
+/*
+ * setpassfilter - Set the pass filter for packets
+ */
+static int
+setpassfilter(argc, argv)
+    int argc;
+    char **argv;
+{
+    if (pcap_compile_nopcap(PPP_HDRLEN, DLT_PPP, &pass_filter, *argv, 1, netmask) == 0)
+        return 1;
+    option_error("error in pass-filter expression.\n");
+    return 0;
+}
+
+/*
+ * setactivefilter - Set the active filter for packets
+ */
+static int
+setactivefilter(argc, argv)
+    int argc;
+    char **argv;
+{
+    if (pcap_compile_nopcap(PPP_HDRLEN, DLT_PPP, &active_filter, *argv, 1, netmask) == 0)
+        return 1;
+    option_error("error in active-filter expression.\n");
+    return 0;
+}
+#endif /* IPPP_FILTER */
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/ipppd/sys-linux.c isdn4k-utils-v3.3/ipppd/sys-linux.c
--- isdn4k-utils-v3.2p1/ipppd/sys-linux.c	2000-10-05 20:45:25.000000000 +0000
+++ isdn4k-utils-v3.3/ipppd/sys-linux.c	2003-06-30 22:30:57.000000000 +0000
@@ -22,7 +22,7 @@
  * WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.
  */
 
-char sys_rcsid[] = "$Id: sys-linux.c,v 1.25 2000/07/25 20:23:51 kai Exp $";
+char sys_rcsid[] = "$Id: sys-linux.c,v 1.26 2003/06/30 22:30:57 keil Exp $";
 
 #define _LINUX_STRING_H_
 
@@ -57,6 +57,7 @@
 #if defined __GLIBC__ && __GLIBC__ >= 2
 # include </usr/include/net/ppp_defs.h>
 # include </usr/include/net/if_ppp.h>
+# include "ippp-filter-compat.h"
 # include </usr/include/net/ethernet.h>
 # include "route.h"
 #else
@@ -70,6 +71,11 @@
 # include <netipx/ipx.h>
 #endif
 
+#ifdef IPPP_FILTER
+#include <net/bpf.h>
+#include <linux/filter.h>
+#endif /* IPPP_FILTER */
+
 #include "fsm.h"
 #include "ipppd.h"
 #include "ipcp.h"
@@ -515,6 +521,40 @@
 	return 1;
 }
 
+#ifdef IPPP_FILTER
+/*
+ * set_filters - set the active and pass filters in the kernel driver.
+ */
+int set_filters(int u, struct bpf_program *pass, struct bpf_program *active)
+{       
+        struct sock_fprog fp;
+
+	/*
+	 *  unfortunately there is no way of checking for kernel support. the
+	 *  driver just returns 0 for unsupported ioctls, which means without
+	 *  kernel support we won't even notice the error.
+	 */
+
+	if (pass) {
+		fp.len = pass->bf_len;
+		fp.filter = (struct sock_filter *) pass->bf_insns;
+		if (ioctl(lns[u].fd, PPPIOCSPASS, &fp) < 0) {
+			syslog(LOG_ERR, "Couldn't set pass-filter in kernel.");
+			return 0;
+		}
+	}
+	if (active) {
+		fp.len = active->bf_len;
+		fp.filter = (struct sock_filter *) active->bf_insns;
+		if (ioctl(lns[u].fd, PPPIOCSACTIVE, &fp) < 0) {
+			syslog(LOG_ERR, "Couldn't set active-filter in kernel.");
+	        	return 0;
+		}
+	}
+	return 1;
+}
+#endif /* IPPP_FILTER */
+
 /*
  * sifup - Config the interface up and enable IP packets to pass.
  */
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnctrl/ctrlconf.c isdn4k-utils-v3.3/isdnctrl/ctrlconf.c
--- isdn4k-utils-v3.2p1/isdnctrl/ctrlconf.c	2001-06-21 16:34:55.000000000 +0000
+++ isdn4k-utils-v3.3/isdnctrl/ctrlconf.c	2003-03-11 14:01:55.000000000 +0000
@@ -1,4 +1,4 @@
-/* $Id: ctrlconf.c,v 1.11 2001/05/23 14:48:23 kai Exp $
+/* $Id: ctrlconf.c,v 1.12 2003/03/11 14:01:55 paul Exp $
  *
  * ISDN accounting for isdn4linux. (Utilities)
  *
@@ -19,6 +19,9 @@
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
  * $Log: ctrlconf.c,v $
+ * Revision 1.12  2003/03/11 14:01:55  paul
+ * Added support for using "-" for stdin / stdout with readconf / writeconf
+ *
  * Revision 1.11  2001/05/23 14:48:23  kai
  * make isdnctrl independent of the version of installed kernel headers,
  * we have our own copy now.
@@ -91,7 +94,13 @@
 	section *PhoneSection;
 */
 
-	ConfigSection = read_file(NULL,file,C_NOT_UNIQUE|C_NO_WARN_FILE);
+	if (strcmp(file, "-")) {
+            ConfigSection = read_file(NULL,file,C_NOT_UNIQUE|C_NO_WARN_FILE);
+        }
+        else {
+            ConfigSection = NULL;
+            file = "/dev/fd/1"; /* stdout */
+        }
 /*
 	read_conffiles(&PhoneSection,NULL);
 */
@@ -322,9 +331,19 @@
 	char    *argv[5];
 	char    *name;
 	int      cnt = 1;
+        int     use_stdin = 0;
 
-	if ((ConfigSection = read_file(NULL,file,C_NOT_UNIQUE|C_NO_WARN_FILE)) == NULL)
-		return -1;
+        if (!strcmp(file, "-")) {
+            use_stdin = 1;
+            file = "/dev/fd/0"; /* stdin */
+        }
+	if ((ConfigSection = read_file(NULL,file,C_NOT_UNIQUE|C_NO_WARN_FILE)) == NULL) {
+            if (use_stdin)
+		fprintf(stderr, "Can't read from stdin!\n");
+            else
+		fprintf(stderr,"Can't read from file `%s'!\n", file);
+            return -1;
+        }
 
 /*
 	read_conffiles(&PhoneSection,NULL);
@@ -332,6 +351,9 @@
 
 	if ((Section = Get_Section(ConfigSection,CONF_SEC_ISDNCTRL)) == NULL)
 	{
+            if (use_stdin)
+		fprintf(stderr, "stdin has no section `%s'!\n", CONF_SEC_ISDNCTRL);
+            else
 		fprintf(stderr,"File `%s' has no section `%s'!\n",file,CONF_SEC_ISDNCTRL);
 		return -1;
 	}
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnctrl/isdn_dwabclib.c isdn4k-utils-v3.3/isdnctrl/isdn_dwabclib.c
--- isdn4k-utils-v3.2p1/isdnctrl/isdn_dwabclib.c	2001-06-21 16:34:55.000000000 +0000
+++ isdn4k-utils-v3.3/isdnctrl/isdn_dwabclib.c	2003-03-11 14:03:43.000000000 +0000
@@ -1,4 +1,4 @@
-/* $Id: isdn_dwabclib.c,v 1.2 2001/03/01 14:59:15 paul Exp $
+/* $Id: isdn_dwabclib.c,v 1.3 2003/03/11 14:03:43 paul Exp $
  *
  *
  * This program is free software; you can redistribute it and/or modify
@@ -16,6 +16,9 @@
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
  * $Log: isdn_dwabclib.c,v $
+ * Revision 1.3  2003/03/11 14:03:43  paul
+ * Using sys_errlist[] is deprecated.
+ *
  * Revision 1.2  2001/03/01 14:59:15  paul
  * Various patches to fix errors when using the newest glibc,
  * replaced use of insecure tempnam() function
@@ -76,8 +79,7 @@
 		if(sock > -1)
 			close(sock);
 
-		if(errno < sys_nerr)
-			sprintf(em + strlen(em)," (%s)",sys_errlist[errno]);
+                    sprintf(em + strlen(em)," (%s)",strerror(errno));
 
 		return(-errno);
 	}
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnctrl/isdnctrl.c isdn4k-utils-v3.3/isdnctrl/isdnctrl.c
--- isdn4k-utils-v3.2p1/isdnctrl/isdnctrl.c	2002-02-22 11:10:25.000000000 +0000
+++ isdn4k-utils-v3.3/isdnctrl/isdnctrl.c	2003-03-11 13:46:56.000000000 +0000
@@ -1,4 +1,4 @@
-/* $Id: isdnctrl.c,v 1.50 2002/01/31 19:53:41 paul Exp $
+/* $Id: isdnctrl.c,v 1.52 2003/03/11 13:46:56 paul Exp $
  * ISDN driver for Linux. (Control-Utility)
  *
  * Copyright 1994,95 by Fritz Elfert (fritz@isdn4linux.de)
@@ -21,6 +21,13 @@
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
  * $Log: isdnctrl.c,v $
+ * Revision 1.52  2003/03/11 13:46:56  paul
+ * "status all" would show also non-ISDN interfaces, this is now fixed.
+ * "status active" added, this shows only those interfaces that are connected.
+ *
+ * Revision 1.51  2003/02/24 17:22:22  keil
+ * - don't allow users to change setup
+ *
  * Revision 1.50  2002/01/31 19:53:41  paul
  * Fixed error messages when opening /dev/isdnctrl - /dev/isdn/isdnctrl etc.,
  * only /dev/isdnctrl was mentioned and people assumed that isdnctrl wasn't
@@ -446,7 +453,8 @@
 	}
 
 	while (!feof(iflst)) {
-		fgets(s, sizeof(s), iflst);
+		if (fgets(s, sizeof(s), iflst)==NULL)
+			break;
 		if ((p = strchr(s, ':'))) {
 			*p = 0;
 
@@ -580,7 +588,11 @@
 }
 
 
-static void statusif(int isdnctrl, char *name, int errexit)
+/* mode = 0: nothing special                       */
+/* mode = 1: exit 0 if connected, exit 1 otherwise */
+/* mode = 2: show only active connections          */
+
+static void statusif(int isdnctrl, char *name, int mode)
 {
         isdn_net_ioctl_phone phone;
 	int rc;
@@ -601,16 +613,19 @@
 	rc = ioctl(isdninfo, IIOCNETGPN, &phone);
 	if (rc < 0) {
 		if (errno == ENOTCONN) {
-			printf("%s is not connected\n", name);
-			if (errexit) {
+			if (mode != 2) {
+                            printf("%s is not connected\n", name);
+                            if (mode == 1) {
 				exit(1); /* exit 1 if interface specified & not conn. */
+                            }
+                        }
+                        return;
 		}
-			return;
-		}
-		if (errexit) {
+		if (mode == 1) {
 			perror(name);
 			exit(-1);
 		}
+                return;
 	}
 	switch (data_version) {
 	case 0x04:
@@ -744,10 +759,11 @@
 		}
 
 #ifdef I4L_CTRL_CONF
-		if (id != NULL && i != RESET && i != WRITECONF && i != READCONF) {
+		if (id != NULL && i != RESET && i != WRITECONF && i != READCONF)
 #else
-		if (id != NULL && i != RESET) {
+		if (id != NULL && i != RESET)
 #endif /* I4L_CTRL_CONF */
+                {
 			if (i == BUSREJECT || i == MAPPING) {
 			   if (strlen(id) > sizeof(iocts.drvid)-1) {
 				fprintf(stderr, "DriverId must not exceed %u characters!\n", (unsigned int)sizeof(iocts.drvid)-1);
@@ -946,6 +962,7 @@
 			        } else {
 			        	char buf[400];
 			        	strncpy(buf, arg1, sizeof(buf) - 1);
+                                        buf[399] = 0;
 			        	iocts.arg = (unsigned long) buf;
 			        	if ((result = ioctl(fd, IIOCSETMAP, &iocts)) < 0) {
 			        		perror(id);
@@ -1028,20 +1045,22 @@
 			        break;
 
 			case STATUS:
-			        if (!strcmp(id, "all")) {
+			        if (!strcmp(id, "all") || !strcmp(id, "active")) {
 			        	char name[10];
+                                        int  show_only_active;
 			        	if ((iflst = fopen(FILE_PROC, "r")) == NULL) {
 			        		perror(FILE_PROC);
 			        		return -1;
 			        	}
+                                        show_only_active = (strcmp(id, "active") ? 0 : 2);
 			        	while (!feof(iflst)) {
 			        		fgets(s, sizeof(s), iflst);
 			        		if ((p = strchr(s, ':'))) {
 			        			*p = 0;
 			        			sscanf(s, "%s", name);
-			        			statusif(fd, name, 0);
+			        			statusif(fd, name, show_only_active);
 			        			while (*nextslaveif)
-			        				statusif(fd, nextslaveif, 0);
+			        				statusif(fd, nextslaveif, show_only_active);
 			        		}
 			        	}
 			        	fclose(iflst);
@@ -1503,6 +1522,8 @@
 			        if (writeconfig(fd, id))
 			        	return -1;
 
+                                if (!strcmp(id, "-"))
+                                    id = "stdout";
 			        printf("ISDN Configuration written to %s.\n", id);
 			        break;
 
@@ -1515,6 +1536,8 @@
 			        if (readconfig(fd, id))
 			        	return -1;
 
+                                if (!strcmp(id, "-"))
+                                    id = "stdin";
 			        printf("ISDN Configuration read from %s.\n", id);
 			        break;
 #endif /* I4L_CTRL_CONF */
@@ -1651,6 +1674,25 @@
 	int fd;
 	int rc;
 
+	/* 
+	 * Security check. Mere mortals mustn't do anything except
+	 * isdnctrl dial <devicename>. --okir
+	 * hangup addlink removelink and status are also needed --kkeil
+	 */
+	if (getuid()) {
+		if (argc != 3 ||
+		  (strcmp(argv[1], "dial")
+		  && strcmp(argv[1], "hangup")
+		  && strcmp(argv[1], "addlink")
+		  && strcmp(argv[1], "removelink")
+		  && strcmp(argv[1], "status"))) {  
+		 	fprintf(stderr, 
+				"Only the dial,hangup,addlink,removelink and status\n"
+				"commands are allowed for none root users\n");
+			return 1;
+		}
+	}
+
 	if ((cmd = strrchr(argv[0], '/')) != NULL)
 		*cmd++ = '\0';
 	else
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnctrl/isdnctrl.man.in isdn4k-utils-v3.3/isdnctrl/isdnctrl.man.in
--- isdn4k-utils-v3.2p1/isdnctrl/isdnctrl.man.in	2002-02-22 11:10:25.000000000 +0000
+++ isdn4k-utils-v3.3/isdnctrl/isdnctrl.man.in	2003-03-11 13:49:28.000000000 +0000
@@ -1,6 +1,6 @@
-.\" $Id: isdnctrl.man.in,v 1.22 2002/02/07 10:43:24 paul Exp $
+.\" $Id: isdnctrl.man.in,v 1.23 2003/03/11 13:49:28 paul Exp $
 .\"
-.\" CHECKIN $Date: 2002/02/07 10:43:24 $
+.\" CHECKIN $Date: 2003/03/11 13:49:28 $
 .\"
 .\" Process this file with
 .\" groff -man -Tascii isdnctrl.8 for ASCII output, or
@@ -418,6 +418,13 @@
 .BR all ,
 then the connection status for all interfaces is shown. The exit status is
 always true in this case.
+.br
+If
+.I name
+is
+.BR active ,
+then only those interfaces that are currently connected are shown. The exit status is
+always true in this case.
 .TP
 .BI verbose " num"
 Set verbosity level to
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/.country-alias isdn4k-utils-v3.3/isdnlog/.country-alias
--- isdn4k-utils-v3.2p1/isdnlog/.country-alias	2002-04-01 18:06:08.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/.country-alias	2003-07-25 21:33:02.000000000 +0000
@@ -1,3 +1,4 @@
+amerik. jungferninseln	amerikanische jungferninseln
 amerikan. jungeferninseln	amerikanische jungferninseln
 amerikanisch samoa	amerikanisch-samoa
 amerikanische jungeferninseln	amerikanische jungferninseln
@@ -11,7 +12,9 @@
 bahrein	bahrain
 bangla desh	bangladesch
 belarus (weirussland)	weissrussland
+bosnien mobilfunk	bosnien-herzegowina mobilfunk
 bosnien und herzegowina	bosnien-herzegowina
+bosnien-herzegovina mobilfunk	bosnien-herzegowina mobilfunk
 botsuana botswana	botsuana
 brunei daressalam	brunei
 brunei darussalam	brunei
@@ -24,17 +27,20 @@
 chil	chile
 chile-mobilfunk	chile mobilfunk
 china (taiwan) mobilfunk	taiwan mobilfunk
+china vr mobilfunk	china mobilfunk
 china-mobilfunk	china mobilfunk
 cokos islands	kokosinseln
 cook inseln	cookinseln
 cook-inseln	cookinseln
 costa-rica mobilfunk	costa rica mobilfunk
 cote divory	elfenbeinkste cote de ivoire
+deutschland bndelfunk dolphin	deutschland bndelfunk dolphin telecom
 deutschland mobil	deutschland mobilfunk
 dominikanische republi	dominikanische republik
 dublin	nordirland
 ecuador guinea	quatorial-guinea
 elfenbeinkste	elfenbeinkste cote de ivoire
+elfenbeinkste / cote de ivoire	elfenbeinkste cote de ivoire
 england	grobritannien
 eritea	eritrea
 faeroer	frer-inseln
@@ -47,8 +53,13 @@
 franzsisch polynesien	franzsisch-polynesien
 feroer	frer-inseln
 ferer	frer-inseln
+ferer mobilfunk	frer-inseln mobilfunk
 froer	frer-inseln
 frer inseln	frer-inseln
+frerinseln	frer-inseln
+frerinseln mobilfunk	frer-inseln mobilfunk
+frr inseln	frer-inseln
+frr inseln mobilfunk	frer-inseln mobilfunk
 frrer	frer-inseln
 griechenland-mobilfunk	griechenland mobilfunk
 groenland	grnland
@@ -94,6 +105,7 @@
 iridium-8816	iridium 008816
 iridium-8817	iridium 008817
 island mobilfunk	irland mobilfunk
+jemen arab. rep. mobilfunk	jemen mobilfunk
 jemen arab. republik	jemen (arab. republik)
 jugoslawien (serbien und montenegro)	jugoslawien
 jungfern inseln britisch	britische jungferninseln
@@ -103,14 +115,18 @@
 kapverdische inseln	cape verde
 kazachstan	kasachstan
 kirgisistan mobilfunk	kirgisien mobilfunk
+kirgistan mobilfunk	kirgisien mobilfunk
 kirgizstan	kirgisien
 kokos inseln	kokosinseln
 kokos-inseln	kokosinseln
 korea	sdkorea
 korea (republik) mobilfunk	korea (sd) mobilfunk
 korea nord	nordkorea
+korea rep. (sd)	sdkorea
+korea rep. (sd) mobilfunk	korea (sd) mobilfunk
 korea rep.(south) mobilfunk	korea rep. (south) mobilfunk
 korea sd	sdkorea
+korea sd mobilfunk	korea (sd) mobilfunk
 kuwait-mobilfunk	kuwait mobilfunk
 libyien	libyen
 libysch-arabische dschamahrija	libyen
@@ -127,11 +143,12 @@
 mauritanien	mauretanien
 mayotte island	mayotte
 mazedonien (ehemalige jugoslawische republik)	mazedonien
+mazedonien (ehemalige jugoslawische republik) mobilfunk	mazedonien mobilfunk
 midway inseln	midway-inseln
 midway island	midway-inseln
 midway islands	midway-inseln
-moldau (republik)	moldavien moldau (republik)
-moldau-republik	moldavien moldau (republik)
+moldau-republik	moldau (republik)
+myanmar (=burma)	myanmar burma
 myanmar (burma)	myanmar burma
 myanmar/burma	myanmar burma
 neu kaledonien	neukaledonien
@@ -163,12 +180,14 @@
 portugal-mobilfunk	portugal mobilfunk
 rumnien-mobilfunk	rumnien mobilfunk
 russische fderation (westl.)	russische fderat. (westl.)
+russische fderation mobilfunk	ruland mobilfunk
 russische frderation	russische forderation (ostl.)
 russische frderation (stl.)	russische forderation (ostl.)
 russische frderation mobilfunk	ruland mobilfunk
 russland	russische forderation (ostl.)
 russland (westlich)	russische fderat. (westl.)
 russland (stlich)	russische forderation (ostl.)
+russland mobilfunk	ruland mobilfunk
 ruland moskau overlay	moskau
 ruland overlay	russische forderation (ostl.)
 ruland-mobilfunk	ruland mobilfunk
@@ -181,24 +200,36 @@
 samoa west	west-samoa
 san mario	san marino
 sansibar	tansania
+sao tome & principe	sao tome und principe
 saudi - arabien	saudi arabien
 saudi-arabien	saudi arabien
 saudiarabien	saudi arabien
+slowak. republik	slowakische republik
+slowak. republik mobilfunk	slowakische republik mobilfunk
 slowakai	slowakische republik
 slowake	slowakische republik
 sonderjylland	snderjylland
 spanien (einschlielich kanar. inseln)	spanien
 spanien balearen	mallorca
 spanien kanarische inseln	kanarische inseln
+st . vincent und grenadin	st. vincent und grenadinen
 st kitts und nevis	st. kitts und nevis
+st pierre und miquelon	st. pierre und miquelon
 st. kitts	st. kitts und nevis
 st. kitts und navis	st. kitts und nevis
+st. kitts und necis	st. kitts und nevis
 st. vincent und grenadien	st. vincent und grenadinen
+surinam mobilfunk	suriname mobilfunk
 syrien (arabische repubik)	syrien
 sd-korea	sdkorea
 sdafrika-mobilfunk	sdafrika mobilfunk
+sdkorea mobilfunk	korea (sd) mobilfunk
 tansani	tansania
 trinidad/tobago	trinidad und tobago
+tschagosinseln (diego garcia)	diego garcia
+tschech. republik	tschechische republik
+tschech. republik mobilfunk	tschechische rep. mobilfunk
+tschechien mobilfunk	tschechische rep. mobilfunk
 tschechische rep.-mobilfunk	tschechische rep. mobilfunk
 tschechische republik mobilfunk	tschechische rep. mobilfunk
 turks und caicos inseln	turks- und caicosinseln
@@ -208,20 +239,27 @@
 urugay	uruguay
 v.r. korea.	nordkorea
 vanuat	vanuatu
+vatikanstaat	vatikan
 venezuele mobilfunk	venezuela mobilfunk
 venuzuela-mobilfunk	venezuela mobilfunk
 ver. arab. emirate	ver. arabische emirate
+ver. arab. emirate mobilfunk	vereinigte arabische emirate mobilfunk
 vereinigt arabische emirate	ver. arabische emirate
 virgin island us	amerikanische jungferninseln
 virgin islands uk	britische jungferninseln
 wake-inseln	wake inseln
 wallis und futuna inseln	wallis und futuna
+wallis/futuna	wallis und futuna
 weirussland	weissrussland
 weiruland	weissrussland
 weiruland (belarus)	weissrussland
 weiruland/belarus	weissrussland
+west samoa	west-samoa
 western samoa (independent state of)	west-samoa
+zaire/kongo dem. rep	kongo (demokratische republik)
+zaire/kongo dem. rep mobilfunk	zaire mobilfunk
 zentral. afrika. rep.	zentralafrikanische republik
+zentralafrik. rep.	zentralafrikanische republik
 zypern (trk.)	zypern (trkisch)
 zypern mobilfunk	zypern(griech) mobilfunk
 zypern nord	zypern (trkisch)
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/.cvsignore isdn4k-utils-v3.3/isdnlog/.cvsignore
--- isdn4k-utils-v3.2p1/isdnlog/.cvsignore	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/.cvsignore	2003-08-14 12:18:57.000000000 +0000
@@ -0,0 +1,7 @@
+config.log
+config.status
+.depend
+Makefile
+policy.h
+zone-??-*.cdb
+zone-default-x.cdb
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/Makefile.in isdn4k-utils-v3.3/isdnlog/Makefile.in
--- isdn4k-utils-v3.2p1/isdnlog/Makefile.in	2002-07-19 19:03:55.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/Makefile.in	2003-07-25 22:18:02.000000000 +0000
@@ -1,8 +1,8 @@
-## $Id: Makefile.in,v 1.203 2002/07/19 19:03:55 keil Exp $
+## $Id: Makefile.in,v 1.209 2003/07/25 22:18:02 tobiasb Exp $
 ##
 ## ISDN accounting for isdn4linux.
 ##
-## Copyright 1995 .. 2000 by Andreas Kool (akool@isdn4linux.de)
+## Copyright 1995 .. 2002 by Andreas Kool (akool@isdn4linux.de)
 ##
 ## This program is free software; you can redistribute it and/or modify
 ## it under the terms of the GNU General Public License as published by
@@ -19,6 +19,59 @@
 ## Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 ##
 ## $Log: Makefile.in,v $
+## Revision 1.209  2003/07/25 22:18:02  tobiasb
+## isdnlog-4.65:
+##  - New values for isdnlog option -2x / dual=x with enable certain
+##    workarounds for correct logging in dualmode in case of prior
+##    errors.  See `man isdnlog' and isdnlog/processor.c for details.
+##  - New isdnlog option -U2 / ignoreCOLP=2 for displaying ignored
+##    COLP information.
+##  - Improved handling of incomplete D-channel frames.
+##  - Increased length of number aliases shown immediately by isdnlog.
+##    Now 127 instead of 32 chars are possible. (Patch by Jochen Erwied.)
+##  - The zone number for an outgoing call as defined in the rate-file
+##    is written to the logfile again and used by isdnrep
+##  - Improved zone summary of isdnrep.  Now the real zone numbers as
+##    defined in the rate-file are shown.  The zone number is taken
+##    from the logfile as mentioned before or computed from the current
+##    rate-file.  Missmatches are indicated with the chars ~,+ and *,
+##    isdnrep -v ... explains the meanings.
+##  - Fixed provider summary of isdnrep. Calls should no longer be
+##    treated wrongly as done via the default (preselected) provider.
+##  - Fixed the -pmx command line option of isdnrep, where x is the xth
+##    defined [MSN].
+##  - `make install' restarts isdnlog after installing the data files.
+##  - A new version number generates new binaries.
+##  - `make clean' removes isdnlog/isdnlog/ilp.o when called with ILP=1.
+##
+## Revision 1.208  2002/09/09 06:56:38  akool
+## isdnlog-4.64:
+##   - new rates
+##   - new providers
+##   - new country-de.dat and dest.cdb (_Many_ thanks to
+##   	Tobias Becker <tobiasb@talypso.de> !)
+##
+## Revision 1.207  2002/08/15 17:22:42  akool
+## isdnlog-4.63
+##  - new rates/provider ...
+##  - isdnrate now display EuroCent as the default
+##
+## Revision 1.206  2002/08/10 16:32:03  akool
+## isdnlog-4.62
+##  - new rates/provider (0190028, Tele2 Ortstarif)
+##  - display in EuroCent now the default
+##
+## Revision 1.205  2002/07/26 22:14:19  akool
+## isdnlog-4.61:
+##   - Support for mysql-4.0alpha -- many thanks to Jochen Erwied (jochen@erwied.de)!
+##
+## Revision 1.204  2002/07/25 18:16:05  akool
+## isdnlog-2.60:
+##   - new provider "01081" (1,5 EuroCent/minute)
+## 	- good bye Euro ;-)
+##   	with the entry "U:^%.3f c" in "rate-de.dat" now isdnlog/isdnbill
+##     shows amounts in EuroCent (Value *= 100.0)
+##
 ## Revision 1.203  2002/07/19 19:03:55  keil
 ## First changes to compile utils without /usr/src/linux/drivers/isdn
 ##
@@ -1537,7 +1590,7 @@
 # DON'T EDIT BELOW THIS LINE
 ######################################################################
 
-VERSION     = 4.59
+VERSION     = 4.65
 
 MANPAGES    = isdnlog/callerid.conf.5 isdnlog/isdn.conf.5 \
 	      isdnlog/isdnformat.5 isdnlog/isdnlog.5 isdnlog/isdnlog.8 \
@@ -1678,6 +1731,9 @@
 ORA_LOAD     =  bin/ora_load
 
 MODS         =  *.o */*.o
+ifdef ILP
+MODS        +=  isdnlog/ilp/ilp.o 
+endif
 
 PROGS        =  $(ISDNLOG) $(ISDNREP) $(ISDNBILL) $(ISDNCONF) $(ISDNRATE)
 
@@ -1699,6 +1755,10 @@
 config.status: configure
 	./config.status --recheck
 
+# recompile when VERSION in Makefile changes for binaries with new version:
+FILES_USING_VERSION = isdnlog/isdnlog.o isdnlog/processor.o isdnlog/user_access.o isdnrep/isdnrep.o isdnconf/isdnconf.o tools/isdnconf.o tools/tools.o
+$(FILES_USING_VERSION): Makefile
+
 options:
 	@echo Making $< with
 	@echo $(CC) $(CFLAGS) $(DEFS) $(INCLUDE)
@@ -1766,7 +1826,7 @@
 		$(INSTALL_DIR) $(DESTDIR)$(MAN8DIR)
 		$(INSTALL_DIR) $(DESTDIR)$(DATADIR)
 
-install: all rootperm installdirs install-conf install-progs install-data
+install: all rootperm installdirs install-conf install-data install-progs
 
 install-old-conf:
 		@if [ -n "$(DESTDIR)$(OLDCONFDIR)" -a "$(DESTDIR)$(OLDCONFDIR)" != '/' ] ; then \
@@ -1819,6 +1879,7 @@
 		$(INSTALL_BIN) $(ISDNREP)  $(DESTDIR)$(BINDIR)
 		$(INSTALL_BIN) $(ISDNCONF) $(DESTDIR)$(BINDIR)
 		$(INSTALL_BIN) $(ISDNRATE) $(DESTDIR)$(BINDIR)
+		$(INSTALL_BIN) $(ISDNBILL) $(DESTDIR)$(BINDIR)
 		-@if (ps x | fgrep $(ISDNLOG) | grep -v grep) >/dev/null; then \
 			kill -HUP `cat $(RUNDIR)/isdnlog.isdnctrl0.pid 2>/dev/null`; \
 			echo "Restarting running isdnlog!" ; \
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/bin/.cvsignore isdn4k-utils-v3.3/isdnlog/bin/.cvsignore
--- isdn4k-utils-v3.2p1/isdnlog/bin/.cvsignore	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/bin/.cvsignore	2003-07-25 22:55:23.000000000 +0000
@@ -0,0 +1,5 @@
+isdnbill
+isdnconf
+isdnlog
+isdnrate
+isdnrep
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/country-de.dat isdn4k-utils-v3.3/isdnlog/country-de.dat
--- isdn4k-utils-v3.2p1/isdnlog/country-de.dat	2002-01-29 16:39:19.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/country-de.dat	2003-08-14 12:18:57.000000000 +0000
@@ -1,4 +1,11 @@
-V:1.40 Int [22-Nov-2001 16:00:00]
+V:1.53 Int [12-Aug-2003 01:00:00]
+#
+# This version of country.dat originates from rates4linux:
+# $Id: country-de.dat,v 1.42 2003/08/14 12:18:57 tobiasb Exp $
+# The rates4linux homepage: http://www.sourceforge.net/projects/rates4linux/
+# It bases on Rev. 1.39 of isdn4k-utils/isdnlog/country-de.dat 
+# in the CVS at http://www.isdn4linux.de.
+#
 # ISO 3166 Countrycodes ( ftp://sunsite.unc.edu/pub/Linux/apps/misc/
 #	countrycodes.1.0.2.tar.gz
 # Airportcodes: http://www.TravelDesk.com/airports.html
@@ -12,6 +19,18 @@
 # Freephone : _ccFF
 # Auskunft :  _ccAK
 # Sonderrufnummern : _ccSO
+#
+# Partial source for national numbering plans (2002-08-23):
+# http://www.itu.int/ITU-T/inr/nnp/index.html
+#
+# Offical German language country names (2002-06-11):
+# http://www.auswaertiges-amt.de/www/de/infoservice/download/pdf/publikationen/staatennamen.pdf
+#
+# Note: The information in this file gets included in the destination database
+# usually /usr/lib/isdn/dest.cdb.  As of August 2002 there is a limit of 1024
+# bytes per entry value based on the size of buf in the function i4l_cdb_fetch
+# in the file isdnlog/tools/cdb/i4l_cdb.c.  The value for _DOMF (N;C[,C][;R])
+# would be longer if fully noted.
 
 N:Usbekistan
 E:Uzbekistan
@@ -20,6 +39,7 @@
 
 N:Kirgisien Mobilfunk
 E:Kyrgyzstan cellphone
+A:Kirgisistan Mobilfunk
 C:+99631, +99632, +99634, +99635, +99636, +99637, +99639
 T:_KGMF
 
@@ -34,20 +54,36 @@
 C:+995
 T:GE
 
+# Source (2002-05-22):
+# http://www.itu.int/itudoc/itu-t/number/a/aze/80942.html
 N:Aserbaidschan
 E:Azerbaijan
 C:+994
 T:AZ
 
+N:Aserbaidschan Mobilfunk
+E:Azerbaijan cellphone
+C:+99450, +99455
+R:AZ
+T:_AZMF
+
 N:Turkmenistan
 C:+993
 T:TM
 
+# Source (2000-06-15):
+# http://www.itu.int/itudoc/itu-t/number/t/tjk/71088.html
 N:Tadschikistan
 E:Tajikistan
-C:+992, +7433, +7431, +74, +7379, +7377, +7376, +7364
+C:+992
 T:TJ
 
+N:Tadschikistan Mobilfunk
+E:Tajikistan cellphone
+C:+9929190		# Dushanbe
+R:TJ
+T:_TJMF
+
 N:Iran
 C:+98
 T:IR
@@ -66,12 +102,20 @@
 C:+975
 T:BT
 
+# Source (2002-03-15)
+# http://www.itu.int/itudoc/itu-t/number/q/qatar/72015.html
 N:Katar
 A:Quatar
 E:Qatar
 C:+974
 T:QA
 
+N:Katar Mobilfunk
+E:Qatar cellphone
+C:+97452, +97453, +97455, +97458
+R:QA
+T:_QAMF
+
 N:Bahrain
 C:+973
 T:BH
@@ -103,12 +147,20 @@
 C:+971
 T:AE
 
+# Source (2000-10-02):
+# http://www.itu.int/itudoc/itu-t/number/y/yem/73267.html
 N:Jemen (Arab. Republik)
 A:Jemen (Arabische Republik), Jemen, Jemen Arab. Rep.
 E:Yemen
-C:+969, +967
+C:+967		# +969 outdated since 1994-12-01
 T:YE
 
+N:Jemen Mobilfunk
+E:Yemen cellphone
+C:+96779
+R:YE
+T:_YEMF
+
 N:Oman
 A:Oman (Sultanat)
 C:+968
@@ -162,11 +214,19 @@
 C:+961
 T:LB
 
+# Source (2001-12-27):
+# http://www.itu.int/itudoc/itu-t/number/m/mdv/76591.html
 N:Malediven
 E:Maldives
 C:+960
 T:MV
 
+N:Malediven Mobilfunk
+E:Maldives cellphone
+C:+9607
+R:MV
+T:_MVMF
+
 N:Myanmar Burma
 A:Myanmar (Birma), Burma, Birma, Myanmar, Birma (Myanmar)
 E:Myamar
@@ -177,11 +237,19 @@
 C:+94
 T:LK
 
+# Source (2001-01-25):
+# http://www.itu.int/itudoc/itu-t/number/a/afg/77447.html
 N:Afghanistan
 A:Afganistan
 C:+93
 T:AF
 
+N:Afghanistan Mobilfunk
+A:Afganistan cellphone
+C:+9370
+R:AF
+T:_AFMF
+
 N:Pakistan
 C:+92
 T:PK
@@ -191,6 +259,7 @@
 C:+9198
 T:_INMF
 
+# Codes _IN* also in use for Inmarsat.
 N:Indien
 A:India
 C:+91
@@ -217,6 +286,31 @@
 C:+886
 T:TW
 
+# Source (2002-08-23):
+# http://www.thuraya.com/tech/
+N:Thuraya
+A:Thuraya RMSS Network
+C:+88216
+R:_INTN
+T:_THUR
+
+# Source (2002-08-23):
+# http://www.eutelsat.com/products/2_4_2_3.html
+N:Emsat
+C:+88213
+R:_INTN
+T:_EMSA
+
+N:GeoVerse
+A:BT GeoVerse 
+C:+88210
+R:_INTN
+T:_GEOV
+
+N:International Networks
+C:+882
+T:_INTN
+
 N:Iridium 008817
 A:Iridium GSM-Homed, Iridium-8817
 C:+8817
@@ -285,38 +379,45 @@
 C:+8736 	#Inmarsat M (Indien)
 C:+8726 	#Inmarsat M (Pacific)
 C:+8716		#Inmarsat M (E. Atlantic)
+C:+8706		#Inmarsat M (Worldwide)
 T:_INM_
 
 N:INMARSAT-M AE
 C:+8716
 A:Inmarsat M (E. Atlantic)
-R:_INM
+R:_INM_
 T:_INMAE
 
 N:INMARSAT-M AW
 C:+8746
 A:Inmarsat M (W. Atlantic)
-R:_INM
+R:_INM_
 T:_INMAW
 
 N:INMARSAT-M IO
 C:+8736
 A:Inmarsat M (Indien)
-R:_INM
+R:_INM_
 T:_INMIO
 
 N:INMARSAT-M PO
 C:+8726
 A:Inmarsat M (Pacific)
-R:_INM
+R:_INM_
 T:_INMPO
 
+N:INMARSAT-M WW
+C:+8706
+A:Inmarsat M (Worldwide)
+R:_INM_
+T:_INMWW
+
 N:Inmarsat Aero
 C:+8745, +8735, +8725, +8715
 T:_INAE
 
 N:Inmarsat B HSD
-C:+87439, +87339, +87239, +87139
+C:+87439, +87339, +87239, +87139, +87039
 T:_INBH
 
 N:Inmarsat B
@@ -325,6 +426,7 @@
 C:+8733 	#Inmarsat B (Indien)
 C:+8723 	#Inmarsat B (Pacific)
 C:+8713 	#Inmarsat B (E. Atlantic)
+C:+8703		#Inmarsat B (Worldwide)
 T:_INB_
 
 N:INMARSAT-B AE
@@ -351,6 +453,12 @@
 R:_INB_
 T:_INBPO
 
+N:INMARSAT-B WW
+C:+8703
+A:Inmarsat B (Worldwide)
+R:_INB_
+T:_INBWW
+
 N:Inmarsat A
 C:+8741 	#Inmarsat A (W. Atlantic)
 C:+8731		#Inmarsat A (Indien)
@@ -424,22 +532,37 @@
 C:+855
 T:KH
 
+# Source (2000-08-25)
+# http://www.itu.int/itudoc/itu-t/number/m/mac/79088.html
 N:Macao
 E:Macau
 C:+853
 T:MO
 
+N:Macao Mobilfunk
+E:Macau cellphone
+C:+85366, +85368
+R:MO
+T:_MOMF
+
+# some reserved number blocks included
 N:Hong Kong Mobilfunk
 E:Hong Kong cellphone
-C:+8529
+C:+852170, +852171, +852173, +852175, +852176, +852177, +852178, +852179
+C:+852601, +852602, +852603, +852604, +852605, +852607, +852608, +852609
+C:+85261, +85262, +85263, +85264, +85265, +85267, +85268
+C:+852901, +852902, +852903, +852904, +852905, +852907, +852908, +852909
+C:+85291, +85292, +85293, +85294, +85295, +85296, +85297, +85298
 R:HK
 T:_HKMF
 
 N:Hong Kong Sondernummern
 E:Hong Kong special numbers
-C:+85217, +85221, +852264, +8528
+C:+852900
 T:_HKSO
 
+# Source (2002-08-01):
+# http://www.ofta.gov.hk/numbering/noplan.pdf
 N:Hongkong
 C:+852
 T:HK
@@ -490,6 +613,7 @@
 
 N:Ruland Mobilfunk
 E:Russia cellphone
+A:Russische Fderation Mobilfunk
 C:+7901, +7902
 T:_RUMF
 
@@ -501,7 +625,7 @@
 C:+7811, +7543, +7517, +75112, +75110, +7510, +7505, +7503, +7501, +709246
 C:+709245, +709244, +709243, +709237, +7091, +7087, +7086, +7085, +7084
 C:+7083, +7082, +7081, +7074, +7073, +7072, +7071, +7011
-C:+7502 Ruland Moskau Overlay
+C:+7502			# Ruland Moskau Overlay
 E:Russia
 T:RU
 
@@ -600,12 +724,24 @@
 C:+685
 T:WS
 
+# Source (2003-04-23): http://www.nanpa.com/pdf/PL_330.pdf
+# Will become +1-684 at 2004-10-02,
+# +684 is be to returned to ITU after 2007-04-02.
 N:Amerikanisch-Samoa
 A:Samoa (Ost), Samoa (US), Samoa O., Amerikanisches Samoa
+A:U. S. Territory of American Samoa
 E:American Samoa
 C:+684
+C:+1684
 T:AS
 
+N:Amerikanisch-Samoa Mobilfunk
+E:American Samoa cellphone
+C:+684733
+C:+1684733
+T:_ASMF
+R:AS
+
 N:Niue-Inseln
 A:Niue Islands
 E:Niue
@@ -630,16 +766,33 @@
 C:+680
 T:PW
 
+# Source (2002-09-14):
+# http://www.itu.int/itudoc/itu-t/number/f/fji/75261.html
 N:Fidschi
 E:Fiji
 A:Fidschi Inseln
 C:+679
 T:FJ
 
+N:Fidschi Mobilfunk
+E:Fiji cellphone
+A:Fidschi Inseln Mobilfunk
+C:+67992, +67999
+R:FJ
+T:_FJMF
+
+# Source (2002-03-25):
+# http://www.itu.int/itudoc/itu-t/number/v/vut/79348.html
 N:Vanuatu
 C:+678
 T:VU
 
+N:Vanuatu Mobilfunk
+E:Vanuatu cellphone
+C:+6784
+R:VU
+T:_VUMF
+
 N:Salomonen
 A:Solomon Inseln, Solomonen, Salomoninseln
 E:Solomon Islands
@@ -695,9 +848,21 @@
 C:+6721
 T:AQ
 
-N:Guam
-C:+671
-T:GU
+# Source (2001-08-09):
+# http://www.itu.int/itudoc/itu-t/number/e/etm/73477_ww9.doc
+# independent (international recognition) since 2002-05-20
+N:Ost Timor
+E:East Timor
+A:Timor-Leste, Demokratische Republik Timor-Leste
+A:Democratic Republic of East Timor
+C:+670
+T:TP
+
+N:Ost Timor Mobilfunk
+E:East Timor cellphone
+C:+67072, +67073, +67074, +67075
+R:TP
+T:_TPMF
 
 N:Thailand Mobilfunk
 E:Thailand cellphone
@@ -783,21 +948,40 @@
 C:+60
 T:MY
 
+# Source (2000-11-20):
+# http://www.itu.int/itudoc/itu-t/number/n/nat/76774.html
 N:Niederl. Antillen
 A:Niederlndische Antillen, Antillen (Niederlande)
 E:Netherlands Antilles
 C:+599
 T:AN
 
+N:Niederl. Antillen Mobilfunk
+E:Netherlands Antilles cellphone
+A:Niederlndische Antillen Mobilfunk
+C:+5994165
+C:+59951, +59952, +59956, +59957, +59959
+C:+59978, +59970
+R:AN
+T:_ANMF
+
 N:Uruguay
 C:+598
 T:UY
 
+# Source (2000-09-04):
+# http://www.itu.int/itudoc/itu-t/number/s/sur/70766_ww9.doc
 N:Suriname
 A:Surinam
 C:+597
 T:SR
 
+N:Suriname Mobilfunk
+E:Suriname cellphone
+C:+59788
+R:SR
+T:_SRMF
+
 N:Martinique / Franz. Antillen
 E:Martinique
 A:Franzsische Antillen, Martinique (French Antilles)
@@ -805,10 +989,18 @@
 C:+596
 T:MQ
 
+# Source (2002)
+# http://www.conatel.gov.py/reglamentos/plantec/
 N:Paraguay
 C:+595
 T:PY
 
+N:Paraguay Mobilfunk
+E:Paraguay cellphone
+C:+5949
+R:PY
+T:_PYMF
+
 N:Franzsisch-Guayana
 A:Franzsisch Guyana, Franz. Guyana, French Guyana
 E:French Guiana
@@ -826,16 +1018,39 @@
 C:+593
 T:EC
 
+# Source (2001-01-06):
+# http://www.itu.int/itudoc/itu-t/number/g/guy/70635.html
 N:Guyana
 A:Guayana
 C:+592
 T:GY
 
+N:Guyana Mobilfunk
+E:Guyana cellphone
+C:+592214, +592224, +592248, +592278, +592284, +592294
+C:+592304, +592374, +592384, +592394
+C:+592614
+C:+592620, +592621, +592622, +592623, +592624, +592625, +592626
+C:+592627, +592628
+C:+592630, +592633, +592634, +592635, +592639
+C:+592640, +592641, +592644, +592645
+C:+592678
+R:GY
+T:_GYMF
+
+# Source (2000-11):
+# http://www.sittel.gov.bo/archivos/mlrpnm.pdf
 N:Bolivien
 E:Bolivia
 C:+591
 T:BO
 
+N:Bolivien Mobilfunk
+E:Bolivia cellphone
+C:+59171, +59174, +59176, +59177
+R:BO
+T:_BOMF
+
 N:Guadeloupe
 E:Guadaloupe
 A:Guadeloup
@@ -844,10 +1059,12 @@
 
 N:Venezuela Mobilfunk
 E:Venezuela cellphone
-C:+5816, +5814
+C:+58412, +58414, +58415, +58416, +58417, +58418
 R:VE
 T:_VEMF
 
+# Source (2001-01-15):
+# http://www.itu.int/itudoc/itu-t/number/v/ven/71706.html
 N:Venezuela
 C:+58
 T:VE
@@ -909,11 +1126,25 @@
 R:CU
 T:_GUAN
 
+# Source (2001-08):
+# http://www.itu.int/itudoc/itu-t/number/c/cub/76193.html
 N:Kuba
 E:Cuba
 C:+53
 T:CU
 
+N:Kuba Mobilfunk
+E:Cuba cellpone
+C:+5361319, +535616, +5352249, +5382749, +53780, +53785, +538264
+C:+5332259, +53332668, +53332669, +5341286, +5341287
+C:+53333088, +53333089, +53333011, +53333014, +53333081, +53333084
+C:+53432458, +53419967, +53419968, +5342210
+C:+53213556, +53213557, +53234277, +53234278, +53226688
+C:+5324419, +532461, +5331466, +53314677
+C:+537264, +5352279, +535679
+R:CU
+T:_CUMF
+
 N:Mexiko
 E:Mexico
 C:+52
@@ -998,10 +1229,18 @@
 C:+502
 T:GT
 
+# Source (2001-06-01):
+# http://www.itu.int/itudoc/itu-t/number/b/bez/70767.html
 N:Belize
 C:+501
 T:BZ
 
+N:Belize Mobilfunk
+E:Belize cellphone
+C:+5016
+R:BZ
+T:_BZMF
+
 N:Falklandinseln
 E:Falkland Islands
 A:Falkland Islands (Malvinas),Malvinas
@@ -1009,6 +1248,8 @@
 T:FK
 R:UK
 
+# Source (2002-05-23):
+# http://www.regtp.de/reg_tele/start/in_05-06-01-01-00_m/index.html
 N:Deutschland
 E:Germany
 C:+49
@@ -1016,70 +1257,73 @@
 
 N:Deutschland Mobilfunk
 E:Germany cellphone
-C:+491610,+491611,+491612,+491613,+491614,+491615,+491616,+491617,+491619 # C
-C:+491618		# T-C-Tel Voice Mail (outdated since 31-Dec-2000)
-C:+49151,+49160,+49170,+49171,+49175	# D1
+C:+491511,+49160,+49170,+49171,+49175	# D1
 C:+491520,+49162,+49172,+49173,+49174	# D2
 C:+49163,+49177,+49178		# Eplus
 C:+49176,+49179		# E2
 C:+491505		# Quam
+C:+491566		# Mobilcom
 R:DE
 T:_DEMF
 
-N:Deutschland Mobilfunk C-Tel Voice Mail
-E:Germany cellphone C-Tel Voice Mail
-A:C-Tel Voice Mail
-C:+491618               # (outdated since 31-Dec-2000)
-R:_DEMF
-T:_DEMCM
-
-N:Deutschland Mobilfunk C-Netz
-E:Germany cellphone C-Netz
-A:C-Netz                # (outdated since 31-Dec-2000)
-C:+491610,+491611,+491612,+491613,+491614,+491615,+491616,+491617,+491619
-R:_DEMF
-T:_DEMC
-
 N:Deutschland Mobilfunk D1
 E:Germany cellphone D1
-A:D1
-C:+49151,+49160,+49170,+49171,+49175
+A:D1, Deutschland Mobilfunk T-Mobile
+C:+491511,+49160,+49170,+49171,+49175	# reserved (2002-07-12): +49151
 R:_DEMF
 T:_DEMD1
 
 N:Deutschland Mobilfunk D2
 E:Germany cellphone D2
-A:D2
-C:+491520,+49162,+49172,+49173,+49174
+A:D2, Deutschland Mobilfunk Vodafone
+C:+491520,+49162,+49172,+49173,+49174	# reserved (2002-07-12): +49152
 R:_DEMF
 T:_DEMD2
 
 N:Deutschland Mobilfunk E1
 E:Germany cellphone E1
-A:E1, Eplus
-C:+49163,+49177,+49178
+A:E1, Eplus, Deutschland Mobilfunk E-Plus
+C:+49163,+49177,+49178	# reserved (2002-07-12): +49155
 R:_DEMF
 T:_DEME1
 
 N:Deutschland Mobilfunk E2
 E:Germany cellphone E2
-A:E2
-C:+49176,+49179
+A:E2, Deutschland Mobilfunk Interkom, Deutschland Mobilfunk O2, O2 Germany
+C:+49176,+49179		# reserved (2002-07-12): +49159
 R:_DEMF
 T:_DEME2
 
 N:Deutschland Mobilfunk Quam
 E:Germany cellphone Quam
 A:Quam
-C:+491505
+C:+491505		# reserved (2002-07-12): +49151
 R:_DEMF
 T:_DEMQ
 
-N:Deutschland Freecall
+N:Deutschland Mobilfunk Mobilcom
+E:Germany cellphone Mobilcom
+C:+491566		# reserved (2002-07-12): +49156
+R:_DEMF
+T:_DEMM
+
+N:Deutschland Bndelfunk Dolphin Telecom
+E:Germany trunk network Dolphin Telecom
+C:+491672
+R:DE
+T:_DEBD
+
+N:Deutschland Persnliche Rufnummer
+E:Germany personal number
+C:+49700		# reserved (2002-05-23): +49701
+R:DE
+T:_DEPR
+
+N:Deutschland Freephone
 E:Germany Freephone
-C:+4911		 # netzinterne Nutzung
-C:+49130         # Freephone (outdated since 31-Dec-2000)
-C:+4931 	 # Testrufnummern
+A:Deutschland Freecall
+C:+4911		 # ? netzinterne Nutzung
+C:+4931 	 # ? Testrufnummern
 C:+49800, +49801 # Freephone
 R:DE
 T:_DEFF
@@ -1122,7 +1366,7 @@
 
 N:Deutschland T-VoteCall
 A:Televotecall
-C:+491371, +491372, +491373, +491374, +49138
+C:+49137, +49138
 R:DE
 T:_DETV
 
@@ -1131,8 +1375,9 @@
 R:DE
 T:_FRA
 
-N:Polen-Mobilfunk
+N:Polen Mobilfunk
 E:Poland cellphone
+A:Polen-Mobilfunk
 C:+48501, +48502, +48601, +48602
 R:PL
 T:_PLMF
@@ -1173,13 +1418,25 @@
 R:DK
 T:_SOEN
 
+N:Dnemark Freephone
+E:Denmark freephone
+C:+4580
+R:DK
+T:_DKFF
+
 N:Dnemark Mobilfunk
 E:Denmark cellphone
 A:Dnemark Mobile
-C:+45503, +45502, +45501, +45409, +45408, +45407, +45406, +45405, +45404, +45403, +45402, +45401, +4530, +4528, +4526, +4523, +4522, +4521, +45209, +45208, +45207, +45206, +45205, +45204, +45203, +45202, +45201
+C:+452
+C:+4530, +4531
+C:+4540
+C:+4550, +4551
+C:+4560, +4561
 R:DK
 T:_DKMF
 
+# Source (2003-07-07)
+# http://www.itst.dk/wimpdoc.asp?page=tema&objno=95024386
 N:Dnemark
 E:Denmark
 C:+45
@@ -1214,23 +1471,57 @@
 C:+44
 T:UK
 
+# Source (2001-09-17):
+# http://www.warwick.ac.uk/search/Phones/nng_list.txt
 N:Insel Man (Grobritannien)
 A:Insel Man
 E:Isle of Man
 R:UK
-C:+44999 # Fixme
+C:+441624	# fixed
+C:+447624	# mobile
+C:+44808162	# freephone
 T:_UKIM
 
+N:Insel Man Mobilfunk
+E:Isle of Man cellphone
+A:Insel Man (Grobritannien) Mobilfunk
+C:+447624
+R:_UKIM
+T:_IMMF
+
+N:Insel Man Freephone
+E:Isle of Man freephone
+A:Insel Man (Grobritannien) Freephone
+C:+44808162
+R:_UKIM
+T:_IMFF
+
+# Source see Isle of Man
 N:Kanalinseln (Grobritannien)
-A:Kanalinseln, Kanalinseln (GB)
+A:Kanalinseln, Kanalinseln (GB), Guernsey und Jersey
 E:Channel Islands
 R:UK
-C:+44998 # Fixme
+C:+441481, +447781, +800976			# Guernsey
+C:+441534, +4477977, +4477978, +44800735	# Jersey
 T:_UKIK
 
+N:Kanalinseln Mobilfunk
+E:Channel Islands cellphone
+A:Kanalinseln (Grobritannien) Mobilfunk
+C:+447781, +4477977, +4477978
+R:_UKIK
+T:_GGMF
+
+N:Kanalinseln Freephone
+E:Channel Islands freephone
+A:Kanalinseln (Grobritannien) Freephone
+C:+44800976, +44800735
+R:_UKIK
+T:_GGFF
+
 N:Nordirland
 E:Northern Ireland
-C:+441232 # Fixme, this is Belfast only
+C:+4428
 R:UK
 T:_UKIR
 
@@ -1264,23 +1555,56 @@
 C:+43
 T:AT
 
+# Source (2002-08-05):
+# http://www.ak.li/en/cc423NumberingPlan.asp
 N:Liechtenstein
-A:Lichtenstein
-A:Liechtenstein Mobilfunk
-C:+423, +4175
+A:Lichtenstein, Frstentum Liechtenstein
+C:+423			# since 1999-04-05
+C:+4175			# until 2003(?), portion of CH=+41 
 T:LI
 
+N:Liechtenstein Mobilfunk
+E:Liechtenstein cellphone
+C:+42376, +42377, +42378, +42379
+R:LI
+T:_LIMF
+
+N:Freephone Liechtenstein
+C:+42380
+R:LI
+T:_LIFF
+
+# Source (2002-06-03):
+# http://www.teleoff.gov.sk/Cislovanie/listnumb.html
 N:Slowakische Republik
 A:Slowakei, Slowakische Rep., Slowak. Rep., Slovakia
 E:Slovak Republic
 C:+421
 T:SK
 
+N:Slowakische Republik Mobilfunk
+E:Slovak Republic cellphone
+A:Slowakei Mobilfunk
+C:+421902, +421903, +421904	# Eurotel Bratislava GSM
+C:+421905, +421906, +421907, +421908, +421915	# Globtel GSM
+R:SK
+T:_SKMF
+
 N:Tschechische Rep. Mobilfunk
 E:Czech Republic cellphone
-C:+420602, +420603, +420604, +420963
+C:+420602, +420603, +420604	# temporary assignment (2002-09-22) 
+C:+42072, +42073, +42077
+C:+420963		# ? voice mail 
 T:_CZMF
 
+N:Freephone Tschechische Rep.
+E:Czech Republic freephone
+C:+420800
+R:CZ
+T:_CZFF
+
+# Source (2002-09-22):
+# http://www.ctu.cz/english/announ.pdf
 N:Tschechische Republik
 A:Tschechien, Tschechische Rep., Tschech. Rep.
 E:Czech Republic
@@ -1296,7 +1620,7 @@
 
 N:Schweiz Mobilfunk
 E:Switzerland cellphone
-C:+4179, +4178, +4176
+C:+4176, +4177, +4178, +4179
 R:CH
 T:_CHMF
 
@@ -1308,9 +1632,12 @@
 
 N:Zurich
 C:+411
+C:+4143,+4144
 R:CH
 T:ZRH
 
+# Source (2001-11-20)
+# http://www.bakom.ch/imperia/md/content/english/telecomdienste/prescriptionstechniques/3.pdf
 N:Schweiz
 E:Switzerland
 C:+41
@@ -1319,6 +1646,7 @@
 N:Rumnien Mobilfunk
 E:Romania cellphone
 C:+4092, +4094
+R:RO
 T:_ROMF
 
 N:Rumnien
@@ -1359,39 +1687,94 @@
 T:VA
 R:IT
 
+# Source (2001-11-15):
+# http://www.itu.int/itudoc/itu-t/number/s/svn/71836.html
 N:Mazedonien
 E:Macedonia
 C:+389
 T:MK
 
+N:Mazedonien Mobilfunk
+E:Macedonia cellphone
+C:+38970
+R:MK
+T:_MKMF
+
+# Source (2001-11-29):
+# http://www.itu.int/itudoc/itu-t/number/b/bih/71264.html
 N:Bosnien-Herzegowina
 E:Bosnia and Hercegovina
-A:Bosnien-Herzegovina, Bosnien
+A:Bosnien-Herzegovina, Bosnien, Bosnien und Herzegowina
 C:+387
 T:BA
 
+N:Bosnien-Herzegowina Mobilfunk
+E:Bosnia and Hercegovina cellphone
+A:Bosnien und Herzegowina Mobilfunk
+C:+38761, +38763, +38765
+R:BA
+T:_BAMF
+
+# Source (2001-06-11):
+# http://www.itu.int/itudoc/itu-t/number/s/svn/71836.html
 N:Slowenien
 E:Slovenia
 C:+386
 T:SI
 
+N:Slowenien Mobilfunk
+E:Slovenia cellphone
+C:+38620, +38621, +38630, +38631, +38640, +38641, +38649
+C:+38650, +38651, +38660, +38661, +38670, +38671
+R:SI
+T:_SIMF
+
+# Source (2001-10-22):
+# http://www.itu.int/itudoc/itu-t/number/c/cro/75465.html
 N:Kroatien
 E:Croatia
 A:Croatia (Hrvatska),Hrvatska
 C:+385
 T:HR
 
-N:Jugoslawien
+N:Kroatien Mobilfunk
+E:Croatia cellphone
+C:+38591, +38598, +38599
+R:HR
+T:_HRMF
+
+# Source (2002-12-05):
+# http://www.itu.int/itudoc/itu-t/number/y/yug/82105_ww2.doc
+N:Serbien und Montenegro
+A:Jugoslawien
 A:Jugoslawien (Serbien/Montenegro), Serbien, Montenegro, Yugoslavia (Servia & Montenegro)
 A:Jugoslawien Montenegro, Jugoslawien Serbien und Montenegro, Jugoslawien-Serbien
-E:Yugoslavia
+E:Serbia and Montenegro
+A:Yugoslavia
 C:+381
 T:YU
 
+N:Serbien und Montenegro Mobilfunk
+A:Jugoslawien Mobilfunk
+E:Serbia and Montenegro cellphone
+A:Yugoslavia cellphone
+C:+38161, +38163, +38164, +38165, +38167, +38169
+C:+381663, +381664, +381665, +381666, +381667
+R:YU
+T:_YUMF
+
+# Source (2002-03-14):
+# http://www.itu.int/itudoc/itu-t/number/u/ukr/78457.html
 N:Ukraine
 C:+380
 T:UA
 
+N:Ukraine Mobilfunk
+E:Ukraine cellphone
+C:+38050
+R:UA
+T:_UAMF
+
 N:San Marino
 C:+378
 T:SM
@@ -1406,6 +1789,14 @@
 C:+377
 T:MC
 
+N:Andorra Mobilfunk
+E:Andorra cellphone
+C:+3763
+R:AD
+T:_ADMF
+
+# Source (1998-07-14):
+# http://www.itu.int/itudoc/itu-t/number/a/and/75461.html
 N:Andorra
 C:+376
 T:AD
@@ -1417,13 +1808,21 @@
 C:+375
 T:BY
 
+# Source (2002-02-21)
+# http://www.itu.int/itudoc/itu-t/number/a/arm/71086.html
 N:Armenien
 E:Armenia
 C:+374
 T:AM
 
-N:Moldavien Moldau (Republik)
-A:Moldau Republik, Moldavien, Moldawien, Moldau
+N:Armenien Mobilfunk
+E:Armenia cellphone
+C:+3747, +374940, +374941
+R:AM
+T:_AMMF
+
+N:Moldau (Republik)
+A:Moldau Republik, Moldavien, Moldawien, Moldau, Republik Moldau
 E:Moldova
 C:+373
 T:MD
@@ -1438,17 +1837,35 @@
 C:+372
 T:EE
 
+# Source (2002-10-21):
+# http://www.itu.int/itudoc/itu-t/number/l/ltu/81903_ww2.doc
 N:Lettland
 E:Latvia
 A:Lettland (Latvia)
 C:+371
 T:LV
 
+N:Lettland Mobilfunk
+E:Latvia cellphone
+C:+37116, +37161 			# reserved
+C:+37162, +37162, +37163, +37165
+C:+37191, +37192, +37193, +37194
+R:LV
+T:_LVMF
+
+# Source (2003-05-04):
+# http://www.rrt.lt/numeracija/en/index.htm
 N:Litauen
 E:Lithuania
 C:+370
 T:LT
 
+N:Litauen Mobilfunk
+E:Lithuania cellphone
+C:+3706		# old numbers closed 2002-09-01
+R:LT
+T:_LTMF
+
 N:Ungarn Mobilfunk
 E:Hungary cellphone
 C:+3620, +3630, +3660
@@ -1459,11 +1876,20 @@
 C:+36
 T:HU
 
+# Source (2003-05-04)
+# http://www.crc.bg/v2/files/en/585.htm
 N:Bulgarien
 E:Bulgaria
 C:+359
 T:BG
 
+N:Bulgarien Mobilfunk
+E:Bulgaria cellpone
+C:+35948, +35987, +35988 		# assigned
+C:+35949, +35989, +35998, +35999 	# reserved
+R:BG
+T:_BGMF
+
 N:Finnland
 E:Finland
 C:+358
@@ -1476,11 +1902,13 @@
 T:_FIMF
 
 N:Zypern(griech) Mobilfunk
-A:Zypern-Mobilfunk
+A:Zypern-Mobilfunk, Zypern Mobilfunk
 E:Cyprus cellphone
-C:+3579, +3576
+C:+3579992, +357994, +357995, +357996, +357998
 T:_CYMF
 
+# Quelle (2003-05-04):
+# http://www.cyta.com.cy/tesa/uk/ti.htm
 N:Zypern
 E:Cyprus
 A:Zypern (Griechisch), Zypern (griech.), Zypern Sd
@@ -1495,6 +1923,14 @@
 R:TK
 T:_CYTK
 
+N:Malta Mobilfunk
+E:Malta cellphone
+C:+35679, +35699
+R:MT
+T:_MTMF
+
+# Source (2002-06-18):
+# http://www.mca.org.mt/images/library/NumberingPlan%20%20for%20web%20site.pdf
 N:Malta
 C:+356
 T:MT
@@ -1504,9 +1940,28 @@
 C:+355
 T:AL
 
-# FIXME!
+# Source (2002-02-28) 
+http://www.pta.is/english/numbering/mobilecodes.htm
 N:Island Mobilfunk
-# C:+354
+E:Iceland cellphone
+C:+354388, +354389
+C:+354398, +354399
+C:+354620, +354621, +354622, +354623, +354624, +354625
+C:+354630
+C:+354649
+C:+354650, +354659
+C:+354660, +354661, +354662, +354663, +354664
+C:+354670, +354671, +354672, +354673, +354674
+C:+35468
+C:+35469
+C:+35482	
+C:+35483
+C:+354840, +354846, +354847, +354848, +354849
+C:+35485
+C:+35486
+C:+354870, +354871, +354872, +354873, +354876, +354878
+C:+35488
+C:+35489
 R:IS
 T:_ISMF
 
@@ -1723,12 +2178,29 @@
 C:+30
 T:GR
 
+# Source (2000-09-18):
+# http://www.itu.int/itudoc/itu-t/number/g/gre/82117_ww2.doc
 N:Grnland
 E:Greenland
 C:+299
 T:GL
 R:DK
 
+N:Grnland Mobilfunk
+E:Greenland cellphone
+C:+29949, +29952, +29953, +29954, +29955, +29956, +29957, +29958, +29959
+R;GL
+T:_GLMF
+
+N:Frer-Inseln Mobilfunk
+E:Faeroe Islands cellphone
+A:Frer Inseln Mobilfunk, Frer Mobilfunk
+C:+29821, +29871, +29891
+R:FO
+T:_FOMF
+
+# Source (2001-03-14):
+# http://www.fse.fo/images/Documents/6_20026114757_911.xls
 N:Frer-Inseln
 A:Frer, Farer, Farer Inseln, Faroer Inseln, Feroer
 E:Faeroe Islands
@@ -1736,14 +2208,30 @@
 T:FO
 R:DK
 
+# Source (1993-09-30):
+# http://www.itu.int/itudoc/itu-t/number/a/aru/75916.html
 N:Aruba
 C:+297
 T:AW
 
+N:Aruba Mobilfunk
+E:Aruba cellphone
+C:+2979
+R:AW
+T:_AWMF
+
+# Source (2001-04-17):
+# http://www.itu.int/itudoc/itu-t/number/e/eri/79141.html
 N:Eritrea
 C:+291
 T:ER
 
+N:Eritrea Mobilfunk
+E:Eritrea cellphone
+C:+291171, +291172, +291173
+R:ER
+T:_ERMF
+
 N:St. Helena
 E:Saint Helena
 C:+290
@@ -1771,40 +2259,96 @@
 C:+269
 T:KM
 
+# Source (2002-08-23):
+# http://www.global269.com/global269/jsp/implementation.jsp
+N:Global269
+A:Global 269
+C:+269800
+R:KM
+T:_KMFF
+
+# Source (2001-10-23):
+# http://www.itu.int/itudoc/itu-t/number/m/mat/76022.html
 N:Mayotte
 A:Mayotte Inseln, Mayotte Island
-C:+26960,+26961,+26962
+C:+26960, +26961, +26962, +26965, +26966, +26967, +26968, +26969
 T:YT
 R:KM
 
+N:Mayotte Mobilfunk
+E:Mayotte cellphone
+C:+26965, +26966, +26967, +26968, +26969
+R:YT
+T:_YTMF
+
+# Source (2002-05-09):
+# http://www.itu.int/itudoc/itu-t/number/s/swz/75920.html
 N:Swasiland
 E:Swaziland
 C:+268
 T:SZ
 
+N:Swasiland Mobilfunk
+E:Swaziland cellphone
+C:+26860
+R:SZ
+T:_SZMF
+
 N:Botsuana
 A:Botswana Republic, Botsuana (Botswana)
 E:Botswana
 C:+267
 T:BW
 
+# Source (2003-02-23)
+# http://www.lta.org.ls/
 N:Lesotho
 C:+266
 T:LS
 
+N:Lesotho Mobilfunk
+E:Lesotho cellphone
+C:+2665, +2666
+R:LS
+T:_LSMF
+
+# Source (2002-01-09):
+# http://www.itu.int/itudoc/itu-t/number/m/mwi/76657.html
 N:Malawi
 C:+265
 T:MW
 
+N:Malawi Mobilfunk
+E:Malawi cellphone
+C:+26508, +26509
+R:MW
+T:_MWMF
+
+# Source (2002-02-21):
+# http://www.itu.int/itudoc/itu-t/number/n/nam/79056.html
 N:Namibia
 C:+264
 T:NA
 
+N:Namibia Mobilfunk
+E:Namibia cellphone
+C:+26481
+R:NA
+T:_NAMF
+
+# Source (2001-07-11):
+# http://www.itu.int/itudoc/itu-t/number/z/zwe/76048.html
 N:Simbabwe
 E:Zimbabwe
 C:+263
 T:ZW
 
+N:Simbabwe Mobilfunk
+E:Zimbabwe cellphone
+C:+2637
+R:ZW
+T:_ZWMF
+
 N:Reunion
 A:Runion, Reunion Island, Reunion Islands
 C:+262
@@ -1835,17 +2379,33 @@
 C:+256
 T:UG
 
+# Source (2000-06-20):
+# http://www.itu.int/itudoc/itu-t/number/t/tan/71089.html
 N:Tansania
 A:Sansiba
 E:Tanzania
 C:+255
 T:TZ
 
+N:Tansania Mobilfunk
+E:Tanzania cellphone
+C:+25574
+R:TZ
+T:_TZMF
+
+# Source (2002-08-24):
+# http://www.cck.go.ke/newnumbers/numbernew.html
 N:Kenia
 E:Kenya
 C:+254
 T:KE
 
+N:Kenia Mobilfunk
+E:Kenya cellphone
+C:+2547
+R:KE
+T:_KEMF
+
 N:Dschibuti
 E:Djibouti
 C:+253
@@ -1855,27 +2415,51 @@
 C:+252
 T:SO
 
+# Source (2000-08-13):
+# http://www.itu.int/itudoc/itu-t/number/e/eth/73270.html
 N:thiopien
 E:Ethiopia
 A:thopien,Athiopien
 C:+251
 T:ET
 
+N:thiopien Mobilfunk
+E:Ethiopia cellphone
+C:+251920, +251921, +251922, +251923, +251929
+R:ET
+T:_ETMF
+
+# Source (2000-08-04)
+# http://www.itu.int/itudoc/itu-t/number/r/rwa/75919.html
 N:Ruanda
 E:Rwanda
 C:+250
 T:RW
 
+N:Ruanda Mobilfunk
+E.Rwanda cellphone
+C:+250081, +250082, +250083, +250084, +250085
+R:RW
+T:_RWMF
+
 N:Sudan
 C:+249
 T:SD
 
-N:Seyschellen
-A:Seychellen, Seychelles Islands
+# Source (2000-11-15):
+# http://www.itu.int/itudoc/itu-t/number/s/syc/72016.html
+N:Seychellen
+A:Seyschellen, Seychelles Islands
 E:Seychelles
 C:+248
 T:SC
 
+N:Seychellen Mobilfunk
+E:Seychelles cellphone
+C:+2485
+R:SC
+T:_SCMF
+
 N:Ascension
 A:Ascension Isle, Ascension Island, Ascension Inseln, Ascension Inseln (GB)
 C:+247
@@ -1890,26 +2474,37 @@
 C:+245
 T:GW
 
+# Source (2001-07-31):
+# http://www.itu.int/itudoc/itu-t/number/a/ago/75259.html
 N:Angola
 C:+244
 T:AO
 
-N:Zaire Mobilfunk
-E:Zaire cellphone
+N:Angola Mobilfunk
+E:Angola cellphone
+C:+24491, +24492
+R:AO
+T:_AOMF
+
+N:Kongo (Demokratische Republik) Mobilfunk
+E:Congo (Democratic Republik of the) cellphone
+A:Zaire Mobilfunk, Zaire cellphone
 C:+24388
 T:_ZRMF
 
-N:Zaire
-A:Kongo (Republik),Kongo (Rebublik)
-C:+243
-T:ZR
-
-N:Kongo
-A:Kongo (Demokratische Republik), Kongo (DR)
-E:Congo
+N:Kongo (Republik)
+A:Kongo, Kongo (Rebublik), Republik Kongo, Republic of the Congo, Congo
+E:Congo (Republic of the)
 C:+242
 T:CG
 
+N:Kongo (Demokratische Republik)
+A:Kongo (DR), Demokratische Republik Kongo, Democratic Republic of the Congo
+A:Zaire 	# till 1997
+E:Congo (Democratic Republic of the)
+C:+243
+T:ZR 	# internet cc-TLD may be .cd
+
 N:Gabun
 E:Gabon
 C:+241
@@ -1932,11 +2527,19 @@
 C:+238
 T:CV
 
+# Source: (2002-02-27):
+# http://www.itu.int/itudoc/itu-t/number/c/cam/75552.html
 N:Kamerun
 E:Cameroon
 C:+237
 T:CM
 
+N:Kamerun Mobilfunk
+E:Cameroon cellphone
+C:+23776, +23777, +23798, +23799
+R:CM
+T:_CMMF
+
 N:Zentralafrikanische Republik
 A:Zentral Afrika (Rep.), Zentralafrika
 E:Central African Republic
@@ -1957,37 +2560,76 @@
 C:+233
 T:GH
 
+# Source (2002-01-07):
+# http://www.itu.int/itudoc/itu-t/number/s/sle/77986.html
 N:Sierra Leone
 C:+232
 T:SL
 
+N:Sierra Leone Mobilfunk
+E:Sierra Leone cellphone
+C:+23223, +23230, +23276
+R:SL
+T:_SLMF
+
 N:Liberia
 C:+231
 T:LR
 
+# Source (2001-12-11):
+# http://www.itu.int/itudoc/itu-t/number/m/mli/79972.html
 N:Mauritius
 C:+230
 T:MU
 
+N:Mauritius Mobilfunk
+E:Mauritius cellphone
+C:+23025
+C:+230421, +230422, +230423
+C:+230491, +230492, +230493, +230494, +230495
+C:+230497, +230498, +230499
+C:+230720, +230721, +230729
+C:+23073, +23075, +23076, +23077
+R:MU
+T:_MUFF
+
 N:Benin
 C:+229
 T:BJ
 
+# Source (2001-07-05):
+# http://www.itu.int/itudoc/itu-t/number/t/tgo/74129.html
 N:Togo
 C:+228
 T:TG
 
+N:Togo Mobilfunk
+A:Togo cellphone
+C:+2289
+R:TG
+T:_TGMF
+
 N:Niger
 E:Niger Republic
 C:+227
 T:NGR
 
+# Source (2001-08-02)
+# http://www.itu.int/itudoc/itu-t/number/b/bfa/76021.html
 N:Burkina Faso Obervolta
 A:Obervolta
 E:Burkina Faso
 C:+226
 T:BF
 
+N:Burkina Faso Mobilfunk
+E:Burkina Faso cellphone
+C:+2262
+C:+22660, +22661, +22662, +22663, +22664, +22665
+C:+22680, +22681, +22682, +22683, +22685, +22685
+R:BF
+T:_BFMF
+
 N:Elfenbeinkste Cote de Ivoire
 A:Cote d'Ivoire (Elfenbeinkste), Cote d'Ivoire, Elfenbeinkste
 A:Cote DIvoire (Ivory Coast)
@@ -2001,26 +2643,58 @@
 C:+224
 T:GN
 
+# Source (2002-06-21):
+# http://www.itu.int/itudoc/itu-t/number/m/mli/79972.html
 N:Mali
 A:Mali Rep.
 E:Mali Republic
 C:+223
 T:ML
 
+N:Mali Mobilfunk
+E:Mali cellphone
+C:+22367
+R:ML
+T:_MLMF
+
+# Source (2001-02-04):
+# http://www.itu.int/itudoc/itu-t/number/m/mrt/73079.html 
 N:Mauretanien
 E:Mauritania
 C:+222
 T:MR
 
+N:Mauretanien Mobilfunk
+E:Mauritania cellphone
+C:+2226
+R:MR
+T:_MRMF
+
+# Source (1997-08-13):
+# http://www.itu.int/itudoc/itu-t/number/s/sen/78131.html
 N:Senegal
 E:Senegal Republic
 C:+221
 T:SN
 
+N:Senegal Mobilfunk
+E:Senegal cellphone
+C:+2216
+R:SN
+T:_SNMF
+
+# Source (2002-01-03):
+# http://www.itu.int/itudoc/itu-t/number/g/gmb/77448.html 
 N:Gambia
 C:+220
 T:GM
 
+N:Gambia Mobilfunk
+E:Gambia cellphone
+C:+2209
+R:GM
+T:_GMMF
+
 N:Libyen
 A:Libysch-Arabische Dschamahirija, Lybien, Lybisch-Arabische Dschamahija
 A:Libysch-Arabische-Republik
@@ -2028,28 +2702,51 @@
 C:+218
 T:LY
 
+# Source (2001-09-08):
+# http://www.itu.int/itudoc/itu-t/number/t/tunis/74494.html
 N:Tunesien
 E:Tunisia
 A:Tunesia
 C:+216
 T:TN
 
+N:Tunesien Mobilfunk
+E:Tunisia cellphone
+C:+21698
+R:TN
+T:_TNMF
+
 N:Algerien Mobilfunk
 E:Algeria cellphone
-# C:+213 fixme
+C:+21361
 R:DZ
 T:_DZMF
 
+# Source (2000-08-15):
+# http://www.itu.int/itudoc/itu-t/number/a/alg/70713.html
 N:Algerien
 E:Algeria
 C:+213
 T:DZ
 
+# Source (2001-08-08):
+# http://www.itu.int/itudoc/itu-t/number/m/mar/70657.html
 N:Marokko
-E:Marocco
-A:Western Sahara # fixme
+E:Morocco
+A:Marocco
 C:+212
-T:EH # fixme
+T:MA		 # T:EH up to V:1.40 
+
+N:Marokko Mobilfunk
+E:Morocco cellphone
+C:+2126
+R:MA
+T:_MAMF
+
+N:Western Sahara
+C:+21248	# Layoune, maybe incomplete 
+R:MA
+T:EH
 
 N:gypten Mobilfunk
 E:Egypt cellphone
@@ -2062,22 +2759,26 @@
 C:+20
 T:EG
 
-N:Alaska
-C:+1907
-R:US
-T:_ALAS
+# source: http://www.teltronics.com/beyond.html
+# Source (2002-08-12) for the list of canadian NPA (+1NPA):
+# http://www.cnac.ca/mapcodes.htm
+N:Kanada
+E:Canada
+C:+1204, +1250, +1289, +1306, +1403, +1416, +1418, +1450, +1506, +1514, +1519
+C:+1604, +1613, +1647, +1705, +1709, +1778, +1780, +1807, +1819, +1867
+C:+1902, +1905
+C:+1438 	# from 2003-03-17 for test, in service 2004-02-14
+C:+1600		# nationwide (SAC)
+T:CA
 
+# fixme: _CAMF must follow CA due to identical number codes
+# for priority of _CAMF
 N:Kanada Mobilfunk
 E:Canada cellphone
 C:+1204, +1250, +1306, +1403, +1416, +1418, +1450, +1506, +1514, +1519, +1600, +1604, +1613, +1705, +1709, +1780, +1807, +1819, +1867, +1902, +1905
+R:CA
 T:_CAMF
 
-# source: http://www.teltronics.com/beyond.html
-N:Kanada
-E:Canada
-C:+1647
-T:CA
-
 N:Jamaika
 E:Jamaica
 C:+1876
@@ -2091,43 +2792,84 @@
 C:+1869
 T:KN
 
+# Source (2002-07-10):
+# http://www.itu.int/itudoc/itu-t/number/t/tto/79162.html
 N:Trinidad und Tobago
 A:Trinidad & Tobago
 E:Trinidad and Tobago
-C:+1868, +1809680, +180967, +180966, +180965, +180964, +180963, +180962, +1809619
+C:+1868
 T:TT
 
+N:Trinidad und Tobago Mobilfunk
+E:Trinidad and Tobage cellphone
+C.+1686620
+C:+1686680, +1686681, +1686682, +1686683, +1686684, +1686685, +168686
+C:+1686688, +1686689
+C:+18687
+R:TT
+T:_TTMF
+
 N:Dominikanische Rep. Mobilfunk
 A:Domin. Rep.-Mobilfunk, Dominikanische Republik Mobilfunk
 E:Dominican Republic cellphone
-C:+18092, +1809227, +1809241, +1809474, +1809537, +1809540, +1809563, +1809683, +1809695
+# fixme: list shortened due to limitations, see note at top of file
+#C:+1809204, +1809222, +1809223, +1809224, +1809249, +1809250, +1809251
+#C:+1809252, +1809253, +1809254, +1809256, +1809257, +1809258, +1809280
+#C:+1809281, +1809282, +1809292, +1809293, +1809299, +1809301, +1809310
+#C:+1809321, +1809322, +1809323, +1809324, +1809325, +1809326, +1809327
+#C:+1809330, +1809340, +1809341, +1809342, +1809343, +1809344, +1809345
+C:+1809348, +1809350, +1809360, +1809370, +1809383, +1809395, +1809396
+C:+1809399
+C:+180942
+C:+1809445, +1809446, +1809447, +1809448, +1809449, +1809450, +1809451
+C:+1809452, +1809453, +1809454, +1809470, +1809481, +1809519, +1809543
+C:+1809545, +1809628, +1809629, +1809630, +1809631, +1809632, +1809633
+C:+1809634, +1809635, +1809639
+C:+180964, +180965
+C:+1809660, +1809696, +1809697, +1809707, +1809710, +1809727, +1809729
+C:+1809750, +1809751, +1809752, +1809753, +1809756, +1809757, +1809758
+C:+1809759, +1809760, +1809761, +1809762, +1809763, +1809764, +1809765
+C:+1809801, +1809802, +1809803, +1809804, +1809805, +1809815, +1809816
+C:+1809817, +1809834, +1809835, +1809836, +1809837, +1809838, +1809839
+C:+1809840, +1809841, +1809844, +1809845, +1809846, +1809847, +1809848
+C:+1809849
+C:+180985, +180986
+C:+1809873, +1809875, +1809876, +1809877, +1809878, +1809879, +1809879
+C:+1809880, +1809881, +1809882, +1809883, +1809884, +1809885, +1809886
+C:+1809889, +1809890, +1809912, +1809913, +1809914, +1809915, +1809916
+C:+1809917, +1809918, +1809938, +1809939, +1809940, +1809941, +1809942
+C:+1809943, +1809944
+R:DO
 T:_DOMF
 
+# Source (2002-02-22):
+# http://www.indotel.org.do/Site/codigos.htm
+# +1809 is nowadays used by Dominican Republic only
 N:Dominikanische Republik
 E:Dominican Republic
 A:Dominikanische Rep., Dom Rep, Domin. Rep.
-C:+184, +1809971, +1809970, +1809908, +1809818, +1809814, +1809813, +1809810, +1809808, +1809807, +1809806, +1809710, +1809707, +1809701, +1809699, +1809698, +1809697, +1809696, +1809694, +1809689, +1809688, +1809687, +1809686, +1809685, +1809684, +1809682, +1809681, +1809616, +1809615, +1809612, +1809606, +1809604, +180959, +180958, +180957, +180956, +1809559, +1809558, +1809557, +1809556, +1809554, +1809553, +1809552, +1809551, +1809550, +180954, +180953, +180952, +1809519, +1809518, +1809512, +1809508, +1809506, +1809504, +1809481, +180947, +1809414, +1809412, +1809350, +1809343, +1809320, +1809310, +1809301, +1809299, +1809295, +1809293, +1809292, +1809291, +1809290, +1809282, +1809281, +1809280, +1809279, +1809278, +1809277, +1809276, +1809275, +1809274, +1809273, +1809248, +1809247, +1809246, +1809245, +1809244, +1809243, +1809242, +1809240, +1809239, +1809238, +1809237, +1809236, +1809234, +1809233, +1809231, +1809226, +1809225, +1809224, +1809223, +1809222, +1809221, +1809220, +1809209, +1809208, +1809204, +1809188
+C:+1809
 T:DO
 
 N:Turks- und Caicosinseln
 E:Turks and Caicos Islands
 A:Turks & Caicos Islands, Turks- & Caicosins.
 A:Turks und Caicos, Turks and Caicos Inseln, Turks u. Caicosinseln
-C:+1809946, +1809941, +1649
+C:+1649
 T:TC
 
 N:Amerikanische Jungferninseln
 A:Jungferninseln (USA), Amerikan. Jungferninseln, American Virgin Isles
 A:US Jungferninseln, Amer. Jungferninseln
 E:Virgin Islands (US)
-C:+180977, +1809719, +1809715, +1809714, +1809713, +1809712, +1809693, +1809692, +1809690, +1809611, +1809513, +1340
+C:+1340
 T:VI
 
 N:Britische Jungferninseln
 A:Jungferninseln (GB), Jungferninseln (britisch), British Virgin Isles
 A:Brit. Jungferninseln, Britisch Jungferninseln
 E:Virgin Islands (British), Virgin Islands (UK)
-C:+1809499, +1809496, +1809495, +1809494, +1809, +1284
+C:+1284
 T:VG
 
 N:St. Vincent und Grenadinen
@@ -2135,32 +2877,26 @@
 A:St. Vincent & Greens.,St. Vincent,St. Vincent & Grenadinen
 A:Saint Vincent und Grenadinen, St. Vincent und Grenada
 E:Saint Vincent and the Grenadines
-C:+1809493, +1809490, +1809485, +1809458, +1809457, +1809456, +1784
+C:+1784
 T:VC
 
 N:Dominica
 A:Domenica
-C:+1809449, +1809448, +1809447, +1809446, +1809445, +1809235, +1767
+C:+1767
 T:DM
 
 N:Grenada
 A:Carriacou
-C:+1809444, +1809443, +1809442, +1809441, +1809440, +1809408, +1809407, +1473
+C:+1473
 T:GD
 
-N:Hawaii
-A:Hawai, Hawaii-Inseln
-C:+1808
-R:US
-T:_HAWA
-
 N:Puerto Rico Mobilfunk
 R:PR
 T:_PRMF
 # fixme
 
 N:Puerto Rico
-C:+1787
+C:+1787, +1939
 T:PR
 
 N:St. Lucia
@@ -2168,12 +2904,18 @@
 C:+1758
 T:LC
 
+N:Guam
+C:+1671
+R:US
+T:GU
+
 N:Marianen (SaipanNord-)
 A:Nrdliche Marianen, Marianen, Marianen (Saipan), Saipan, Salpan
 A:Marianen (Nrdliche)
 A:Westl. Marianen
+A:Commonwealth of the Northern Mariana Islands (CNMI)
 E:Northern Mariana Islands
-C:+1670, +1671
+C:+1670
 T:MP
 
 N:Montserrat
@@ -2198,6 +2940,8 @@
 T:KY
 R:UK
 
+# Source (1999-09-03)
+# http://www.itu.int/itudoc/itu-t/number/a/atg/75462.html
 N:Antigua und Barbuda
 A:Antigua & Barbuda, Antigua & Barbadu, Antigua, Antigua und Barbadu
 E:Antigua and Barbuda
@@ -2205,21 +2949,43 @@
 C:+1268
 T:AG
 
+N:Antigua und Barbuda Mobilfunk
+E:Antigua and Barbuda cellphone
+C:+1268464, +1268723, +1268724
+R:AG
+T:_AGMF
+
 N:Anguilla
 C:+1264
 T:AI
 
+# Source (2002-02-27):
+# http://www.itu.int/itudoc/itu-t/number/b/brb/71262.html
 N:Barbados
 C:+1246
 T:BB
 
+N:Barbados Mobilfunk
+E:Barbados cellphone
+C:+124623
+R:BB
+T:_BBMF
+
+# Source (2002-07-05):
+# http://www.itu.int/itudoc/itu-t/number/b/bhs/80946.html
 N:Bahamas
 C:+1242
 T:BS
 
+N:Bahamas Mobilfunk
+E:Bahamas cellphone
+C:+1242357, +1242359, +1242457, +1242557
+R:BS
+T:_BSMF
+
 N:USA toll free
 C:+1800, +1866*, +1877, +1888
-T:_USTF
+T:_USTF			# fixme: should by _USFF
 
 N:USA
 A:Vereinigte Staaten (USA), United States of America, United States of America & Canada
@@ -2228,3 +2994,271 @@
 A:North America
 C:+1
 T:US
+
+# from here till end of file: +1NPA number blocks inside the USA by state
+# including moved Alsaka and Hawaii entries:
+N:Alaska
+A:Alaska (USA state)
+C:+1907
+R:US
+T:ALAS		# fixme: should be _USAK
+
+N:Alabama (USA state)
+C:+1205, +1251, +1256, +1334
+R:US
+T:_USAL
+
+N:Arkansas (USA state)
+C:+1479, +1501, +1870
+R:US
+T:_USAR
+
+N:Arizona (USA state)
+C:+1480, +1520, +1602, +1623, +1928
+R:US
+T:_USAZ
+
+N:California (USA state)
+C:+1209, +1213, +1310, +1323, +1408, +1415, +1510, +1530, +1559, +1562
+C:+1619, +1626, +1650, +1661, +1707, +1714, +1760, +1805, +1818, +1831
+C:+1858, +1909, +1916, +1925, +1949
+R:US
+T:_USCA
+
+N:Colorado (USA state)
+C:+1303, +1719, +1720, +1970
+R:US
+T:_USCO
+
+N:Connecticut (USA state)
+C:+1203, +1860
+R:US
+T:_USCT
+
+N:Washington DC (USA state)
+C:+1202
+R:US
+T:_USDC
+
+N:Delaware (USA state)
+C:+1302
+R:US
+T:_USDE
+
+N:Florida (USA state)
+C:+1239, +1305, +1321, +1352, +1386, +1407, +1561, +1727, +1754, +1772
+C:+1786, +1813, +1850, +1863, +1904, +1941, +1954
+R:US
+T:_USFL
+
+N:Georgia (USA state)
+C:+1229, +1404, +1478, +1678, +1706, +1770, +1912
+R:US
+T:_USGA
+
+N:Hawaii
+A:Hawai, Hawaii-Inseln, Hawaii (USA state)
+C:+1808
+R:US
+T:_HAWA		# fixme: should be _USHI
+
+N:Iowa (USA state)
+C:+1319, +1515, +1563, +1641, +1712
+R:US
+T:_USIA
+
+N:Idaho (USA state)
+C:+1208
+R:US
+T:_USID
+
+N:Illinois (USA state)
+C:+1217, +1224, +1309, +1312, +1618, +1630, +1708, +1773, +1815, +1847
+R:US
+T:_USIL
+
+N:Indiana (USA state)
+C:+1219, +1260, +1317, +1574, +1765, +1812
+R:US
+T:_USIN
+
+N:Kansas (USA state)
+C:+1316, +1620, +1785, +1913
+R:US
+T:_USKS
+
+N:Kentucky (USA state)
+C:+1270, +1502, +1606, +1859
+R:US
+T:_USKY
+
+N:Louisiana (USA state)
+C:+1225, +1318, +1337, +1504, +1985
+R:US
+T:_USLA
+
+N:Massachusetts (USA state)
+C:+1339, +1351, +1413, +1508, +1617, +1774, +1781, +1857, +1978
+R:US
+T:_USMA
+
+N:Maryland (USA state)
+C:+1240, +1301, +1410, +1443
+R:US
+T:_USMD
+
+N:Maine (USA state)
+C:+1207
+R:US
+T:_USME
+
+N:Michigan (USA state)
+C:+1231, +1248, +1269, +1313, +1517, +1586, +1616, +1734, +1810, +1906
+C:+1989
+R:US
+T:_USMI
+
+N:Minnesota (USA state)
+C:+1218, +1320, +1507, +1612, +1651, +1763, +1952
+R:US
+T:_USMN
+
+N:Missouri (USA state)
+C:+1314, +1417, +1573, +1636, +1660, +1816
+R:US
+T:_USMO
+
+N:Mississippi (USA state)
+C:+1228, +1601, +1662
+R:US
+T:_USMS
+
+N:Montana (USA state)
+C:+1406
+R:US
+T:_USMT
+
+N:North Carolina (USA state)
+C:+1252, +1336, +1704, +1828, +1910, +1919, +1980
+R:US
+T:_USNC
+
+N:North Dakota (USA state)
+C:+1701
+R:US
+T:_USND
+
+N:Nebraska (USA state)
+C:+1308, +1402
+R:US
+T:_USNE
+
+N:New Hampshire (USA state)
+C:+1603
+R:US
+T:_USNH
+
+N:New Jersey (USA state)
+C:+1201, +1551, +1609, +1732, +1848, +1856, +1862, +1908, +1973
+R:US
+T:_USNJ
+
+N:New Mexico (USA state)
+C:+1505
+R:US
+T:_USNM
+
+N:Nevada (USA state)
+C:+1702, +1775
+R:US
+T:_USNV
+
+N:New York (USA state)
+C:+1212, +1315, +1347, +1516, +1518, +1585, +1607, +1631, +1646, +1716
+C:+1718, +1845, +1914, +1917
+R:US
+T:_USNY
+
+N:Ohio (USA state)
+C:+1216, +1234, +1330, +1419, +1440, +1513, +1567, +1614, +1740, +1937
+R:US
+T:_USOH
+
+N:Oklahoma (USA state)
+C:+1405, +1580, +1918
+R:US
+T:_USOK
+
+N:Oregon (USA state)
+C:+1503, +1541, +1971
+R:US
+T:_USOR
+
+N:Pennsylvania (USA state)
+C:+1215, +1267, +1412, +1484, +1570, +1610, +1717, +1724, +1814, +1878
+R:US
+T:_USPA
+
+N:Rhode Island (USA state)
+C:+1401
+R:US
+T:_USRI
+
+N:South Carolina (USA state)
+C:+1803, +1843, +1864
+R:US
+T:_USSC
+
+N:South Dakota (USA state)
+C:+1605
+R:US
+T:_USSD
+
+N:Tennessee (USA state)
+C:+1423, +1615, +1731, +1865, +1901, +1931
+R:US
+T:_USTN
+
+N:Texas (USA state)
+C:+1210, +1214, +1254, +1281, +1361, +1409, +1469, +1512, +1682, +1713
+C:+1806, +1817, +1830, +1832, +1903, +1915, +1936, +1940, +1956, +1972
+C:+1979
+C:+1325, +1432 	# since 2003-04-05
+C:+1430 	# since 2003-02-15
+R:US
+T:_USTX
+
+N:Utah (USA state)
+C:+1435, +1801
+R:US
+T:_USUT
+
+N:Virginia (USA state)
+C:+1276, +1434, +1540, +1571, +1703, +1757, +1804
+R:US
+T:_USVA
+
+N:Vermont (USA state)
+C:+1802
+R:US
+T:_USVT
+
+N:Washington (USA state)
+C:+1206, +1253, +1360, +1425, +1509
+R:US
+T:_USWA
+
+N:Wisconsin (USA state)
+C:+1262, +1414, +1608, +1715, +1920
+R:US
+T:_USWI
+
+N:West Virginia (USA state)
+C:+1304
+R:US
+T:_USWV
+
+N:Wyoming (USA state)
+C:+1307
+R:US
+T:_USWY
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/isdnconf/.cvsignore isdn4k-utils-v3.3/isdnlog/isdnconf/.cvsignore
--- isdn4k-utils-v3.2p1/isdnlog/isdnconf/.cvsignore	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/isdnconf/.cvsignore	2003-07-25 22:55:23.000000000 +0000
@@ -0,0 +1 @@
+isdnconf.1
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/isdnlog/.cvsignore isdn4k-utils-v3.3/isdnlog/isdnlog/.cvsignore
--- isdn4k-utils-v3.2p1/isdnlog/isdnlog/.cvsignore	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/isdnlog/.cvsignore	2003-07-25 22:55:23.000000000 +0000
@@ -0,0 +1,6 @@
+callerid.conf.5
+isdn.conf.5
+isdnformat.5
+isdnlog.5
+isdnlog.8
+isdnlog.users.5
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/isdnlog/isdnlog.8.in isdn4k-utils-v3.3/isdnlog/isdnlog/isdnlog.8.in
--- isdn4k-utils-v3.2p1/isdnlog/isdnlog/isdnlog.8.in	2002-04-01 18:06:09.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/isdnlog/isdnlog.8.in	2003-08-14 12:18:57.000000000 +0000
@@ -1,5 +1,5 @@
-.\" $Id: isdnlog.8.in,v 1.10 2002/03/11 16:13:38 paul Exp $
-.\" CHECKIN $Date: 2002/03/11 16:13:38 $
+.\" $Id: isdnlog.8.in,v 1.12 2003/08/14 12:18:57 tobiasb Exp $
+.\" CHECKIN $Date: 2003/08/14 12:18:57 $
 .TH isdnlog 8 "@MANDATE_ISDNLOG8@" "ISDN 4 Linux @I4LVERSION@" "Linux System Administration"
 .PD 0
 .SH NAME
@@ -94,7 +94,7 @@
 .B \-i\fIx\fB	internS0="value"
 Telefon number shorter then
 .I value
-are considered to be internal numbers one your PABX
+are considered to be internal numbers on your PABX.
 
 .TP
 .B \-o	other={yes|no}
@@ -111,11 +111,13 @@
 
 .TP
 .B \-U\fIx\fB	ignoreCOLP="value"
-Ignore COLP/CLIP frames when value is 1.
+Ignore COLP/CLIP frames when value is 1 or greater.
 Value 0 is default, and tells isdnlog to not ignore COLP/CLIP frames.
 .br
 Sometimes the COLP number is a number in a different areacode to the
 number that was dialled, and then the cost calculation would be wrong.
+.br
+With value 2 the ignored COLP number is displayed.
 
 .TP
 .B \-2\fIx\fB	dual="value"
@@ -124,6 +126,32 @@
 are doing. With \fIx\fR=2 you can increase the debug output - every single
 digit will be displayed.
 
+Some setups may require workarounds for reliable logging.  These workarounds
+are enabled by addition of the following numbers to the dual value.  They are
+intended for the dualmode but may also be useful without. 
+In this case, specify only the sum of the following numbers without
+1 or 2 for the dual mode. 
+
+.RS
+.TP
+0x100
+Enable this when the destination number of an outgoing call
+contains the number of the previous call, e.g. calling 222
+after calling 111 before results in 111222 for the second call.
+
+This may also help in situations where an unanswered incoming call
+causes incorrect logging of the following outgoing call.
+
+.TP
+0x200
+Enable this when outgoing calls are logged without a source number (own MSN).
+
+.TP
+0x400
+Enable this when unanswered incoming calls are logged multiple times
+(revealed by isdnrep -E).
+.RE
+
 .TP
 .B \-1
 A HFC-based card is used for echo mode. Enable echo mode for the HFC card with
@@ -379,7 +407,7 @@
 .B	providerchange="path_top_script"
 (There is no commandline option for this)
 This script is called with 3 parameters, the new provider number
-(fron rate-CC.dat) the number, which would be dialed, and the servicename.
+(from rate-CC.dat), the number, which would be dialed, and the servicename.
 The script should adjust routing, name resolution and so on to
 connect to the ISP.
 If the script returns non zero, LCR will not be done.
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/isdnlog/isdnlog.c isdn4k-utils-v3.3/isdnlog/isdnlog/isdnlog.c
--- isdn4k-utils-v3.2p1/isdnlog/isdnlog/isdnlog.c	2002-01-29 16:39:20.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/isdnlog/isdnlog.c	2003-07-25 22:18:03.000000000 +0000
@@ -1,4 +1,4 @@
-/* $Id: isdnlog.c,v 1.68 2001/10/15 19:51:48 akool Exp $
+/* $Id: isdnlog.c,v 1.69 2003/07/25 22:18:03 tobiasb Exp $
  *
  * ISDN accounting for isdn4linux. (log-module)
  *
@@ -19,6 +19,31 @@
  * along with this program; if not, write to the Free Software
  *
  * $Log: isdnlog.c,v $
+ * Revision 1.69  2003/07/25 22:18:03  tobiasb
+ * isdnlog-4.65:
+ *  - New values for isdnlog option -2x / dual=x with enable certain
+ *    workarounds for correct logging in dualmode in case of prior
+ *    errors.  See `man isdnlog' and isdnlog/processor.c for details.
+ *  - New isdnlog option -U2 / ignoreCOLP=2 for displaying ignored
+ *    COLP information.
+ *  - Improved handling of incomplete D-channel frames.
+ *  - Increased length of number aliases shown immediately by isdnlog.
+ *    Now 127 instead of 32 chars are possible. (Patch by Jochen Erwied.)
+ *  - The zone number for an outgoing call as defined in the rate-file
+ *    is written to the logfile again and used by isdnrep
+ *  - Improved zone summary of isdnrep.  Now the real zone numbers as
+ *    defined in the rate-file are shown.  The zone number is taken
+ *    from the logfile as mentioned before or computed from the current
+ *    rate-file.  Missmatches are indicated with the chars ~,+ and *,
+ *    isdnrep -v ... explains the meanings.
+ *  - Fixed provider summary of isdnrep. Calls should no longer be
+ *    treated wrongly as done via the default (preselected) provider.
+ *  - Fixed the -pmx command line option of isdnrep, where x is the xth
+ *    defined [MSN].
+ *  - `make install' restarts isdnlog after installing the data files.
+ *  - A new version number generates new binaries.
+ *  - `make clean' removes isdnlog/isdnlog/ilp.o when called with ILP=1.
+ *
  * Revision 1.68  2001/10/15 19:51:48  akool
  * isdnlog-4.53
  *  - verified Leo's correction of Paul's byte-order independent Patch to the CDB
@@ -771,6 +796,7 @@
   sprintf(mlabel, "%%s%s  %%s%%s", "%e.%b %T %I");
   amtsholung = NULL;
   dual = 0;
+  dualfix = 0;
   hfcdual = 0;
   hup3 = 240;
   abclcr = 0;
@@ -933,6 +959,8 @@
       	       	 break;
 
       case '2' : dual = strtol(optarg, NIL, 0);
+                 dualfix = dual & ~0xFF;
+                 dual &= 0xFF;
       	       	 break;
 
       case 'O' : outfile = strdup(optarg);
@@ -1169,8 +1197,11 @@
 				if (!strcmp(Ptr->name,CONF_ENT_WIDTH))
 					width = (int)strtol(Ptr->value, NIL, 0);
 				else
-				if (!strcmp(Ptr->name,CONF_ENT_DUAL))
+				if (!strcmp(Ptr->name,CONF_ENT_DUAL)) {
 					dual = (int)strtol(Ptr->value, NIL, 0);
+          dualfix = dual & ~0xFF;
+          dual &= 0xFF;
+        }
 				else
 				if (!strcmp(Ptr->name,CONF_ENT_AMT))
                                        amtsholung = strdup(Ptr->value);
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/isdnlog/mysqldb.c isdn4k-utils-v3.3/isdnlog/isdnlog/mysqldb.c
--- isdn4k-utils-v3.2p1/isdnlog/isdnlog/mysqldb.c	2000-05-11 10:55:16.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/isdnlog/mysqldb.c	2002-07-26 22:14:19.000000000 +0000
@@ -1,4 +1,4 @@
-/* $Id: mysqldb.c,v 1.2 2000/04/02 17:35:07 akool Exp $
+/* $Id: mysqldb.c,v 1.3 2002/07/26 22:14:19 akool Exp $
  *
  * Interface for mySQL-Database for isdn4linux. (db-module)
  *
@@ -20,6 +20,10 @@
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
  * $Log: mysqldb.c,v $
+ * Revision 1.3  2002/07/26 22:14:19  akool
+ * isdnlog-4.61:
+ *   - Support for mysql-4.0alpha -- many thanks to Jochen Erwied (jochen@erwied.de)!
+ *
  * Revision 1.2  2000/04/02 17:35:07  akool
  * isdnlog-4.18
  *  - isdnlog/isdnlog/isdnlog.8.in  ... documented hup3
@@ -88,6 +92,22 @@
 
   /* make a connection to the database daemon */
 
+#if MYSQL_VERSION_ID > 40000
+  if (!(mysql_init(&mysql)))
+    {
+      syslog( LOG_ERR, "%s", "Init of mySQL failed.");
+      syslog( LOG_ERR, "%s", mysql_error( &mysql ));
+      return -1;
+    }
+  if (!(mysql_real_connect(&mysql, mysql_db_Host, mysql_db_User,
+               mysql_db_Passwd, mysql_db_Name, 0, NULL, 0)))
+    {
+      syslog( LOG_ERR, "%s", "Connection to mySQL failed.");
+      syslog( LOG_ERR, "%s", mysql_error( &mysql ));
+      return -1;
+    }
+
+#else
   if (!(mysql_connect(&mysql, mysql_db_Host, mysql_db_User, mysql_db_Passwd)))
     {
       syslog( LOG_ERR, "%s", "Connection to mySQL failed.");
@@ -103,6 +123,7 @@
       syslog( LOG_ERR, "%s", mysql_error( &mysql ));
       return( -1);
     }
+#endif
 
   return( 0);
 }
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/isdnlog/processor.c isdn4k-utils-v3.3/isdnlog/isdnlog/processor.c
--- isdn4k-utils-v3.2p1/isdnlog/isdnlog/processor.c	2002-04-01 18:06:10.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/isdnlog/processor.c	2003-08-14 12:18:57.000000000 +0000
@@ -1,4 +1,4 @@
-/* $Id: processor.c,v 1.123 2002/03/11 16:18:43 paul Exp $
+/* $Id: processor.c,v 1.125 2003/08/14 12:18:57 tobiasb Exp $
  *
  * ISDN accounting for isdn4linux. (log-module)
  *
@@ -19,6 +19,37 @@
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
  * $Log: processor.c,v $
+ * Revision 1.125  2003/08/14 12:18:57  tobiasb
+ * Allow dualmode workaround 0x100 aka DUALFIX_DESTNUM to work also with
+ *   CALL_PROCEEDING messages for cleaning up unanswered incoming calls.
+ *   (http://lists.suse.com/archive/suse-isdn/2003-Aug/0026.html in German)
+ * Update for `Denmark cellphone' entry in destination database.
+ *
+ * Revision 1.124  2003/07/25 22:18:03  tobiasb
+ * isdnlog-4.65:
+ *  - New values for isdnlog option -2x / dual=x with enable certain
+ *    workarounds for correct logging in dualmode in case of prior
+ *    errors.  See `man isdnlog' and isdnlog/processor.c for details.
+ *  - New isdnlog option -U2 / ignoreCOLP=2 for displaying ignored
+ *    COLP information.
+ *  - Improved handling of incomplete D-channel frames.
+ *  - Increased length of number aliases shown immediately by isdnlog.
+ *    Now 127 instead of 32 chars are possible. (Patch by Jochen Erwied.)
+ *  - The zone number for an outgoing call as defined in the rate-file
+ *    is written to the logfile again and used by isdnrep
+ *  - Improved zone summary of isdnrep.  Now the real zone numbers as
+ *    defined in the rate-file are shown.  The zone number is taken
+ *    from the logfile as mentioned before or computed from the current
+ *    rate-file.  Missmatches are indicated with the chars ~,+ and *,
+ *    isdnrep -v ... explains the meanings.
+ *  - Fixed provider summary of isdnrep. Calls should no longer be
+ *    treated wrongly as done via the default (preselected) provider.
+ *  - Fixed the -pmx command line option of isdnrep, where x is the xth
+ *    defined [MSN].
+ *  - `make install' restarts isdnlog after installing the data files.
+ *  - A new version number generates new binaries.
+ *  - `make clean' removes isdnlog/isdnlog/ilp.o when called with ILP=1.
+ *
  * Revision 1.123  2002/03/11 16:18:43  paul
  * DM -> EUR; and only test for IIOCNETGPN on i386 systems
  *
@@ -1183,7 +1214,7 @@
 
 static int    HiSax = 0, hexSeen = 0, uid = UNKNOWN, lfd = 0;
 static char  *asnp, *asnm = NULL;
-static int    chanused[2] = { 0, 0 };
+static int    chanused[MAXCHAN] = { 0, 0 }; /* chan < MAXCHAN, not < 2  */
 static int    IIOCNETGPNavailable = -1; /* -1 = unknown, 0 = no, 1 = yes */
 
 #ifdef Q931
@@ -1899,6 +1930,13 @@
 
       l = strtol(p += 3, NIL, 16);
 
+      l1 = strlen(p+2); /* *(p+2) is ' ' before first digit of first contents byte */
+      if (l1 < 3*l) { /* not enouph input to for l bytes of element contents */
+	sprintf(s, "Not enough raw input from isdnctrl? for contents of element 0x%X: %d raw bytes (length=%d) needed but only %d raw bytes present --  ignoring this element!", element, 3*l, l, l1);
+        info(chan, PRT_SHOWNUMBERS, STATE_RING, s);
+        return;
+      }
+
       if (Q931dmp) {
         auto char s[BUFSIZ];
 
@@ -2396,8 +2434,13 @@
 
                     *pd = 0;
 
-                    if (ignoreCOLP && !Q931dmp) /* FIXME */
+                    if (ignoreCOLP && !Q931dmp) { /* FIXME */
+                      if (ignoreCOLP & 0x02) { /* show ignored info */
+                        sprintf(s1, "COLP %s -- ignored", s);
+                        info(chan, PRT_SHOWNUMBERS, STATE_RING, s1);
+                      }
                       break;
+                    }
 
                     if (!*s) {
                       info(chan, PRT_SHOWNUMBERS, STATE_RING, "COLP *INVALID* -- ignored!");
@@ -4098,6 +4141,13 @@
   else {
     call[chan].tarifknown = 1;
     call[chan].pay = call[chan].Rate.Charge;
+		if (call[chan].zone == UNKNOWN) {
+			if ( call[chan].Rate.z > 0 && call[chan].Rate.domestic
+		       && call[chan].sondernummer[CALLED] == UNKNOWN )
+				call[chan].zone = call[chan].Rate.z; /* store exact zone DE:[1234] */
+			else
+				call[chan].zone = call[chan].Rate.zone; /* store for logfile entry */
+		}	
   } /* else */
 } /* processRate */
 
@@ -4357,6 +4407,7 @@
   static   char        last[BUFSIZ];
   auto     int         isAVMB1 = 0;
   auto     double      tx;
+  auto     int         origchan = -1; /* sourcechan for RELEASE in chan 4 */
 
 
   hexSeen = 1;
@@ -4385,7 +4436,7 @@
   if (!memcmp(ps, "D2", 2)) { /* AVMB1 */
     if (firsttime) {
       firsttime = 0;
-      print_msg (PRT_NORMAL, "(AVM B1 driver detected (D2))");
+      print_msg (PRT_NORMAL, "(AVM B1 driver detected (D2))\n");
     } /* if */
     memcpy(ps, "HEX: ", 5);
   } /* if */
@@ -4393,7 +4444,7 @@
   if (!memcmp(ps, "DTRC:", 5)) { /* Eicon Driver */
     if (firsttime) {
       firsttime = 0;
-      print_msg (PRT_NORMAL, "(Eicon active driver detected)");
+      print_msg (PRT_NORMAL, "(Eicon active driver detected)\n");
     } /* if */
     memcpy(ps, "HEX: ", 5);
   } /* if */
@@ -4407,7 +4458,7 @@
       firsttime = 0;
 
       if (!Q931dmp)
-        print_msg(PRT_NORMAL, "(HiSax driver detected)");
+        print_msg(PRT_NORMAL, "(HiSax driver detected)\n");
 
       HiSax = 1;
       strcpy(last, s);
@@ -4687,10 +4738,38 @@
        innerhalb von SETUP/A_ACK aufgerufen werden muss, sonst
        aber erst nach feststellen von chan
        Daher GOTO (urgs...) an das Ende vom if hex:.. */
-
+    /* Tobias Becker, 2003-02-25:
+       Using dualmode and a HFC card, an outgoing call from an a/b adapter
+       (labelled `1&1', dating from 1996) produced the following messages
+       recognized by isdnlog:
+       (1) NET -> SETUP ACK.. with CHANNEL: BRI, B1 needed
+       (2) USR -> SETUP with BEARER, CHANNEL: any channel, and Calling
+                        party number
+       No further CHANNEL messages occur for this call.  Prior to (1)
+       there may be lost messages as isdnctrl0 states:
+       `03:09.16 Card1 empty_fifo hfcpci paket inv. len 2 or crc 255'
+       (1) is decoded in chan 5, sets channel=1 and triggers the move
+       from chan 5 to chan 0.
+       (2) is decoded in chan 5 (SETUP overrides chan 0 before) but
+       does not set channel, so the information in call[5] is not
+       moved to call[0].
+       Work-around: decode SETUP in chan 0/1 when cref match
+       This workaround requires the value of DUALFIX_SRCNUM in dualfix,
+       which is set with -2.. or dual=.. at command line or parameter file. 
+    */
     if (type == SETUP) { /* neuen Kanal, ev. dummy, wenn keiner da ist */
       chan = 5; /* den nehmen wir _nur_ dafuer! */
-      clearchan(chan, 1);
+      if (dualfix & DUALFIX_SRCNUM) {
+        for (i=0; i<2; i++) /* look for already allocated chan 0 or 1 */
+          if (cref>=0 && cref==call[i].cref && !dialin
+              && !call[i].dialin && call[i].tei==tei && call[i].channel==i+1) {
+	    chan = i;
+            print_msg(PRT_DEBUG_BUGS, " DEBUG> %s: Decoding SETUP in chan %d (cref=%d tei=%d)\n", st + 4, chan, cref, tei);
+	    break;
+	  }
+      }  
+      if (chan == 5) /* do not clear other chans */
+        clearchan(chan, 1);
       call[chan].dialin = dialin;
       call[chan].tei = tei;
       call[chan].card = card;
@@ -4702,7 +4781,10 @@
         LCR(chan, s);
 #endif
 
-      if (call[chan].channel) { /* Aha, Kanal war dabei, dann nehmen wir den gleich */
+      if (chan != 5 && call[chan].channel && call[chan].channel != chan+1)
+        print_msg(PRT_WARN, "Warning: SETUP assumed for channel B%d lead to channel B%d.\n", chan+1, call[chan].channel);
+	
+      if (chan == 5 && call[chan].channel) { /* Aha, Kanal war dabei, dann nehmen wir den gleich */
         chan = call[chan].channel - 1;
 
         if (chanused[chan])
@@ -4773,8 +4855,27 @@
 
         chan = call[chan].channel - 1;
 
-        if (!chanused[chan]) {
+        /* a previous unanswered incomming or outgoing call may have left
+         * chanused[chan] != 0  so that the old if (!chanused[chan]) does
+         * not the needed copy.
+         * Hopefully the second line does it right:
+         * - !call[chan].dialog && call[chan].dialin && call[chan].cause!=-1
+         *   turned out to be to restrictive,
+         * - !call[chan].dialog turned out to be to generally.
+         * - ... && type=SETUP_ACKNOWLEDGE is to restrictrive.  In case of
+         *   SETUP with complete called party number, the exchange responds
+         *   with C_PROC instead of S_ACK and C_PROC contains the B-channel. 
+         * This workaround requires the value of DUALFIX_DESTNUM in dualfix,
+         * which is set with -2.. or dual=.. at command line or parameter file. 
+         * |TB| 2003-08-14
+         */
+        if (!chanused[chan] || (dualfix & DUALFIX_DESTNUM &&
+            !call[chan].dialog && !call[5].dialin)) { 
           /* nicht --channel, channel muss unveraendert bleiben! */
+          if (chanused[chan]) { /* catch second line condition */
+            print_msg(PRT_DEBUG_BUGS, " DEBUG> %s: %s contained channel B%d which is marked as in use -- overwriting anyway.\n", st+4, (type==SETUP_ACKNOWLEDGE)?"S_ACK":"C_PROC", call[5].channel);
+            chanused[chan] = 0;
+          }
           memcpy((char *)&call[chan], (char *)&call[5], sizeof(CALL));
           Change_Channel(5, chan);
 	  addlist(chan, type, 1);
@@ -5030,10 +5131,19 @@
            CONNECT noch folgt, wird dafuer jetzt chan auf
            4 gepackt, um die schoenen Daten in 0/1/ev.4 nicht
            zu zerstoeren. Wir erkennen das an fehlender tei. */
-
+        /* The above strategy leaves chan 0/1 uncleared since it seems
+         * unknown whether this is the last RELEASE with an unanswered
+         * call or not. */
         if (call[chan].tei == BROADCAST) {
           memcpy((char *)&call[4], (char *)&call[chan], sizeof(CALL));
           Change_Channel(chan, 4);
+          /* The following proofed to be not clever, since chan 4 is also
+           * cleared later.  For a cleared status for the next call another
+           * idea is needed.
+            clearchan(chan, 1);
+            chanused[chan] = 0;
+           */
+          origchan = chan; /* save number of persistent channel */
           chan = 4;
 	  addlist(chan, type, 1);
           call[chan].tei = tei;
@@ -5092,8 +5202,24 @@
 	  } /* if */
 	} /* if */
 
-	if (!Q931dmp)
-	  logger(chan);
+	if (!Q931dmp) {
+          /* An unanswered incoming calls can cause multiple logfile-entries,
+           * because there is a RELEASE message for each 'ringing' terminal
+           * and this messages are decoded independly from each other using
+           * chan 4.  With DUALFIX_MULTLOG only the first entry should be
+           * written.  |TB| */
+	  if (dualfix & DUALFIX_MULTLOG
+              && chan==4 && !call[4].dialog && call[4].dialin
+              && origchan > -1 && call[4].cref==call[origchan].cref
+              && call[origchan].logcount)
+            print_msg(PRT_DEBUG_BUGS, " DEBUG> %s: No logfile-entry for cref=%d, tei=%d, origchan=%d -- unanswered incoming call already logged %d time(s).\n",
+              st+4, call[chan].cref, call[chan].tei, origchan,
+              call[origchan].logcount);
+          else {
+	    logger(chan);
+            call[origchan>-1?origchan:chan].logcount++; /* remember logentry */
+          }
+        }
 
 	chanused[chan] = 0;
 	addlist(chan, type, 2);
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/isdnrep/.cvsignore isdn4k-utils-v3.3/isdnlog/isdnrep/.cvsignore
--- isdn4k-utils-v3.2p1/isdnlog/isdnrep/.cvsignore	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/isdnrep/.cvsignore	2003-07-25 22:55:23.000000000 +0000
@@ -0,0 +1 @@
+isdnrep.1
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/isdnrep/isdnbill.c isdn4k-utils-v3.3/isdnlog/isdnrep/isdnbill.c
--- isdn4k-utils-v3.2p1/isdnlog/isdnrep/isdnbill.c	2002-04-01 18:06:10.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/isdnrep/isdnbill.c	2002-07-25 18:16:05.000000000 +0000
@@ -1,4 +1,4 @@
-/* $Id: isdnbill.c,v 1.18 2002/03/01 19:33:52 akool Exp $
+/* $Id: isdnbill.c,v 1.19 2002/07/25 18:16:05 akool Exp $
  *
  * ISDN accounting for isdn4linux. (Billing-module)
  *
@@ -297,19 +297,18 @@
   	  strich('-', 67);
         }
 
-        printf("%6s,%d %-12s %5d %s  %s %9.4f",
+        printf("%6s,%d %-12s %5d %s  %13s",
           msnsum[w][j][i].msn,
           j,
           msnsum[w][j][i].alias ? msnsum[w][j][i].alias : "",
           msnsum[w][j][i].ncalls,
           timestr(msnsum[w][j][i].duration),
-          c.currency,
-          msnsum[w][j][i].pay);
+	  printRate(msnsum[w][j][i].pay));
 
         if (msnsum[w][j][i].pay == msnsum[w][j][i].compute)
           printf("\n");
         else
-          printf("  %s %9.4f\n", c.currency, msnsum[w][j][i].compute);
+          printf("  %13s\n", printRate(msnsum[w][j][i].compute));
 
         ncalls   += msnsum[w][j][i].ncalls;
         duration += msnsum[w][j][i].duration;
@@ -336,16 +335,15 @@
   if (!firsttime) {
   strich('=', 67);
 
-  printf("                      %5d %s  %s %9.4f",
+  printf("                      %5d %s  %13s",
     ncalls,
     timestr(duration),
-    c.currency,
-    pay);
+    printRate(pay));
 
   if (pay == compute)
     printf("\n");
   else
-    printf("  %s %9.4f\n", c.currency, compute);
+    printf("  %13s\n", printRate(compute));
   } /* if */
 
   ncalls = 0;
@@ -375,13 +373,11 @@
 
       printf(":%-24s", getProvider(pnum2prefix(i, c.connect)));
 
-      printf("%5d %s  %s %9.4f  %s %9.4f %8d %5.1f%%\n",
+      printf("%5d %s  %13s  %13s %8d %5.1f%%\n",
         provsum[w][i].ncalls,
         timestr(provsum[w][i].duration),
-        c.currency,
-        provsum[w][i].pay,
-        c.currency,
-        provsum[w][i].compute,
+        printRate(provsum[w][i].pay),
+        printRate(provsum[w][i].compute),
         provsum[w][i].failed,
         100.0 * (provsum[w][i].ncalls - provsum[w][i].failed) / provsum[w][i].ncalls);
 
@@ -410,14 +406,12 @@
   if (!firsttime) {
   strich('=', 93);
 
-  printf("%*s%5d %s  %s %9.4f  %s %9.4f %8d %5.1f%%\n",
+  printf("%*s%5d %s  %13s  %13s %8d %5.1f%%\n",
     32, "",
     ncalls,
     timestr(duration),
-    c.currency,
-    pay,
-    c.currency,
-    compute,
+    printRate(pay),
+    printRate(compute),
     failed,
     100.0 * (ncalls - failed) / ncalls);
   } /* if */
@@ -461,16 +455,14 @@
         case 7 : printf("elsewhere       "); break;
       } /* switch */
 
-      printf("%5d %s  %s %9.4f  %s %9.4f",
+      printf("%5d %s  %13s  %13s",
         zonesum[w][i].ncalls,
         timestr(zonesum[w][i].duration),
-        c.currency,
-        zonesum[w][i].pay,
-        c.currency,
-        zonesum[w][i].compute);
+        printRate(zonesum[w][i].pay),
+        printRate(zonesum[w][i].compute));
 
       if (0 /* preselect == DTAG */)
-        printf("  %s %9.4f\n", c.currency, zonesum[w][i].aktiv);
+        printf("  %13s\n", printRate(zonesum[w][i].aktiv));
       else
         printf("\n");
 
@@ -499,17 +491,15 @@
   if (!firsttime) {
   strich('=', (0 /* preselect == DTAG */) ? 73 : 61);
 
-  printf("%*s%5d %s  %s %9.4f  %s %9.4f",
+  printf("%*s%5d %s  %13s  %13s",
     16, "",
     ncalls,
     timestr(duration),
-    c.currency,
-    pay,
-    c.currency,
-    compute);
+    printRate(pay),
+    printRate(compute));
 
   if (0 /* preselect == DTAG */)
-    printf("  %s %9.4f\n", c.currency, aktiv);
+    printf("  %13s\n", printRate(aktiv));
   else
     printf("\n");
 
@@ -606,14 +596,12 @@
               firsttime[k][0] = 1;
             } /* if */
 
-            printf("%-25s %5d   %s %9.4f %s   %s %9.4f\n",
+            printf("%-25s %5d   %12s %s   %12s\n",
               clip(onlynumbers ? partner[k][i].num : known[i]->who, 25),
               partner[k][i].ncalls,
-              c.currency,
-              partner[k][i].pay,
+              printRate(partner[k][i].pay),
               timestr(partner[k][i].duration),
-              c.currency,
-              partner[k][i].compute);
+              printRate(partner[k][i].compute));
           }
           else {
 
@@ -646,15 +634,13 @@
 
             p1 = msnsum[SUBTOTAL][unknown[k][i].si1][unknown[k][i].ihome].alias;
 
-            printf("%-16s <- %-12s %5d   %s %9.4f  %s   %s %9.4f\n",
+            printf("%-16s <- %-12s %5d   %12s  %s   %12s\n",
               p,
               clip(p1 ? p1 : "", 16),
               unknown[k][i].ncalls,
-              c.currency,
-              unknown[k][i].pay,
+              printRate(unknown[k][i].pay),
               timestr(unknown[k][i].duration),
-              c.currency,
-              unknown[k][i].compute);
+              printRate(unknown[k][i].compute));
           }
           else {
 
@@ -1218,7 +1204,7 @@
                 c.pay = c.pay * 100.0 / 116.0;
 
               if (c.pay)
-                printf("%s%9.4f%s ", c.currency, c.pay, c.computed ? "*" : " ");
+                printf("%12s%s ", printRate(c.pay), c.computed ? "*" : " ");
               else
                 printf("%*s", indent, "");
 
@@ -1226,7 +1212,7 @@
 
 #if 0
               if (c.aktiv)
-                printf(" AktivPlus - %s%9.4f", c.currency, c.pay - c.aktiv);
+                printf(" AktivPlus - %13s", printRate(c.pay - c.aktiv));
 #endif
 
               msnsum[SUBTOTAL][c.si1][c.ihome].pay += c.pay;
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/isdnrep/isdnrep.c isdn4k-utils-v3.3/isdnlog/isdnrep/isdnrep.c
--- isdn4k-utils-v3.2p1/isdnlog/isdnrep/isdnrep.c	2001-06-21 16:34:56.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/isdnrep/isdnrep.c	2003-07-25 22:18:03.000000000 +0000
@@ -1,4 +1,4 @@
-/* $Id: isdnrep.c,v 1.95 2001/03/21 10:24:01 paul Exp $
+/* $Id: isdnrep.c,v 1.96 2003/07/25 22:18:03 tobiasb Exp $
  *
  * ISDN accounting for isdn4linux. (Report-module)
  *
@@ -24,6 +24,31 @@
  *
  *
  * $Log: isdnrep.c,v $
+ * Revision 1.96  2003/07/25 22:18:03  tobiasb
+ * isdnlog-4.65:
+ *  - New values for isdnlog option -2x / dual=x with enable certain
+ *    workarounds for correct logging in dualmode in case of prior
+ *    errors.  See `man isdnlog' and isdnlog/processor.c for details.
+ *  - New isdnlog option -U2 / ignoreCOLP=2 for displaying ignored
+ *    COLP information.
+ *  - Improved handling of incomplete D-channel frames.
+ *  - Increased length of number aliases shown immediately by isdnlog.
+ *    Now 127 instead of 32 chars are possible. (Patch by Jochen Erwied.)
+ *  - The zone number for an outgoing call as defined in the rate-file
+ *    is written to the logfile again and used by isdnrep
+ *  - Improved zone summary of isdnrep.  Now the real zone numbers as
+ *    defined in the rate-file are shown.  The zone number is taken
+ *    from the logfile as mentioned before or computed from the current
+ *    rate-file.  Missmatches are indicated with the chars ~,+ and *,
+ *    isdnrep -v ... explains the meanings.
+ *  - Fixed provider summary of isdnrep. Calls should no longer be
+ *    treated wrongly as done via the default (preselected) provider.
+ *  - Fixed the -pmx command line option of isdnrep, where x is the xth
+ *    defined [MSN].
+ *  - `make install' restarts isdnlog after installing the data files.
+ *  - A new version number generates new binaries.
+ *  - `make clean' removes isdnlog/isdnlog/ilp.o when called with ILP=1.
+ *
  * Revision 1.95  2001/03/21 10:24:01  paul
  * Previous patch for correctly deleting entries messed up the printing
  * of a specific date (or range), now hopefully fixed. Please test!
@@ -194,6 +219,7 @@
 #define F_BODY_BOTTOM2  32
 #define F_COUNT_ONLY    64
 #define F_TEXT_LINE    128
+#define F_TABLE_LINE   256
 
 /*****************************************************************************/
 
@@ -216,7 +242,7 @@
 #define H_BODY_HEADER3 "<TH colspan=%d>%s</TH>\n"
 #define H_BODY_BOTTOM1 "<TD align=left colspan=%d>%s</TD>%s\n"
 #define H_BODY_BOTTOM2 "</TABLE><P>\n"
-
+#define H_TABLE_LINE   "<TR><TD align=left colspan=%d><TT>%s</TT></TD></TR>\n"
 #define H_LINE "<TR><TD colspan=%d><HR size=%d noshade width=100%%></TD></TR>\n"
 
 #define H_LEFT         "<TD align=left><TT>%s</TT></TD>"
@@ -241,6 +267,14 @@
 
 /*****************************************************************************/
 
+/* flags for zones_src.flags (FZN = flag zone name) */
+#define FZN_KNOWN   0x01  /* zone_names[i] is a valid zone name, not ?? */
+#define FZN_UNSURE  0x02  /* zone_names[i] may be incorrect */
+#define FZN_MPROV   0x04  /* zone i is used with more than one provider */
+#define FZN_MNAME   0x08  /* found different names for zone i */
+
+/*****************************************************************************/
+
 typedef struct {
 	int   type;
 	char *string;
@@ -257,6 +291,11 @@
 	char  *name;
 } file_list;
 
+typedef struct {
+	int flags;      /* see FZN_ constants */
+  int first_prov; /* for detection of FZN_MPROV */
+} zones_src_t;
+			
 /*****************************************************************************/
 
 static time_t get_month(char *String, int TimeStatus);
@@ -322,6 +361,8 @@
 static char *   zones_names[MAXZONES + 1];
 static double   zones_dm[MAXZONES + 1];
 static double   zones_dur[MAXZONES + 1];
+static zones_src_t
+                zones_src[MAXZONES +1];
 static char**   ShowMSN = NULL;
 static int*     colsize = NULL;
 static double   h_percent = 100.0;
@@ -592,6 +633,8 @@
   }
 
   memset(zones_usage, 0, sizeof(zones_usage));
+	memset(zones_names, 0, sizeof(zones_names));
+	memset(zones_src, 0, sizeof(zones_src)); /* start with zone names unknown */
 
   while (fgets(s, BUFSIZ, fi)) {
     strcpy(string,s);
@@ -809,6 +852,7 @@
 
 	if (!incomingonly)
 	{
+		int ztypes = 0;
 		h_percent = 60.0;
 		h_table_color = H_TABLE_COLOR3;
 		get_format("%-21.21s %4d call(s) %10.10s  %12s");
@@ -818,22 +862,46 @@
 		print_line2(F_BODY_HEADERL,"Outgoing calls ordered by Zone");
 		strich(1);
 
-                for (i = 0; i < MAXZONES /* + 1 */; i++)
-                  if (zones_usage[i]) {
-                    auto     char  s[BUFSIZ];
+		for (i = 0; i < MAXZONES /* + 1 */; i++)
+			if (zones_usage[i]) {
+				auto     char  s[BUFSIZ];
+				char zinfo=' ';
+				int *zflags=&(zones_src[i].flags);
 
-                    sprintf(s, "Zone %3d:%s", i, zones_names[i]);
+				if (*zflags & FZN_MNAME) {
+					zinfo = '*';
+					ztypes |= FZN_MNAME;
+				}	
+				else if (*zflags & FZN_MPROV) {
+					zinfo = '+';
+					ztypes |= FZN_MPROV;
+				}	
+				else if (*zflags & FZN_UNSURE) {
+					zinfo = '~';
+					ztypes |= FZN_UNSURE;
+				}	
 
-                    print_line3(NULL, s, zones_usage[i],
-                      double2clock(zones_dur[i]),
-                      print_currency(zones_dm[i], 0));
+				sprintf(s, "Zone %3d:%c%s", i, zinfo, zones_names[i]);
+
+				print_line3(NULL, s, zones_usage[i],
+				double2clock(zones_dur[i]),
+				print_currency(zones_dm[i], 0));
 			} /* if */
 
 #if DEBUG
-                if (zones_usage[UNKNOWNZONE])
-                  printf( "(%s)\n", unknownzones);
+		if (zones_usage[UNKNOWNZONE])
+			printf( "(%s)\n", unknownzones);
 #endif
 
+		if (verbose && ztypes) {	/* explain symbol in front of zone number */
+			if (ztypes & FZN_UNSURE)
+				print_line2(F_TABLE_LINE,"         ~ = Zone name not known for sure");
+			if (ztypes & FZN_MPROV)
+				print_line2(F_TABLE_LINE,"         + = Zone summed over several providers");
+			if (ztypes & FZN_MNAME)
+				print_line2(F_TABLE_LINE,"         * = Zone name differs with provider");
+		}
+
 		print_line2(F_BODY_BOTTOM2,"");
 
 		h_percent = 60.0;
@@ -873,7 +941,7 @@
 		strich(1);
 
 		for (k = 0; k <= mymsns; k++) {
-			if (msn_sum[k]) {
+			if (usage_sum[k]) { /* there have been calls with this MSN */
 
 				print_line3(NULL, ((k == mymsns) ? S_UNKNOWN : known[k]->who),
 				  usage_sum[k],
@@ -1026,6 +1094,9 @@
 		                     break;
 		case F_BODY_BOTTOM2: printf(H_BODY_BOTTOM2);
 		                     break;
+		case F_TABLE_LINE:   printf(H_TABLE_LINE, get_format_size(), html_conv(string));
+		                     break;
+
 		default            : printf("%s\n",string);
 		                     break;
 	}
@@ -2089,6 +2160,8 @@
 {
   RATE Rate;
   TELNUM srcnum, destnum;
+	int have_z;    /* Zone Rate.z from getZone valid or not */
+	int best_zone; /* =Rate.z if valid or =Rate.zone if Rate.z invalid */
 
   if (*cur_call->num[CALLING]) {
     normalizeNumber(cur_call->num[CALLING],&srcnum,TN_ALL);
@@ -2133,12 +2206,83 @@
     Rate.now = call[0].disconnect;
     Rate.prefix = cur_call->provider;
     if (!getRate(&Rate,0)) {
-      if(strcmp(cur_call->version, LOG_VERSION))
-         cur_call->pay = Rate.Charge; /* Fixme: is that ok, propably rates have changed */
-      cur_call->zone = Rate._zone;
-      zones_names[Rate._zone] = Rate.Zone ? strdup(Rate.Zone) : strdup("??");
-    }
-  }
+#if DEBUG
+			fprintf(stderr,"Rate.zone=%i Rate.z=%i Rate.domestic=%i call.[0]so..r[CALLED]=%i\n", Rate.zone, Rate.z, Rate.domestic, call[0].sondernummer[CALLED]);
+#endif
+			have_z = (Rate.domestic && !call[0].sondernummer[CALLED] && Rate.z>0);
+			best_zone = have_z ? Rate.z : Rate.zone;
+      if(strcmp(cur_call->version, LOG_VERSION)) {
+				/* LOG_VERSION is "3.2" since 1999-01-24 or isdnlog-3.33, earlier
+				 * calls are recalculated.  At least for Germany this makes nowadays
+				 * (2003-02) no sense, since rates _have_ changed and the Euro was
+				 * introduced on 2002-01-01. */	
+        cur_call->pay = Rate.Charge; /* Fixme: is that ok, propably rates have changed */
+	      cur_call->zone = (best_zone < MAXZONES) ? best_zone : UNKNOWN;
+			}
+			else {
+				/* A patched isdnlog-4.64 or later versions may have written the zone
+				 * in the last field of the log entry.  In this case, keep this zone.
+				 * isdnlog-3.32 and earlier did so too, but with an older LOG_VERSION
+				 * which triggered recalculation above.
+				 * As the zone summation is carried out over all providers, using
+				 * the zone number from the rate-file (Rate.zone) seems a little bit
+				 * closer to the desired result as the internal zone index (Rate._zone)
+				 */
+				if (cur_call->zone == UNKNOWN)
+					cur_call->zone = (best_zone < MAXZONES) ? best_zone : UNKNOWN;
+			}
+			/* Next difficulty: We need a zone name for the zone summation. These
+			 * names may differ between different providers.  Even with a recorded
+			 * zone from the logfile, we need a name.
+			 * As before duplicated strings (strdup) are not released 
+			 * TODO: Use the zone names from the preselected provider with
+			 * priority instead of the current use of the first `best' name. */
+			if (cur_call->zone != UNKNOWN) {	/* valid index for zones_-arrays */
+				int *zflags=&(zones_src[cur_call->zone].flags);
+
+				if ( cur_call->provider>0 && zones_src[cur_call->zone].first_prov>0
+				     && zones_src[cur_call->zone].first_prov != cur_call->provider)
+					*zflags |= FZN_MPROV; /* zone is used at different providers */ 
+
+				if (!zones_names[cur_call->zone]) { /* no zone name yet */
+					/* get a name in any circumstands */
+					if (Rate.Zone) {
+						zones_names[cur_call->zone] = strdup(Rate.Zone);
+						*zflags |= FZN_KNOWN;
+						if (Rate.zone!=cur_call->zone && !have_z && Rate.z!=cur_call->zone)
+							/* zone number from logfile does not match zone from rate file */
+							*zflags |= FZN_UNSURE;
+					}
+					else {
+						zones_names[cur_call->zone] = strdup("??"); /* old behaviour */
+					}
+					zones_src[cur_call->zone].first_prov = cur_call->provider;
+				}
+				else { /* got already a zone name */
+					if ( !(*zflags & FZN_KNOWN) && Rate.Zone ) {
+						/* get a name better than ?? */
+						zones_names[cur_call->zone] = strdup(Rate.Zone);
+						*zflags |= FZN_KNOWN;
+						if (Rate.zone!=cur_call->zone && !have_z && Rate.z!=cur_call->zone)
+							*zflags |= FZN_UNSURE;
+					}
+					else if ( *zflags & FZN_UNSURE && Rate.Zone &&
+					          ( Rate.zone==cur_call->zone ||
+                      (have_z && Rate.z==cur_call->zone) ) ) {
+						/* get a name without zone number difference between log and rate */
+						zones_names[cur_call->zone] = strdup(Rate.Zone);
+						zones_src[cur_call->zone].flags &= ~FZN_UNSURE;
+					}
+					else {
+						/* zone name not replaced */
+						if ( (*zflags & (FZN_KNOWN|FZN_UNSURE|FZN_MNAME|FZN_MPROV)) == (FZN_KNOWN|FZN_MPROV)
+								 && strcmp(zones_names[cur_call->zone], Rate.Zone) )
+							*zflags |= FZN_MNAME; /* diff. names at diff. providers */
+					} 
+				} /* if zone name first time */
+			} /* if valid zones_.. index */
+    } /* if getRate sucessful */
+  } /* if DIALOUT && duration > && num[CALLED] */
 } /* repair */
 
 /*****************************************************************************/
@@ -2246,10 +2390,14 @@
 			case  17: if (!adapt) {
 			      	    cur_call->provider = atoi(array[i]);
 									/* Korrektur der falschen Eintrage bis zum 16-Jan-99 */
-									if (cur_call->provider <= UNKNOWN || cur_call->provider >= MAXPROVIDER)
+									if (cur_call->provider <= UNKNOWN)
 										cur_call->provider = preselect;
 									/* -lt- provider-# may change during time */
 									cur_call->provider = pnum2prefix(cur_call->provider,cur_call->t);
+									/* provider from logfile unknown in ratefile or rateconf
+									 * --> default to preselected provider */
+									if (cur_call->provider == UNKNOWN)
+										cur_call->provider = pnum2prefix(preselect, cur_call->t);
 								} /* if */
 								break;
 
@@ -2286,6 +2434,11 @@
 
   }
 
+	/* repair() recalculates the connection cost for entries with LOG_VERSION
+   * older than the current and sets cur_call->zone for outgoing calls with
+   * recorded one of -1 (=UNKNWON).  The necessary information is taken from
+   * the current rate-file.
+   */
   repair(cur_call);
 
   return(rc);
@@ -2497,7 +2650,7 @@
 }
 
 /*****************************************************************************/
-
+/* called for -p ... command line options */ 
 int set_msnlist(char *String)
 {
   int Cnt;
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/isdnrep/rep_main.c isdn4k-utils-v3.3/isdnlog/isdnrep/rep_main.c
--- isdn4k-utils-v3.2p1/isdnlog/isdnrep/rep_main.c	2002-04-01 18:06:10.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/isdnrep/rep_main.c	2003-07-25 22:18:03.000000000 +0000
@@ -1,4 +1,4 @@
-/* $Id: rep_main.c,v 1.15 2002/03/11 16:17:11 paul Exp $
+/* $Id: rep_main.c,v 1.16 2003/07/25 22:18:03 tobiasb Exp $
  *
  * ISDN accounting for isdn4linux. (Report-module)
  *
@@ -20,6 +20,31 @@
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
  * $Log: rep_main.c,v $
+ * Revision 1.16  2003/07/25 22:18:03  tobiasb
+ * isdnlog-4.65:
+ *  - New values for isdnlog option -2x / dual=x with enable certain
+ *    workarounds for correct logging in dualmode in case of prior
+ *    errors.  See `man isdnlog' and isdnlog/processor.c for details.
+ *  - New isdnlog option -U2 / ignoreCOLP=2 for displaying ignored
+ *    COLP information.
+ *  - Improved handling of incomplete D-channel frames.
+ *  - Increased length of number aliases shown immediately by isdnlog.
+ *    Now 127 instead of 32 chars are possible. (Patch by Jochen Erwied.)
+ *  - The zone number for an outgoing call as defined in the rate-file
+ *    is written to the logfile again and used by isdnrep
+ *  - Improved zone summary of isdnrep.  Now the real zone numbers as
+ *    defined in the rate-file are shown.  The zone number is taken
+ *    from the logfile as mentioned before or computed from the current
+ *    rate-file.  Missmatches are indicated with the chars ~,+ and *,
+ *    isdnrep -v ... explains the meanings.
+ *  - Fixed provider summary of isdnrep. Calls should no longer be
+ *    treated wrongly as done via the default (preselected) provider.
+ *  - Fixed the -pmx command line option of isdnrep, where x is the xth
+ *    defined [MSN].
+ *  - `make install' restarts isdnlog after installing the data files.
+ *  - A new version number generates new binaries.
+ *  - `make clean' removes isdnlog/isdnlog/ilp.o when called with ILP=1.
+ *
  * Revision 1.15  2002/03/11 16:17:11  paul
  * DM -> EUR
  *
@@ -248,6 +273,7 @@
 	auto char *ptr         = NULL;
 	auto char *linefmt     = "";
 	auto char *htmlreq     = NULL;
+	auto char *phonenumberarg = NULL;
 
 
 	set_print_fct_for_tools(print_in_modules);
@@ -256,6 +282,14 @@
 	new_args(&argc,&argv);
 	*/
 
+	/* readconfig should be done before option parsing.  At least -pmx
+	 * needs access to known in set_msnlist.  Otherwise no selection of
+	 * configured MSNs via their index (x=1..) is possible.  By the other
+	 * hand this order can cause problems.  A corrupt config can block
+	 * the simple `isdnrep -V'.  Resolution: parse options first but call
+	 * set_msnlist after readconfig.
+	 */
+
   while ((c = getopt(argc, argv, options)) != EOF)
     switch (c) {
       case 'a' : timearea++;
@@ -298,7 +332,7 @@
       case 'f' : strcpy(fnbuff, optarg);
                  break;
 
-      case 'p' : if (!phonenumberonly) set_msnlist(optarg);
+      case 'p' : if (!phonenumberonly) phonenumberarg = strdup(optarg);
       	       	 phonenumberonly++;
       	       	 break;
 
@@ -337,6 +371,11 @@
   if (readconfig(myname) != 0)
   	return 1;
 
+	if (phonenumberonly && phonenumberarg != NULL) {
+		set_msnlist(phonenumberarg);
+		free(phonenumberarg);
+	}
+
   if (htmlreq)
   {
 		send_html_request(myname,htmlreq);
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/rate-de.dat isdn4k-utils-v3.3/isdnlog/rate-de.dat
--- isdn4k-utils-v3.2p1/isdnlog/rate-de.dat	2002-07-05 23:22:32.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/rate-de.dat	2003-08-07 21:08:50.000000000 +0000
@@ -1,14 +1,20 @@
-V:2.02 [29-Jun-2002 12:27:46]
+V:3.06 [07-Aug-2003 22:35:40]
 
 # Whrungsformat
-U:%.3f EUR
+#
+# ACHTUNG! Falls weiterhin in EURO angezeigt werden soll, bitte die folgende
+# 				 Zeile aktivieren:
+# U:%.3f EUR
+#
+# Neu: Anzeige in Cent. Hierzu ist isdnlog-4.61 oder besser erforderlich!
+U:^%.3f 
 
 # Diese Tariftabelle ist ein Service der I4L-Tarifdatenbank-Crew.
 # Alle Angaben erfolgen ohne Gewhr
 #
-# (C) Copyright 1999, 2001 by Andreas Kool (akool@isdn4linux.de)
+# (C) Copyright 1999, 2000, 2001, 2002 by Andreas Kool (akool@isdn4linux.de)
 #
-# $Id: rate-de.dat,v 1.121 2002/06/29 10:43:42 akool Exp $
+# $Id: rate-de.dat,v 1.127 2003/08/07 21:08:50 tobiasb Exp $
 #
 #
 # Das "A:" Tag mu folgendermaen gefllt werden:
@@ -23,11 +29,13 @@
 #
 # Zonenzuordnung fr Deutschland
 #
-# ! ! !  A C H T U N G  ! ! !
-#
-# Die Zonenzuordnung hat sich gendert !  Die alte Zuordnung befindet
-# sich zum Vergleich weiter unten.  Aktualisiert werden aber nur noch
-# die Zonen nach der nun folgenden, neuen Zuordnung !
+# Vorbemerkung (Stand Januar 2003): Zwingend erforderlich ist die richtige
+# Verwendung der Inlandszonen 1-3, da diese Zonen nicht wie alle anderen
+# Zonen mittels A:-Tags zugeordnet werden, sondern aufgrund der Verzonungs-
+# tabelle (zone-de-dtag.cdb).  Die folgende Beschreibung der brigen Zonen
+# mag veraltet sein.  Insbesondere die unmittelbar folgende Grobzuordnung ist
+# aber weiterhin gltig, solange keine zwingenden Hindernisse bestehen.
+# Weitere Informationen zum Aufbau dieser Datei liefert man rate-files.
 #
 #   0 -   9     : Inland
 #  10 -  30     : Handies (D-Netze, E-Netze)
@@ -125,50 +133,6 @@
 #
 #  ab 200    : Auslandstarife
 #
-# Hier nochmal die alte, nicht mehr untersttzte Zoneneinteilung.  nderungen
-# sollten an diesen Zonen nicht mehr vorgenommen werden.
-#
-#   0 : Verbindungen an der eigenen Tk-Anlage (zwangslufig kostenlos)
-#       sowie alle "FreeCall" (kostenlos) Nummern des jeweiligen Providers
-#   1 : Ortszone (alle Nummern, die ohne Vorwahl erreichbar sind.
-#                 Z.Zt. nur ber den preselected Provider erreichbar)
-#   2 : Cityzone (Nummern im Umkreis von max. 20 km)
-#   3 : Region 50 (Nummern im Umkreis von max. 50 km)
-#   4 : Fernzone (Deutschlandweit)
-#
-#   5 : C-Mobilbox
-#   6 : C-Netz
-#   7 : D1-Netz
-#   8 : D2-Netz
-#   9 : E-plus-Netz
-#  10 : E2-Netz
-#
-#  21 : Auskunft Inland
-#  22 : Auskunft Ausland
-#
-#  20 : Internet
-#
-#  11 : Euro City
-#  12 : Euro 1
-#  13 : Euro 2
-#  14 : Welt 1
-#  15 : Welt 2
-#  16 : Welt 3
-#  17 : Welt 4
-#
-# Die DTAG-Zonen
-#  Vis-a-vis 1
-#  Vis-a-vis 2
-#  Vis-a-vis 3
-#  Konferenzzuschlag
-#  T-Net-Box
-#  Interntarif Draht-Funk
-#  Interntarif Funk-Draht
-#  Interntarif Funk-Funk
-#  Interntarif Draht-Draht
-#  D1Ext
-# werden z.Zt. nicht untersttzt
-#
 #####################################################################
 #
 #
@@ -190,6 +154,8 @@
 S:CompuServe PPP Access
 N:0191919  # 010880191919
 #
+# Folgende Liste ist nicht auf einem aktuellen Stand, die Verbindungspreise
+# sind bei den jeweiligen Anbietern (010xy) meistens nicht angegeben.
 S:Internet by call
 N:0191501   # o.tel.o Online                           # 010110191501   (User:otelo; pw:online)
 N:019160    # CompuServeOffice			       # 019160
@@ -199,6 +165,9 @@
 N:0192070   # Arcor Internet-by-Call                   # 010700192070   (User:arcor; pw:internet)
 N:0192134   # Drillisch online Standard                # 0100500192134  (User:Drillisch@internet; pw:beliebig)
 N:0192300   # surf callino                             # 010750192300   (User:callino; pw:internet)
+N:019231760 # freenet.de AG Super CbC                  # 01019019231760 (user:beliebig; pw: beliebig)
+N:019231770 # freenet.de AG Internet-by-call           # 01019019231770 (user:beliebig; pw: beliebig)
+N:019231780 # freenet.de AG Sorglos                    # 01019019231780 (user:beliebig; pw: beliebig)
 N:0192340   # net@home (GTS Esprit) Call by Call 01040 # 010400192340   (User:esprit; pw:telecom oder User:gts; pw:internet)
 N:0192343   # Call.POP/Imagecom (GTS Esprit)           # 010400192343   (User:call; pw:pop)
 N:0192361   # Lbecker Nachrichten LN-Online           # 010880192361   (User:LN; pw:online)
@@ -214,111 +183,19 @@
 N:01928150  # Corax Coraxline                          # 0101901928150  (User:beliebig; pw:beliebig)
 N:019282200 # X9MEDIA Internet by Call                 # 01019019282200 (User:beliebig; pw:beliebig)
 N:019282500 # surflos Internet by Call                 # 01019019282500 (User:beliebig; pw:beliebig)
-N:01929     # 01019Freenet (Mobilcom)                  # 0101901929     (User:beliebig; pw:beliebig)
+N:01929     # freenet.de AG Standard                   # 0101901929     (User:beliebig; pw:beliebig)
 N:0193094100# clara.net Internet by Call               # 010880193094100(User:claranet; pw:claranet)
-#
-# S:T-VoteCall
-# N:01371, 01372, 01373, 01374, 0138
-#
-# S:Cityruf
-# N:01640, 01641, 01642, 01643, 01644, 01645, 01646, 01647, 01648, 01649
-# N:01682, 01683, 01684, 01685, 01686, 01687, 01688, 01689, 01690, 01691
-# N:016951, 016952
-#
-# S:Quix
-# N:016500, 016501, 016502, 016503, 016504, 016505, 016506, 016507
-# N:016508, 01651, 01653, 01654, 01655, 01656, 016591, 016592, 016593
-#
-# S:TeLMI
-# N:01660, 01661, 01665, 01669
-#
-# S:Scall
-# N:01680, 01681, 01696, 01699
-#
-# S:Skyper
-# N:01692, 01693, 016953
-#
-# S:C-Netz
-# N:01610*, 01611*, 01612*, 01613*, 01614*, 01615*, 01616*, 01617*, 01619*
-#
-# S:T-C-Tel Voice Mail
-# N:01618*
-#
-# S:D1
-# N:0170*, 0171*, 0175*
-#
-# S:D2
-# N:0172*, 0173*, 0174*
-#
-# S:Eplus
-# N:0177*, 0178*
-#
-# S:E2
-# N:0176*, 0179*
-#
-# S:Shared Cost Service 01801
-# N:01801*
-#
-# S:Shared Cost Service 01802
-# N:01802*
-#
-# S:Shared Cost Service 01803
-# N:01803*
-#
-# S:Shared Cost Service 01804
-# N:01804*
-#
-# S:Shared Cost Service 01805
-# N:01805*
-#
-# S:Service 01901
-# N:01901*
-#
-# S:Service 01902
-# N:01902*
-#
-# S:Service 01903
-# N:01903*
-#
-# S:Service 01904
-# N:01904*
-#
-# S:Service 01905
-# N:01905*
-#
-# S:Service 01906
-# N:01906*
-#
-# S:Service 01907
-# N:01907*
-#
-# S:Service 01908
-# N:01908*
-#
-# S:Service 01909
-# N:01909*
-#
-# S:Expo 2000 Hotline
-# N:02000
-#
-# S:Persnliche Rufnummer
-# N:0700*
-#
-# S:freecall
-# N:0130*, 0800*
-#
-# S:Polizei / Notruf
-# N:110
-#
-# S:Feuerwehr / Rettungsleitstelle
-# N:112
-#
+
+# mag mit weiter unten folgenden N:118* kollidieren
 S:Auskunft
 N:11811 # DTV
 N:11818 # Debitel
+N:11819 # Freenet
 N:11822 # GTS
 N:11833 # DTAG Inland
 N:11834 # DTAG Ausland
+N:11836 # DTAG Inland trkisch
+N:11837 # DTAG Inland englisch
 N:11850 # Talkline
 N:11870 # Mannesmann Arcor
 N:11871 # Mannesmann Arcor
@@ -327,9 +204,10 @@
 #
 S:Weckruf
 N:0190600000 # Virtual Interactive Phone GmbH, VIP Wecker (0,81 Pf/min)
-#########################################################################
+
+#####################################################################
 # Der Nummernraum fr das ffentliche Telefonnetz/ISDN in Deutschland
-# Stand: 30.08.1999
+# Stand: 30.08.1999, teilweise aktualisiert bis 01.01.2003
 #
 # S:nationale Verkehrsausscheidungsziffer
 # N:0*
@@ -361,8 +239,8 @@
 S:Innovative Dienste
 N:012*
 
-S:Freephone # (auslaufend)
-N:0130*
+#S:Freephone # (auslaufend)
+#N:0130*
 
 S:Zugnge zu Datennetzen der DTAG # (auslaufend)
 N:013111*, 013115*, 013119*
@@ -382,9 +260,6 @@
 S:Cityruf # (TMobil)
 N:0164*
 
-S:Quix # (Miniruf GmbH)
-N:0165*
-
 S:Telmi # (Deutsche Funkruf GmbH)
 N:0166*
 
@@ -394,6 +269,8 @@
 S:Cityruf, Scall, Skyper # (TMobil)
 N:0169*
 
+# Mobilfunknummer sind international erreichbar, kein rein nationaler Service.
+
 # S:D1 # (TMobil)
 # N:0170*, 0171*, 0175*
 
@@ -419,10 +296,16 @@
 N:0182*
 
 S:Premium Rate # (Planung: Verlagerung nach 0900; danach: Reserve)
-N:0190*
+N:01901*, 01902*, 01903*, 01904*, 01905*, 01906*, 01907*, 01908*, 01909*
+# 01900-xx(x) wird de facto zur Auswahl eines Call by Call Anbieters genutzt
+# und kann daher analog 010* nicht als Sonderrufnummer definiert sein.
+# N:01900*
 
 S:Online-Dienste # (019xz, 019yzzz mit x = 1 ... 3, y = 1 ... 4 und z = 0 ... 9) (Planung: Verlagerung nach 0905; danach: Reserve)
-N:019*
+N:0191*
+N:0192*
+N:0193*
+N:0194*
 
 S:Zugnge zu Datennetzen der DTAG # (auslaufend)
 N:0195*, 0197*
@@ -442,8 +325,12 @@
 S:Freephone
 N:0800*, 0801*
 
-S:frei # (Nutzung fr Premium Rate-Dienste ist in Vorbereitung)
-N:0900*
+S:Premium Rate - Information
+N:09001*
+S:Premium Rate - Unterhaltung
+N:09003*
+S:Premium Rate - Sonstiges (Erotik)
+N:09005*
 
 S:frei # (Planung: "Mabez"-Dienste)
 N:0902*
@@ -465,60 +352,28 @@
 
 S:netzinterne Nutzung
 N:011*
-#####################################################################
-#
-# Aktuelle (24-Jun-00  18:13) Preise fr Sonderrufnummern:
-# 0700:    tagsber 24 Pf/Min
-#          abends   12 Pf/Min
-#
-# 0800:    immer kostenfrei
-# 0130:
-#
-# 0180-1:  zum Ortstarif erreichbar
-# 0180-2:  einmalig 12 Pfennig egal wie lange der Anruf dauert
-# 0180-3:  18 Pf/Min
-# 0180-4:  einmalig 48 Pfennig egal wie lange der Anruf dauert
-# 0180-5:  24 Pf/Min
-# 0190-4/6:      81 Pf/Min
-# 0190-1/2/3/5:  121 Pf/Min
-# 0190-7/9:      242 Pf/Min
-# 0190-8:        363 Pf/Min
-#
-#####################################################################
-#
-#
-P:112,0 010012 Telecom GmbH
-B:010012
-C:Address:Postfach 200743, 40104 Dsseldorf
-C:Name:010012 Telecom GmbH
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
-C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-C:Euro
-D:dtag
-Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
-T:*/*=0
-Z:2-4 National
-A:+49
-T:*/09-18=0.06/60 Tagtarif
-T:*/18-09=0.04/60 Nachttarif
-Z:10 Mobilfunknetz D1/D2
-A:_DEMD1
-A:_DEMD2
-T:*/*=0.26/60
-Z:11 Mobilfunknetz E
-A:_DEME1
-A:_DEME2
-A:_DEMQ
-T:*/*=0.29/60
+
+# Zuordnung der Auskunftdienste zu den jeweiligen Provider, diese
+# Zuordnung gilt unabhngig der Wahl einer VBN.  Bis auf weiteres
+# werden die Auskunftsdienste beim Telefonie-Angebot des jeweiligen
+# Providers angegeben, beginnend mit Zone 40.
+# Auskunftsdienste
+
+X: 11833=33, 11834=33, 11836=33, 11837=33 	# Dt. Telekom
+X: 11880=80, 11887=80, 11890=80 	# Telegate
+X: 11819=19 	# Freenet
+
+# Zuordnung von offenen Internetzugngen zu den jeweiligen Telefonanbietern,
+# da 019[1-3]* unabhngig einer vorangestellten VBN zum selben
+# Anbieter fhrt und bei diesen Rufnummern eine VBN nicht notwendig ist.
+# Bei Irrtum bitte Nachricht an rates4linux-users@lists.sourceforge.net .
+
+X: 0191011=33 	# T-Online -> Dt. Telekom
+X: 019231760=19, 019231770=19, 019231780=19, 01929=19 	# Freenet -> 01019
+
 #####################################################################
 #
 #
-# NEU
 P:11,0 o.tel.o CbC
 B:01011
 # G:21-Nov-2001
@@ -527,132 +382,78 @@
 C:Address:Mannesmann Zwlfte Verwaltungsgesellschaft mbH, Mannesmannufer 2, 40213 Dsseldorf
 C:Homepage:http://www.o-tel-o.de
 C:Hotline:01803/1998 oder 0800/7370 (Geschaeftskunden)
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-C:Erfasste Zonen:
-C:0, 2	-   4	Deutschland
-C:10	-  11	Mobilfunk
-C:45		Auskunft o.tel.o
-C:102		o.tel.o online
-Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
-A:_F800
-T:*/*=0
-Z:2-4 Inlandsverbindungen
-A:DE
-T:W/07-18=0.092/60
-T:W/18-20=0.031/60
-T:W/20-07=0.019/60
-T:E,H/*=0.019/60
-Z:11 D1 Netz
-A:_DEMD1
-T:*/*=0.245/60
-Z:12 D2 Netz
-A:_DEMD2
-T:W/07-18=0.245/60 Hauptzeit
-T:W/18-07=0.235/60 Nebenzeit
-T:E,H/*=0.235/60 Freizeit
-Z:14 E-Plus Netz
-A:_DEME1
-T:*/*=0.276/60
-Z:15 E2 Netz
-A:_DEME2
-T:*/*=0.291/60
+C:Es gelten die Arcor CbC Tarife.
+R:70,0;0-
 #####################################################################
 #
 #
 P:13,0 Tele2 Privat CbC
 B:01013
-C:Name:Tele2 CbC
+C:Name:Tele2 Privat CbC
 C:Address:Telecommunications Services GmbH, Postfach 130840, 40558 Dsseldorf
 C:Homepage:http://www.tele2.de
 C:Telefon:01805-01013-1
 C:Hotline:0800/24-01013
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Quelle:Preisliste 22 ab 2003-07-09
+C:TarifURL:http://www.tele2.de/ger/pdf/T_Privat.pdf
+C:TarifURL:http://www.tele2.de/chap02/c020101.html
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Euro
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
 C:Erfasste Zonen:
-C:2	-   4	Deutschland
-C:10		Mobilfunk
-C:200	- 205	Ausland
-# G:07-May-2001
+C:  1 -   4  Deutschland
+C: 10 -  11  Mobilfunk
+C:200 - 201  International 1
+C:restliches Ausland identisch mit Tele2 Preselection
+# G:09-Jul-2003
 D:dtag
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
-Z:2-4 National
+Z:1 National-Ort
+T:W/07-19=0.0309/60
+T:W/19-07=0.0099/60 Einfhrungspreis bis mind. 31.08.2003
+T:E,H/*=0.0099/60 Einfhrungspreis bis mind. 31.08.2003
+Z:2-4 National-Fern
 A:+49
-T:W/07-19=0.02/0,0.04/60
-T:W/19-07=0.02/0,0.02/60
-T:E,H/*=0.02/0,0.02/60
-Z:10 Mobilfunknetz
-A:_DEMF
-T:*/*=0.04/0,0.23/60
+T:W/07-19=0.046/60
+T:W/19-07=0.0165/60
+T:E,H/*=0.0185/60
 #
-Z:200 Mobilfunk Euro
-# tobiasb/2002-04-19: Mobilfunk auskommentiert,
-# wenn nicht in country[-de].dat vom 22-Nov-2001.
-#A:Alaska Mobilfunk, Andorra Mobilfunk
-A:_BEMF,_DKMF
-#A:Frer Inseln Mobilfunk
-A:_FIMF,_FRMF
-A:_UKMF
+Z:10 Mobil D-Netze
+A:_DEMD1
+A:_DEMD2
+T:*/*=0.2199/60
+Z:11 Mobil E-Netze
+A:_DEME1
+A:_DEME2
+T:*/*=0.2499/60
+#
+Z:200 Int. 1
+A:ALAS,BE,DK,FI,FR,UK
+A:_HAWA,IE,IT,CA,LI,LU
+A:NL,NO,AT,PT,SM,SE
+A:CH,ES,US,VA
+T:*/*=0.045/60
+Z:201 Int. 1 Mobil
+#A:Alaska Mobilfunk
+A:_BEMF,_DKMF,_FIMF
+A:_FRMF,_UKMF
 #A:Hawaii Mobilfunk
-A:_IEMF,_ISMF
-A:_ITMF,_CAMF
-#A:Liechtenstein Mobilfunk
-A:_LUMF
-A:_MCMF,_NLMF,_NOMF,_ATMF
-A:_PTMF,_PRMF
+A:_IEMF,_ITMF,_CAMF
+A:_LIMF,_LUMF,_NLMF
+A:_NOMF,_ATMF,_PTMF
 #A:San Marino Mobilfunk
-A:_SEMF
-A:_CHMF,_ESMF
-#A:USA Mobilfunk, Vatikanstadt Mobilfunk
-A:_GRMF
-#A:Jugoslawien Mobilfunk
-A:_PLMF
-A:_RUMF,_CZMF
-A:_TRMF,_HUMF
-T:*/*=0.04/0,0.23/60
-Z:201 Euro 1
-A:_ALAS,AD,BE,DK
-A:FO,FI,FR
-A:UK,_HAWA,IE,IS
-A:IT,CA,LI,LU
-A:MC,NL,NO,AT
-A:PT,PR,SM,SE
-A:CH,ES,US,VA
-T:*/*=0.04/0,0.04/60
-Z:202 Euro 2
-A:GR,YU,PL
-A:SU,CZ
-A:TR,HU
-T:*/*=0.04/0,0.20/60
-Z:203 Ozeanien
-A:AU,CN,HK
-A:JP,NZ,SG
-A:TW
-T:*/*=0.04/0,0.30/60
-Z:204 Welt 1
-A:AL,DZ,BA
-A:BG,EE,GI
-A:IL,HR,LV,LY
-A:LT,MT,EH,MK
-A:MD,RO,SK,SI
-A:TN,UA,BY,CY
-T:*/*=0.04/0,0.46/60
-Z:205 Welt 2
-A:+
-C:Welt 2 gilt nicht fr Inmarsat.
-T:*/*=0.04/0,1/60
+A:_SEMF,_CHMF,_ESMF
+#A:USA Mobilfunk, Vatikanstaat Mobilfunk
+T:*/*=0.295/60
+R:13,1;210-
 #####################################################################
 P:13,1 Tele2 Privat Preselection
 B:01013
@@ -661,737 +462,464 @@
 C:Homepage:http://www.tele2.de
 C:Telefon:01805-01013-1
 C:Hotline:0800/24-01013
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Quelle:Preisliste 22 ab 2003-07-09
+C:TarifURL:http://www.tele2.de/ger/pdf/T_Privat.pdf
+C:TarifURL:http://www.tele2.de/chap02/c020201b.html
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Euro
 C:Erfasste Zonen:
-C:2	-   4	Deutschland
-C:10		Mobilfunk
-C:200	- 205	Ausland
-# G:15-Jun-2000
+C:  2 -   4  Deutschland
+C: 10 -  11  Mobilfunk
+C:200 - 201  International 1
+C:210 - 223  restliches Ausland
+# Zonen 200- werden in 273,0 Tele 2 Ortstarif genutzt
+# Zonen 210- werden in 13,0 Tele 2 Privat CbC genutzt (oben)
+# G:09-Jul-2003
 D:dtag
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
+Z:1 National-Ort
+T:W/07-19=0.0309/60
+T:W/19-07=0.0099/60 Einfhrungspreis bis mind. 31.08.2003
+T:E,H/*=0.0099/60 Einfhrungspreis bis mind. 31.08.2003
 Z:2-4 National
 A:+49
-T:W/07-19=0.02/0,0.04(60)/1
-T:W/19-07=0.02/0,0.02(60)/1
-T:E,H/*=0.02/0,0.02(60)/1
-Z:10 Mobilfunknetz
-A:_DEMF
-T:*/*=0.04/0,0.23(60)/1
+T:W/07-19=0.045/60
+T:W/19-07=0.0165/60
+T:E,H/*=0.0175/60
 #
-Z:200 Mobilfunk Euro
-# tobiasb/2002-04-19: Mobilfunk auskommentiert,
-# wenn nicht in country[-de].dat vom 22-Nov-2001.
-#A:Alaska Mobilfunk, Andorra Mobilfunk
-A:_BEMF,_DKMF
-#A:Frer Inseln Mobilfunk
-A:_FIMF,_FRMF
-A:_UKMF
+Z:10 Mobil D-Netze
+A:_DEMD1
+A:_DEMD2
+T:*/*=0.1999/60
+Z:11 Mobil E-Netze
+A:_DEME1
+A:_DEME2
+T:*/*=0.2199/60
+#
+Z:200 Int. 1
+A:ALAS,BE,DK,FI,FR,UK
+A:_HAWA,IE,IT,CA,LI,LU
+A:NL,NO,AT,PT,SM,SE
+A:CH,ES,US,VA
+T:*/*=0.04/60
+Z:201 Int. 1 Mobil
+#A:Alaska Mobilfunk
+A:_BEMF,_DKMF,_FIMF
+A:_FRMF,_UKMF
 #A:Hawaii Mobilfunk
-A:_IEMF,_ISMF
-A:_ITMF,_CAMF
-#A:Liechtenstein Mobilfunk
-A:_LUMF
-A:_MCMF,_NLMF,_NOMF,_ATMF
-A:_PTMF,_PRMF
+A:_IEMF,_ITMF,_CAMF
+A:_LIMF,_LUMF,_NLMF
+A:_NOMF,_ATMF,_PTMF
 #A:San Marino Mobilfunk
-A:_SEMF
-A:_CHMF,_ESMF
-#A:USA Mobilfunk, Vatikanstadt Mobilfunk
+A:_SEMF,_CHMF,_ESMF
+#A:USA Mobilfunk, Vatikanstaat Mobilfunk
+T:*/*=0.29/60
+Z:210 Int. 2
+A:AD,FO,GI,IS,MT,MC,PR
+T:*/*=0.10/60
+Z:211 Int. 2 Mobil
+A:_ADMF,_FOMF
+#A:Gibraltar Mobilfunk
+A:_ISMF,_MTMF
+#A:Monaco Mobilfunk
+A:_PRMF
+T:*/*=0.32/60
+Z:212 Int. 3
+A:TR
+T:*/*=0.174/60
+Z:213 Int.3 Mobil
+A:_TRMF
+T:*/*=0.394/60
+Z:214 Int. 4
+A:GR,YU,HR,PL,SU,SK
+A:SI,CZ,HU,CY
+T:*/*=0.19/60
+Z:215 Int. 4 Mobil
 A:_GRMF
 #A:Jugoslawien Mobilfunk
-A:_PLMF
-A:_RUMF,_CZMF
-A:_TRMF,_HUMF
-T:*/*=0.04/0,0.23(60)/1
-Z:201 Euro 1
-A:_ALAS,AD,BE,DK
-A:FO,FI,FR
-A:UK,_HAWA,IE,IS
-A:IT,CA,LI,LU
-A:MC,NL,NO,AT
-A:PT,PR,SM,SE
-A:CH,ES,US,VA
-T:*/*=0.04/0,0.04(60)/1
-Z:202 Euro 2
-A:GR,YU,PL
-A:SU,CZ
-A:TR,HU
-T:*/*=0.04/0,0.20(60)/1
-Z:203 Ozeanien
-A:AU,CN,HK
-A:JP,NZ,SG
+A:_HRMF,_PLMF,_RUMF,_SKMF
+A:_SIMF,_CZMF
+A:_HUMF,_CYMF
+T:*/*=0.41/60
+Z:216 Int. 5
+A:AL,BA,BG,IL,LV,MK,PS
+A:RO,UA,BY
+T:*/*=0.30/60
+Z:217 Int. 5 Mobil
+#A:Albanien Mobilfunk
+A:_BAMF
+#A:Bulgarien Mobilfunk
+A:_ILMF
+#A:Lettland Mobilfunk
+A:_MKMF
+#A:Palstina Mobilfunk,
+A:_ROMF,_UAMF
+#A:Weirussland Mobilfunk
+T:*/*=0.52/60
+Z:218 Int. 6
+A:EG,DZ,EE,JO,KZ,LB,LY
+A:LT,MA,MD,SY,TN
+T:*/*=0.45/60
+Z:219 Int. 6 Mobil
+A:_EGMF,_DZMF,_EEMF
+A:_JOMF
+#A:Kasachstan Mobilfunk
+A:_LBMF
+#A:Libyen Mobilfunk
+A:_LTMF,_MAMF
+#A:Moldawien Mobilfunk, Syrien Mobilfunk
+A:_TNMF
+T:*/*=0.67/60
+Z:220 Int. 7
+A:AU,BR,CN,HK,JP,NZ,SG,KR
 A:TW
-T:*/*=0.04/0,0.30(60)/1
-Z:204 Welt 1
-A:AL,DZ,BA
-A:BG,EE,GI
-A:IL,HR,LV,LY
-A:LT,MT,EH,MK
-A:MD,RO,SK,SI
-A:TN,UA,BY,CY
-T:*/*=0.04/0,0.46(60)/1
-Z:205 Welt 2
+T:*/*=0.65/60
+Z:221 Int. 7 Mobil
+A:_AUMF,_BRMF,_CNMF,_HKMF
+A:_JPMF,_NZMF,_SGMF,_KRMF
+A:_TWMF
+T:*/*=0.87/60
+Z:222 Int. 8
+A:CL,DO,CU,MX
+A:AN
+T:*/*=0.95/60
+Z:223 Int. 8 Mobil
+A:_CLMF,_DOMF
+A:_CUMF
+#A:Mexiko Mobilfunk
+A:_ANMF
+T:*/*=1.17/60
+Z:224 Int. 9
+C:Mobilfunk in Int. 9 22  mehr
 A:+
-C:Welt 2 gilt nicht fr Inmarsat.
-T:*/*=0.04/0,1(60)/1
+# folgende Ziele laufen sonst unter anderen Lndern und hier wohl eher richtig:
+A:FK,GL,GU,KY,CC,NF
+A:PN,RE,SH,PM
+A:CX
+T:*/*=1/60
 #####################################################################
-#
-#
-P:19,0 Mobilcom CbC
-B:01019
-C:Name:01019 Telefondienste GmbH
-C:Address:01019 Telefondienste GmbH, Postfach 520, 24753 Rendsburg-Bdelsdorf
-C:Homepage:http://www.mobilcom.de
-C:Hotline:0800/01019-09
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+P:13,2 Tele2 Turbo CbC
+B:01013
+C:Name:Tele2 Turbo CbC
+C:Address:Telecommunications Services GmbH, Postfach 130840, 40558 Dsseldorf
+C:Homepage:http://www.tele2.de
+C:Telefon:01805-01013-1
+C:Hotline:0800/24-01013
+C:Quelle:Preisliste 3 ab 2003-05-05
+C:TarifURL:http://www.tele2.de/chap02/c020201c.html
+C:TarifURL:http://www.tele2.de/ger/pdf/turbor_neu.pdf
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
 C:Euro
 C:Erfasste Zonen:
-C:2	-   4	Deutschland
-C:10		Mobilfunk
-C:102		01019freenet
-# G:unknown
+C:  2 -   4  Deutschland
+C:Rest identisch mit Tele 2 (Privat) CbC 
+# G:05-May-2003
 D:dtag
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
-Z:2-4 Ferngesprche bundesweit
+Z:1 National-Ort
+T:W/07-19=0.0309/60
+T:W/19-07=0.0099/60 Einfhrungspreis bis mind. 31.08.2003
+T:E,H/*=0.0099/60 Einfhrungspreis bis mind. 31.08.2003
+Z:2-4 National-Fern
 A:+49
-T:*/07-19=0.0608/60 Standard
-T:*/19-22=0.0455/60 Standard
-T:*/22-07=0.0251/60 Spar
-Z:10 Mobilfunk
-A:_DEMF
-T:*/*=0.2454/60
-Z:102 01019freenet
-A:01929
-S:Internet by call
-T:*/*=0.0251/60 FreeNet
+T:*/*=0.027/60
+#
+R:13,0;1,10-201
+R:13,1;210-
 #####################################################################
-P:19,1 Mobilcom Preselection/Profi
-B:01019
-C:Name:MobilCom Preselection/Profi
-C:Address:City LINE GmbH, Holler Str. 126, 24782 Bdelsdorf
-C:Homepage:http://www.mobilcom.de
-C:Hotline:01805/191919
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+P:13,3 Tele2 Turbo Preselection
+B:01013
+C:Name:Tele2 Turbo Preselection
+C:Address:Telecommunications Services GmbH, Postfach 130840, 40558 Dsseldorf
+C:Homepage:http://www.tele2.de
+C:Telefon:01805-01013-1
+C:Hotline:0800/24-01013
+C:Quelle:Preisliste 4 ab 2003-05-05
+C:TarifURL:http://www.tele2.de/chap02/c020201c.html
+C:TarifURL:http://www.tele2.de/ger/pdf/turbor_neu.pdf
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Euro
 C:Erfasste Zonen:
-C:2	-   4	Deutschland
-C:10		Mobilfunk
-C:102		01019freenet
-C:200	-	Ausland
-# G:01.08.2001
-# FIXME Sekundentaktung? Aus Website nicht ganz klar ersichtlich
-C:MobilCom AG
-C:Homepage: http://www.mobilcom.de
-C:Hotline:  01805/191919
-C:Adresse:  Postfach 1249
-C:	    24822 Schleswig
+C:  2 -   4  Deutschland
+C:Rest identisch mit Tele 2 (Privat) Preselection
+# G:05-May-2003
+D:dtag
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
-Z:2 Orts-/Nahzone
-T:*/*=0.0455(60)/1
-Z:3-4 Fernzone
+Z:1 National-Ort
+T:W/07-19=0.0309/60
+T:W/19-07=0.0099/60 Einfhrungspreis bis mind. 31.08.2003
+T:E,H/*=0.0099/60 Einfhrungspreis bis mind. 31.08.2003
+Z:2-4 National-Fern
 A:+49
-T:*/*=0.0608(60)/1
-Z:10 Mobilfunk
-A:_DEMD1
-A:_DEMD2
-A:_DEME1
-A:_DEME2
-A:_DEMQ
-T:*/*=0.25(60)/1
-Z:102 01019freenet
-A:01929
-S:Internet by call
-T:*/*=0.0251(60)/1 FreeNet
+T:*/*=0.027/60
+#
+R:13,1;10-
 #####################################################################
-P:19,2 Mobilcom Preselection/Privat
-B:01019
-C:Name:MobilCom Preselection/Privat
-C:Address:City LINE GmbH, Holler Str. 126, 24782 Bdelsdorf
-C:Homepage:http://www.mobilcom.de
-C:Hotline:01805/191919
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+#
+#
+P:15,0 Maestro Telecom
+B:01015
+C:Name:Maestro Telecom
+C:Homepage:http://www.01015.com/
+C:TarifURL:http://www.01015.com/tarife.php
+C:EMail:info@maestrotelecom.de
+C:Telefax:0800-5345767
+C:Address:Postfach 10 25 26, 45025 Essen
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-C:Erfasste Zonen:
-C:2	-   4	Deutschland
-C:10		Mobilfunk
-C:102		01019freenet
-C:200	-	Ausland
-# G:01.08.2001
+# G:02-Jul-2003
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
-Z:1-4 Ferngesprche bundesweit
-A:+49
-T:*/07-19=0.0608/60 Standard
-T:*/19-22=0.0455/60 Spar
-T:*/22-07=0.0250/60 Nacht
+Z:2-4 Deutschland Festnetz
+A:DE
+T:*/*=0.026/60
 Z:10 Mobilfunk
 A:_DEMF
-T:*/*=0.2454/60
-Z:102 01019freenet
-A:01929
-S:Internet by call
-T:*/*=0.0251/60 FreeNet
+T:*/*=0.165/60
+Z:208 Dnemark
+A:DK
+T:*/*=0.030/60
 #####################################################################
-P:19,3 Mobilcom Aktiv 8
+#
+#
+P:19,0 01019 CbC 	# zuvor: Mobilcom CbC
 B:01019
-C:Name:MobilCom CbC
-C:Address:City LINE GmbH, Holler Str. 126, 24782 Bdelsdorf
-C:Homepage:http://www.mobilcom.de
-C:Hotline:01805/191919
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Name:01019-Tarif, 01019 Telefondienste GmbH
+C:Address:01019 Service-Team, Postfach 2120, 24020 Kiel
+#C:Address:01019 Telefondienste GmbH, Postfach 520, 24753 Rendsburg-Bdelsdorf
+C:Homepage:http://www.01019telefondienste.de/, http://www.01019.net/
+C:Telefon:01805-802980 (Service), 01805-050260 (Rechnung)
+C:Telefax:01805-802981 (Service), 01805-050270 (Rechnung)
+C:EMail:service@01019.net, rechnung@01019.net
+C:Quelle:01019-Tarif (2003-06)
+C:TarifURL:http://www.01019.net/tarife/callbycall.html
+C:Quelle:(fr freenet.de Internet-CbC) freenet.de AG Tarifblatt (2005-05-15)
+C:TarifURL:http://www.freenet.de/freenet/zugang/impressum/tarifblatt/index.html
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Euro
 C:Erfasste Zonen:
-C:2	-   4	Deutschland
+C:0		Freecall
+C:1	-   4	Deutschland
 C:10		Mobilfunk
-C:102		01019freenet
-C:200		Ausland Gruppe A
-# G:01-Oct-2001
+C:40            Auskunft
+C:102	- 105	freenet.de Internet-CbC
+# G:30-Jun-2003
 D:dtag
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
+Z:1 Ortsgesprche
+T:*/09-18=0.015/60
+T:*/18-09=0.013/60
 Z:2-4 Ferngesprche bundesweit
 A:+49
-T:W/08-18=0.045/60 Standard
-T:W/18-08=0.0245/60 Spar
-T:E,H/*=0.0245/60 Spar
-Z:10 Mobilfunk D
+T:*/07-19=0.061/60
+T:*/19-07=0.041/60
+Z:10 Mobilfunk
 A:_DEMD1
 A:_DEMD2
-T:*/*=0.1984/60
-Z:11 Mobilfunk E
 A:_DEME1
 A:_DEME2
-T:*/*=0.2291/60
-Z:102 01019freenet
-A:01929
-S:Internet by call
-# eXpress Net: http://www.express-net.de
-A:01928120
-T:*/*=0.0250/60 FreeNet
-#####################################################################
-#####################################################################
+T:*/*=0.245/60
 #
+Z:40 Auskunft 11819
+A:11819
+T:*/*=0.844/60:120,0.302/60
 #
-P:24,0 TelePassport
-B:01024
-C:Name:Telepassport 99 Plus
-C:Address:Telepassport Service GmbH, Schwindstrae 3, 60325 Frankfurt
-C:Adresss:Telepassprt, Juri-Gagarin-Ring 88, 99084 Erfurt
-C:Homepage:http://www.telepassport.de
-C:Hotline:0800/808 808 8
-C:Telefon:0361/594 2500
-C:Telefax:0800/808 808 9
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
-C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-C:Erfasste Zonen:
-C:2	-   4	Deutschland
-C:10		Mobilfunk
-C:102		TelePassport-Online
-C:200	-	Ausland
-# G:15-Jul-1999
-D:dtag
-Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
-T:*/*=0
-Z:1-2 Lokal
-T:W/08-18=0.12/60 Geschftszeit
-T:W/18-08=0.08/60 Freizeit
-T:E,H/*=0.08/60 Wochenende
-Z:3 Nah
-T:W/08-18=0.14/60 Geschftszeit
-T:W/18-08=0.10/60 Freizeit
-T:E,H/*=0.10/60 Wochenende
-Z:4 Fern
-A:+49
-T:W/08-18=0.16/60 Geschftszeit
-T:W/18-08=0.12/60 Freizeit
-T:E,H/*=0.12/60 Wochenende
-Z:10 Mobilfunk
-A:_DEMCM
-A:_DEMC
-A:_DEMD1
-A:_DEMD2
-A:_DEME1
-A:_DEME2
-T:W/08-18=0.56/60 Geschftszeit
-T:W/18-08=0.46/60 Freizeit
-T:E,H/*=0.46/60 Wochenende
-Z:102 TelePassport-Online
-A:01924924
-S:Internet by call
-T:*/*=0.06/60
-Z:200 Euro 1
-A:AD,BE,DK,FO,FI,FR,GR
-A:UK,_UKIM,IE,IS,IT,_UKIK
-A:LI,LU,MC,NL,_UKIR,NO
-A:AT,PL,PT,SM,SE,CH,SK
-A:ES,CZ,VA
-T:*/*=0.56/60
-Z:201 Euro 2
-A:AL,BA,BG,EE,GI,IL
-A:YU,HR,LV,LT,MT,MK,MD
-A:RO,SU,SI,TR,UA,HU,BY,CY
-T:*/*=0.96/60
-Z:202 Welt 1
-A:CA,US
-T:*/*=0.46/60
-Z:203 Welt 2
-A:AU,HK,KR,JP,SG,NZ
-T:*/*=0.96/60
-Z:204 Welt 3
-A:+
-T:*/*=1.96/60
+# alle ohne Anmeldung nutzbar:
+Z:102 freenet.de Standard CbC
+A:01929
+T:*/*=0.02505/60 	# kann/wird nach Anmeldung anders sein
+Z:103 freenet.de Super CbC
+A:019231760
+T:*/08-18=0.0145/60 Standard
+T:*/18-08=0.0089/60 Abend/Nacht
+Z:104 freenet.de Internet-by-Call
+A:019231770
+T:*/*=0.0590/0,0.0078/60
+Z:105 freenet.de Sorglos CbC
+A:019231780
+T:*/*=0.0129/60 	# fr freenet.de Mitglieder auch bei 01929
 #####################################################################
-P:24,1 Telepassport Plus
-B:01024
-# G:15-Jul-1999
-C:Name:Telepassport Plus
-C:Address:Telepassport Service GmbH, Schwindstrae 3, 60325 Frankfurt
-C:Adresss:Telepassport, Juri-Gagarin-Ring 88, 99084 Erfurt
-C:Homepage:http://www.telepassport.de
-C:Hotline:0800/808 808 8
-C:Telefon:0361/594 2500
-C:Telefax:0800/808 808 9
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+P:19,1 01019 Profi 	# zuvor: Mobilcom Preselection/Profi
+B:01019
+C:Name:01019 Profi, 01019 Telefondienste GmbH
+C:Address:01019 Service-Team, Postfach 2120, 24020 Kiel
+C:Homepage:http://www.01019telefondienste.de/, http://www.01019.net/
+C:Telefon:01805-802980 (Service), 01805-050260 (Rechnung)
+C:Telefax:01805-802981 (Service), 01805-050270 (Rechnung)
+C:EMail:service@01019.net, rechnung@01019.net
+C:Quelle:Profi-Tarif (2003-05-07)
+C:TarifURL:http://www.01019.net/tarife/profi.html
+C:TarifURL:http://www.01019.net/download/01019_3in1_0907.pdf
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Special:Preselection
+C:Preselection
+C:Euro
 C:Erfasste Zonen:
-C:2	-   4	Deutschland
+C:1	-   4	Deutschland
 C:10		Mobilfunk
-C:102		TelePassport-Online
-C:200	-	Ausland
-Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
-T:*/*=0
-Z:1-4 Inland
+# G:09-Jul-2003
+R:19,0;0,40,102-105 	# Freecall, Auskunft, Internet-CbC wie bei 01019 CbC
+Z:1 Ortsgesprche
+T:*/*=0.030(60)/1
+Z:2 Regio 20
+T:*/*=0.0460(60)/1
+Z:3-4 Fernzone
 A:+49
-T:W/08-18=0.16/60 Geschftszeit
-T:W/18-08=0.12/60 Freizeit
-T:E,H/*=0.12/60 Wochenende
+T:*/*=0.0610(60)/1
 Z:10 Mobilfunk
-A:_DEMCM
-A:_DEMC
 A:_DEMD1
 A:_DEMD2
-A:_DEME1
-A:_DEME2
-T:*/*=0.56/60
-Z:102 TelePassport-Online
-A:01924924
-S:Internet by call
-T:W/08-18=0.08/60 Geschftszeit
-T:W/18-08=0.06/60 Freizeit
-T:E,H/*=0.08/60 Wochenende
-Z:200 Euro 1
-A:AD,BE,DK,FO,FI,FR,GR
-A:UK,_UKIM,IE,IS,IT,_UKIK
-A:LI,LU,MC,NL,_UKIR,NO
-A:AT,PL,PT,SM,SE,CH,SK
-A:ES,CZ,VA
-T:*/*=0.56/60
-Z:201 Euro 2
-A:AL,BA,BG,EE,GI,IL
-A:YU,HR,LV,LT,MT,MK,MD
-A:RO,SU,SI,TR,UA,HU,BY,CY
-T:*/*=0.96/60
-Z:202 Welt 1
-A:CA,US
-T:*/*=0.46/60
-Z:203 Welt 2
-A:AU,HK,KR,JP,SG,NZ
-T:*/*=0.96/60
-Z:204 Welt 3
-A:+
-T:*/*=1.96/60
+A:_DEME1		# Eplus
+A:_DEME2		# E2
+T:*/*=0.2450(60)/1
 #####################################################################
-P:24,2 Telepassport CbC
-B:01024
-# G:15-Jul-1999
-C:Name:Telepassport CbC
-C:Address:Telepassport Service GmbH, Schwindstrae 3, 60325 Frankfurt
-C:Adresss:Telepassport, Juri-Gagarin-Ring 88, 99084 Erfurt
-C:Homepage:http://www.telepassport.de
-C:Hotline:0800/808 808 8
-C:Telefon:0361/594 2500
-C:Telefax:0800/808 808 9
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+P:19,2 01019 Privat 	# zuvor: Mobilcom Preselection/Privat
+B:01019
+C:Name:01019 Privat, 01019 Telefondienste GmbH
+C:Address:01019 Service-Team, Postfach 2120, 24020 Kiel
+C:Homepage:http://www.01019telefondienste.de/, http://www.01019.net/
+C:Telefon:01805-802980 (Service), 01805-050260 (Rechnung)
+C:Telefax:01805-802981 (Service), 01805-050270 (Rechnung)
+C:EMail:service@01019.net, rechnung@01019.net
+C:Quelle:Profi-Tarif (2003-05-07)
+C:TarifURL:http://www.01019.net/tarife/privat.html
+C:TarifURL:http://www.01019.net/download/01019_3in1_0907.pdf
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Special:Preselection
+C:Preselection
+C:Euro
 C:Erfasste Zonen:
-C:2	-   4	Deutschland
+C:1	-   4	Deutschland
 C:10		Mobilfunk
-C:102		TelePassport-Online
-C:200	-	Ausland
-Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
-T:*/*=0
-Z:1-4 Inland
+# G:09-Jul-2003
+R:19,0;0,40,102-105 	# Freecall, Auskunft, Internet-CbC wie bei 01019 CbC
+Z:1 Ortsgesprche
+T:*/07-19=0.0300/60
+T:*/19-22=0.0200/60
+T:*/22-07=0.0150/60
+Z:2-4 Ferngesprche bundesweit
 A:+49
-T:*/07-21=0.14/60 Geschftszeit
-T:*/21-07=0.10/60 Freizeit
+T:*/07-19=0.0610/60 Standard
+T:*/19-22=0.0460/60 Spar
+T:*/22-07=0.0250/60 Nacht
 Z:10 Mobilfunk
-A:_DEMCM
-A:_DEMC
 A:_DEMD1
 A:_DEMD2
-A:_DEME1
-A:_DEME2
-T:*/*=0.56/60
-Z:102 TelePassport-Online
-A:01924924
-S:Internet by call
-T:W/08-18=0.08/60 Geschftszeit
-T:W/18-08=0.06/60 Freizeit
-T:E,H/*=0.08/60 Wochenende
-Z:200 Euro 1
-A:AD,BE,DK,FO,FI,FR,GR
-A:UK,_UKIM,IE,IS,IT,_UKIK
-A:LI,LU,MC,NL,_UKIR,NO
-A:AT,PL,PT,SM,SE,CH,SK
-A:ES,CZ,VA
-T:*/*=0.56/60
-Z:201 Euro 2
-A:AL,BA,BG,EE,GI,IL
-A:YU,HR,LV,LT,MT,MK,MD
-A:RO,SU,SI,TR,UA,HU,BY,CY
-T:*/*=0.96/60
-Z:202 Welt 1
-A:CA,US
-T:*/*=0.46/60
-Z:203 Welt 2
-A:AU,HK,KR,JP,SG,NZ
-T:*/*=0.96/60
-Z:204 Welt 3
-A:+
-T:*/*=1.96/60
+A:_DEME1		# Eplus
+A:_DEME2		# E2
+T:*/*=0.2450/60
 #####################################################################
-P:24,3 Telepassport RegionalTarif Plus
-B:01024
-# G:01.05.1999
-C:Name:Telepassport RegionalTarif Plus
-C:Address:Telepassport Service GmbH, Schwindstrae 3, 60325 Frankfurt
-C:Adresss:Telepassport, Juri-Gagarin-Ring 88, 99084 Erfurt
-C:Homepage:http://www.telepassport.de
-C:Hotline:0800/808 808 8
-C:Telefon:0361/594 2500
-C:Telefax:0800/808 808 9
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+P:19,3 01019 Aktiv 8 	# zuvor: Mobilcom Aktiv 8
+B:01019
+C:Name:01019 Aktiv 8, 01019 Telefondienste GmbH
+C:Address:01019 Service-Team, Postfach 2120, 24020 Kiel
+C:Homepage:http://www.01019telefondienste.de/, http://www.01019.net/
+C:Telefon:01805-802980 (Service), 01805-050260 (Rechnung)
+C:Telefax:01805-802981 (Service), 01805-050270 (Rechnung)
+C:EMail:service@01019.net, rechnung@01019.net
+C:Quelle:Aktiv 8-Tarif (2003-05-07)
+C:TarifURL:http://www.01019.net/tarife/aktiv8.html
+C:TarifURL:http://www.01019.net/download/01019_3in1_0907.pdf
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-C:Sondertarif 5 "Bundesland/Region":Gesprche innerhalb des Bundeslandes/Region
+C:Special:monatliche Grundgebhr EUR 4,50; 12 Monate Mindestlaufzeit.
+C:Special:Preselection
+C:Preselection
+C:Euro
 C:Erfasste Zonen:
-C:2	-   4	Deutschland
-C:5		Sondertarif
-C:10		Mobilfunk
-C:102		TelePassport-Online
-C:200	-	Ausland
-Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
-T:*/*=0
-Z:1-2 Lokal
-T:*/*=0.10/60
-Z:3-4 Fern
+C:1	-   4	Deutschland
+C:10	-  11	Mobilfunk
+# G:09-Jul-2003
+R:19,0;0,40,102-105 	# Freecall, Auskunft, Internet-CbC wie bei 01019 CbC
+Z:1 Ortsgesprche
+T:*/08-18=0.0200/60
+T:*/18-08=0.0150/60
+Z:2-4 Ferngesprche bundesweit
 A:+49
-T:*/*=0.16/60
-Z:5 Bundesland/Region
-T:*/*=0.14/60
-Z:10 Mobilfunk
-A:_DEMCM
-A:_DEMC
+T:W/08-18=0.0450/60 Hauptzeit
+T:W/19-08=0.0250/60 Nebenzeit
+T:E/*=0.0250/60 Nebenzeit
+Z:10 Mobilfunk D
 A:_DEMD1
 A:_DEMD2
-A:_DEME1
-A:_DEME2
-T:*/*=0.56/60
-Z:102 TelePassport-Online
-A:01924924
-S:Internet by call
-T:*/*=0.06/60
-Z:200 International 1
-A:AD,BE,DK,FO,FI,FR,GR
-A:UK,_UKIM,IE,IS,IT,_UKIK
-A:LI,LU,MC,NL,_UKIR,NO
-A:AT,PL,PT,SM,SE,CH,SK
-A:ES,CZ,VA
-A:CA,US
-T:*/*=0.56/60
-Z:201 International 2
-A:AL,BA,BG,EE,GI,IL
-A:YU,HR,LV,LT,MT,MK,MD
-A:RO,SU,SI,TR,UA,HU,BY,CY
-A:AU,HK,KR,JP,SG,NZ
-T:*/*=0.96/60
-Z:202 International 3
-A:+
-T:*/*=1.96/60
+T:*/*=0.1980/60
+# 1. TarifURL sagt Mobilfunk _ab_ 0.198 EUR/Min, daher folgendes beibehalten.
+Z:11 Mobilfunk E
+A:_DEME1		# Eplus
+A:_DEME2		# E2
+T:*/*=0.2291/60
 #####################################################################
-P:24,4 Telepassport SdOst-Tarif
+#
+#
+P:24,0 01024 CbC 	# zuvor: Super 24 (als P:24,7)
 B:01024
-# G:01.05.1999
-C:Name:Telepassport SdOst-Tarif
-C:Address:Telepassport Service GmbH, Schwindstrae 3, 60325 Frankfurt
-C:Adresss:Telepassport, Juri-Gagarin-Ring 88, 99084 Erfurt
-C:Homepage:http://www.telepassport.de
-C:Hotline:0800/808 808 8
-C:Telefon:0361/594 2500
-C:Telefax:0800/808 808 9
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Name:01024 CbC
+C:Address:01024 Telefondienste GmbH, Postfach 2120, 24020 Kiel
+C:Hotline:0800/24-01024, 0190-7-35724
+C:Telefax:0190-1-56156
+C:EMail:info@01024-telefondienste.de
+C:Homepage:http://www.01024-telefondienste.de/
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
 C:Erfasste Zonen:
 C:2	-   4	Deutschland
 C:10		Mobilfunk
-C:102		TelePassport-Online
-C:200	-	Ausland
-Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
-T:*/*=0
-Z:1-2 Lokal
-T:*/*=0.12/60
-Z:3 Nah
-T:W/08-18=0.16/60 Geschftszeit
-T:W/18-08=0.12/60 Freizeit
-T:E,H/*=0.12/60 Wochenende
-Z:4 Fern
-A:+49
-T:W/08-18=0.18/60 Geschftszeit
-T:W/18-08=0.12/60 Freizeit
-T:E,H/*=0.12/60 Wochenende
-Z:10 Mobilfunk
-A:_DEMCM
-A:_DEMC
-A:_DEMD1
-A:_DEMD2
-A:_DEME1
-A:_DEME2
-T:W/08-18=0.58/60 Geschftszeit
-T:W/18-08=0.48/60 Freizeit
-T:E,H/*=0.48/60 Wochenende
-Z:102 TelePassport-Online
-A:01924924
-S:Internet by call
-T:W/08-18=0.08/60 Geschftszeit
-T:W/18-08=0.06/60 Freizeit
-T:E,H/*=0.08/60 Wochenende
-Z:200 Global 1
-A:BE,DK,FI,FR,GR,UK
-A:IE,IS,IT,LI,LU,MC,NL
-A:NO,AT,PL,PT,SE,CH,SK,ES
-A:CZ,TR,US,CA
-T:*/*=0.68/60
-Z:201 Global 2
-A:AL,BA,BG,IL,YU,HR
-A:MT,MK,RO,SI,HU,CY
-A:AZ,EE,LV,LT,MD,SU
-A:TJ,UA,BY
-A:AU,TW,HK,KR,ID,JP
-A:MY,NZ,PH,SG,TH
-T:*/*=0.88/60
-Z:202 Global 3
-A:AM,GE,KZ,KG,TM,UZ
-A:ZA
-T:*/*=1.48/60
-Z:203 Global 4
-A:+
-T:*/*=1.98/60
-#####################################################################
-P:24,5 Telepassport SdOst
-B:01024
-# G:01.05.1999
-C:Name:Telepassport SdOst
-C:Address:Telepassport Service GmbH, Schwindstrae 3, 60325 Frankfurt
-C:Adresss:Telepassport, Juri-Gagarin-Ring 88, 99084 Erfurt
-C:Homepage:http://www.telepassport.de
-C:Hotline:0800/808 808 8
-C:Telefon:0361/594 2500
-C:Telefax:0800/808 808 9
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
-C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
-T:*/*=0
-Z:1-4 Inland
-A:+49
-T:W/08-18=0.18/60 Geschftszeit
-T:W/18-08=0.12/60 Freizeit
-T:E,H/*=0.12/60 Wochenende
-Z:10 Mobilfunk
-A:_DEMCM
-A:_DEMC
-A:_DEMD1
-A:_DEMD2
-A:_DEME1
-A:_DEME2
-T:*/*=0.56/60
-Z:102 TelePassport-Online
-A:01924924
-S:Internet by call
-T:*/*=0.08/60
-Z:200 Global 1
-A:BE,DK,FI,FR,GR,UK
-A:IE,IS,IT,LI,LU,MC,NL
-A:NO,AT,PL,PT,SE,CH,SK,ES
-A:CZ,TR,US,CA
-T:*/*=0.68/60
-Z:201 Global 2
-A:AL,BA,BG,IL,YU,HR
-A:MT,MK,RO,SI,HU,CY
-A:AZ,EE,LV,LT,MD,SU
-A:TJ,UA,BY
-A:AU,TW,HK,KR,ID,JP
-A:MY,NZ,PH,SG,TH
-T:*/*=0.88/60
-Z:202 Global 3
-A:AM,GE,KZ,KG,TM,UZ
-A:ZA
-T:*/*=1.48/60
-Z:203 Global 4
-A:+
-T:*/*=1.98/60
-#####################################################################
-P:24,6 Telepassport StudentenTarif
-B:01024
-# G:01.05.1999
-C:Name:Telepassport StudentenTarif
-C:Address:Telepassport Service GmbH, Schwindstrae 3, 60325 Frankfurt
-C:Adresss:Telepassport, Juri-Gagarin-Ring 88, 99084 Erfurt
-C:Homepage:http://www.telepassport.de
-C:Hotline:0800/808 808 8
-C:Telefon:0361/594 2500
-C:Telefax:0800/808 808 9
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
-C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+# G:01-Mar-2003
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
-Z:1-2 Lokal
-T:*/*=0.10/60
-Z:3 Nah
-T:W/08-18=0.12/60 Geschftszeit
-T:W/18-08=0.10/60 Freizeit
-T:E,H/*=0.10/60 Wochenende
-Z:4 Fern
+Z:1 Ortsgesprche
+T:*/*=0.015/60
+Z:2-4 Inland
 A:+49
-T:W/08-18=0.14/60 Geschftszeit
-T:W/18-08=0.10/60 Freizeit
-T:E,H/*=0.10/60 Wochenende
+T:*/07-09=0.024/60
+T:*/09-21=0.033/60
+T:*/21-07=0.018/60
 Z:10 Mobilfunk
-A:_DEMCM
-A:_DEMC
 A:_DEMD1
 A:_DEMD2
 A:_DEME1
 A:_DEME2
-T:W/08-18=0.58/60 Geschftszeit
-T:W/18-08=0.48/60 Freizeit
-T:E,H/*=0.48/60 Wochenende
-Z:102 TelePassport-Online
-A:01924924
-S:Internet by call
-T:W/08-18=0.08/60 Geschftszeit
-T:W/18-08=0.06/60 Freizeit
-T:E,H/*=0.06/60 Wochenende
-Z:200 Ausland Spezial
-A:BE,DK,FI,FR,UK,IT
-A:NL,NO,AT,SE,CH
-A:CA,US
-T:*/*=0.48/60
-Z:201 International 1
-A:AD,FO,GR,IE,IS,LI,LU
-A:MC,PL,PT,SM,SK,ES
-A:CZ,VA
-T:*/*=0.68/60
-Z:202 International 2
-A:AL,BA,BG,EE,GI,IL
-A:YU,HR,LV,LT,MT,MK,MD
-A:RO,SU,SI,TR,UA,HU,BY,CY
-A:AU,HK,KR,JP,SG,NZ
-T:*/*=0.98/60
-Z:203 Global 4
-A:+
-T:*/*=1.98/60
-#####################################################################
-P:24,7 Super 24
-B:01024
-C:*** Die Euro-Preise sind bislang nicht bekanntgegeben worden!
-C:*** Daher bislang schlicht umgerechnet! 30.Dec.2001/AK
-C:Name:Super 24
-C:Hotline:0800/24-01024
-C:Homepage:http://www.super24.com
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
-C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-C:Erfasste Zonen:
-C:2	-   4	Deutschland
-C:10		Mobilfunk
-C:102		SUPER24 Internet
-C:200	-	Ausland
-# G:13.06.2000
-Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
-T:*/*=0
-Z:1-4 Inland
-A:+49
-T:*/*=0.03/60
-Z:10 Mobilfunk
-A:_DEMF
+A:_DEMQ
 T:*/*=0.19/60
 #####################################################################
 #
@@ -1402,14 +930,16 @@
 C:Address:Nordcom GmbH, Dtlinger Str. 6-8, 28197 Bremen
 C:Homepage:http://www.nordcom.net
 C:Sondertarif 5 "Nordcom-Nordcom": Netzinterne Gesprche zwischen Nordcom Kunden
+C:Regionalanbieter fr Bremen, Bremerhaven, Achim, Lemwerder, Langen
+C:und Schiffdorf.
+C:Komplettanschluss, mtl. 22,00 EUR.
 C:Euro
 C:Erfasste Zonen:
 C:1     -   4   Deutschland
 C:5             Sondertarif
 C:10            Mobilfunk
-C:102           nordNet
-C:nordNet: Internet Zugang, 0,025 DM / Min
-C:Stand: 2001-06-01
+C:102           nordNet (Internetzugang)
+# G:01-Jan-2003
 Z:0 FreeCall
 A:011*
 A:0130*,0800*,0801*
@@ -1418,35 +948,40 @@
 A:112
 T:*/*=0
 Z:1-3 Ortstarif
-T:W/06-18=0.031(60)/1 Tag
-T:W/18-06=0.015(60)/1 Freizeit
-T:E,H/*=0.015(60)/1 Wochenende
+T:W/06-18=0.031|0.031(60)/1 Tag
+T:W/18-06=0.031|0.015(60)/1 Freizeit
+T:E,H/*=0.031|0.015(60)/1 Wochenende
 Z:4 Ferntarif
-T:W/06-18=0.061(60)/1 Tag
-T:W/18-06=0.026(60)/1 Freizeit
-T:E,H/*=0.026(60)/1 Wochenende
+T:W/06-18=0.031|0.061(60)/1 Tag
+T:W/18-06=0.031|0.026(60)/1 Freizeit
+T:E,H/*=0.031|0.026(60)/1 Wochenende
 A:DE
 Z:5 Nordcom-Nordcom
-T:W/06-18=0.02(60)/1 Tag
-T:W/18-06=0.01(60)/1 Freizeit
-T:E,H/*=0.01(60)/1 Wochenende
+#Rufnummern von anderen Nordcom-Kunden hier eintragen, folgendes # entfernen
+#A:+49421555, +49471555
+T:W/06-18=0.031|0.02(60)/1 Tag
+T:W/18-06=0.031|0.01(60)/1 Freizeit
+T:E,H/*=0.031|0.01(60)/1 Wochenende
+#
 Z:12-13 Mobilfunk D1/D2
 A:_DEMD1
 A:_DEMD2
-T:*/*=0.245(60)/1
+T:*/*=0.031|0.245(60)/1
 Z:14 Mobilfunk E-plus
 A:_DEME1
-T:W/06-18=0.276(60)/1 Tag
-T:W/18-06=0.245(60)/1 Freizeit
+T:W/06-18=0.031|0.276(60)/1 Tag
+T:W/18-06=0.031|0.245(60)/1 Freizeit
+T:E,H/*=0.031|0.245(60)/1 Freizeit
 Z:15 Mobilfunk E2
 A:_DEME2
-T:W/06-18=0.291(60)/1 Tag
-T:W/18-06=0.245(60)/1 Freizeit
-T:E,H/*=0.245(60)/1 Wochenende
+T:W/06-18=0.031|0.291(60)/1 Tag
+T:W/18-06=0.031|0.245(60)/1 Freizeit
+T:E,H/*=0.031|0.245(60)/1 Wochenende
+#
 Z:102 nordNet
 A:+494212774003
 A:+494713084003
-T:*/*=0.013(60)/1
+T:*/*=0.013/60
 #####################################################################
 P:27,1 Nordcom nordFonNet Pro
 B:01027
@@ -1454,47 +989,15 @@
 C:Address:Nordcom GmbH, Dtlinger Str. 6-8, 28197 Bremen
 C:Sondertarif 5 "Nordcom-Nordcom": Netzinterne Gesprche zwischen Nordcom
 C:Kunden
+C:Regionalanbieter fr Bremen, Bremerhaven, Achim, Lemwerder, Langen
+C:und Schiffdorf.
+C:Komplettanschluss, mtl. 47,00 EUR.
 C:Euro
 C:Erfasste Zonen:
-C:1     -   4   Deutschland
-C:5             Sondertarif
-C:10            Mobilfunk
 C:102           nordNet Flatrate
-C:Stand: 2001-06-01
-Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
-T:*/*=0
-Z:1-3 Ortstarif
-T:W/06-18=0.031(60)/1 Tag
-T:W/18-06=0.015(60)/1 Freizeit
-T:E,H/*=0.015(60)/1 Wochenende
-Z:4 Ferntarif
-T:W/06-18=0.061(60)/1 Tag
-T:W/18-06=0.026(60)/1 Freizeit
-T:E,H/*=0.026(60)/1 Wochenende
-A:DE
-Z:5 Nordcom-Nordcom
-T:W/06-18=0.02(60)/1 Tag
-T:W/18-06=0.01(60)/1 Freizeit
-T:E,H/*=0.01(60)/1 Wochenende
-Z:12-13 Mobilfunk D1/D2
-A:_DEMD1
-A:_DEMD2
-T:*/*=0.245(60)/1
-Z:14 Mobilfunk E-plus
-A:_DEME1
-T:W/06-18=0.276(60)/1 Tag
-T:W/18-06=0.245(60)/1 Freizeit
-T:E,H/*=0.245(60)/1 Wochenende
-Z:15 Mobilfunk E2
-A:_DEME2
-T:W/06-18=0.291(60)/1 Tag
-T:W/18-06=0.276(60)/1 Freizeit
-T:E,H/*=0.276(60)/1 Wochenende
+C:brige Zonen wie nordFon(Net) ISDN
+# G:01-Jan-2003
+R:27,0;0-15
 Z:102 nordNet Flatrate
 A:+494212774003
 A:+494713084003
@@ -1504,135 +1007,155 @@
 #
 P:33,0 DTAG T-ISDN Standard
 B:01033
-# G:26-Dez-2001
+# G:01-Sep-2003
 D:dtag
 C:Name:Deutsche Telekom AG
 C:Address:Deutsche Telekom AG, Friedrich-Ebert-Allee 140, 53113 Bonn
 C:Homepage:http://www.dtag.de
 C:Hotline:0800/33-01000, T-Online Tarifhotline: 0800/33-03333
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-C:Quelle:"Preisliste Telefondienst (Inlandsverbindungen)", Stand 2002-05-01
-C:Quelle:http://www.telekom.de/dtag/agb/dokument/pdf/0,1384,225,00.pdf
+C:Quelle:"Preisliste Telefondienst (Inlandsverbindungen)", Stand 2003-07-01
+C:Quelle:http://www.telekom.de/dtag/agb/dokument/pdf/0,1384,742,00.pdf
+C:Quelle:"Preisliste Telefondienst (Inlandsverbindungen)", Stand 2003-09-01
+C:Quelle:http://www.telekom.de/dtag/agb/dokument/pdf/0,1384,988,00.pdf
 C:Quelle:"Preisliste Auskunftsdienst", Stand 2002-06-03
-#C:Quelle:(derzeit offenbar nur auf Anfrage von info@telekom.de erhltlich)
-#C:Quelle:Pressemeldung "Neues Tarifmodell Inlandsauskunft", 2002-05-31
-#C:Quelle:http://www.telekom.de/dtag/presse/artikel/0,1018,x1641,00.html
-C:Quelle:"Preisliste Telefondienst (Auslandsverbindungen)", Stand 2002-03-01
-C:Quelle:http://www.telekom.de/dtag/agb/dokument/pdf/0,1384,71,00.pdf
+C:Quelle:http://www.telekom.de/dtag/agb/dokument/pdf/0,1384,680,00.pdf
+C:Quelle:"Preisliste Telefondienst (Auslandsverbindungen)", Stand 2003-03-15
+C:Quelle:http://www.telekom.de/dtag/agb/dokument/pdf/0,1384,743,00.pdf
 C:Euro
 C:Erfasste Zonen:
-C:   0 -   4 Deutschland
+C:   0       Freephone
+C:   1 -   4 Deutschland
 C:  10 -  12 Mobilfunk
-C:  29 -  39 Satellitenfunk
+C:  20       Bndelfunk (01672 = Dolphin Telecom)
+C:  25 -  35 Satellitenfunk
 C:  40 -  41 Auskunft DTAG Inland/Ausland
 C:  60 -  67 Funkruf Cityruf, Scall, Skyper
 C:  80 -  84 Shared Cost 0180
 C:  90 -  94 Premium Rate 0190
 C: 100       T-Online
-C: 160 - 162 T-VoteCall 0137,0138
+C: 160 - 164 T-VoteCall 0137,0138
 C: 170       Persnliche Rufnummer 0700
 C: 171       Ansage Lotto (01162) und Zeit (01191)
-C: 250 - 271 Ausland Mobilfunk
-C: 280 - 295 Ausland
+C: 251 - 281 Ausland Mobilfunk
+C: 301 - 311 Ausland
 # Auslandszonen 200-249 fr AktivPlus in P:33,1 (vorrangig) freigehalten.
 # nicht erfasst nach Inlandspreisliste:
-#   012, 01672, 0181-0189, 'Mobilfunk MobilCom'
-# nach Auslandspreisliste:
-#   div. Satelliten- und auslndische Mobilfunknetze, Zonen sind auskommentiert
-#   Vis--Vis-Tarife in Grenzgebieten, Global 269 (+269800)
+#   012, 0181-0189
+# nicht erfasst nach Auslandspreisliste:
+#   div. auslndische Mobilfunknetze, Zonen sind auskommentiert
+# Die Informationen zu auslndischen Mobilfunknetzen in den Dateien
+#   country[-de].dat und dest.cdb mssen nicht mit denen der DTAG
+#   bereinstimmen.  Die DTAG bietet zur Ermittelung der fr sie relevanten
+#   Vorwahlnummern folgende Rufnummer an: 0800-33-03333.
 #
-Z:0 FreeCall
-A:08003301113
-A:08003301000
-A:08003301115
-A:08003301136
-A:08003302000
-A:08003301172
-A:08003301174
-A:08003302050
-A:01136
-A:110
-A:112
+Z:0 Freephone
+# DTAG Servicerufnummer nur noch zur Information (evtl. veraltet):
+# A:08003301113 # Telekom Direkt
+# A:08003301000 # Telekom Privatkundenvertrieb
+# A:08003301115 # Telekom Geschaftskundenvertrieb
+# A:08003301136 # Telegrammaufnahme per Telefax
+# A:08003302000 # Strungsannahme PK
+# A:08003301172 # Strungsannahme GK
+# A:08003301174 # Strungsannahme Kabelfernsehen
+# A:08003302050 # Beratung Telefonkarten
 # A:+10         # Operator Service
-A:0800
-A:_NLFF,_CHFF
+A:110         # Polizei / Notruf
+A:112         # Feuerwehr / Rettungsleitstelle
+A:0800*,0801* # Freephone
 A:_F800
-A:0800*,0801*
-A:031*
+A:_KMFF
+# Gebhrenfreiheit restlicher Destinationen unbelegt
+A:01136       # Telegrammaufnahme per Telefax
+A:031* 	      # Testrufnummern
+A:_NLFF,_CHFF
 T:*/*=0
 #
 Z:1-2 City
-A:01141
-A:0193066
-T:[-24.12.2002]W/07-18=0.059972/90 Tag	# 0.0517 +16%
-T:[-24.12.2002]W/18-07=0.059972/240 Abend	# 0.0517 +16%
-T:[-24.12.2002]E,H/*=0.059972/240 Abend	# 0.0517 +16%
-T:[24.12.2002-02.01.2003]*/*=0.059972/240 Weihnachten	# 0.0517 +16%
-T:[02.01.2003]W/07-18=0.059972/90 Tag	# 0.0517 +16%
-T:[02.01.2003]W/18-07=0.059972/240 Abend	# 0.0517 +16%
-T:[02.01.2003]E,H/*=0.059972/240 Abend	# 0.0517 +16%
+A:01141 	# Auftragsstelle Dt. Telekom
+A:0193066 	# 'Online-Dienst'
+T:[-01.09.2003]W/08-18=0.059972/90 Tag	# 0.0517 +16%
+T:[-01.09.2003]W/18-08=0.059972/240 Abend	# 0.0517 +16%
+T:[-01.09.2003]E,H/*=0.059972/240 Abend	# 0.0517 +16%
+T:[01.09.2003-24.12.2003]W/09-18=0.059972/90 Tag	# 0.0517 +16%
+T:[01.09.2003-24.12.2003]W/18-09=0.059972/240 Abend	# 0.0517 +16%
+T:[01.09.2003-24.12.2003]E,H/*=0.059972/240 Abend	# 0.0517 +16%
+T:[24.12.2003-25.12.2003]*/*=0.059972/240 Heiligabend	# 0.0517 +16%
+T:[25.12.2003-31.12.2003]W/09-18=0.059972/90 Tag	# 0.0517 +16%
+T:[25.12.2003-31.12.2003]W/18-09=0.059972/240 Abend	# 0.0517 +16%
+T:[25.12.2003-31.12.2003]E,H/*=0.059972/240 Abend	# 0.0517 +16%
+T:[31.12.2003-01.01.2004]*/*=0.059972/240 Silvester	# 0.0517 +16%
+T:[01.01.2004]W/09-18=0.059972/90 Tag	# 0.0517 +16%
+T:[01.01.2004]W/18-09=0.059972/240 Abend	# 0.0517 +16%
+T:[01.01.2004]E,H/*=0.059972/240 Abend	# 0.0517 +16%
 Z:3-4 Deutschland
 A:DE
-T:[-24.12.2002]W/07-18=0.091988/60 Tag	# 0.0793 +16%
-T:[-24.12.2002]W/18-07=0.030624/60 Abend	# 0.0264 +16%
-T:[-24.12.2002]E,H/*=0.030624/60 Abend	# 0.0264 +16%
-T:[24.12.2002-02.01.2003]*/*=0.030624/60 Weihnachten	# 0.0264 +16%
-T:[02.01.2003]W/07-18=0.091988/60 Tag	# 0.0793 +16%
-T:[02.01.2003]W/18-07=0.030624/60 Abend	# 0.0264 +16%
-T:[02.01.2003]E,H/*=0.030624/60 Abend	# 0.0264 +16%
+T:[-24.12.2003]W/07-18=0.090828/60 Tag	# 0.0783 +16%
+T:[-24.12.2003]W/18-07=0.030276/60 Abend	# 0.0261 +16%
+T:[-24.12.2003]E,H/*=0.030276/60 Abend	# 0.0261 +16%
+T:[24.12.2003-25.12.2003]*/*=0.030276/60 Heiligabend	# 0.0261 +16%
+T:[25.12.2003-31.12.2003]W/07-18=0.090828/60 Tag	# 0.0783 +16%
+T:[25.12.2003-31.12.2003]W/18-07=0.030276/60 Abend	# 0.0261 +16%
+T:[25.12.2003-31.12.2003]E,H/*=0.030276/60 Abend	# 0.0261 +16%
+T:[31.12.2003-01.01.2004]*/*=0.030276/60 Silvester	# 0.0261 +16%
+T:[01.01.2004]W/07-18=0.090828/60 Tag	# 0.0783 +16%
+T:[01.01.2004]W/18-07=0.030276/60 Abend	# 0.0261 +16%
+T:[01.01.2004]E,H/*=0.030276/60 Abend	# 0.0261 +16%
 #
-Z:10 Mobilfunknetz D1/D2
+Z:10 Mobilfunk D1/D2
 A:_DEMD1
 A:_DEMD2
 T:*/*=0.24534/60	# 0.2115 +16%
-Z:11 Mobilfunknetz E-Plus
+Z:11 Mobilfunk E1/E2
 A:_DEME1
-T:*/*=0.27608/60	# 0.2380 +16%
-Z:12 Mobilfunknetz E2/Quam
 A:_DEME2
-A:_DEMQ
 T:*/*=0.291392/60	# 0.2512 +16%
+Z:12 Mobilfunk Mobilcom
+A:_DEMM
+T:*/*=0.309952/60	# 0.2672 +16%
+#
+Z:20 Bndelfunk Dolphin Telecom
+A:_DEBD
+T:*/*=0.368068/60	# 0.3173 +16%
 #
 # FIXME: gem. header nur Z:31-39 fr Satellitenfunk
-# FIXME: fehlt in country-de.dat [22-Nov-2001]
-# Z:29 Thuraya
-# A:+88216
-# T:*/*=4.5936(60)/0.8	# 3.9600 +16%
-# Z:30 EMSAT
-# A:+88213
-# T:*/*=3.0624(60)/1.2	# 2.6400 +16%
-Z:31 Inmarsat A
+Z:25 Inmarsat A
 A:_INA_
 T:*/*=5.267328(60)/0.7	# 4.5408 +16%
-Z:32 Inmarsat B HSD
-A:_INBH
-T:*/*=12.2496(60)/0.3	# 10.5600 +16%
-Z:33 Inmarsat B
+Z:26 Inmarsat B
 A:_INB_
 T:*/*=4.5936(60)/0.8	# 3.9600 +16%
-Z:34 Inmarsat Aero
+Z:27 Inmarsat B HSD
+A:_INBH
+T:*/*=12.2496(60)/0.3	# 10.5600 +16%
+Z:28 Inmarsat Aero
 A:_INAE
 T:*/*=5.267328(60)/0.7	# 4.5408 +16%
-Z:35 Inmarsat M
+Z:29 Inmarsat M
 A:_INM_
 T:*/*=4.5936(60)/0.8	# 3.9600 +16%
-Z:36 Inmarsat Mini-M
+Z:30 Inmarsat Mini-M
 A:_INMM
 T:*/*=3.67488(60)/1	# 3.1680 +16%
-Z:37 Inmarsat A Daten/Fax
+Z:31 Inmarsat A Daten/Fax
 A:_INDF
 T:*/*=5.267328(60)/0.7	# 4.5408 +16%
-Z:38 Iridium
+Z:32 Iridium
 A:_IR16,_IR17
 T:*/*=4.5936(60)/0.8	# 3.9600 +16%
-# FIXME: fehlt in country-de.dat [22-Nov-2001]
-# Z:39 GeoVerse
-# A:+88210
-# T:*/*=0.119944(60)/30	# 0.1034 +16%
+Z:33 GeoVerse
+A:_GEOV
+T:*/*=0.119944(60)/30	# 0.1034 +16%
+Z:34 Emsat
+A:_EMSA
+T:*/*=3.0624(60)/1.2	# 2.6400 +16%
+Z:35 Thuraya
+A:_THUR
+T:*/*=4.5936(60)/0.8	# 3.9600 +16%
 #
 Z:40 Auskunft DTAG Inland
-A:11833,11836,11837
+A:11833,11836,11837 	# auf deutsch, trkisch und englisch
 T:*/*=0.24998/0,0.098948/6 	# 0.2155 0.0853 +16%  FIXME: nach Weitervermittlung falsch
 Z:41 Auskunft DTAG Ausland
 A:11834
@@ -1646,7 +1169,7 @@
 A:01690,01691
 T:W/09-18=0.061248/20 Standard	# 0.0528 +16%
 T:W/18-09=0.061248/30 Spar	# 0.0528 +16%
-T:E,H/*=0.061248/30 Spar	# 0.0528 +16%
+T:E,H/*=0.061248/30 Spar 	# 0.0528 +16%  FIXME: gilt auch 24.12./31.12
 Z:61 Cityruf 01695-[12]
 A:016951,016952
 T:*/*=0.061248/5	# 0.0528 +16%
@@ -1657,7 +1180,7 @@
 A:01681
 T:W/09-18=0.734976/0,0/60 Standard	# 0.6336 +16%
 T:W/18-09=0.489984/0,0/60 Spar	# 0.4224 +16%
-T:E,H/*=0.489984/0,0/60 Spar	# 0.4224 +16%
+T:E,H/*=0.489984/0,0/60 Spar 	# 0.4224 +16%  FIXME: gilt auch 24.12./31.12
 Z:64 Scall 01696
 A:01696
 T:*/*=0.489984/0,0/60	# 0.4224 +16%
@@ -1689,7 +1212,8 @@
 T:*/*=0.119944/60	# 0.1034 +16%
 #
 Z:90 Premium Rate 0190-0
-A:01900
+# Entsprechend header ist 01900 keine Sonderrufnummer mehr.
+A:+491900
 T:*/*=5.00/60 variabel! 	# nach Ansage bzw. 0800-33-00900
 Z:91 Premium Rate 0190-[1235]
 A:01901,01902,01903,01905
@@ -1703,284 +1227,303 @@
 Z:94 Premium Rate 0190-8
 A:01908
 T:*/*=0.061828/2	# 0.0533 +16%
+Z:95 Premium Rate 0900
+A:09001,09003,09005
+T:*/*=5.00(60)/6 variabel!!
 #
 Z:100 T-Online
 # nur bei Tarif 'eco' oder 'DSL-flat' richtig, fr 'by call' s. u.
 A:0191011
-T:*/*=0.0148248/60 eco	# 0.01278 +16%
-# T-Online by call luft auch ber die 0191011, dann diese T-Zeile:
-# T:*/*=0.01993/60 by call 	# (Netto-DM-Preis / 1.95583 * 1.16)
+T:*/*=0.015892/60 eco o. dsl flat	# 0.01370 +16%
+# T-Online by call luft auch ber die 0191011, dann diese T-Zeilen:
+# T:*/*=0.019894/60 by call	# 0.01715 +16%
 #
-Z:160 T-VoteCall 0137-1
-A:01371
+Z:160 T-VoteCall 0137-[15]
+A:01371,01375
 T:*/*=0.119944/0,0/60	# 0.1034 +16%
 Z:161 T-VoteCall 0137-[234], 0138
 A:01372,01373,01374,0138
 T:*/*=0.119944/30,0.059972/30	# 0.1034 0.0517 +16%
-Z:162 T-VoteCall 0137-9
-A:01379
+Z:162 T-VoteCall 0137-6
+A:01376
+T:*/*=0.239888/0,0/60	# 0.2068 +16%
+Z:163 T-VoteCall 0137-7
+A:01377
+T:*/*=0.979968/0,0/60	# 0.8448 +16%
+Z:164 T-VoteCall 0137-[89]
+A:01378,01379
 T:*/*=0.489984/0,0/60	# 0.4224 +16%
 #
 Z:170 Persnliche Rufnummer
-A:0700
-T:W/09-18=0.061248/30	# 0.0528 +16%
-T:W/18-09=0.061248/60	# 0.0528 +16%
-T:E,H/*=0.061248/60	# 0.0528 +16%
+A:0700 	# FIXME: zumindest teilw. intern. erreichbar, aber N:0700 in header
+T:[-24.12.2003]W/09-18=0.061248/30	# 0.0528 +16%
+T:[-24.12.2003]W/18-09=0.061248/60	# 0.0528 +16%
+T:[-24.12.2003]E,H/*=0.061248/60	# 0.0528 +16%
+T:[24.12.2003-25.12.2003]*/*=0.61248/60 Heiligabend	# 0.528 +16%
+T:[25.12.2003-31.12.2003]W/09-18=0.061248/30	# 0.0528 +16%
+T:[25.12.2003-31.12.2003]W/18-09=0.061248/60	# 0.0528 +16%
+T:[25.12.2003-31.12.2003]E,H/*=0.061248/60	# 0.0528 +16%
+T:[31.12.2003-01.01.2004]*/*=0.61248/60 Silvester	# 0.528 +16%
+T:[01.01.2004]W/09-18=0.061248/30	# 0.0528 +16%
+T:[01.01.2004]W/18-09=0.061248/60	# 0.0528 +16%
+T:[01.01.2004]E,H/*=0.061248/60	# 0.0528 +16%
 #
 Z:171 Ansage Lotto/Zeit
 A:01162,01191
-T:*/*=0.061248/30	# 0.0528 +16%
+T:*/*=0.24592/60	# 0.2120 +16%
 #
-Z:250 Welt Mobilfunk 1
-A:_ESMF
-T:*/*=0.27086(60)/60	# 0.2335 +16%
-Z:251 Welt Mobilfunk 2
-# A:Andorra Mobilfunk
-A:_BEMF,_DKMF
-A:_FIMF,_IEMF,_ITMF
-# FIXME: Liechtenstein Mobilfunk: Alias in country falsch (=Liechtenstein)
+# Numerierung der Zonen fr Auslandsmobilfunk
+#    Z := 246 + 3*<Nr> + <*/**/***>
+#    z. B. 'Nr. 1 *' = 250 oder Nr. '11 ***' = 282
+Z:251 Welt Mobilfunk 1.2
+A:_ADMF
+A:_BEMF,_DKMF,_FIMF
+A:_IEMF,_ITMF
+A:_LIMF
 A:_LUMF
-# A:Malta Mobilfunk
-A:_MCMF,_NOMF,_ATMF
-# A:Vatikanstadt Mobilfunk
-T:*/*=0.342432(60)/60	# 0.2952 +16%
-Z:252 Welt Mobilfunk 3
-# A:Frer Mobilfunk
+A:_MTMF
+A:_MCMF,_NOMF
+A:_ATMF,_ESMF
+#A:Vatikanstadt Mobilfunk
+T:*/*=0.342432/60	# 0.1057+0.1895 +16%
+Z:252 Welt Mobilfunk 1.3
+A:_FOMF
 A:_FRMF,_UKMF
-# A:Insel Man Mobilfunk, Kanalinseln Mobilfunk
+A:_IMMF,_GGMF
 A:_NLMF
-# A:Nordirland Mobilfunk
-A:_PTMF,_SEMF,_CHMF
-T:*/*=0.372592(60)/60	# 0.3212 +16%
-Z:253 Welt Mobilfunk 4
+#A:Nordirland Mobilfunk
+A:_PTMF,_SEMF
+A:_CHMF
+T:*/*=0.372592/60	# 0.1057+0.2155 +16%
+Z:253 Welt Mobilfunk 2.1
 A:_TRMF,_HUMF
-T:*/*=0.393588(60)/60	# 0.3393 +16%
-# Z:254 Welt Mobilfunk 5
-# A:Bosnien und Herzegowina Mobilfunk
-# T:*/*=0.454952(60)/60	# 0.3922 +16%
-Z:255 Welt Mobilfunk 6
+T:*/*=0.393588/60	# 0.2115+0.1278 +16%
+Z:254 Welt Mobilfunk 2.2
 A:_GRMF,_ISMF
-# A: Jugoslawien Mobilfunk, Kroatien Mobilfunk
+#A:Jugoslawien Mobilfunk
+A:_HRMF
 A:_PLMF
-# A: Slowakai Mobilfunk, Slowenien Mobilfunk
+A:_SKMF,_SIMF
 A:_CZMF,_CYMF
-T:*/*=0.46516(60)/60	# 0.4010 +16%
-# Z:256 Welt Mobilfunk 7
-# A:Albanien Mobilfunk
-# T:*/*=0.526524(60)/60	# 0.4539 +16%
-Z:257 Welt Mobilfunk 8
+T:*/*=0.46516/60	# 0.2115+0.1895 +16%
+Z:256 Welt Mobilfunk 3.1
+A:_BAMF
+T:*/*=0.454952/60	# 0.2644+0.1278 +16%
+#Z:257 Welt Mobilfunk 3.2
+#A:Albanien Mobilfunk
+#T:*/*=0.526524/60	# 0.2644+0.1895 +16%
+Z:260 Welt Mobilfunk 4.2
 A:_RUMF
-T:*/*=0.551232(60)/6.67	# 0.4752 +16%
-# Z:258 Welt Mobilfunk 9
-# A:Bulgarien Mobilfunk, Mazedonien (ehemalige jugoslawische Republik) Mobilfunk
-# A:Ukraine Mobilfunk, Weirussland Mobilfunk
-# T:*/*=0.61248(60)/6	# 0.5280 +16%
-Z:259 Welt Mobilfunk 10
+T:*/*=0.559816/60	# 0.2931+0.1895 +16%
+Z:262 Welt Mobilfunk 5.1
+A:_MKMF,_UAMF
+T:*/*=0.53824/60	# 0.3362+0.1278 +16%
+Z:263 Welt Mobilfunk 5.2
+#A:Bulgarien Mobilfunk
 A:_ILMF,_ROMF
-T:*/*=0.673728(60)/5.46	# 0.5808 +16%
-Z:260 Welt Mobilfunk 11
+#A:Weirussland Mobilfunk
+T:*/*=0.609812/60	# 0.3362+0.1895 +16%
+Z:265 Welt Mobilfunk 6.1
 A:_EEMF
-# A:Lettland Mobilfunk
+#A:Lettland Mobilfunk
 A:_LBMF
-# A:Marokko Mobilfunk, Moldau (Republik) Mobilfunk
-T:*/*=0.734976(60)/5	# 0.6336 +16%
-# Z:261 Welt Mobilfunk 12
-# A:Litauen Mobilfunk
-# T:*/*=0.796224(60)/4.62	# 0.6864 +16%
-Z:262 Welt Mobilfunk 13
+A:_MAMF
+#A:Moldau (Republik) Mobilfunk
+T:*/*=0.738224/60	# 0.5086+0.1278 +16%
+Z:266 Welt Mobilfunk 6.2
+A:_LTMF
+T:*/*=0.809796/60	# 0.5086+0.1895 +16%
+Z:268 Welt Mobilfunk 7.1
 A:_AUMF,_HKMF
-T:*/*=0.91872(60)/4	# 0.7920 +16%
-Z:263 Welt Mobilfunk 14
-A:_TWMF,_JPMF,_KRMF
-T:*/*=0.979968(60)/3.75	# 0.8448 +16%
-# Z:264 Welt Mobilfunk 15
-# A:Kasachstan Mobilfunk
-# T:*/*=1.041216(60)/3.53	# 0.8976 +16%
-Z:265 Welt Mobilfunk 16
-A:_BRMF,_SGMF
-T:*/*=1.22496(60)/3	# 1.0560 +16%
-Z:266 Welt Mobilfunk 17
+#A:Kasachstan Mobilfunk
+A:_SGMF
+T:*/*=0.938208/60	# 0.6810+0.1278 +16%
+Z:269 Welt Mobilfunk 7.2
+A:_BRMF,_TWMF,_JPMF
+A:_KRMF
+T:*/*=1.00978/60	# 0.6810+0.1895 +16%
+Z:272 Welt Mobilfunk 8.2
 A:_NZMF
-T:*/*=1.286208(60)/2.86	# 1.1088 +16%
-Z:267 Welt Mobilfunk 18
+T:*/*=1.209764/60	# 0.8534+0.1895 +16%
+Z:274 Welt Mobilfunk 9.1
 A:_CLMF,_CNMF
-# A:Georgien Mobilfunk
-T:*/*=1.347456(60)/2.73	# 1.1616 +16%
-Z:268 Welt Mobilfunk 19
-A:_COMF,_PHMF,_ZAMF
-T:*/*=1.5312(60)/2.40	# 1.3200 +16%
-Z:269 Welt Mobilfunk 20
+#A:Georgien Mobilfunk
 A:_MYMF
-T:*/*=1.653696(60)/2.23	# 1.4256 +16%
-Z:270 Welt Mobilfunk 21
-# A:Armenien Mobilfunk, Aruba Mobilfunk, Aserbaidschan Mobilfunk
-# A:Bahrain Mobilfunk, Bolivien Mobilfunk
-# A:Brunei Darussalam Mobilfunk, Burkino Faso Mobilfunk,
+T:*/*=1.409748/60	# 1.0258+0.1895 +16%
+Z:275 Welt Mobilfunk 9.2
+A:_ZAMF
+T:*/*=1.338176/60	# 1.0258+0.1278 +16%
+Z:277 Welt Mobilfunk 10.1
+A:_COMF,_PHMF
+T:*/*=1.53816/60	# 1.1982+0.1278 +16%
+Z:280 Welt Mobilfunk 11.1
+A:_AMMF,_AWMF,_AZMF
+#A:Bahrain Mobilfunk
+A:_BOMF
+#A:Brunei Darussalam Mobilfunk
+A:_BFMF
 A:_ECMF
-# A:Gabun Mobilfunk, Kamerun Mobilfunk
+#A:Gabun Mobilfunk
+A:_CMMF
 A:_KGMF
-# A:Kuba Mobilfunk, Myanmar Mobilfunk
+A:_CUMF
+#A:Myanmar Mobilfunk
 A:_PAMF
-# A:Sambia Mobilfunk, Tadschikistan Mobilfunk
+#A:Sambia Mobilfunk
+A:_TJMF
 A:_THMF
-# A:Turkmenistan Mobilfunk, Uganda Mobilfunk
-# A:Uruguay Mobilfunk, Usbekistan Mobilfunk, Vietnam Mobilfunk
-T:*/*=1.714944(60)/2.15	# 1.4784 +16%
-Z:271 Welt Mobilfunk 22
+#A:Turkmenistan Mobilfunk, Uganda Mobilfunk, Uruguay Mobilfunk
+#A:Usbekistan Mobilfunk, Vietnam Mobilfunk
+T:*/*=1.638152/60	# 1.2844+0.1278 +16%
+Z:281 Welt Mobilfunk 11.2
 A:_SVMF,_IDMF,_PEMF
 A:_VEMF
-T:*/*=1.776192(60)/2.07	# 1.5312 +16%
+T:*/*=1.709724/60	# 1.2844+0.1895 +16%
 #
-Z:280 Welt 1
+Z:301 Welt 1
 A:AD,BE,DK,FO,FI,FR
 A:GI,UK,_UKIM,IE,IT
 A:CA,_UKIK,LI,LU
 A:MT,MC,NL,_UKIR,NO
 A:AT,PT,PR,SM,SE
 A:CH,ES,VA,US
-T:*/*=0.122612(60)/60	# 0.1057 +16%
-Z:281 Welt 2
+T:*/*=0.122612/60	# 0.1057 +16%
+Z:302 Welt 2
 A:GR,IS,YU,HR,PL
 A:SK,SI,CZ,TR
 A:HU,CY
-T:*/*=0.24534(60)/60	# 0.2115 +16%
-Z:282 Welt 3
+T:*/*=0.24534/60	# 0.2115 +16%
+Z:303 Welt 3
 A:AL,BA
-T:*/*=0.306704(60)/60	# 0.2644 +16%
-Z:283 Welt 4
+T:*/*=0.306704/60	# 0.2644 +16%
+Z:304 Welt 4
 A:SU
-T:*/*=0.367488(60)/10	# 0.3168 +16%
-Z:284 Welt 5
-A:BG,BY
-T:*/*=0.428736(60)/8.6	# 0.3696 +16%
-Z:285 Welt 6
-A:IL,MK
-A:RO,UA
-T:*/*=0.489984(60)/7.5	# 0.4224 +16%
-Z:286 Welt 7
+T:*/*=0.339996/60	# 0.2931 +16%
+Z:305 Welt 5
+A:BG,IL,MK
+A:RO,UA,BY
+T:*/*=0.389992/60	# 0.3362 +16%
+Z:306 Welt 6
 A:EG,DZ,EE,JO,LV,LB
-A:LY,LT,EH
+A:LY,LT,MA
 A:MD,SY
 A:TN
-T:*/*=0.61248(60)/6	# 0.5280 +16%
-Z:287 Welt 8
-A:AU,TW,HK
-A:JP,KR
+T:*/*=0.589976/60	# 0.5086 +16%
+Z:307 Welt 7
+A:AU,BR,TW,HK
+A:JP,KZ,KR,SG
 A:AQ,NF
-T:*/*=0.796224(60)/4.62	# 0.6864 +16%
-Z:288 Welt 9
-A:KZ
-T:*/*=0.91872(60)/4	# 0.7920 +16%
-Z:289 Welt 10
-A:BR,DO,MX
+T:*/*=0.78996/60	# 0.6810 +16%
+Z:308 Welt 8
+A:DO,MX,NZ
 A:AN
-T:*/*=1.041216(60)/3.55	# 0.8976 +16%
-Z:290 Welt 11
-A:NZ,SG
-T:*/*=1.102464(60)/3.34	# 0.9504 +16%
-Z:291 Welt 12
-A:AR,CL,CN,GE,LS
-T:*/*=1.22496(60)/3	# 1.0560 +16%
-Z:292 Welt 13
-A:ZA
-T:*/*=1.347456(60)/2.73	# 1.1616 +16%
-Z:293 Welt 14
+T:*/*=0.989944/60	# 0.8534 +16%
+Z:309 Welt 9
+A:AR,CL,CN,GE,LS,MY,ZA
+T:*/*=1.189928/60	# 1.0258 +16%
+Z:310 Welt 10
 A:IR,CO,PH
 A:SA,AE
-T:*/*=1.408704(60)/2.61	# 1.2144 +16%
-Z:294 Welt 15
-A:MY
-T:*/*=1.5312/2.4	# 1.3200 +16%
-Z:295 Welt 16 (andere)
-A:+
-T:*/*=1.592448(60)/2.31	# 1.3728 +16%
+T:*/*=1.389912/60	# 1.1982 +16%
+Z:311 Welt 11 (andere)
+A:+ 	# evtl. zu umfassend
+A:FK,GU,KY,RE,SH
+A:PM
+T:*/*=1.489904/60	# 1.2844 +16%
 #
 #####################################################################
-P:33,1 DTAG T-ISDN 300
-# Dieser Tarif gilt auch bei AktivPlus
+P:33,1 DTAG AktivPlus
+# Dieser Tarif gilt auch bei T-ISDN 300 (wird nicht angeboten)
+# AktivPlus basis ist ein anderer Tarife (siehe weiter unten)
 B:01033
-# G:26-Dec-2001
+# G:01-Jan-2003
 D:dtag
 C:Name:Deutsche Telekom AG AktivPlus
 C:Address:Deutsche Telekom AG, Friedrich-Ebert-Allee 140, 53113 Bonn
 C:Homepage:http://www.dtag.de
 C:Hotline:0800/33-01000, T-Online Tarifhotline: 0800/33-03333
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-C:Quelle:"Preisliste T-ISDN 300", Stand 2002-02-25
-C:Quelle:http://www.telekom.de/dtag/agb/produkte?nr=ISDN300c
-# C:Quelle:http://www.telekom.de/dtag/agb/dokument/pdf/0,1384,107,00.pdf
-C:Grundgebhr zustzlich fr diesen Tarif: 9,90 DM / Monat
+C:Quelle:"Preisliste AktivPlus", Stand 2003-01-01
+C:Quelle:http://www.dtag.de/dtag/agb/dokument/pdf/0,1384,746,00.pdf
+C:Grundgebhr zustzlich fr diesen Tarif: 5,06 EUR/Monat (bei T-ISDN)
 C:Euro
 C:Erfasste Zonen:
 C:   1 -   4 Deutschland
 C:  10 -  12 Mobilfunk
 C: 200 - 209 Ausland Mobilfunk AktivPlus
 C: 220 - 225 Ausland AktivPlus
-C: 254 - 271 Ausland Mobilfunk
-C: 282 - 295 Ausland
+C: 256 - 281 Ausland Mobilfunk
+C: 303 - 311 Ausland
 # 250- manuell von (33,0) bernommen und um 200-225 ausgednnt, so keine Fehler-
-# meldungen und R-Tag auf 200- bei xxl (33,2) ist moeglich
-C:Uebernommene Zonen von DTAG T-ISDN Standard (33,0):
+# meldungen und R-Tag auf 200- bei xxl (33,2) ist mglich
+C:bernommene Zonen von DTAG T-ISDN Standard (33,0):
 C:   0       Freecall
-C:  31 - 171 nationale Dienste + Satellitenfunk
-R:33,0;0,31-171
+C:  20 - 171 nationale Dienste sowie Bndel- und Satellitenfunk
+R:33,0;0,20-171
 #
 Z:1-2 City
-A:01141
-A:0193066
-T:[-24.12.2002]W/09-18=0.030624/60 Tag	# 0.0264 +16%
-T:[-24.12.2002]W/18-09=0.015312/60 Spar	# 0.0132 +16%
-T:[-24.12.2002]E,H/*=0.015312/60 Spar	# 0.0132 +16%
-T:[24.12.2002-02.01.2003]*/*=0.015312/60 Weihnachten	# 0.0132 +16%
-T:[02.01.2003-]W/09-18=0.030624/60 Tag	# 0.0264 +16%
-T:[02.01.2003-]W/18-09=0.015312/60 Spar	# 0.0132 +16%
-T:[02.01.2003-]E,H/*=0.015312/60 Spar	# 0.0132 +16%
+A:01141 	# Auftragsstelle Dt. Telekom
+A:0193066 	# 'Online-Dienst'
+T:[-24.12.2003]W/07-18=0.030624/60 Tag	# 0.0264 +16%
+T:[-24.12.2003]W/18-07=0.015312/60 Spar	# 0.0132 +16%
+T:[-24.12.2003]E,H/*=0.015312/60 Spar	# 0.0132 +16%
+T:[24.12.2003-25.12.2003]*/*=0.015312/60 Heiligabend	# 0.0132 +16%
+T:[25.12.2003-31.12.2003]W/07-18=0.030624/60 Tag	# 0.0264 +16%
+T:[25.12.2003-31.12.2003]W/18-07=0.015312/60 Spar	# 0.0132 +16%
+T:[25.12.2003-31.12.2003]E,H/*=0.015312/60 Spar	# 0.0132 +16%
+T:[31.12.2003-01.01.2004]*/*=0.015312/60 Silvester	# 0.0132 +16%
+T:[01.01.2004]W/07-18=0.030624/60 Tag	# 0.0264 +16%
+T:[01.01.2004]W/18-07=0.015312/60 Spar	# 0.0132 +16%
+T:[01.01.2004]E,H/*=0.015312/60 Spar	# 0.0132 +16%
 Z:3-4 Deutschland
 A:DE
-T:[-24.12.2002]W/09-18=0.045936/60 Tag	# 0.0396 +16%
-T:[-24.12.2002]W/18-09=0.02552/60 Spar	# 0.0220 +16%
-T:[-24.12.2002]E,H/*=0.02552/60 Spar	# 0.0220 +16%
-T:[24.12.2002-02.01.2003]*/*=0.02552/60 Weihnachten	# 0.0220 +16%
-T:[02.01.2003-]W/09-18=0.045936/60 Tag	# 0.0396 +16%
-T:[02.01.2003-]W/18-09=0.02552/60 Spar	# 0.0220 +16%
-T:[02.01.2003-]E,H/*=0.02552/60 Spar	# 0.0220 +16%
+T:[-24.12.2003]W/07-18=0.045936/60 Tag	# 0.0396 +16%
+T:[-24.12.2003]W/18-07=0.02552/60 Spar	# 0.0220 +16%
+T:[-24.12.2003]E,H/*=0.02552/60 Spar	# 0.0220 +16%
+T:[24.12.2003-25.12.2003]*/*=0.02552/60 Heiligabend	# 0.0220 +16%
+T:[25.12.2003-31.12.2003]W/07-18=0.045936/60 Tag	# 0.0396 +16%
+T:[25.12.2003-31.12.2003]W/18-07=0.02552/60 Spar	# 0.0220 +16%
+T:[25.12.2003-31.12.2003]E,H/*=0.02552/60 Spar	# 0.0220 +16%
+T:[31.12.2003-01.01.2004]*/*=0.02552/60 Silvester	# 0.0220 +16%
+T:[01.01.2004]W/07-18=0.045936/60 Tag	# 0.0396 +16%
+T:[01.01.2004]W/18-07=0.02552/60 Spar	# 0.0220 +16%
+T:[01.01.2004]E,H/*=0.02552/60 Spar	# 0.0220 +16%
 #
-Z:10 Mobilfunknetz D1/D2
+Z:10 Mobilfunk D1/D2
 A:_DEMD1
 A:_DEMD2
 T:*/*=0.199404/60	# 0.1719 +16%
-Z:11 Mobilfunknetz E-Plus
+Z:11 Mobilfunk E1/E2
 A:_DEME1
-T:*/*=0.230028/60	# 0.1983 +16%
-Z:12 Mobilfunknetz E2/Quam
 A:_DEME2
-A:_DEMQ
 T:*/*=0.24534/60	# 0.2115 +16%
+Z:12 Mobilfunk Mobilcom
+A:_DEMM
+T:*/*=0.259956/60	# 0.2241 +16%
 #
 # 1.2 bedeutet in Preisliste Nr. 1 mit Fussnote ** fr Mobilfunkzuschlag usw.
-Z:200 Welt Mobilfunk AktivPlus 1.1
-A:_ESMF
-T:*/*=0.194184/60	# 0.0396+0.1278 +16%
-Z:201 Welt Mobilfunk AktivPlus 1.2
-# A:Andorra Mobilfunk
+Z:200 Welt Mobilfunk AktivPlus 1.2
+A:_ADMF
 A:_BEMF,_DKMF,_FIMF
 A:_IEMF,_ITMF
-# FIXME: Liechtenstein Mobilfunk: Alias in country falsch (=Liechtenstein)
-A:_LUMF
-# A:Malta Mobilfunk
-A:_MCMF,_NOMF,_ATMF
+A:_LIMF
+A:_LUMF,_MCMF,_NOMF
+A:_ATMF,_ESMF
 # A:Vatikanstadt Mobilfunk
 T:*/*=0.265756/60	# 0.0396+0.1895 +16%
-Z:202 Welt Mobilfunk AktivPlus 1.3
-# A:Frer Mobilfunk
+Z:201 Welt Mobilfunk AktivPlus 1.3
 A:_FRMF,_UKMF
-# A:Insel Man Mobilfunk, Kanalinseln Mobilfunk
+A:_IMMF,_GGMF
 A:_NLMF
 # A:Nordirland Mobilfunk
 A:_SEMF,_CHMF
 T:*/*=0.295916/60	# 0.0396+0.2155 +16%
+Z:202 Welt Mobilfunk AktivPlus 2.2
+A:_MTMF
+T:*/*=0.316912/60	# 0.0837+0.1895 +16%
 Z:203 Welt Mobilfunk AktivPlus 2.3
+A:_FOMF
 A:_PTMF
 T:*/*=0.347072/60	# 0.0837+0.2155 +16%
 Z:204 Welt Mobilfunk AktivPlus 3.2
@@ -1990,31 +1533,31 @@
 A:_TRMF,_HUMF
 T:*/*=0.347652/60	# 0.1719+0.1278 +16%
 Z:206 Welt Mobilfunk AktivPlus 4.2
-# A:Jugoslawien Mobilfunk, Kroatien Mobilfunk
+#A:Jugoslawien Mobilfunk
+A:_HRMF
 A:_PLMF
-# A:Slowakei Mobilfunk, Slowenien Mobilfunk
+A:_SKMF,_SIMF
 A:_CYMF
 T:*/*=0.419224/60	# 0.1719+0.1895 +16%
-# Z:207 Welt Mobilfunk AktivPlus 5.1
-# A:Ukraine Mobilfunk
-# T:*/*=0.449848/60	# 0.2600+0.1278 +16%
+Z:207 Welt Mobilfunk AktivPlus 5.1
+A:_UAMF
+T:*/*=0.449848/60	# 0.2600+0.1278 +16%
 Z:208 Welt Mobilfunk AktivPlus 5.2
 A:_RUMF
 # A: Weirussland Mobilfunk
 T:*/*=0.52142/60	# 0.2600+0.1895 +16%
-# Z:209 Welt Mobilfunk AktivPlus 6.1
-# A:Kasachstan Mobilfunk
-# T:*/*=0.6032/60	# 0.3922+0.1278 +16%
+#Z:209 Welt Mobilfunk AktivPlus 6.1
+#A:Kasachstan Mobilfunk
+#T:*/*=0.6032/60	# 0.3922+0.1278 +16%
 #
 Z:220 Welt AktivPlus 1
-A:AD,BE,DK,FO,FI,FR
-A:GI,UK,_UKIM,IE,IT,CA
-A:_UKIK,LI,LU,MT,MC,NL
-A:_UKIR,NO,AT,SM
-A:SE,CH,ES,VA,US
+A:AD,BE,DK,FI,FR,UK,_UKIM
+A:IE,IT,CA,_UKIK,LI,LU,MC
+A:NL,_UKIR,NO,AT,SM,SE,CH
+A:ES,VA,US
 T:*/*=0.045936/60	# 0.0396 +16%
 Z:221 Welt AktivPlus 2
-A:PT,PR
+A:FO,GI,MT,PT,PR
 T:*/*=0.097092/60	# 0.0837 +16%
 Z:222 Welt AktivPlus 3
 A:GR,IS,CZ
@@ -2030,194 +1573,279 @@
 A:KZ
 T:*/*=0.454952/60	# 0.3922 +16%
 #
-# Z:254 Welt Mobilfunk 5
-# A:Bosnien und Herzegowina Mobilfunk
-# T:*/*=0.454952(60)/60	# 0.3922 +16%
-# Z:256 Welt Mobilfunk 7
-# A:Albanien Mobilfunk
-# T:*/*=0.526524(60)/60	# 0.4539 +16%
-# Z:258 Welt Mobilfunk 9
-# A:Bulgarien Mobilfunk, Mazedonien (ehemalige jugoslawische Republik) Mobilfunk
-# T:*/*=0.61248(60)/6	# 0.5280 +16%
-Z:259 Welt Mobilfunk 10
+#r:33,0;250-
+Z:256 Welt Mobilfunk 3.1
+A:_BAMF
+T:*/*=0.454952/60	# 0.2644+0.1278 +16%
+#Z:257 Welt Mobilfunk 3.2
+#A:Albanien Mobilfunk
+#T:*/*=0.526524/60	# 0.2644+0.1895 +16%
+Z:262 Welt Mobilfunk 5.1
+A:_MKMF
+T:*/*=0.53824/60	# 0.3362+0.1278 +16%
+Z:263 Welt Mobilfunk 5.2
+#A:Bulgarien Mobilfunk
 A:_ILMF,_ROMF
-T:*/*=0.673728(60)/5.46	# 0.5808 +16%
-Z:260 Welt Mobilfunk 11
+T:*/*=0.609812/60	# 0.3362+0.1895 +16%
+Z:265 Welt Mobilfunk 6.1
 A:_EEMF
-# A:Lettland Mobilfunk
+#A:Lettland Mobilfunk
 A:_LBMF
-# A:Marokko Mobilfunk, Moldau (Republik) Mobilfunk
-T:*/*=0.734976(60)/5	# 0.6336 +16%
-# Z:261 Welt Mobilfunk 12
-# A:Litauen Mobilfunk
-# T:*/*=0.796224(60)/4.62	# 0.6864 +16%
-Z:262 Welt Mobilfunk 13
+A:_MAMF
+#A:Moldau (Republik) Mobilfunk
+T:*/*=0.738224/60	# 0.5086+0.1278 +16%
+Z:266 Welt Mobilfunk 6.2
+A:_LTMF
+T:*/*=0.809796/60	# 0.5086+0.1895 +16%
+Z:268 Welt Mobilfunk 7.1
 A:_AUMF,_HKMF
-T:*/*=0.91872(60)/4	# 0.7920 +16%
-Z:263 Welt Mobilfunk 14
-A:_TWMF,_JPMF,_KRMF
-T:*/*=0.979968(60)/3.75	# 0.8448 +16%
-Z:265 Welt Mobilfunk 16
-A:_BRMF,_SGMF
-T:*/*=1.22496(60)/3	# 1.0560 +16%
-Z:266 Welt Mobilfunk 17
+A:_SGMF
+T:*/*=0.938208/60	# 0.6810+0.1278 +16%
+Z:269 Welt Mobilfunk 7.2
+A:_BRMF,_TWMF,_JPMF
+A:_KRMF
+T:*/*=1.00978/60	# 0.6810+0.1895 +16%
+Z:272 Welt Mobilfunk 8.2
 A:_NZMF
-T:*/*=1.286208(60)/2.86	# 1.1088 +16%
-Z:267 Welt Mobilfunk 18
+T:*/*=1.209764/60	# 0.8534+0.1895 +16%
+Z:274 Welt Mobilfunk 9.1
 A:_CLMF,_CNMF
-# A:Georgien Mobilfunk
-T:*/*=1.347456(60)/2.73	# 1.1616 +16%
-Z:268 Welt Mobilfunk 19
-A:_COMF,_PHMF,_ZAMF
-T:*/*=1.5312(60)/2.40	# 1.3200 +16%
-Z:269 Welt Mobilfunk 20
+#A:Georgien Mobilfunk
 A:_MYMF
-T:*/*=1.653696(60)/2.23	# 1.4256 +16%
-Z:270 Welt Mobilfunk 21
-# A:Armenien Mobilfunk, Aruba Mobilfunk, Aserbaidschan Mobilfunk
-# A:Bahrain Mobilfunk, Bolivien Mobilfunk
-# A:Brunei Darussalam Mobilfunk, Burkino Faso Mobilfunk,
+T:*/*=1.409748/60	# 1.0258+0.1895 +16%
+Z:275 Welt Mobilfunk 9.2
+A:_ZAMF
+T:*/*=1.338176/60	# 1.0258+0.1278 +16%
+Z:277 Welt Mobilfunk 10.1
+A:_COMF,_PHMF
+T:*/*=1.53816/60	# 1.1982+0.1278 +16%
+Z:280 Welt Mobilfunk 11.1
+A:_AMMF,_AWMF,_AZMF
+#A:Bahrain Mobilfunk
+A:_BOMF
+#A:Brunei Darussalam Mobilfunk
+A:_BFMF
 A:_ECMF
-# A:Gabun Mobilfunk, Kamerun Mobilfunk
+#A:Gabun Mobilfunk
+A:_CMMF
 A:_KGMF
-# A:Kuba Mobilfunk, Myanmar Mobilfunk
+A:_CUMF
+#A:Myanmar Mobilfunk
 A:_PAMF
-# A:Sambia Mobilfunk, Tadschikistan Mobilfunk
+#A:Sambia Mobilfunk
+A:_TJMF
 A:_THMF
-# A:Turkmenistan Mobilfunk, Uganda Mobilfunk
-# A:Uruguay Mobilfunk, Usbekistan Mobilfunk, Vietnam Mobilfunk
-T:*/*=1.714944(60)/2.15	# 1.4784 +16%
-Z:271 Welt Mobilfunk 22
+#A:Turkmenistan Mobilfunk, Uganda Mobilfunk, Uruguay Mobilfunk
+#A:Usbekistan Mobilfunk, Vietnam Mobilfunk
+T:*/*=1.638152/60	# 1.2844+0.1278 +16%
+Z:281 Welt Mobilfunk 11.2
 A:_SVMF,_IDMF,_PEMF
 A:_VEMF
-T:*/*=1.776192(60)/2.07	# 1.5312 +16%
+T:*/*=1.709724/60	# 1.2844+0.1895 +16%
 #
-Z:282 Welt 3
+Z:303 Welt 3
 A:AL,BA
-T:*/*=0.306704(60)/60	# 0.2644 +16%
-Z:284 Welt 5
-A:BG
-T:*/*=0.428736(60)/8.6	# 0.3696 +16%
-Z:285 Welt 6
-A:IL,MK
+T:*/*=0.306704/60	# 0.2644 +16%
+Z:305 Welt 5
+A:BG,IL,MK
 A:RO
-T:*/*=0.489984(60)/7.5	# 0.4224 +16%
-Z:286 Welt 7
+T:*/*=0.389992/60	# 0.3362 +16%
+Z:306 Welt 6
 A:EG,DZ,EE,JO,LV,LB
-A:LY,LT,EH
+A:LY,LT,MA
 A:MD,SY
 A:TN
-T:*/*=0.61248(60)/6	# 0.5280 +16%
-Z:287 Welt 8
+T:*/*=0.589976/60	# 0.5086 +16%
+Z:307 Welt 7
 A:AU,TW,HK
-A:JP,KR
+A:JP,KR,SG
 A:AQ,NF
-T:*/*=0.796224(60)/4.62	# 0.6864 +16%
-Z:289 Welt 10
-A:BR,DO,MX
+T:*/*=0.78996/60	# 0.6810 +16%
+Z:308 Welt 8
+A:BR,DO,MX,NZ
 A:AN
-T:*/*=1.041216(60)/3.55	# 0.8976 +16%
-Z:290 Welt 11
-A:NZ,SG
-T:*/*=1.102464(60)/3.34	# 0.9504 +16%
-Z:291 Welt 12
-A:AR,CL,CN,GE,LS
-T:*/*=1.22496(60)/3	# 1.0560 +16%
-Z:292 Welt 13
-A:ZA
-T:*/*=1.347456(60)/2.73	# 1.1616 +16%
-Z:293 Welt 14
+T:*/*=0.989944/60	# 0.8534 +16%
+Z:309 Welt 9
+A:AR,CL,CN,GE,LS,MY,ZA
+T:*/*=1.189928/60	# 1.0258 +16%
+Z:310 Welt 10
 A:IR,CO,PH
 A:SA,AE
-T:*/*=1.408704(60)/2.61	# 1.2144 +16%
-Z:294 Welt 15
-A:MY
-T:*/*=1.5312/2.4	# 1.3200 +16%
-Z:295 Welt 16 (andere)
-A:+
-T:*/*=1.592448(60)/2.31	# 1.3728 +16%
+T:*/*=1.389912/60	# 1.1982 +16%
+Z:311 Welt 11 (andere)
+A:+ 	# evtl. zu umfassend
+A:FK,GU,KY,RE,SH
+A:PM
+T:*/*=1.489904/60	# 1.2844 +16%
+# /r:33,0;250-
 #
 #####################################################################
-P:33,2 DTAG T-ISDN xxl
+P:33,2 DTAG AktivPlus xxl
 B:01033
-# G:01-Jun-2000
+# G:01-Jan-2003
 D:dtag
 C:Name:Deutsche Telekom AG AktivPlus xxl
 C:Address:Deutsche Telekom AG, Friedrich-Ebert-Allee 140, 53113 Bonn
 C:Homepage:http://www.dtag.de
 C:Hotline:0800/33-01000, T-Online Tarifhotline: 0800/33-03333
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-C:Quelle:"Preisliste T-ISDN xxl", Stand 2002-02-25
-C:Quelle:http://www.telekom.de/dtag/agb/dokument/pdf/0,1384,142,00.pdf
-C:Tarif gilt nur in Verbindung mit T-ISDN xxl Anschluss fr min. 31,28 EUR/Monat.
+C:Quelle:"Preisliste AktivPlus xxl", Stand 2003-01-01
+C:Quelle:http://www.telekom.de/dtag/agb/dokument/pdf/0,1384,750,00.pdf
+C:Grundgebhr zustzlich gegenber Standard-ISDN: 7,61 EUR/Monat.
 C:Euro
 C:Erfasste Zonen:
 C:   1 -   4 Deutschland
 C: 180       Auftragsdienst DTAG (01141)
-C:Uebernommene Zonen von DTAG T-ISDN Standard (33,0):
+C:bernommene Zonen von DTAG T-ISDN Standard (33,0):
 C:   0       Freecall
-C:  31 - 171 nationale Dienste + Satellitenfunk
-C:Uebernommene Zonen von DTAG T-ISDN 300 (33,1):
+C:  25 - 171 nationale Dienste sowie Bndel- und Satellitenfunk
+C:bernommene Zonen von DTAG T-ISDN 300 (33,1):
 C:  10 -  12 Mobilfunk
 C: 200 -     Ausland
-R:33,0;0,31-171
+R:33,0;0,25-171
 R:33,1;10-12,200-
 #
 Z:1-2 City
-A:0193066
-T:[-24.12.2002]W/09-18=0.030624/60 Tag	# 0.0264 +16%
-T:[-24.12.2002]W/18-09=0.015312/60 Spar	# 0.0132 +16%
-T:[-24.12.2002]6/*=0.015312/60 Spar	# 0.0132 +16%
-T:[-24.12.2002]7,H/*=0/60 xxl unentgeltlich
-T:[24.12.2002-02.01.2003]W,6/*=0.015312/60 Weihnachten	# 0.0132 +16%
-T:[24.12.2002-02.01.2003]7,H/*=0/60 xxl unentgeltlich
-T:[02.01.2003-]W/09-18=0.030624/60 Tag	# 0.0264 +16%
-T:[02.01.2003-]W/18-09=0.015312/60 Spar	# 0.0132 +16%
-T:[02.01.2003-]6/*=0.015312/60 Spar	# 0.0132 +16%
-T:[02.01.2003-]7,H/*=0/60 xxl unentgeltlich
+A:0193066 	# 'Online-Dienst'
+T:[-24.12.2003]W/07-18=0.030624/60 Tag	# 0.0264 +16%
+T:[-24.12.2003]W/18-07=0.015312/60 Spar	# 0.0132 +16%
+T:[-24.12.2003]6/*=0.015312/60 Spar	# 0.0132 +16%
+T:[-24.12.2003]7,H/*=0/60 xxl unentgeltlich
+T:[24.12.2003-25.12.2003]W,6/*=0.015312/60 Heiligabend	# 0.0132 +16%
+T:[24.12.2003-25.12.2003]7,H/*=0/60 xxl unentgeltlich
+T:[25.12.2003-31.12.2003]W/07-18=0.030624/60 Tag	# 0.0264 +16%
+T:[25.12.2003-31.12.2003]W/18-07=0.015312/60 Spar	# 0.0132 +16%
+T:[25.12.2003-31.12.2003]6/*=0.015312/60 Spar	# 0.0132 +16%
+T:[25.12.2003-31.12.2003]7,H/*=0/60 xxl unentgeltlich
+T:[31.12.2003-01.01.2004]W,6/*=0.015312/60 Silvester	# 0.0132 +16%
+T:[31.12.2003-01.01.2004]7,H/*=0/60 xxl unentgeltlich
+T:[01.01.2004]W/07-18=0.030624/60 Tag	# 0.0264 +16%
+T:[01.01.2004]W/18-07=0.015312/60 Spar	# 0.0132 +16%
+T:[01.01.2004]6/*=0.015312/60 Spar	# 0.0132 +16%
+T:[01.01.2004]7,H/*=0/60 xxl unentgeltlich
 Z:3-4 Deutschland
 A:DE
-T:[-24.12.2002]W/09-18=0.045936/60 Tag	# 0.0396 +16%
-T:[-24.12.2002]W/18-09=0.02552/60 Spar	# 0.0220 +16%
-T:[-24.12.2002]6/*=0.02552/60 Spar	# 0.0220 +16%
-T:[-24.12.2002]7,H/*=0/60 xxl unentgeltlich
-T:[24.12.2002-02.01.2003]W,6/*=0.02552/60 Weihnachten	# 0.0220 +16%
-T:[24.12.2002-02.01.2003]7,H/*=0/60 xxl unentgeltlich
-T:[02.01.2003-]W/09-18=0.045936/60 Tag	# 0.0396 +16%
-T:[02.01.2003-]W/18-09=0.02552/60 Spar	# 0.0220 +16%
-T:[02.01.2003-]6/*=0.02552/60 Spar	# 0.0220 +16%
-T:[02.01.2003-]7,H/*=0/60 xxl unentgeltlich
+T:[-24.12.2003]W/07-18=0.045936/60 Tag	# 0.0396 +16%
+T:[-24.12.2003]W/18-07=0.02552/60 Spar	# 0.0220 +16%
+T:[-24.12.2003]6/*=0.02552/60 Spar	# 0.0220 +16%
+T:[-24.12.2003]7,H/*=0/60 xxl unentgeltlich
+T:[24.12.2003-25.12.2003]W,6/*=0.02552/60 Heiligabend	# 0.0220 +16%
+T:[24.12.2003-25.12.2003]7,H/*=0/60 xxl unentgeltlich
+T:[25.12.2003-31.12.2003]W/07-18=0.045936/60 Tag	# 0.0396 +16%
+T:[25.12.2003-31.12.2003]W/18-07=0.02552/60 Spar	# 0.0220 +16%
+T:[25.12.2003-31.12.2003]6/*=0.02552/60 Spar	# 0.0220 +16%
+T:[25.12.2003-31.12.2003]7,H/*=0/60 xxl unentgeltlich
+T:[31.12.2003-01.01.2004]W,6/*=0.02552/60 Silvester	# 0.0220 +16%
+T:[31.12.2003-01.01.2004]7,H/*=0/60 xxl unentgeltlich
+T:[01.01.2004]W/07-18=0.045936/60 Tag	# 0.0396 +16%
+T:[01.01.2004]W/18-07=0.02552/60 Spar	# 0.0220 +16%
+T:[01.01.2004]6/*=0.02552/60 Spar	# 0.0220 +16%
+T:[01.01.2004]7,H/*=0/60 xxl unentgeltlich
 #
 Z:180
-A:01141
-T:W/09-18=0.030624/60	# 0.0264 +16%
-T:W/18-09=0.015312/60	# 0.0132 +16%
-T:E,H/*=0.015312/60	# 0.0132 +16%
+A:01141 	# Auftragsdienst Dt. Telekom, bis auf 7,E = Tarifzone 1/City
+T:[-24.12.2003]W/07-18=0.030624/60 Tag	# 0.0264 +16%
+T:[-24.12.2003]W/18-07=0.015312/60 Spar	# 0.0132 +16%
+T:[-24.12.2003]E,H/*=0.015312/60 Spar	# 0.0132 +16%
+T:[24.12.2003-25.12.2003]*/*=0.015312/60 Heiligabend	# 0.0132 +16%
+T:[25.12.2003-31.12.2003]W/07-18=0.030624/60 Tag	# 0.0264 +16%
+T:[25.12.2003-31.12.2003]W/18-07=0.015312/60 Spar	# 0.0132 +16%
+T:[25.12.2003-31.12.2003]E,H/*=0.015312/60 Spar	# 0.0132 +16%
+T:[31.12.2003-01.01.2004]*/*=0.015312/60 Silvester	# 0.0132 +16%
+T:[01.01.2004]W/07-18=0.030624/60 Tag	# 0.0264 +16%
+T:[01.01.2004]W/18-07=0.015312/60 Spar	# 0.0132 +16%
+T:[01.01.2004]E,H/*=0.015312/60 Spar	# 0.0132 +16%
+#
+#####################################################################
+P:33,3 DTAG AktivPlus basis
+# hier nur nationale Festnetzverbindungen (Zone 1-4) vergnstigt
+B:01033
+# G:01-Sep-2002
+D:dtag
+C:Name:Deutsche Telekom AG AktivPlus basis
+C:Address:Deutsche Telekom AG, Friedrich-Ebert-Allee 140, 53113 Bonn
+C:Homepage:http://www.dtag.de
+C:Hotline:0800/33-01000, T-Online Tarifhotline: 0800/33-03333
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Quelle:"Preisliste AktivPlus basis", Stand 2002-09-01
+C:Quelle:http://www.dtag.de/dtag/agb/dokument/pdf/0,1384,748,00.pdf
+C:Grundgebhr zustzlich fr diesen Tarif: 2,51 EUR/Monat
+C:Euro
+C:Tarif bernimmt nationale Festnetzverbindungen von AktivPlus,
+C:sonstige Zonen von T-ISDN standard.
+R:33,0;0,10-
+R:33,1;1-4
 #
 #####################################################################
 #
 #
+P:39,0 01039 Call-Mc-Call
+B:01039
+# G:21-Nov-2000
+D:dtag
+C:Name:Launch Communication Services GmbH
+C:Address:Launch Communication Services GmbH, Lyoner Strae 51, 60528 Frankfurt/Main
+C:Homepage:http://www.first-telecom.de/
+C:Telefon: 0180-5-139513
+C:Telefax:+49 69 65006 300
+C:TarifURL:http://www.first-telecom.de/ftwebbase/tarife.wc
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Erfasste Zonen:
+C:2	-   4	Deutschland
+C:10		Mobilfunk
+C:200	-	Ausland
+Z:0 FreeCall
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
+T:*/*=0
+Z:1-4 Festnetz zu Festnetz
+A:+49
+T:*/*=0.059/60 Standard
+Z:10 Festnetz zu Mobilfunk
+A:_DEMD1	# D1
+A:_DEMD2	# D2
+A:_DEME1		# Eplus
+A:_DEME2		# E2
+T:*/*=0.24(60)/1
+Z:208 Dnemark
+A:DK
+T:*/*=0.034/60
+#####################################################################
+#
+#
 P:40,0 Ventelo
 B:01040
-# G:14-Feb-2000
+# G:20-Apr-2002
 D:dtag
-C:Ventelo Deutschland GmbH, Am Seestern 3, 40547 Dsseldorf
+C:Name:Ventelo CbC (01040)
+C:Address:Ventelo Deutschland GmbH, Am Seestern 3, 40547 Dsseldorf
+C:Homepage:http://www.ventelo.de/
+C:TarifURL:http://www.ventelo.de/html/call/standard.html
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
 C:Euro
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*                # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031*                # Testrufnummern
+A:110                 # Polizei
+A:112                 # Notruf, Feuerwehr
 T:*/*=0
 Z:2-4 Deutschland
 A:+49
 T:W/08-19=0.08/60 Hauptzeit
 T:W/19-21=0.05/60 Freizeit
-T:W/21-08=0.0219/60 Nebenzeit
-T:E,H/08-21=0.041/60 Wochenende
-T:E,H/21-08=0.0219/60 Wochenende
+T:[15.03.2003-01.04.2003]*/21-08=0.0174/60 Nebenzeit Sonderaktion
+T:[15.03.2003-01.04.2003]E,H/08-21=0.0184/60 Wochenende Sonderaktion
+T:[02.04.2003-19.04.2003]*/21-08=0.0210/60 Nebenzeit
+T:[02.04.2003]E,H/08-21=0.041/60 Wochenende
+T:[20.04.2003]*/21-08=0.0219/60 Nebenzeit
 Z:10 Mobilfunk
 A:_DEMD1
 A:_DEMD2
@@ -2229,198 +1857,1055 @@
 #####################################################################
 #
 #
-# P:50 Talkline
-# B:01050
-# C:PS PhoneServices GmbH, Adenauer Damm 1, 25337 Elmshorn 01050
-# C:Homepage:	http://www.null1050.de (??)
-# C:oder:  	http://www.talkline.de
-# C:Hotline:  01802/2002
-# C:Faxabruf: 01802/2001
+P:41,0 HanseNet CbC
+B:01041
+D:dtag
+C:Name:HanseNet CbC
+C:Address:HanseNet Telekommunikation GmbH, Hammerbrookstr. 63, 20097 Hamburg
+C:Telefon:0800-4110411
+C:Telefax:0800-4120412
+C:EMail:info@hansenet.com
+C:Homepage:http://www.hansenet.de/
+C:TarifURL:http://w1.hansenet.de/hnet2001/1,1346,callbycall-5590,00.html?typ=pv
+# G:01-Mar-2003
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Regionales Angebot fr Hamburg und angrenzende Ortsnetze.
+C:DTAG Entfernungszonen ungeprft angewandt.
+C:Abweichungen bei Heimatortsnetz ungleich 040 (Hamburg) wahrscheinlich.
+C:Erfasste Zonen:
+C:   0        Freephone
+C:   1 -   4  Deutschland
+C:  10        Mobilfunk
+C: 103        Internet by call
+C: 200 - 202  Ausland
+Z:0 FreeCall
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
+T:*/*=0
+Z:1-2 HanseNet City
+T:W/08-18=0.0249/60
+T:W/18-08=0.0164/60
+T:E,H/*=0.0164/60
+Z:3-4 Deutschland
+A:DE
+T:W/08-18=0.0699/60
+T:W/18-08=0.0219/60
+T:E,H/*=0.0219/60
+Z:10 Mobilfunk
+A:_DEMF
+T:W/08-18=0.4199/60
+T:W/18-08=0.2699/60
+T:E,H/*=0.2699/60
+#
+Z:103 Internet by call
+A:0192312
+T:*/*=0.0099/60 	# von auerhalb der Hansenet City-Zone teurer.
+#
+Z:200 Europa & Nordamerika
+A:AL,AD,BE,BA,BG,DK
+A:EE,FO,FI,FR,GI,GR
+A:UK,IE,IS,IL,IT,YU,CA
+A:HR,LV,LI,LT,LU,MT,MK
+A:MD,MC,NL,NO,AT,PL,PT
+A:RO,RU,SM,SE,CH
+A:SK,SI,ES,CZ,TR,UA
+A:HU,US,VA,BY,CY
+T:*/*=0.4199/60
+Z:201 Pazifik & Nordafrika
+A:DZ,AU,HK,JP,KR,LY,MY
+A:MA,NZ,SG,TN
+T:*/*=0.9299/60
+Z:202 Welt
+A:+
+T:*/*=1.4599/60
 #####################################################################
+P:41,1 HanseNet Preselection
+B:01041
+D:dtag
+C:Name:HanseNet Preselection privat
+C:Address:HanseNet Telekommunikation GmbH, Hammerbrookstr. 63, 20097 Hamburg
+C:Telefon:0800-4110411
+C:Telefax:0800-4120412
+C:EMail:info@hansenet.com
+C:Homepage:http://www.hansenet.de/
+C:TarifURL:http://w1.hansenet.de/hnet2001/1,1346,preselection-5598,00.html?typ=pv
+C:TarifURL:http://w1.hansenet.de/hnet/upload/material/3_preselection.pdf
+# G:01-Aug-2003
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Preselection
+C:Mindestumsatz 4,90 EUR/Monat.
+C:Regionales Angebot fr Hamburg und angrenzende Ortsnetze.
+C:Preselection fr Ortsgesprche nur in Hamburg, Ahrensburg, Aumhle, Seevetal,
+C:Quickborn, Siek, Rosengarten und Tangstedt.
+C:DTAG Entfernungszonen ungeprft angewandt.
+C:Abweichungen bei Heimatortsnetz ungleich 040 (Hamburg) wahrscheinlich.
+C:Erfasste Zonen:
+C:   1 -   4  Deutschland
+C:   5        HanseNet Partnercity
+C:  10 -  12  Mobilfunk
+C: 102        Internet
+C: 200 - 202  Europa Festnetz
+C: 205 - 206  Europa Mobilfunk
+C: 210 - 213  Welt
+R:41,0;0 	# Freephone variantenunabhngig
+Z:1-2 HanseNet City
+T:W/08-18=0.0299(60)/1
+T:W/18-08=0.0150(60)/1
+T:E,H/*=0.0150(60)/1
+Z:3 HanseNet Regio 	# ~ Regio 50 von +4940
+T:W/08-18=0.0599(60)/1
+T:W/18-08=0.0299(60)/1
+T:E,H/*=0.0299(60)/1
+Z:4 Deutschland
+A:DE
+T:W/08-18=0.0650(60)/1
+T:W/18-08=0.0299(60)/1
+T:E,H/*=0.0299(60)/1
+Z:5 HanseNet Partnercity
+# Dortmund, Dsseldorf, Kln, Oldenburg (Oldenburg), Stuttgart
+A:+49231,+49211,+49221,+49441,+49711
+T:W/08-18=0.0599(60)/1
+T:W/18-08=0.0299(60)/1
+T:E,H/*=0.0299(60)/1
+Z:10 Mobil
+A:_DEMF
+T:*/*=0.2500(60)/1
+#
+Z:102 Internet
+A:0192314
+T:*/*=0.0099(60)/1 	# ohne Preselection oder Komplettanschluss teurer
+#
+Z:200 Europa 1 Festnetz
+A:BE,DK,FI,FR,UK,_UKIR,IE
+A:IT,LI,LU,MC,NL,NO,AT
+A:SE,CH,ES
+T:*/*=0.0999(60)/1
+Z:201 Europa 2 Festnetz
+A:AD,EE,GR,IS,YU,HR,MT,PL
+A:PT,SK,SI,CZ,TR
+A:HU,VA
+T:*/*=0.1999(60)/1
+Z:202 Europa 3
+A:AL,BA,BG,FO,GI,IL,LV
+A:LT,MK
+A:MD
+A:RO
+# Russland mit den Vorwahlen 0070xx bis 0074xx und 0076xx bis 0079xx:
+A:+70,+71,+72,+73,+74,+76,+77,+78,+79
+A:SM,UA,BY,CY
+T:*/*=0.3499(60)/1
+Z:205 Europa 1 Mobilfunk
+A:_BEMF,_DKMF,_FIMF
+A:_FRMF,_UKMF
+#A:Nordirland Mobilfunk
+A:_ITMF,_LIMF,_LUMF
+A:_MCMF,_NLMF,_NOMF
+A:_ATMF,_SEMF,_CHMF
+A:_ESMF
+T:*/*=0.3499(60)/1
+Z:206 Europa 2 Mobilfunk
+A:_ADMF,_EEMF,_GRMF
+A:_ISMF
+#A:Jugoslawien Mobilfunk
+A:_HRMF,_MTMF,_PLMF
+A:_PTMF,_SKMF,_SIMF
+A:_CZMF,_TRMF,_HUMF
+#A:Vatikanstadt Mobilfunk
+T:*/*=0.3499(60)/1
+Z:210 Welt 1
+A:ALAS,_HAWA,CA,PR,US
+T:*/*=0.0999(60)/1
+Z:211 Welt 2
+A:DZ,AU,GL,HK,JP,KR,LY
+A:MY,MA,MX,NZ,SG,TW,TN
+T:*/*=0.6499(60)/1
+Z:212 Welt 3
+A:AR,AM,BS,BJ,BT,BR,CL,CR
+A:EC,GE,GT,KZ,KG,CO,MW
+A:NA,ZW,ZA,SD,SZ,TJ,TM
+A:UG,UY,UZ,VE
+T:*/*=0.9499(60)/1
+Z:213 Welt 4
+A:+
+# folgende Ziele wrden sonst unter USA (+1) fallen:
+A:JM,KN,TT,DO
+A:TC,VI,VG
+A:VC,DM,LC,MP,MS
+A:AG,AI,BB
+T:*/*=1.4499(60)/1
+#####################################################################
+P:41,2 HanseNet Komplett Standard
+B:01041
+D:dtag
+C:Name:HanseNet Komplett Standard privat
+C:Address:HanseNet Telekommunikation GmbH, Hammerbrookstr. 63, 20097 Hamburg
+C:Telefon:0800-4110411
+C:Telefax:0800-4120412
+C:EMail:info@hansenet.com
+C:Homepage:http://www.hansenet.de/
+C:TarifURL:http://w1.hansenet.de/hnet2001/1,1346,kp_pv-5624,00.html?typ=pv
+# G:01-Jun-2002
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Komplettanschluss
+C:Regionales Angebot fr Hamburg und angrenzende Ortsnetze.
+C:DTAG Entfernungszonen ungeprft angewandt.
+C:Abweichungen bei Heimatortsnetz ungleich 040 (Hamburg) wahrscheinlich.
+C:Erfasste Zonen:
+C:   1 -   4  Deutschland
+R:41,0;0 	# Freephone variantenunabhngig
+Z:1-2 HanseNet City
+T:W/08-18=0.0299(60)/1
+T:W/18-08=0.0150(60)/1
+T:E,H/*=0.0150(60)/1
+# ? Z:4 identisch mit 41,1, R-Tag fhrt aber zu Versagen von Z:1,
+#   vielleicht wegen dann fehlenden parent/country fr +4940.
+#   Regio 50 Verzonung fr Z:3 funktioniert ebenfalls nicht mit R-Tag
+Z:3 HanseNet Regio 	# ~ Regio 50 von +4940
+T:W/08-18=0.0599(60)/1
+T:W/18-08=0.0299(60)/1
+T:E,H/*=0.0299(60)/1
+Z:4 Deutschland
+A:DE
+T:W/08-18=0.0650(60)/1
+T:W/18-08=0.0299(60)/1
+T:E,H/*=0.0299(60)/1
+R:41,1;5- 	# ansonsten identisch zu Preselection
+#####################################################################
+P:41,3 HanseNet Komplett Profi
+B:01041
+D:dtag
+C:Name:HanseNet Komplett Profi privat
+C:Name:(gilt auch fr Telefonie bei) HanseNet Speed-Komplett privat
+C:Name:(gilt auch fr Telefonie bei) HanseNet Speed-Movie privat
+C:Address:HanseNet Telekommunikation GmbH, Hammerbrookstr. 63, 20097 Hamburg
+C:Telefon:0800-4110411
+C:Telefax:0800-4120412
+C:EMail:info@hansenet.com
+C:Homepage:http://www.hansenet.de/
+C:TarifURL:http://w1.hansenet.de/HNet2001/Produkte/Privat/kundenpreise_festnetz/1,1672,,00.html
+C:TarifURL:http://w1.hansenet.de/HNet2001/Produkte/Privat/kundenpreise_ausland/1,1673,,00.html
+# G:01-Mar-2003
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Komplettanschluss
+C:nicht erfasst: Sondertarife zu HanseNet Kunden mit gleichen Varianten
+C:Regionales Angebot fr Hamburg und angrenzende Ortsnetze.
+C:DTAG Entfernungszonen ungeprft angewandt.
+C:Abweichungen bei Heimatortsnetz ungleich 040 (Hamburg) wahrscheinlich.
+C:Erfasste Zonen:
+C:   1 -   4  Deutschland
+C:  10        Mobilfunk
+C: 200        Europa 1
+C: 210        Welt 1
+R:41,0;0 	# Freephone variantenunabhngig
+Z:1-2 HanseNet City
+T:W/08-18=0.0250(60)/1
+T:W/18-08=0.0150(60)/1
+T:E,H/*=0.0150(60)/1
+Z:3-4 Deutschland
+A:DE
+T:W/08-18=0.0399(60)/1
+T:W/18-08=0.0250(60)/1
+T:E,H/*=0.0250(60)/1
+Z:10 Mobilfunk
+A:_DEMF
+T:*/*=0.2200(60)/1
+Z:200 Europa 1 Festnetz
+A:BE,DK,FI,FR,UK,_UKIR,IE
+A:IT,LI,LU,MC,NL,NO,AT
+A:SE,CH,ES
+T:*/*=0.0499(60)/1
+Z:210 Welt 1
+A:ALAS,_HAWA,CA,PR,US
+T:*/*=0.0499(60)/1
+R:41,1;102,201-206,211-  	# ansonsten identisch zu Preselection
+#####################################################################
+#
+#
 P:50,0 Talkline ID CbC
 B:01050
 C:Name:Talkline ID GmbH
-C:Address:Talkline GmbH & Co. KG, Talkline-Platz 1, 25388 Elmshorn
-C:Homepage:http://www.talkline.de
-C:Telefon:01802 / 2002
-C:Telefax:01802 / 2001
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Address:Talkline ID GmbH, Willy-Brandt-Allee 20, 53113 Bonn
+C:Homepage:http://01050.com/
+C:Homepage:http://www.talkline-id.de/
+C:TarifURL:http://01050.denkwerk.com/tarife.html
+C:Telefon:0228-96972-0
+C:Telefax:0228-96972-20
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
 C:Euro
 C:Erfasste Zonen:
-C:   1 -   4	Deutschland
-C:  10 -  15	Mobilfunk
-C:  40		Talkline Auskunft
-C: 102		Internet Talkline By Call
-C: 200 - 	Ausland
+C:   2 -   4 Deutschland
+C:  10       Mobilfunk
 D:dtag
-# G:17-Jun-2002
+# G:17.04.2003 12:14
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:2-4 Fern
 A:DE
-T:W/07-18=0.082/60
-T:W/18-22=0.039/60
-T:W/22-07=0.019/60
-T:E,H/07-18=0.05/60
-T:E,H/18-22=0.039/60
-T:E,H/22-07=0.019/60
+T:1-5/00-07=0.027/60
+T:1-5/07-18=0.092/60
+T:1-5/18-21=0.023/60
+T:1-5/21-00=0.0164/60
+T:6-7/07-18=0.050/60
+T:6-7/18-22=0.039/60
+T:6-7/22-07=0.021/60
 Z:10 Mobil
-A:_DEMF
-T:*/*=0.185/60
+A:_DEMD1
+A:_DEMD2
+A:_DEME1
+A:_DEME2
+T:*/*=0.300/60
 #####################################################################
 #
 #
 P:51,0 01051
 B:01051
 C:ID-Switch GmbH, Graf-Adolf-Strae, 40210 Dsseldorf
-# G:18-Feb-2000
+# G:25-Apr-2003
 C:Homepage: http://www.01051.com
 C:Adresse:  ID-Switch GmbH, Koenigsallee 60f, 40210 Duesseldorf
 C:Name:01051
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:TarifURL:http://www.01051.com/tarifetextfile.php3
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
 C:Euro
 D:dtag
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
+Z:1 Ortsgesprche
+T:*/*=0.01/60 Einfhrungspreis
 Z:2-4 Ferngesprche
 A:DE
 T:*/*=0.036/60
 Z:10 Mobilfunk
 A:_DEMF
-T:*/*=0.2045/60
+T:*/*=0.205/60
 #####################################################################
 #
 #
 P:55,0 prompt
 B:01055
-# G:29-Dec-2001
-C:Address:prompt GmbH & C0. KG
-C:Name:prompt
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+# G:02-Jul-2003
+C:Name:prompt CbC
+C:Address:prompt GmbH & Co. KG, Wilhelm-Halle-Str. 50, 80639 Mnchen
+C:Telefon:01801-776678
+C:Telefax:01801-055329
+C:EMail:info@01055.com
+C:Homepage:http://www.01055-prompt.de/
+C:TarifURL:http://www.01055-prompt.de/upload/Tarif_CbC.pdf
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
 C:Euro
 D:dtag
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:2-4 Fern
 A:+49
-T:W/08-18=0.046/60 Standard
-T:W/18-08=0.024/60 Standard
-T:E,H/*=0.024/60 Spar
+T:W/08-18=0.046/60 Geschftszeit
+T:W/18-08=0.024/60 Freizeit
+T:E,H/*=0.024/60 Freizeit
 Z:10 Mobilfunk D1/D2
 A:_DEMD1
 A:_DEMD2
-T:*/*=0.1891/60
+T:*/*=0.1819/60
 Z:11 Mobilfunk E1/E2
 A:_DEME1
 A:_DEME2
-T:*/*=0.2147/60
+T:*/*=0.215/60
+#
+Z:200 Welt 1
+A:UK
+T:*/*=0.036/60
+Z:201 Welt 2
+A:SE,ES
+T:*/*=0.038/60
+Z:202 Welt 3
+A:IT,NL,AT
+T:*/*=0.039/60
+Z:203 Welt 4
+A:CA
+T:*/*=0.040/60
+Z:204 Welt 5
+A:CH
+T:*/*=0.041/60 vorbehaltlich anders lautender Tarifansage
+Z:205 Welt 6
+A:FR,LU,NO,US
+T:*/*=0.042/60
+Z:206 Welt 7
+A:DK
+T:*/*=0.043/60
+Z:207 Welt 8
+A:BE,IE,VA
+T:*/*=0.044/60
+Z:208 Welt 9
+A:AU,FI,NZ,PT
+T:*/*=0.049/60
+Z:209 Welt 10
+A:SG
+T:*/*=0.054/60
+Z:210 Welt 11
+A:CL,CN,JP
+T:*/*=0.059/60
+Z:211 Welt 12
+A:GR
+T:*/*=0.064/60
+Z:212 Welt 13
+A:PL
+T:*/*=0.066/60
+Z:213 Welt 14
+A:LI
+T:*/*=0.067/60
+Z:214 Welt 15
+A:EE,CZ
+T:*/*=0.069/60
+Z:215 Welt 16
+A:HR
+A:_HKMF
+T:*/*=0.070/60
+Z:216 Welt 17
+A:IL
+T:*/*=0.072/60
+Z:217 Welt 18
+A:_HAWA
+T:*/*=0.073/60
+Z:218 Welt 19
+A:TW
+T:*/*=0.078/60
+Z:219 Welt 20
+A:HK,KR,HU
+T:*/*=0.079/60
+Z:220 Welt 21
+A:SM
+T:*/*=0.080/60
+Z:221 Welt 22
+A:MY
+T:*/*=0.082/60
+Z:222 Welt 23
+A:SI
+T:*/*=0.084/60
+Z:223 Welt 24
+A:ALAS
+T:*/*=0.085/60
+Z:224 Welt 25
+A:SK
+T:*/*=0.087/60
+Z:225 Welt 26
+A:AR,SU,ZA
+T:*/*=0.089/60
+Z:226 Welt 27
+A:BR
+T:*/*=0.099/60
+Z:227 Welt 28
+A:_MYMF
+T:*/*=0.100/60
+Z:228 Welt 29
+A:_KRMF
+T:*/*=0.103/60
+Z:229 Welt 30
+A:IS
+T:*/*=0.105/60
+Z:230 Welt 31
+A:BG
+T:*/*=0.109/60
+Z:231 Welt 32
+A:MW,MC
+T:*/*=0.110/60
+Z:232 Welt 33
+A:CO
+T:*/*=0.112/60
+Z:233 Welt 34
+A:GE
+T:*/*=0.120/60
+Z:234 Welt 35
+A:CR,CY
+T:*/*=0.125/60
+Z:235 Welt 36
+A:LT
+T:*/*=0.128/60
+Z:236 Welt 37
+A:NA
+T:*/*=0.130/60
+Z:237 Welt 38
+A:DO
+T:*/*=0.145/60
+Z:238 Welt 39
+A:ID
+T:*/*=0.146/60
+Z:239 Welt 40
+A:LV
+T:*/*=0.149/60
+Z:240 Welt 41
+A:GI
+T:*/*=0.150/60
+Z:241 Welt 42
+A:RO,UZ
+A:_ILMF
+T:*/*=0.159/60
+Z:242 Welt 43
+A:DZ,SV
+T:*/*=0.160/60
+Z:243 Welt 44
+A:AD,YU
+T:*/*=0.162/60
+Z:244 Welt 45
+A:KZ
+T:*/*=0.166/60
+Z:245 Welt 46
+A:GN,KY,MX
+T:*/*=0.170/60
+Z:246 Welt 47
+A:TR
+T:*/*=0.173/60
+Z:247 Welt 48
+A:ZM
+T:*/*=0.175/60
+Z:248 Welt 49
+A:_CZMF
+T:*/*=0.177/60
+Z:249 Welt 50
+A:AL,BA,KG
+A:_LTMF
+T:*/*=0.179/60
+Z:250 Welt 51
+A:GH,MD
+T:*/*=0.180/60
+Z:251 Welt 52
+A:PE
+T:*/*=0.185/60
+Z:252 Welt 53
+A:BD,UA
+A:_TWMF
+T:*/*=0.189/60
+Z:253 Welt 54
+A:UG
+#A:Albanien Mobilfunk
+A:_SVMF,_JPMF
+A:_COMF
+T:*/*=0.190/60
+#Z:254 Welt 55
+#A:Uganda Mobilfunk
+#T:*/*=0.194/60
+Z:255 Welt 56
+A:LY
+T:*/*=0.196/60
+Z:256 Welt 57
+A:PH
+A:_IDMF,_UAMF
+T:*/*=0.198/60
+Z:257 Welt 58
+A:PR
+A:_BGMF,_GRMF,_NOMF
+A:_SKMF
+T:*/*=0.199/60
+Z:258 Welt 59
+A:_ISMF
+T:*/*=0.200/60
+Z:259 Welt 60
+A:_BAMF
+T:*/*=0.204/60
+Z:260 Welt 61
+A:_TRMF
+T:*/*=0.208/60
+Z:261 Welt 62
+A:BZ
+A:_DKMF
+T:*/*=0.210/60
+Z:262 Welt 63
+A:_AUMF
+T:*/*=0.213/60
+Z:263 Welt 64
+A:_DZMF,_BRMF,_PHMF
+A:_SEMF
+T:*/*=0.215/60
+Z:264 Welt 65
+A:IN
+A:_ESMF
+T:*/*=0.219/60
+Z:265 Welt 66
+A:LB,PY,TM
+A:_CLMF
+T:*/*=0.220/60
+Z:266 Welt 67
+A:_EGMF
+T:*/*=0.222/60
+Z:267 Welt 68
+A:EG
+A:_YUMF
+T:*/*=0.224/60
+Z:268 Welt 69
+A:UY
+T:*/*=0.225/60
+Z:269 Welt 70
+A:_FIMF,_SIMF
+T:*/*=0.228/60
+Z:270 Welt 71
+A:_ITMF,_HUMF
+T:*/*=0.229/60
+Z:271 Welt 72
+A:CG
+A:_BDMF,_IEMF,_NAMF
+#A:Sambia Mobilfunk
+T:*/*=0.230/60
+Z:272 Welt 73
+A:_PLMF
+T:*/*=0.234/60
+Z:273 Welt 74
+A:TJ
+A:_TNMF
+T:*/*=0.235/60
+Z:274 Welt 75
+A:FO
+T:*/*=0.237/60
+Z:275 Welt 76
+A:MK
+T:*/*=0.238/60
+Z:276 Welt 77
+A:PA
+A:_UKMF
+T:*/*=0.239/60
+Z:277 Welt 78
+A:HT,MN
+A:_ARMF
+#A:Kasachstan Mobilfunk, Turkmenistan Mobilfunk
+T:*/*=0.240/60
+Z:278 Welt 79
+A:_ATMF,_THMF
+T:*/*=0.243/60
+Z:279 Welt 80
+A:AM
+A:_ZWMF
+T:*/*=0.245/60
+Z:280 Welt 81
+A:BY
+T:*/*=0.247/60
+Z:281 Welt 82
+A:MA
+#A:Weiruland (Belarus) Mobilfunk
+T:*/*=0.248/60
+Z:282 Welt 83
+A:VE
+A:_BEMF,_FRMF,_ZAMF
+T:*/*=0.249/60
+Z:283 Welt 84
+A:AZ,EC,MQ,RW
+T:*/*=0.250/60
+Z:284 Welt 85
+A:BM,MT
+A:_ROMF
+T:*/*=0.255/60
+Z:285 Welt 86
+A:AE
+A:_KGMF
+T:*/*=0.259/60
+Z:286 Welt 87
+#A:Libyen Mobilfunk
+A:_PYMF
+T:*/*=0.260/60
+Z:287 Welt 88
+A:SA,TN
+A:_HRMF,_NZMF
+T:*/*=0.265/60
+Z:288 Welt 89
+A:GF,MG
+T:*/*=0.270/60
+Z:289 Welt 90
+A:_LVMF
+T:*/*=0.275/60
+Z:290 Welt 91
+A:GU
+T:*/*=0.276/60
+Z:291 Welt 92
+A:SN,CF
+A:_ADMF,_BMMF
+#A:Georgien Mobilfunk
+T:*/*=0.280/60
+Z:292 Welt 93
+A:BW
+T:*/*=0.281/60
+Z:293 Welt 94
+A:_TJMF
+T:*/*=0.285/60
+Z:294 Welt 95
+A:LS
+T:*/*=0.286/60
+Z:295 Welt 96
+A:AS
+T:*/*=0.287/60
+Z:296 Welt 97
+A:_EEMF
+T:*/*=0.288/60
+Z:297 Welt 98
+A:_MTMF,_PTMF
+T:*/*=0.289/60
+Z:298 Welt 99
+A:BH,BJ,BO,GA,GP,GT,LA,LR
+A:MZ
+A:_ECMF,_LUMF,_NLMF
+A:_CHMF
+#A:Uruguay Mobilfunk
+T:*/*=0.290/60
+Z:299 Welt 100
+A:AO,CI,PK,TH
+A:_JOMF,_SNMF
+T:*/*=0.295/60
+Z:300 Welt 101
+A:_MKMF
+T:*/*=0.299/60
+#Z:301 Welt 102
+#A:Franz. Guyana Mobilfunk
+#T:*/*=0.300/60
+#Z:302 Welt 103
+#A:Moldavien Mobilfunk, Usbekistan Mobilfunk
+#T:*/*=0.304/60
+Z:303 Welt 104
+A:LK
+T:*/*=0.305/60
+Z:304 Welt 105
+A:NGR,TG
+A:_AZMF,_AEMF
+T:*/*=0.310/60
+Z:305 Welt 106
+A:_MCMF
+T:*/*=0.314/60
+Z:306 Welt 107
+A:JM,NI,TZ
+#A:Guadeloupe Mobilfunk
+A:_PAMF
+T:*/*=0.320/60
+Z:307 Welt 108
+A:GM,HN
+A:_BOMF
+T:*/*=0.330/60
+Z:308 Welt 109
+A:_LIMF,_MAMF
+T:*/*=0.339/60
+Z:309 Welt 110
+A:PF
+#A:Bahrein Mobilfunk
+T:*/*=0.340/60
+#Z:310 Welt 111
+#A:Elfenbeinkste / Cote de Ivoire Mobilfunk
+#T:*/*=0.345/60
+Z:311 Welt 112
+A:_MWMF,_PEMF
+T:*/*=0.347/60
+Z:312 Welt 113
+A:KE,NG
+T:*/*=0.350/60
+Z:313 Welt 114
+A:ML
+A:_LBMF,_CYMF
+T:*/*=0.360/60
+Z:314 Welt 115
+A:_AWMF
+T:*/*=0.363/60
+Z:315 Welt 116
+A:JO,QA,TD
+A:_NIMF
+T:*/*=0.370/60
+Z:316 Welt 117
+A:AW
+T:*/*=0.373/60
+Z:317 Welt 118
+A:BI
+T:*/*=0.377/60
+Z:318 Welt 119
+A:OM
+T:*/*=0.380/60
+Z:319 Welt 120
+A:IR
+#A:Gabun Mobilfunk
+T:*/*=0.385/60
+Z:320 Welt 121
+A:BT
+T:*/*=0.388/60
+Z:321 Welt 122
+A:FJ,CV,KW,SR
+A:_AMMF,_ZRMF
+T:*/*=0.390/60
+Z:322 Welt 123
+A:SZ
+T:*/*=0.415/60
+Z:323 Welt 124
+A:GQ,SD
+T:*/*=0.420/60
+#Z:324 Welt 125
+#A:Guinea Mobilfunk
+#T:*/*=0.427/60
+Z:325 Welt 126
+A:CM
+#A:Brunei Mobilfunk
+A:_FOMF
+T:*/*=0.440/60
+#Z:326 Welt 127
+#A:Martinique Mobilfunk
+#T:*/*=0.442/60
+Z:327 Welt 128
+A:MR
+T:*/*=0.443/60
+Z:328 Welt 129
+A:SY
+T:*/*=0.445/60
+Z:329 Welt 130
+A:BN,NP,ZW
+A:_KWMF
+T:*/*=0.450/60
+Z:330 Welt 131
+A:_LSMF
+T:*/*=0.461/60
+Z:331 Welt 132
+A:MV
+A:_BFMF,_MLMF
+T:*/*=0.470/60
+Z:332 Welt 133
+A:AF
+A:_KEMF
+T:*/*=0.480/60
+#Z:333 Welt 134
+#A:Gibraltar Mobilfunk
+#T:*/*=0.481/60
+Z:334 Welt 135
+A:BF
+T:*/*=0.483/60
+Z:335 Welt 136
+A:YE,KH
+A:_VEMF
+T:*/*=0.490/60
+Z:336 Welt 137
+A:ZR
+T:*/*=0.514/60
+#Z:337 Welt 138
+#A:Kap Verde Mobilfunk
+#T:*/*=0.532/60
+Z:338 Welt 139
+A:RE
+T:*/*=0.550/60
+Z:339 Welt 140
+A:SL
+T:*/*=0.559/60
+Z:340 Welt 141
+A:VN
+A:_CMMF
+T:*/*=0.560/60
+Z:341 Welt 142
+A:ET,GL
+T:*/*=0.590/60
+Z:342 Welt 143
+A:_MOMF
+T:*/*=0.648/60
+Z:343 Welt 144
+A:ER
+T:*/*=0.660/60
+Z:344 Welt 145
+A:MO
+T:*/*=0.677/60
+#Z:345 Welt 146
+#A:Vietnam Mobilfunk
+#T:*/*=0.680/60
+Z:346 Welt 147
+A:IQ
+T:*/*=0.890/60
+Z:347 Welt 148
+A:GY
+T:*/*=0.955/60
+Z:348 Welt 149
+A:PG
+T:*/*=0.990/60
+Z:349 Welt 150
+A:VI,AI,AG,ASI
+A:BB,VG,CK,DM,FK
+A:GD,KI,KM,MP,MH,MU
+A:YT,FM,MS,NC,SC
+A:SH,KN,LC,PM,VC
+A:TK,TO,TT,TC,VU
+T:*/*=1.000/60
+Z:350 Welt 151
+A:AN
+T:*/*=1.002/60
+#Z:351 Welt 152
+#A:Papua-Neuguinea Mobilfunk
+#T:*/*=1.050/60
+Z:352 Welt 153
+A:BS
+T:*/*=1.090/60
+Z:353 Welt 154
+A:CU
+T:*/*=1.160/60
+Z:354 Welt 155
+A:PW
+T:*/*=1.175/60
+Z:355 Welt 156
+A:_CUMF
+T:*/*=1.185/60
+Z:356 Welt 157
+A:NF
+T:*/*=1.206/60
+Z:357 Welt 158
+A:TV
+T:*/*=1.282/60
+Z:358 Welt 159
+A:SB
+T:*/*=1.308/60
+Z:359 Welt 160
+A:GW
+T:*/*=1.329/60
+Z:360 Welt 161
+A:ST
+T:*/*=1.343/60
+Z:361 Welt 162
+A:WF
+T:*/*=1.364/60
+Z:362 Welt 163
+A:_THUR
+T:*/*=1.372/60
+Z:363 Welt 164
+A:WS
+T:*/*=1.427/60
+Z:364 Welt 165
+A:NU
+T:*/*=1.500/60
+Z:365 Welt 166
+A:DJ
+T:*/*=1.523/60
+Z:366 Welt 167
+A:_GUAN
+T:*/*=1.605/60
+Z:367 Welt 168
+A:NR,SO
+T:*/*=1.700/60
+Z:368 Welt 169
+A:KP
+T:*/*=1.710/60
+Z:369 Welt 170
+A:MM
+T:*/*=1.835/60
+Z:370 Welt 171
+A:TP
+T:*/*=2.131/60
+Z:371 Welt 172
+A:NKW
+T:*/*=2.400/60
+Z:372 Welt 173
+A:AQ
+T:*/*=2.765/60
 #####################################################################
 #
 #
 P:58,0 01058
 B:01058
-C:Address:KaTel Gesellschaft fr Telekommunikation mbH, Mathias-Brggen-Strae 87-89, 50829 Kln
-C:Name:KaTel
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Name:01058 CbC
+C:Address:01058 Telecom GmbH, Leopoldstr. 16, 40211 Dsseldorf
+C:Telefon:01805-701058, 01058-031
+C:Telefax:01805-901058
+C:EMail:support@01058telecom.de
+C:Homepage:http://www.01058.com/
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
 C:Euro
 D:dtag
+# G:05-Jun-2003
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
+# alternativ 0900-3-3358 als Providervorwahl fr Ortsgesprche (0,99 /min)
+Z:1 Ortsgesprche
+T:*/*=0.01/60
 Z:2-4 Deutschland
-A:+49
-T:*/*=0.035/60
+A:DE
+T:*/*=0.033/60
 Z:10 Mobilfunk
 A:_DEMD1
 A:_DEMD2
 A:_DEME1
 A:_DEME2
-T:*/*=0.205/60
+T:*/*=0.204/60
 #####################################################################
 #
 #
-P:63,0 Conos CbC
+P:63,0 01063 TELECOM
 B:01063
-C:Address:Conos AG, Mottmannstrae 2, 53842 Troisdorf
-C:URL: http://www.conos-ag.de
-C:Name:KDD-Conos PrivateCall easy
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Name:01063 TELECOM GmbH & Co. KG.
+C:Address:01063 TELECOM GmbH & Co. KG, Mottmannstrae 2, 53842 Troisdorf
+C:Homepage:http://www.01063telecom.de/
+C:TarifURL:http://www.01063telecom.de/callbycall.htm
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
 C:Euro
-C:Special:Preselection
-C:Special:Sondertarif fr Gesprche zu KDD-Conos Mobilfunkteilnehmern vorhanden
-C:Preselection
-C:Erfasste Zonen:
-C:0	-   4	Deutschland
-C:5		Sondertarif
-C:10		Mobilfunk
-C:200	- 209	Ausland
-C:Sondertarif 5: Gesprche zu KDD-Conos Mobilfunkteilnehmern
-# G: 07-99
+# G:06-Nov-2002
+D:dtag
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
+Z:2-4 Deutschland
+A:DE
+T:*/0-21=0.045(60)/1
+T:*/21-0=0.03375(60)/1 Happy Hour
 Z:10 Mobilfunk D
 A:_DEMD1
 A:_DEMD2
-T:*/*=0.189(60)/30
+T:*/*=0.230(60)/1
 Z:11 Mobilfunk E
 A:_DEME1
 A:_DEME2
-T:*/*=0.204(60)/30
+T:*/*=0.245(60)/1
+Z:12 Mobilfunk sonstige
+A:_DEMQ
+A:_DEMM
+T:*/*=0.29(60)/1
 #####################################################################
-P:63,1 Conos PrivatePhone genau
+P:63,1 oneVoice Second
 B:01063
-C:Corporate Network & Services Aktiengesellschaft Lievelingsweg 125 52119 Bonn 01063
-C:Address:Corporate Network & Services Aktiengesellschaft, Lievelingsweg 125, 5
-C:URL: http://www.kdd-conos.de
-C:Name:KDD-Conos PrivateCall genau
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
-C:Special:Die Homepage der Tarif-Datenbank Crew: http://www.digitalprojects.com
+C:Name:oneVoice Second
+C:Name:(vormals) Conos PrivatePhone genau
+C:Name:(vormals) KDD-Conos PrivateCall genau
+C:Address oneVoice Communications GmbH, Mottmannstr. 2, 53842 Troisdorf
+C:Telefon:01805-075705
+C:Telefax:01805-066605
+C:Homepage:http://www.onevoice.de/
+C:TarifURL:http://www.onevoice.de/pdf/oneVOICEPreislistesecond112002_Festnetz_1_.pdf
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
 C:Special:Preselection
-C:Special:Sondertarif fr Gesprche zu KDD-Conos Mobilfunkteilnehmern vorhanden
 C:Preselection
-C:Erfasste Zonen:
-C:0	-   4	Deutschland
-C:5		Sondertarif
-C:10		Mobilfunk
-C:200	- 209	Ausland
-C:Sondertarif 5: Gesprche zu KDD-Conos Mobilfunkteilnehmern
+C:Euro
 D:dtag
-# G: 07-99
+# G:01-Nov-2002
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:2-4 Deutschland
 A:+49
@@ -2431,37 +2916,34 @@
 Z:10 Mobilfunk D1/D2
 A:_DEMD1
 A:_DEMD2
-T:*/*=0.255(60)/1
+T:*/*=0.245(60)/1
 Z:11 Mobilfunk E1/E2
 A:_DEME1
 A:_DEME2
-T:*/*=0.28(60)/1
+T:*/*=0.255(60)/1
 #####################################################################
-P:63,2 Conos PrivatePhone easy
+P:63,2 oneVoice Minute
 B:01063
-C:Corporate Network & Services Aktiengesellschaft Lievelingsweg 125 52119 Bonn 01063
-C:Address:Corporate Network & Services Aktiengesellschaft, Lievelingsweg 125, 5
-C:URL: http://www.kdd-conos.de
-C:Name:KDD-Conos PrivateCall genau
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
-C:Special:Die Homepage der Tarif-Datenbank Crew: http://www.digitalprojects.com
+C:Name:oneVoice Minute
+C:Name:(vormals) Conos PrivatePhone easy
+C:Address oneVoice Communications GmbH, Mottmannstr. 2, 53842 Troisdorf
+C:Telefon:01805-075705
+C:Telefax:01805-066605
+C:Homepage:http://www.onevoice.de/
+C:TarifURL:http://www.onevoice.de/pdf/oneVOICEPreislisteminute112002_Festnetz.pdf
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
 C:Special:Preselection
-C:Special:Sondertarif fr Gesprche zu KDD-Conos Mobilfunkteilnehmern vorhanden
 C:Preselection
-C:Erfasste Zonen:
-C:0	-   4	Deutschland
-C:5		Sondertarif
-C:10		Mobilfunk
-C:200	- 209	Ausland
-C:Sondertarif 5: Gesprche zu KDD-Conos Mobilfunkteilnehmern
+C:Euro
 D:dtag
-# G: 26-Dez-2001
+# G:01-Nov-2002
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:2-4 Deutschland
 A:+49
@@ -2472,139 +2954,131 @@
 Z:10 Mobilfunk D1/D2
 A:_DEMD1
 A:_DEMD2
-T:*/*=0.25/60
+T:*/*=0.24/60
 Z:11 Mobilfunk E1/E2
 A:_DEME1
 A:_DEME2
-T:*/*=0.275/60
-#####################################################################
-#
-#
-P:66,0 Interoute
-B:01066
-C:Address:Interoute Telecom Deutschland GmbH, Lyoner Str. 15, 60528 Frankfurt
-C:Name:Interoute
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
-C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-C:Bei Preselection sekundengenaue Taktung
-C:Euro
-D:dtag
-# G:01-Nov-2000
-Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
-T:*/*=0
-Z:2-4 National
-A:+49
-T:W/08-17=0.03/0,0.032/60
-T:W/17-18=0.03/0,0.03/60
-T:W/18-22=0.03/0,0.022/60
-T:W/22-08=0.03/0,0.019/60
-T:E,H/08-22=0.03/0,0.022/60
-T:E,H/22-08=0.03/0,0.019/60
-Z:10-15 Mobil
-A:_DEMF
-T:*/08-17=0.03/0,0.30(60)/1
-T:*/17-08=0.03/0,0.25(60)/1
+T:*/*=0.25/60
 #####################################################################
 #
 #
 P:70,0 Arcor CbC
 B:01070
-# G:01-Jul-2001
-C:Mannesmann Arcor
-C:Address:Mannesmann AG & Co., Klner Str. 12, 65760 Eschborn
+# G:18-Jun-2003
 C:Name:Arcor CbC
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
-C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Address:Mannesmann AG & Co., Klner Str. 12, 65760 Eschborn
+C:TarifURL:http://www.privat.arcor.net/produkte/arcor_call_by_call/cbc_tarife_2.shtml
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net 
 C:Euro
+C:Zonen 0.. werden auch fr o.tel.o CbC (11,0) verwendet.
 D:dtag
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
-Z:2-4 Inland
+Z:1-2 City
+T:W/07-18=0.045/60 Hauptzeit
+T:W/18-20=0.031/60 Freizeit
+T:W/20-07=0.017/60 Nebenzeit
+T:E,H/*=0.0149/60 Wochenende
+Z:3-4 Fern
 A:+49
-T:W/07-18=0.092/60
-T:W/18-20=0.031/60
-T:W/20-07=0.019/60
-T:E,H/*=0.019/60
-Z:11 D1 Netz
+T:W/07-18=0.092/60 Hauptzeit
+T:W/18-20=0.031/60 Freizeit
+T:W/20-07=0.017/60 Nebenzeit
+T:E,H/*=0.017/60 Wochenende
+Z:10 Mobilfunk T-Mobile
 A:_DEMD1
-T:*/*=0.245/60
-Z:12 D2 Netz
+T:*/*=0.2454/60
+Z:11 Mobilfunk Vodafone
 A:_DEMD2
-T:W/07-18=0.245/60 Hauptzeit
-T:W/18-07=0.235/60 Nebenzeit
-T:E,H/*=0.235/60 Freizeit
-Z:14 E-Plus Netz
+T:W/07-18=0.2454/60
+T:W/18-07=0.2352/60
+T:E/*=0.2352/60
+Z:12 Mobilfunk E-Plus
 A:_DEME1
-T:*/*=0.276/60
-Z:15 E2 Netz
+T:*/*=0.2761/60
+Z:13 Mobilfunk O2 Germany
 A:_DEME2
-T:*/*=0.291/60
+T:*/*=0.2914/60
 #####################################################################
-P:70,1 Arcor Town to Town sunny
+P:70,1 Arcor Preselect standard
 B:01070
-# G:01.07.2001
-C:Mannesmann Arcor
-C:Mannesmann AG & Co., Klner Str. 12, 65760 Eschborn 01070
+# G:01-Apr-2003
+C:Name:Arcor Preselect standard
+C:Name:(vormals) Arcor Town to Town sunny
+C:Name:(vormals) Arcor Town to Town
 C:Address:Mannesmann AG & Co., Klner Str. 12, 65760 Eschborn
-C:Name:Arcor Town to Town
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
-C:Special:Die Homepage der Tarif-Datenbank Crew: http://www.digitalprojects.com
+C:TarifURL:http://www.privat.arcor.net/produkte/arcor_preselect/pre_preise_standard.shtml
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Euro
 D:dtag
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
-Z:1-2 Nah
-T:W/09-18=0.0307/60 Hauptzeit
-T:W/18-09=0.0153/60 Nebenzeit
-T:E,H/*=0.0153/60 Nebenzeit
+# nach Preisliste Z:1-2 Ort/Nah
+Z:2 Nah
+# hier ggf. Wunschrufnummern im Festnetz eintragen und # vor A: lschen
+#A:+4969555, +4989555
+T:W/07-18=0.045/60 Hauptzeit
+T:W/18-21=0.025/60 Freizeit
+T:E,H/07-21=0.025/60 Freizeit
+T:*/21-07=0.020/60 Nebenzeit
 Z:3-4 Fern
-T:W/09-18=0.046/60 Hauptzeit
-T:W/18-09=0.0205/60 Nebenzeit
-T:E,H/*=0.0205/60 Nebenzeit
 A:+49
-Z:11 Mobilfunk D1/D2
+T:W/07-18=0.090/60 Hauptzeit
+T:W/18-21=0.025/60 Freizeit
+T:E,H/07-21=0.025/60 Freizeit
+T:*/21-07=0.020/60 Nebenzeit
+Z:11 Mobilfunk D-Netze
 A:_DEMD1
 A:_DEMD2
-T:*/*=0.1994/60
-Z:14 E-Plus Netz
+T:*/*=0.24/60
+# hier ggf. Wunschrufnummern in D-Netzen eintragen und folgende 3 # lschen
+#Z:12 Mobilfunk D Wunschrufnummern
+#A:+49171555, +49172555
+#T:*/*=0.20/60
+Z:14 Mobilfunk E-Netze u. a.
 A:_DEME1
-T:*/*=0.2301/60
-Z:15 E2 Netz
 A:_DEME2
-T:*/*=0.2454/60
+A:_DEMQ
+A:_DEMM
+T:*/*=0.28/60
+# hier ggf. Wunschrufnummern in E-Netzen eintragen und folgende 3 # lschen
+#Z:15 Mobilfunk E Wunschrufnummern
+#A:+49177555, +49179555
+#T:*/*=0.24/60
 #####################################################################
-P:70,2 Arcor Town to Town world
+P:70,2 Arcor Preselect world
 B:01070
-# G:01.11.2001
-C:Mannesmann Arcor
-C:Mannesmann AG & Co., Klner Str. 12, 65760 Eschborn 01070
+# G:01-Nov-2001
+C:Name:Arcor Preselect world
+C:Name:(vormals) Arcor Town to Town world
+C:Name:(vormals) Arcor Town to Town Sekunde
 C:Address:Mannesmann AG & Co., Klner Str. 12, 65760 Eschborn
-C:Name:Arcor Town to Town Sekunde
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
-C:Special:Die Homepage der Tarif-Datenbank Crew: http://www.digitalprojects.com
+C:TarifURL:http://www.privat.arcor.net/produkte/arcor_preselect/pre_preise_world.shtml
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Monatlicher Grundpreis: 3,99 EUR, Mindestlaufzeit 6 Monate.
+C:Euro
 D:dtag
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
-Z:1-4 Inland
+Z:2-4 Inland
 T:W/07-19=0.05/60 Hauptzeit
 T:W/19-07=0.02/60 Nebenzeit
 T:E,H/*=0.02/60 Nebenzeit
@@ -2619,14 +3093,52 @@
 Z:15 E2 Netz
 A:_DEME2
 T:*/*=0.29/60
+# Es gibt weitere Arcor Tarife (preselect und Vollanschluss sowie Sekundentakt)
+# ...
+#####################################################################
+#
+#
+P:77,0 01077
+B:01077
+C:Name:01077
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Address:Callax Telecom Holding GmbH, Produkt 01077 Call By Call
+C:Address:Postfach 240 319, 40091 Dsseldorf
+C:Homepage:http://www.01077.com/
+C:TarifURL:http://www.01077.com/tarife.php
+C:EMail:support@01077.com
+C:Telefon:0180-5-701077
+C:Telefax:0180-5-901077
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+D:dtag
+# G:08-Jul-2003
+Z:0 FreeCall
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
+T:*/*=0
+Z:2-4 Inland
+A:+49
+T:*/07-22=0.0260/60
+T:1-4/22-07=0.0260/60
+T:5-7/22-07=0.0170/60 	# Fr-So von 22h-7h
+Z:10 Mobilfunk
+A:_DEMD1
+A:_DEMD2
+A:_DEME1
+A:_DEME2
+T:*/09-22=0.1850/60
+T:*/22-09=0.1400/60
 #####################################################################
 #
 #
 P:78,0 3U
 B:01078
-# G:10-Aug-2000
+# G:24-Apr-2003
 C:Name:3U
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
 C:Address:3U Telecom AG
 C:Address:Mergenthalerallee 79-81
@@ -2638,15 +3150,20 @@
 C:Hotline:01805/01078-0
 C:Quelle:Gesamtpreisliste 2002, Stand 2002-01-02
 C:TarifURL:http://www.3u.net/download/Preisliste_D_3U.pdf
+C:TarifURL:http://www.3u.net/main.php?id=7
 C:Euro
 D:dtag
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
+Z:1 Ort
+T:W/08-18=0.0199(60)/1
+T:W/18-08=0.0149(60)/1
+T:E,H/*=0.0149(60)/1
 Z:2-4 Fern
 T:W/08-18=0.046(60)/1
 T:W/18-08=0.025(60)/1
@@ -2659,94 +3176,629 @@
 #####################################################################
 #
 #
-P:86,0 One.Tel
+P:80,0 Telegate
+B:01080
+C:Address:Fraunhofer Strae 12a, 82152 Mnchen-Martinsried
+C:Name:Telegate
+C:Homepage:http://www.telegate.de/
+C:TarifURL:http://www.telegate.de/telegate/agbcbc.htm
+C:TarifURL:http://www.telegate.de/telegate/agb.htm
+C:EMail:info@telegate.de
+C:Telefax:089/8954-1010
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+# G:01-Jul-2003
+Z:0 FreeCall
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
+T:*/*=0
+Z:2-4 Inlandsverbindungen
+A:+49
+T:*/*=0.0299/60
+Z:10 Mobilfunk
+A:_DEMD1	# D1
+A:_DEMD2	# D2
+A:_DEME1		# Eplus
+A:_DEME2		# E2
+T:*/*=0.2499/60
+#
+# FIXME: Preiswechsel nach Weitervermittlung nicht untersttzt.
+Z:40 Telefonauskunft Inland
+A:11880
+A:11887
+T:*/*=1.19/60
+Z:41 Telefonauskunft Ausland
+A:11890
+T:*/*=1.19/0,1.19/60
+#####################################################################
+#
+#
+P:81,0 01081
+B:01081
+C:Name:01081 AG
+D:dtag
+C:Name:01081 Telecom AG
+C:Address:Postfach 10 49 27, 40040 Dsseldorf
+C:Homepage:http://www.01081.com/
+C:TarifURL:http://www.01081.com/tarife.php
+C:EMail:info@01081.com
+C:Telefax:01805-908060
+C:TarifChanged:2003-07-18
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+# G:18-Jul-2003
+C:Euro
+Z:0 FreeCall
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
+T:*/*=0
+Z:2-4 GermanCall
+A:+49
+T:*/*=0.027/60
+Z:10 Mobilfunk
+A:_DEMD1
+A:_DEMD2
+A:_DEME1
+A:_DEME2
+T:*/*=0.185/60
+#
+Z:200 Welt 1
+A:HK,SE,SG
+T:*/*=0.03/60
+Z:201 Welt 2
+A:UK,US
+T:*/*=0.034/60
+Z:202 Welt 3
+A:AU,BE,DK,FR,IE,IL,IT
+A:CA,NL,NO,AT,CH,ES
+T:*/*=0.035/60
+Z:203 Welt 4
+A:FI
+T:*/*=0.039/60
+Z:204 Welt 5
+A:CL,KR,LU,PT
+T:*/*=0.04/60
+Z:205 Welt 6
+A:EE
+T:*/*=0.043/60
+Z:206 Welt 7
+A:JP,NZ,CZ
+T:*/*=0.045/60
+Z:207 Welt 8
+A:IS
+T:*/*=0.05/60
+Z:208 Welt 9
+A:MY,TW
+T:*/*=0.055/60
+Z:209 Welt 10
+A:AD
+T:*/*=0.06/60
+Z:210 Welt 11
+A:GR
+T:*/*=0.065/60
+Z:211 Welt 12
+A:AR
+T:*/*=0.07/60
+Z:212 Welt 13
+A:PR,SK
+T:*/*=0.075/60
+Z:213 Welt 14
+A:SI
+A:_MYMF,_RUMF
+T:*/*=0.085/60
+Z:214 Welt 15
+A:GE,SU
+T:*/*=0.09/60
+Z:215 Welt 16
+A:_HKMF
+T:*/*=0.095/60
+Z:216 Welt 17
+A:BG
+A:_SGMF
+T:*/*=0.1/60
+Z:217 Welt 18
+A:MC
+T:*/*=0.105/60
+Z:218 Welt 19
+A:PL,VA
+A:_ARMF,_KRMF
+T:*/*=0.11/60
+Z:219 Welt 20
+A:GU,LI
+T:*/*=0.115/60
+Z:220 Welt 21
+A:DO,CO,MD,PS
+T:*/*=0.12/60
+Z:221 Welt 22
+A:CN,ID,SM
+T:*/*=0.13/60
+Z:222 Welt 23
+A:MX
+T:*/*=0.135/60
+Z:223 Welt 24
+A:AL,CR,FO,PE
+T:*/*=0.14/60
+Z:224 Welt 25
+A:HU
+T:*/*=0.145/60
+Z:225 Welt 26
+A:LT
+#A:Georgien Mobilfunk
+A:_TWMF
+T:*/*=0.15/60
+Z:226 Welt 27
+A:HR,LS,UA
+T:*/*=0.155/60
+Z:227 Welt 28
+A:AS,GI,NA,VE
+#A:Albanien Mobilfunk
+A:_GRMF
+T:*/*=0.16/60
+Z:228 Welt 29
+A:CY
+A:_CYMF
+T:*/*=0.165/60
+Z:229 Welt 30
+A:BS,ZA,TH,UZ
+A:_ADMF
+T:*/*=0.17/60
+Z:230 Welt 31
+A:BT,RO,TR
+T:*/*=0.175/60
+Z:231 Welt 32
+A:PH
+A:_CNMF
+T:*/*=0.18/60
+Z:232 Welt 33
+A:MT
+A:_LUMF
+T:*/*=0.185/60
+Z:233 Welt 34
+A:BA,BR
+#A:Mexiko Mobilfunk
+T:*/*=0.19/60
+Z:234 Welt 35
+A:AZ,SZ
+A:_BMMF,_BGMF,_LTMF
+A:_MTMF,_NOMF
+T:*/*=0.2/60
+Z:235 Welt 36
+A:LV
+T:*/*=0.205/60
+Z:236 Welt 37
+A:BM,KY
+A:_TRMF
+T:*/*=0.21/60
+Z:237 Welt 38
+A:_AUMF
+T:*/*=0.215/60
+Z:238 Welt 39
+A:DZ,LB
+A:_AZMF,_PHMF
+T:*/*=0.22/60
+Z:239 Welt 40
+A:ZW
+A:_DKMF
+T:*/*=0.225/60
+Z:240 Welt 41
+A:AO,BO,YU,PY
+A:_ISMF,_JPMF
+T:*/*=0.23/60
+Z:241 Welt 42
+A:_EGMF,_SIMF
+T:*/*=0.235/60
+Z:242 Welt 43
+A:EG,AG,VG
+A:_BAMF,_EEMF,_NZMF
+A:_PLMF,_SEMF,_SKMF
+A:_HUMF
+T:*/*=0.24/60
+Z:243 Welt 44
+A:_FIMF
+T:*/*=0.245/60
+Z:244 Welt 45
+A:AI,AM,CC,EC,GT,CX
+A:_BRMF,_CRMF
+T:*/*=0.25/60
+Z:245 Welt 46
+A:JO
+A:_IDMF
+#A:Kasachstan Mobilfunk
+T:*/*=0.255/60
+Z:246 Welt 47
+A:BN,GF,MK
+A:_AOMF,_IEMF,_ILMF
+A:_YUMF,_ATMF,_ROMF
+T:*/*=0.26/60
+Z:247 Welt 48
+A:GP,KZ,KG
+T:*/*=0.265/60
+Z:248 Welt 49
+A:TJ
+A:_FRMF,_ITMF
+T:*/*=0.27/60
+Z:249 Welt 50
+A:UG
+A:_ZAMF
+T:*/*=0.275/60
+Z:250 Welt 51
+A:BD,BJ
+A:+4470,+44845,+44870 	# jeweils: Grobritannien (Fest und Mobil)
+A:AN,PM
+A:_CLMF,_UKMF,_HRMF
+A:_NLMF,_CHMF
+T:*/*=0.28/60
+Z:251 Welt 52
+A:TN
+T:*/*=0.285/60
+Z:252 Welt 53
+A:_BEMF,_MKMF,_NAMF
+A:_PTMF,_CZMF
+T:*/*=0.29/60
+Z:253 Welt 54
+A:PG
+A:_INMF,_ESMF
+T:*/*=0.295/60
+Z:254 Welt 55
+A:AW,IN
+A:_MCMF
+T:*/*=0.3/60
+Z:255 Welt 56
+A:KW
+T:*/*=0.31/60
+Z:256 Welt 57
+A:JM,LY,MA,NI
+A:_LVMF
+T:*/*=0.32/60
+Z:257 Welt 58
+A:_LSMF
+T:*/*=0.325/60
+Z:258 Welt 59
+A:GQ,GN,ZM,AE
+A:_VEMF
+T:*/*=0.33/60
+Z:259 Welt 60
+A:GH
+T:*/*=0.335/60
+Z:260 Welt 61
+A:BY,PF,TG,UY
+A:_THMF
+T:*/*=0.34/60
+Z:261 Welt 62
+A:BW,SV,LK
+#A:Ghana Mobilfunk
+A:_PYMF
+T:*/*=0.36/60
+Z:262 Welt 63
+A:GA,MN,PK,SA,TM
+T:*/*=0.37/60
+Z:263 Welt 64
+A:CV,PA
+T:*/*=0.375/60
+Z:264 Welt 65
+A:BB,GM,LR,MO,MZ,SN,ZR
+A:_GTMF
+T:*/*=0.38/60
+Z:265 Welt 66
+A:_BOMF
+T:*/*=0.39/60
+Z:266 Welt 67
+A:KE,YT,TZ
+T:*/*=0.4/60
+Z:267 Welt 68
+A:RE
+T:*/*=0.41/60
+Z:268 Welt 69
+A:CF
+T:*/*=0.42/60
+Z:269 Welt 70
+A:TC
+T:*/*=0.425/60
+Z:270 Welt 71
+A:MG,MW,KN,SR
+T:*/*=0.43/60
+Z:271 Welt 72
+A:TT
+A:_PEMF
+T:*/*=0.435/60
+Z:272 Welt 73
+A:DM,CM,LA
+T:*/*=0.44/60
+Z:273 Welt 74
+A:BZ
+T:*/*=0.445/60
+Z:274 Welt 75
+A:HN,LC
+T:*/*=0.45/60
+Z:275 Welt 76
+A:NP,VC
+#A:St . Vincent und Grenadin Mobilfunk
+T:*/*=0.455/60
+Z:276 Welt 77
+A:NG
+T:*/*=0.46/60
+Z:277 Welt 78
+A:QA
+T:*/*=0.465/60
+Z:278 Welt 79
+A:HT
+T:*/*=0.47/60
+Z:279 Welt 80
+A:NC
+T:*/*=0.475/60
+Z:280 Welt 81
+A:BH,GL,CG,MR,NGR,SD
+A:_KGMF
+T:*/*=0.48/60
+Z:281 Welt 82
+A:MV,ML
+T:*/*=0.485/60
+Z:282 Welt 83
+A:AQ,BI,CI,GD,KM,PW
+T:*/*=0.49/60
+Z:283 Welt 84
+A:MH,WS
+A:_MAMF
+T:*/*=0.5/60
+Z:284 Welt 85
+A:SC
+T:*/*=0.52/60
+Z:285 Welt 86
+A:IR,MU,RW
+T:*/*=0.53/60
+Z:286 Welt 87
+A:OM
+A:_LBMF
+T:*/*=0.56/60
+Z:287 Welt 88
+A:KP,SL
+T:*/*=0.575/60
+Z:288 Welt 89
+A:_NIMF
+T:*/*=0.58/60
+Z:289 Welt 90
+A:IQ,SY
+#A:Honduras Mobilfunk
+T:*/*=0.59/60
+Z:290 Welt 91
+A:ET,NF
+T:*/*=0.61/60
+Z:291 Welt 92
+A:FK,FJ,MM
+T:*/*=0.64/60
+Z:292 Welt 93
+A:TO
+T:*/*=0.65/60
+Z:293 Welt 94
+A:SH
+T:*/*=0.66/60
+Z:294 Welt 95
+A:BF,GW
+T:*/*=0.69/60
+Z:295 Welt 96
+A:AF
+T:*/*=0.7/60
+Z:296 Welt 97
+A:KH
+T:*/*=0.715/60
+Z:297 Welt 98
+A:ASI,YE
+T:*/*=0.72/60
+Z:298 Welt 99
+A:TD
+T:*/*=0.73/60
+Z:299 Welt 100
+A:GY,FM
+T:*/*=0.75/60
+Z:300 Welt 101
+A:ER
+T:*/*=0.76/60
+Z:301 Welt 102
+A:DJ
+T:*/*=0.77/60
+Z:302 Welt 103
+A:_GUAB,MS
+T:*/*=0.79/60
+Z:303 Welt 104
+A:NR,VN
+T:*/*=0.8/60
+Z:304 Welt 105
+A:SO
+T:*/*=0.82/60
+Z:305 Welt 106
+A:KI
+T:*/*=0.89/60
+Z:306 Welt 107
+A:TV
+T:*/*=0.92/60
+Z:307 Welt 108
+A:NU
+T:*/*=0.95/60
+Z:308 Welt 109
+A:CK,CU,VU
+T:*/*=0.99/60
+Z:309 Welt 110
+A:SB
+T:*/*=1.12/60
+Z:310 Welt 111
+A:_EMSA,_THUR
+T:*/*=1.35/60
+#####################################################################
+#
+#
+P:86,0 01086 by Call (Standard)
 B:01086
+C:Name:01086 by Call (Standard)
+C:Address:OneTel Telecommunication GmbH, Siemensstr. 12b, D-63263 Neu-Isenburg
 C:Address:ONE.TEL Limited (UK), Clements House, 14-18 Gresham Street, London, EC2V 7JE, England
-C:Name:ONE.TEL
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
-C:Euro
+C:Homepage:http://www.01086.com/
+C:TarifURL:http://01086.com/standard.html
+C:TarifURL:http://01086.com/pdf/preise/bc250703.pdf
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-# G:21-Dec-2001
+C:Euro
+C:Zeitweise internationaler Takt von 240 Sekunden.
+C:Von Anschlssen in 23 Grostdten gilt abweichender Tarif (P:86,1)
+# G:23-Jul-2003
 D:dtag
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
-Z:2-4 National
-A:+49
-T:*/06-18=0.03(60)/240
-T:*/18-06=0.02(60)/240
-Z:10 Mobilfunknetz
-A:_DEMF
-T:*/*=0.30/60
+# Ortgesprche in `Krze'
+Z:2-4 Fern
+A:DE
+T:W/07-18=0.0268/60 Sunshine
+T:W/18-20=0.0258/60 Happy Hours
+T:W/20-07=0.0218/60 Moonshine
+T:E,H/*=0.0184/60 Holiday
+#
+Z:10 Mobilfunk D-Netze
+A:_DEMD1
+A:_DEMD2
+T:*/*=0.181/60
+Z:11 Mobilfunk E-Netze
+A:_DEME1
+A:_DEME2
+T:*/*=0.203/60
 #####################################################################
+P:86,1 01086 by Call-City
+B:01086
+C:Name:01086 by Call-City
+C:Address:OneTel Telecommunication GmbH, Siemensstr. 12b, D-63263 Neu-Isenburg
+C:Address:ONE.TEL Limited (UK), Clements House, 14-18 Gresham Street, London, EC2V 7JE, England
+C:Homepage:http://www.01086.com/
+C:TarifURL:http://01086.com/city.html
+C:TarifURL:http://01086.com/pdf/preise/bccity250703.pdf
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Euro
+C:Zeitweise internationaler Takt von 240 Sekunden.
+C:Tarif gilt nur von Anschlssen in 23 Grostdten (siehe Zone 1)
+# G:23-Jul-2003
+D:dtag
+R:81,0;0 	# FreeCall 
+Z:1 City to City
+A:+49201,+49211,+49221,+49231,+4930,+49341,+49351,+49361,+49381,+49391
+A:+4940,+49421,+49431,+49511,+49521,+49621,+4969
+A:+49711,+49721,+49821,+4989,+49911,+49931
+T:W/07-18=0.0238/60 Sunshine
+T:W/18-20=0.0178/60 Happy Hours
+T:W/20-07=0.0158/60 Moonshine
+T:E,H/*=0.0158/60 Holiday
+Z:2-4 Fern
+A:DE
+T:W/07-18=0.0248/60 Sunshine
+T:W/18-20=0.0188/60 Happy Hour
+T:W/20-07=0.0163/60 Moonshine
+T:E,H/*=0.0168/60 Holiday
+#
+Z:10 Mobilfunk D-Netze
+A:_DEMD1
+A:_DEMD2
+T:*/*=0.178/60
+Z:11 Mobilfunk E-Netze
+A:_DEME1
+A:_DEME2
+T:*/*=0.188/60
 #
+# Es gibt weitere CbC-Tarife unter dem Namen Premium Call (...)
+#####################################################################
 #
-P:89,0 M'net Klassik
+#
+P:89,0 M'net ISDN privat
 B:01089
 D:dtag
+C:Name:M'net ISDN privat
+C:Name:(vormals) M'net Klassik
 C:Address:M'net Telekommunikations GmbH, Mllerstrae 7, 80469 Mnchen
-C:Name:M'net
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.m-net.de/
+C:TarifURL:http://www.m-net.de/pdf/isdn/isdn_privat_a_auto.pdf
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Rabatt ab monatlich 125 Euro Nettoverbindungsentgelt.
+C:Komplettanschluss ab 19,90 EUR/Monat Grundgebhr.
+C:Regionales Angebot fr Stadtgebiet Mnchen und
+C:Landkreise Mnchen, Dachau, Starnberg oder Ingolstadt.
 C:Euro
+# G:01-Apr-2003
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:1-2 City
-T:W/08-18=0.01|0.0297(60)/1
-T:W/18-08=0.01|0.017(60)/1
-T:E,H/*=0.01|0.017(60)/1
+T:W/08-18=0.01|0.0297(60)/60/1
+T:W/18-08=0.01|0.017(60)/60/1
+T:E,H/*=0.01|0.017(60)/60/1
 Z:3 Bayern
 # FIXME Zone stimmt nicht
-T:W/08-18=0.01|0.046(60)/1
-T:W/18-08=0.01|0.0297(60)/1
-T:E,H/*=0.01|0.0297(60)/1
+T:W/08-18=0.01|0.046(60)/60/1
+T:W/18-08=0.01|0.0297(60)/60/1
+T:E,H/*=0.01|0.0297(60)/60/1
 Z:4 Deutschland
 A:DE
-T:W/08-18=0.01|0.061(60)/1
-T:W/18-08=0.01|0.0297(60)/1
-T:E,H/*=0.01|0.0297(60)/1
+T:W/08-18=0.01|0.061(60)/60/1
+T:W/18-08=0.01|0.0297(60)/60/1
+T:E,H/*=0.01|0.0297(60)/60/1
 
 Z:5 M'net zu M'net
 # Alle bekannten Anschlussinhaber bei M'net in der Form
 # A:+49<Vorwahl><Nummer> eintragen
 #A:+498912345678
-T:W/08-18=0.01|0.0148(60)/1
+T:W/08-18=0.01|0.0148(60)/60/1
 T:W/18-08=0/60
 T:E,H/*=0/60
 
-Z:10 Mobilfunk D1/D2/E2
+Z:10 Mobilfunk
 A:_DEMD1
 A:_DEMD2
+A:_DEME1
 A:_DEME2
-T:*/*=0.01|0.2505(60)/1
+T:*/*=0.01|0.2505(60)/60/1
 
-Z:11 Mobilfunk E-plus/Quam
-A:_DEME1
-A:_DEMQ
-T:*/*=0.01|0.3017(60)/1
+Z:11 Mobilfunk sonstige
+A:_DEBD
+T:*/*=0.01|0.3700(60)/60/1
 
+Z:102 Internetzugang
+A:+498989058905
+T:*/*=0.01|0.0097(60)/60/1
+
+#####################################################################
 P:89,1 M'net Klassik plus
 B:01089
 D:dtag
+C:Name:M'net ISDN business Klassik plus
 C:Address:M'net Telekommunikations GmbH, Mllerstrae 7, 80469 Mnchen
-C:Name:M'net
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.m-net.de/
+C:TarifURL:http://www.m-net.de/pdf/isdn/isdn_business_a_auto.pdf
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Komplettanschluss fr ab 25,46 EUR/Monat Grundgebhr.
+C:Rabatt ab monatlich 125 Euro Nettoverbindungsentgelt.
+C:Regionales Angebot fr Stadtgebiet Mnchen und
+C:Landkreise Mnchen, Dachau, Starnberg oder Ingolstadt.
+C:Euro
+# G:01-Apr-2003
+# FIXME: _nicht_ bundeseinheitliche werden nicht untersttzt
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*                # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031*                # Testrufnummern
+A:110                 # Polizei
+A:112                 # Notruf, Feuerwehr
 T:*/*=0
 Z:1-2 City
 T:W/08-18=0.01|0.0256(60)/1
@@ -2778,30 +3830,44 @@
 A:_DEMD2
 T:*/*=0.01|0.22(60)/1
 
-Z:11 Mobilfunk E-plus/Quam
+Z:11 Mobilfunk sonstige
 A:_DEME1
-A:_DEMQ
+A:_DEBD
 T:*/*=0.01|0.3017(60)/1
 
 Z:12 Mobilfunk E2
 A:_DEME2
 T:*/*=0.01|0.2505(60)/1
 
+Z:102 Internetzugang
+A:+498989058905
+T:*/*=0.01|0.0097(60)/1
+
+#####################################################################
 P:89,2 M'net GGD
 B:01089
 D:dtag
+C:Name:M'net ISDN business GGD (Gr Gott Deutschland)
 C:Address:M'net Telekommunikations GmbH, Mllerstrae 7, 80469 Mnchen
-C:Name:M'net
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.m-net.de/
+C:TarifURL:http://www.m-net.de/pdf/isdn/isdn_business_a_auto.pdf
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Rabatt ab monatlich 125 Euro Nettoverbindungsentgelt.
+C:Komplettanschluss ab 25,52 EUR/Monat Grundgebhr.
+C:Regionales Angebot fr Stadtgebiet Mnchen und
+C:Landkreise Mnchen, Dachau, Starnberg oder Ingolstadt.
+C:Euro
+# G:01-Apr-2003
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*                # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031*                # Testrufnummern
+A:110                 # Polizei
+A:112                 # Notruf, Feuerwehr
 T:*/*=0
 Z:1-3 Bayern
+# FIXME Zone stimmt nicht
 T:*/08-18=0.028/60 Hauptzeit
 T:*/18-21=0.0256/60 Freizeit
 T:*/21-08=0.02/60 Nebenzeit
@@ -2825,135 +3891,252 @@
 A:_DEMD2
 T:*/*=0.22/60
 
-Z:11 Mobilfunk E-plus/Quam 
+Z:11 Mobilfunk sonstige
 A:_DEME1
-A:_DEMQ
+A:_DEBD
 T:*/*=0.3017/60
 
 Z:12 Mobilfunk E2
 A:_DEME2
 T:*/*=0.2505/60
 
+Z:102 Internetzugang
+A:+498989058905
+T:*/*=0.01|0.0097(60)/60
+
+#####################################################################
+P:89,3 M'net ISDN privat sekundengenau
+B:01089
+D:dtag
+C:Name:M'net ISDN privat sekundengenau
+C:Address:M'net Telekommunikations GmbH, Mllerstrae 7, 80469 Mnchen
+C:Homepage:http://www.m-net.de/
+C:TarifURL:http://www.m-net.de/pdf/isdn/isdn_privat_a_auto.pdf
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Rabatt ab monatlich 125 Euro Nettoverbindungsentgelt.
+C:Komplettanschluss ab 21,90 EUR/Monat Grundgebhr.
+C:Regionales Angebot fr Stadtgebiet Mnchen und
+C:Landkreise Mnchen, Dachau, Starnberg oder Ingolstadt.
+C:Euro
+# G:01-Apr-2003
+Z:0 FreeCall
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
+T:*/*=0
+Z:1-2 City
+T:W/08-18=0.01|0.0297(60)/1
+T:W/18-08=0.01|0.017(60)/1
+T:E,H/*=0.01|0.017(60)/1
+Z:3 Bayern
+# FIXME Zone stimmt nicht
+T:W/08-18=0.01|0.046(60)/1
+T:W/18-08=0.01|0.0297(60)/1
+T:E,H/*=0.01|0.0297(60)/1
+Z:4 Deutschland
+A:DE
+T:W/08-18=0.01|0.061(60)/1
+T:W/18-08=0.01|0.0297(60)/1
+T:E,H/*=0.01|0.0297(60)/1
+
+Z:5 M'net zu M'net
+# Alle bekannten Anschlussinhaber bei M'net in der Form
+# A:+49<Vorwahl><Nummer> eintragen
+#A:+498912345678
+T:W/08-18=0.01|0.0148(60)/1
+T:W/18-08=0/60
+T:E,H/*=0/60
+
+Z:10 Mobilfunk
+A:_DEMD1
+A:_DEMD2
+A:_DEME1
+A:_DEME2
+T:*/*=0.01|0.2505(60)/1
+
+Z:11 Mobilfunk sonstige
+A:_DEBD
+T:*/*=0.01|0.3700(60)/1
+
+Z:102 Internetzugang
+A:+498989058905
+T:*/*=0.01|0.0097(60)/1
+
 #####################################################################
 #
 #
 P:90,0 BT Ignite CbC
 B:01090
-# G:21-Dec-2001
-C:Address:BT Ignite Deutschland, c/o nexnet, Postfach 270247, 12472 Berlin
-C:Name:BT Ignite
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+# G:11-Jan-2003
+C:Name:BT Ignite CbC
+C:Address:BT Ignite GmbH & Co, Eisenheimerstr. 11, 80687 Mnchen
+C:Telefon:089-2600-0
+C:Telefax:040-2600-8605
+C:EMail:nexnet@btignite.de
+C:Homepage:http://www.01090.com/
+C:TarifURL:http://www.01090.com/cgi-bin/tell/form.cgi
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Euro
 D:dtag
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
-Z:1-4 Fern
+Z:2-4 Fern
 A:+49
 T:W/08-18=0.07/60 Hauptzeit
-T:[18.02.2002-31.03.2002]W/08-18=0.029/60 Hauptzeit Sonderaktion
-T:W/18-08=0.029/60 Freizeit
-T:E,H/*=0.029/60 Freizeit
+T:W/06-08,18-21=0.04/60 Freizeit
+T:W/21-06=0.03/60 Traumzeit
+T:E,H/06-21=0.04/60 Freizeit
+T:E,H/21-06=0.03/60 Traumzeit
 Z:10 Mobil
-A:_DEMF
-T:W/08-18=0.40/60 Hauptzeit
-T:W/18-08=0.25/60 Freizeit
-T:E,H/*=0.25/60 Freizeit
-Z:11 Mobil E2
+A:_DEMD1
+A:_DEMD2
+A:_DEME1
 A:_DEME2
-T:*/*=0.23/60 Standard
-Z:21 Telefonauskunft
-A:11881
-T:*/*=1.59/0,0.22(60)/10
-Z:100 Internet planet-interkom
-A:0191799
-T:W/08-18=0.032(60)/1
-T:W/18-08=0.025(60)/1
-T:E,H/*=0.025(60)/1
-Z:170 Persnliche Rufnummer
-A:0700
-T:W/09-18=0.24/60 Hauptzeit
-T:W/18-08=0.12/60 Nebenzeit
-T:E,H/*=0.12/60 Nebenzeit
-Z:200 EuroNah
-A:AD,BE,DK,FO,FI,FR,GI
-A:GR,UK,IE,IS,IT,LI
-A:LU,MC
-A:NL,NO,AT,PL,PT,_AZOR,_MADE
-A:SM,SE,CH,SK,ES,CZ
-A:HU,VA,CY
-T:*/*=0.39/60
-Z:201 EuroFern
+T:*/*=0.23/60 
+# Tarifliste erfordert Geographiekenntnisse: `EU-Lnder', `restliches Europa'
+# Ist bsplw. Grnland ein EU-Staat? -> im Zweifel Rckgriff auf letzte Zone 
+# Aussereuropische Mobilfunknetze stark unvollstndig erfasst.
+Z:200 EuroSpezial
+A:BE,DK,FR,UK,IE,IT,NL
+A:NO,AT,SE,CH
+T:*/*=0.11/60
+Z:201 EuroSpezial Mobilfunk
+A:_BEMF,_DKMF,_FRMF
+A:_UKMF,_IEMF,_ITMF
+A:_NLMF,_NOMF,_ATMF
+A:_SEMF,_CHMF
+T:*/*=0.27/60
+Z:202 EuroNah
+A:FI,GR,LU,PT,ES
+A:AD,IS,LI,MC,PL,SM
+A:CZ,HU,VA
+T:*/*=0.20/60
+Z:203 EuroNah Mobilfunk
+A:_FIMF,_GRMF,_LUMF
+A:_PTMF,_ESMF,_ESMF
+A:_ADMF,_ISMF,_LIMF
+A:_MCMF,_PLMF
+#A:San Marino Mobilfunk
+A:_CZMF,_HUMF
+#A:Vatikanstadt Mobilfunk
+T:*/*=0.36/60
+Z:204 EuroFern
 A:AL,BA,BG,EE,YU
-A:YU,YU,HR,LV,LT,MT,MK
+A:HR,LV,LT,MT,MK
 A:MD
-A:RO,MOW,SI,TR,UA
+A:RO,SU,SI,TR,UA
 A:BY
-T:*/*=0.99/60
-Z:202 Nordamerika
-A:CA,US,_ALAS
-T:*/*=0.39/60
-Z:203 Asien Pazifik
+A:IL
+T:*/*=0.46/60
+Z:205 EuroFern Mobilfunk
+#A:Albanien Mobilfunk
+A:_BAMF
+#A:Bulgarien Mobilfunk
+A:_EEMF
+#A:Jugoslawien Mobilfunk
+A:_HRMF
+#A:Lettland Mobilfunk
+A:_LTMF,_MTMF,_MKMF
+#A:Moldau-Republik Mobilfunk
+A:_ROMF,_RUMF,_SIMF
+A:_TRMF,_UAMF
+#A:Weirussland Mobilfunk
+T:*/*=0.62/60
+Z:206 Nordamerika
+#FIXME: USA (US=+1) zu allgemein
+A:CA,US,ALAS
+T:*/*=0.11/60
+Z:207 Nordamerika Mobilfunk
+A:_CAMF
+T:*/*=0.27/60
+Z:208 Asien/Pazifik
 A:AU,HK,JP,KR,MY
-A:NZ,SG
-T:*/*=1.49/60
-#Z:204 Sonstige Lnder
-#A:+
-#T:*/*=1.99/60
+A:NZ,SG,TW
+T:*/*=0.76/60
+Z:209 Asien/Pazifik Mobilfunk
+A:_AUMF,_HKMF,_JPMF
+A:_KRMF,_MYMF,_NZMF
+A:_SGMF,_TWMF
+T:*/*=0.92/60
+Z:210 Sonstige Lnder
+A:+
+T:*/*=0.99/60
+#FIXME: alle weiteren Codes _[A-Z][A-Z]MF aus country(-de).dat hier:
+#Z:211 Sonstige Lnder Mobilfunk
+#A:
+#T:*/*=1.15/60
 #####################################################################
 #
 #
-P:100,0 TELELEV
-B:010000
-C:Name:TELELEV
-C:Address:Telekommunikation GmbH, Dnhoffstrae 39, 51373 Leverkusen
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+P:94,0 Startec
+B:01094
+C:Address:Global Communications GmbH, Eupener Strae 57 - 59, 50933 Kln
+C:Name:Global Communications
+C:Homepage:http://www.startec.info/
+C:TarifURL:http://www.startec.info/seiten/01094/tarife/tarife-inland.htm
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
-##################################################################
-P:100,1 Meocom
+Z:1-4 National
+A:+49
+T:*/*=0.079/60
+Z:10 Mobilfunknetz
+A:_DEMD1	# D1
+A:_DEMD2	# D2
+T:*/*=0.179/60
+A:_DEME1		# Eplus
+A:_DEME2		# E2
+T:*/*=0.269/60
+#####################################################################
+#
+#
+P:100,0 Meocom
 B:010000
-C:EMail: service@meocom.de
-C:Address: MEOCOM Telekommunikation, Burgstr. 1, 45467 Mlheim a. d. Ruhr
-C:Telefon: 0800/0-636-636
-C:Homepage: http://www.meocom.de
 C:Name:Meocom ISDN
-C:Zusaetzliche Tarife: Meocom-direkt (analog) und -ISDN-plus
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Address:meocom Telekommunikation GmbH, Helmholtzstr. 144, 46045 Oberhausen
+C:Telefon: 0800/0-636-636
+C:EMail:info@meocom.de
+C:Homepage:http://www.meocom.de/
+C:TarifURL:http://www.meocom.de/service/MEOTarifisdn.doc
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-C:Meocom ist nur als Preselection-Tarif nutzbar (minutengenaue Abrechnung)
-C:Meocom-Kunden untereinander telefonieren fuer 1 Cent/min (Mo-So, 0-24 Uhr)
-C: Es fehlen weitere Sonderrufnummern (0180,0190,0900,... [wie Telekom]
-C: Auslandsmobilfunk [+0,25 Euro zu den Auslandstarifen])
+C:Regionalanbieter fr Oberhausen und Mlheim.
+C:Komplettanschluss fr 19,90 Euro/Monat.
+C:Meocom gehrt zur Tropolys GmbH, Dsseldorf, zu der weitere Regionalanbieter
+C:mit vergleichbaren Tarifmodellen gehren
+C:Es fehlen weitere Sonderrufnummern (0180,0190,0900,... [wie Telekom])
+# G:05-Aug-2002
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
-Z:1 Meocom lokal
+# Zonen lokal und City zusammengelegt
+Z:1-2 Meocom City
 A:+49208*
-T:W/8-18=0.31(600)/60
-T:W/18-8=0.03(120)/60
-T:E,H/*=0.03(120)/60
-Z:2 Meocom City
 A:+49201*,+492041*,+492043*,+492045*,+492051*,+492054*,+492056*,+492858*
 A:+492064*,+492065*,+492066*,+49209*,+492102*,+492841*,+492843*,+492844*
 A:+492855*
-T:W/8-18=0.31(600)/60
-T:W/18-8=0.03(120)/60
-T:E,H/*=0.03(120)/60
+T:W/8-18=0.031/60
+T:W/18-8=0.015/60
+T:E,H/*=0.015/60
 Z:3 Meocom Regional
 A:+49202*,+492052*,+492053*,+492058*,+492058*
 A:+492103*,+492104*,+492104*,+49211*,+49212*,+492131*,+492132*,+492133*
@@ -2969,33 +4152,39 @@
 A:+492834*,+492835*,+492836*,+492838*,+492839*,+492845*,+492850*,+492851*
 A:+492852*,+492853*,+492856*,+492856*,+492857*,+492859*,+492861*,+492864*
 A:+492865*,+492865*,+492866*,+492867*,+49287*,+492873*,+492874*
-T:W/8-18=0.23(300)/60
-T:W/5-8,18-22=0.31(600)/60
-T:W/22-5=0.02(60)/60
-T:E,H/*=0.31(600)/60
+T:W/8-18=0.046/60
+T:W/5-8,18-22=0.031/60
+T:W/22-5=0.02/60
+T:E,H/*=0.031/60
 Z:4 Meocom fern
 A:DE
-T:W/8-18=0.36(300)/60
-T:W/5-8,18-22=0.31(600)/60
-T:W/22-5=0.02(60)/60
-T:E,H/*=0.31(600)/60
-Z:12 Mobilfunk D1
+T:W/8-18=0.072/60
+T:W/5-8,18-22=0.031/60
+T:W/22-5=0.02/60
+T:E,H/*=0.031/60
+Z:5 Meocom unter uns
+# Rufnummern von weiteren Meocom-Kunden im eigenen Ortsnetz hier eintragen:
+#A:+49208555
+T:*/*=0.01/60
+#
+Z:10 Mobilfunk D
 A:_DEMD1
-T:*/*=0.47(120)/60
-Z:13 Mobilfunk D2
 A:_DEMD2
-T:*/*=0.47(120)/60
+T:*/*=0.235/60
 Z:14 Mobilfunk E+
 A:_DEME1
-T:*/*=1.38(300)/60
+T:*/*=0.276/60
 Z:15 Mobilfunk E2
 A:_DEME2
-T:*/*=2.91(600)/60
+T:*/*=0.291/60
+#
 Z:100 MeoSurf
 A:01921560
-T:*/*=1.23(6000)/60
+T:*/*=0.0123/60
+#
 Z:201 Europa 1
-A:AD,BE,DK,TO,FI,FR,GI,UK
+A:AD,BE,DK,FO,FI,FR
+A:GI,UK
 A:IE,IT,LI,LU,_MADE
 A:NL,NO,AT,PT,SM,SE
 A:CH,ES,VA
@@ -3015,7 +4204,7 @@
 T:*/*=1.20(60)/60
 Z:206 Welt 1
 A:EG,DZ,EE,IL,JO,LB,LY,LV,LT
-A:EH,SY,TN
+A:MA,SY,TN
 T:*/*=0.60(60)/60
 Z:207 Welt 2
 A:AU,CN,HK,JP,KR,NZ,SG,TW
@@ -3025,38 +4214,97 @@
 T:*/*=1.00(60)/60
 Z:209 Welt 4 (restliche Laender)
 T:*/*=1.40(60)/60
+# Mobilfunk jeweils +0.25 EUR
+Z:221 Europa 1 Mobilfunk
+A:_ADMF,_BEMF,_DKMF
+A:_FOMF,_FIMF,_FRMF
+#A:Gibraltar Mobilfunk
+A:_UKMF,_IEMF,_ITMF
+A:_LIMF,_LUMF
+#A:Madeira Mobilfunk
+A:_NLMF,_NOMF,_ATMF
+A:_PTMF
+#A:San Marino Mobilfunk
+A:_SEMF,_CHMF,_ESMF
+#A:Vatikan Mobilfunk
+T:*/*=0.37/60
+Z:222 Europa 2 Mobilfunk
+#A:Albanien Mobilfunk
+A:_BAMF,_GRMF,_ISMF
+#A:Jugoslawien Mobilfunk
+A:_HRMF,_MTMF,_MCMF,_PLMF
+A:_SKMF,_SIMF,_CZMF
+A:_TRMF,_HUMF,_CYMF
+T:*/*=0.50/60
+Z:223 Europa 3 Mobilfunk
+#A:Bulgarien Mobilfunk, Kasachstan Mobilfunk
+A:_MKMF
+#A:Moldavien Mobilfunk
+A:_ROMF,_RUMF
+#A:Weissrussland Mobilfunk
+T:*/*=0.70/60
+Z:224 Nordamerika Mobilfunk
+A:_CAMF
+#A:USA Mobilfunk, Hawaii Mobilfunk
+T:*/*=0.37/60
+Z:225 Suedamerika/Suedafrika Mobilfunk
+A:_ARMF,_CLMF,_COMF
+#A:Lesotho Mobilfunk
+A:_ZAMF
+T:*/*=1.45/60
+Z:226 Welt 1 Mobilfunk
+A:_EGMF,_DZMF,_EEMF,_ILMF
+A:_JOMF,_LBMF
+#A:Lybien Mobilfunk, Lettland Mobilfunk
+A:_LTMF,_MAMF
+#A:Syrien Mobilfunk
+A:_TNMF
+T:*/*=0.85/60
+Z:227 Welt 2 Mobilfunk
+A:_AUMF,_CNMF,_HKMF,_JPMF
+A:_KRMF,_NZMF,_SGMF
+A:_TWMF
+T:*/*=1.05/60
+Z:228 Welt 3 Mobilfunk
+A:_BRMF,_DOMF
+#A:Mexiko Mobilfunk
+T:*/*=1.25/60
+#Z:229 Welt 4 Mobilfunk
+#FIXME: alle bis hierher ungenannten _[A-Z][A-Z]MF-Codes hier:
+#A:
+#T:*/*=1.65/60
+#
 #####################################################################
-P:100,2 Meocom ISDN plus
+P:100,1 Meocom ISDN plus
 B:010000
-C:EMail: service@meocom.de
-C:Address: MEOCOM Telekommunikation, Helmholtzstr. 144, 46045 Oberhausen
+C:Name:Meocom ISDN plus
+C:Address:meocom Telekommunikation GmbH, Helmholtzstr. 144, 46045 Oberhausen
 C:Telefon: 0800/0-636-636
-C:Homepage: http://www.meocom.de
-C:Name:Meocom ISDN
-C:Zusaetzliche Tarife: Meocom-direkt (analog) und -ISDN-plus
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:EMail:info@meocom.de
+C:Homepage:http://www.meocom.de/
+C:TarifURL:http://www.meocom.de/service/MEOTarifisdnplus.doc
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-C:Meocom ist nur als Preselection-Tarif nutzbar (minutengenaue Abrechnung)
-C:Meocom-Kunden untereinander telefonieren fuer 1 Cent/min (Mo-So, 0-24 Uhr)
-C: Es fehlen weitere Sonderrufnummern (0180,0190,0900,... [wie Telekom]
-C: Auslandsmobilfunk [+0,25 Euro zu den Auslandstarifen])
+C:Regionalanbieter fr Oberhausen und Mlheim.
+C:Komplettanschluss fr 24,90 Euro/Monat.
+C:Meocom gehrt zur Tropolys GmbH, Dsseldorf, zu der weitere Regionalanbieter
+C:mit vergleichbaren Tarifmodellen gehren
+C:Es fehlen weitere Sonderrufnummern (0180,0190,0900,... [wie Telekom])
+# G:05-Aug-2002
 Z:0 FreeCall
 A:0130*,0800*
 A:110
 A:112
 T:*/*=0
-Z:1 Meocom Lokal
+# Zonen lokal und City zusammengelegt
+Z:1-2 Meocom City
 A:+49208*
-T:W/8-18=0.13(300)/60
-T:W/18-8=0.03(120)/60
-T:E,H/*=0.03(120)/60
-Z:2 Meocom City
 A:+49201*,+492041*,+492043*,+492045*,+492051*,+492054*,+492056*,+492858*
 A:+492064*,+492065*,+492066*,+49209*,+492102*,+492841*,+492843*,+492844*
 A:+492855*
-T:W/8-18=0.13(300)/60
-T:W/18-8=0.03(120)/60
-T:E,H/*=0.03(120)/60
+T:W/8-18=0.026/60
+T:W/18-8=0.015/60
+T:E,H/*=0.015/60
 Z:3 Meocom Regional
 A:+49202*,+492052*,+492053*,+492058*,+492058*
 A:+492103*,+492104*,+492104*,+49211*,+49212*,+492131*,+492132*,+492133*
@@ -3072,127 +4320,252 @@
 A:+492834*,+492835*,+492836*,+492838*,+492839*,+492845*,+492850*,+492851*
 A:+492852*,+492853*,+492856*,+492856*,+492857*,+492859*,+492861*,+492864*
 A:+492865*,+492865*,+492866*,+492867*,+49287*,+492873*,+492874*
-T:W/8-18=0.23(300)/60
-T:W/5-8,18-22=0.02(60)/60
-T:W/22-5=0.03(120)/60
-T:E,H/*=0.02(60)/60
+T:W/8-18=0.046/60
+T:W/5-8,18-22=0.02/60
+T:W/22-5=0.015/60
+T:E,H/*=0.015/60
 Z:4 Meocom fern
 A:DE
-T:W/8-18=0.23(300)/60
-T:W/5-8,18-22=0.13(300)/60
-T:W/22-5=0.02(60)/60
-T:E,H/*=0.13(300)/60
-Z:12 Mobilfunk D1
+T:W/8-18=0.046/60
+T:W/5-8,18-22=0.026/60
+T:W/22-5=0.020/60
+T:E,H/*=0.026/60
+Z:5 Meocom unter uns
+# Rufnummern von weiteren Meocom-Kunden im eigenen Ortsnetz hier eintragen:
+#A:+49208555
+T:*/*=0.01/60
+#
+Z:12 Mobilfunk D
 A:_DEMD1
-T:*/*=1.99(600)/60
-Z:13 Mobilfunk D2
 A:_DEMD2
-T:*/*=1.99(600)/60
+T:*/*=0.199/60
 Z:14 Mobilfunk E+
 A:_DEME1
-T:*/*=0.23(60)/60
+T:*/*=0.23/60
 Z:15 Mobilfunk E2
 A:_DEME2
-T:*/*=0.49(120)/60
+T:*/*=0.245/60
+#
 Z:100 MeoSurf
 A:01921560
-T:*/*=0.36(3000)/60
-Z:201 Europa 1
-A:AD,BE,DK,TO,FI,FR,GI,UK
-A:IE,IT,LI,LU,_MADE
-A:NL,NO,AT,PT,SM,SE
-A:CH,ES,VA
-T:*/*=0.12(60)/60
-Z:202 Europa 2
-A:AL,BA,GR,IS,YU,HR,MT,MC
-A:PL,SK,SI,CZ,TR,HU,CY
-T:*/*=0.25(60)/60
-Z:203 Europa 3
-T:*/*=0.45(60)/60
-A:BG,KZ,MK,MD,RO,SU,BY
-Z:204 Nordamerika
-A:CA,US,_HAWA
-T:*/*=0.12(60)/60
-Z:205 Suedamerika/Suedafrika
-A:AR,CL,CO,LS,ZA
-T:*/*=1.20(60)/60
-Z:206 Welt 1
-A:EG,DZ,EE,IL,JO,LB,LY,LV,LT
-A:EH,SY,TN
-T:*/*=0.60(60)/60
-Z:207 Welt 2
-A:AU,CN,HK,JP,KR,NZ,SG,TW
-T:*/*=0.80(60)/60
-Z:208 Welt 3
-A:BR,DO,MX
-T:*/*=1.00(60)/60
-Z:209 Welt 4 (restliche Laender)
-T:*/*=1.40(60)/60
+T:*/*=0.072/60
+# Ausland wie Meocom ISDN
+R:100,0;201-
+#
+# Es gibt weitere Tarife bei meocom (ISDN business ...)
+#####################################################################
+#
+#
+P:112,0 010012 Telecom GmbH
+B:010012
+C:Address:Postfach 200743, 40104 Dsseldorf
+C:Name:010012 Telecom GmbH
+C:Homepage:http://www.010012.com/
+C:TarifURL:http://www.010012.com/PDF/alltarif.pdf
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+C:Euro
+D:dtag
+# G:03-Jan-2003
+Z:0 FreeCall
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
+T:*/*=0
+Z:2-4 National
+A:+49
+T:*/09-18=0.06/60 Tagtarif
+T:*/18-09=0.04/60 Nachttarif
+Z:10 Mobilfunk D
+A:_DEMD1	# D1
+A:_DEMD2
+T:*/*=0.26/60
+Z:11 Mobilfunk E
+A:_DEME1		# Eplus
+A:_DEME2		# E2
+T:*/*=0.29/60
+#####################################################################
+#
+#
+P:123,0 010023 CbC
+B:010023
+D:dtag
+C:Name:010023 CbC (VarTec Telecom)
+C:Address:VarTec Telecom Deutschland, Bismarckallee 7a, 79098 Freiburg
+C:Homepage:http://www.vartec.de/
+C:TarifURL:http://www.vartec.de/german/products/cbc/domestic.asp
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+Z:0 FreeCall
+A:0800*			# Freephone
+A:031*			# Testrufnummern
+A:110			# Polizei
+A:112			# Notruf, Feuerwehr
+T:*/*=0
+Z:2-4 National
+A:DE
+T:1-5/08-18=0.035(60)/600/60 Geschftszeit
+T:1-5/18-08=0.025(60)/600/60 Freizeit
+T:6-7/*=0.025(60)/600/60 Freizeit
+Z:10 Mobilfunknetze
+A:_DEMF
+T:*/*=0.50|0.199/60
+# auerdem Preselect-Tarif im Angebot
+#####################################################################
+#
+#
+P:223,0 HugoTel
+B:0190023
+C:Name:HugoTel
+C:Address:CONOS AG, Mottmannstrasse 2, 53842 Troisdorf, Telefon (02241) 94 34-0
+C:Homepage:http://www.hugotel.de/
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+Z:0 FreeCall
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
+T:*/*=0
+Z:1-4 GermanCall
+A:+49
+T:*/*=0.060/60
+Z:10 Mobilfunk
+A:_DEMF
+T:*/*=0.240/60
 #####################################################################
 #
 #
 P:224,0 Pennyphone
 B:0190024
-C:Address:
+C:Address:Callax Telecom Holding GmbH, Stichwort "PennyPHONE", Leopoldstr. 16, 40211 Dsseldorf
 C:Name:Pennyphone (01058)
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.pennyphone.de/
+C:TarifURL:http://www.pennyphone.de/tarife.php
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-# G:02-Apr-2002
+# G:26-Jul-2003
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:1-4 GermanCall
 A:+49
-T:*/*=0.026/60
+T:1-5/21-00=0.016/60 Nebenzeit
+T:1-5/00-21=0.027/60
+T:6-7/*=0.027/60
 Z:10 Mobilfunk
 A:_DEMD1
 A:_DEMD2
 A:_DEME1
 A:_DEME2
-T:*/*=0.195/60
+T:*/*=0.180/60
+#####################################################################
+#
+#
+P:225,0 Clever25
+B:0190025
+C:Name:Clever25 (Talkline ID 01050)
+C:Address:Clever25 @
+C:Address:Talkline-Platz 1, D-25388 Elmshorn
+C:Homepage:http://www.clever25.de/
+C:TarifURL:http://www.clever25.de/tarife.php
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+# G:26-Jul-2003
+Z:0 FreeCall
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
+T:*/*=0
+Z:1-4 GermanCall
+A:+49
+T:1-5/09-17=0.024/60
+T:6-7/09-17=0.026/60
+T:*/17-09=0.036/60
+Z:10 Mobilfunk
+A:_DEMF
+T:*/*=0.238/60
+#####################################################################
+#
+#
+P:228,0 maxTEL!
+B:0190028
+C:Address:Callax Telecom Holding GmbH, Stichwort "Maxtel", Postfach 240 319, 40091 Dsseldorf
+C:Homepage:http://www.maxtel.de/
+C:Name:maxTEL (01058)
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+# G:17.04.2003 12:18
+Z:0 FreeCall
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
+T:*/*=0
+Z:1-4 GermanCall
+A:+49
+T:*/*=0.026(60)/180
+Z:10 Mobilfunk
+A:_DEMD1
+A:_DEMD2
+A:_DEME1
+A:_DEME2
+T:*/*=0.169(60)/180
 #####################################################################
 #
 #
 P:229,0 Telebillig*
 B:0190029
-C:Address:
+C:Address:Telebillig @ TeleDiscount GmbH, Schillingrotter Strasse 38, 50996 Kln
 C:Name:Telebillig (01051)
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.telebillig.de/
+C:TarifURL:http://www.telebillig.de/tarife.php3
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-# G:02-Apr-2002
+# G:07-Aug-2003
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:1-4 GermanCall
 A:+49
-T:*/*=0.024/60
+T:*/*=0.025/60
 Z:10 Mobilfunk
 A:_DEMF
-T:*/*=0.20/60
+T:*/*=0.145/60
+Z:208 Dnemark
+A:DK
+T:*/*=0.031/60
 #####################################################################
 #
 #
 P:231,0 Teledump*
 B:0190031
-C:Address:
+C:Address:Teledump @ TeleDiscount GmbH, Schillingrotter Strasse 38, 50996 Kln
 C:Name:Teledump (01051)
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.teledump.de/index2.php
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-# G:23-Apr-2002
+# G:11-Jul-2003
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:1-4 GermanCall
 A:+49
@@ -3205,68 +4578,91 @@
 #
 P:232,0 Phonedump
 B:0190032
-C:Address:
+C:Address:Callax Telecom Holding GmbH, Stichwort "Phonedump", Postfach 240 319, 40091 Dsseldorf
 C:Name:Phonedump (01058)
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.phonedump.de/index2.php
+C:TarifURL:http://www.phonedump.de/tarife.php
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-# G:26-Jun-2002
+# G:26-Jul-2003
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:1-4 GermanCall
 A:+49
-T:*/*=0.028/60
+T:1-5/18-19=0.020/60
+T:1-5/19-18=0.028/60
+T:6-7/*=0.028/60
 Z:10 Mobilfunk
 A:_DEMD1
 A:_DEMD2
 A:_DEME1
 A:_DEME2
-T:*/*=0.169/60
+T:*/*=0.179/60
 #####################################################################
 #
 #
 P:235,0 TeleDiscount*
 B:0190035
-C:Address:
+D:dtag
+C:Address:TeleDiscount GmbH, Schillingrotter Strasse 38, 50996 Kln
 C:Name:TeleDiscount (01051)
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.telediscount.de/
+C:TarifURL:http://www.telediscount.de/tarife.php
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+# G:26-Jul-2003
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
-Z:1-4 GermanCall
-A:+49
+Z:1 Ortsgesprch
+T:*/*=0.015/60
+Z:2-4 GermanCall
+A:DE
 T:*/*=0.029/60
 Z:10 Mobilfunk
 A:_DEMF
-T:*/*=0.19/60
+T:*/*=0.185/60
+Z:208 Dnemark
+A:DK
+T:*/*=0.036/60
 #####################################################################
 #
 #
 P:237,0 Fonfux
 B:0190037
-C:Address:
+D:dtag
+C:Address:Callax Telecom Holding GmbH, Stichwort "FONFUX", Leopoldstr. 16, 40211 Dsseldorf
 C:Name:Fonfux (01058)
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.fonfux.de/
+C:TarifURL:http://www.fonfux.de/tarife.php
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+# G:15-Jun-2003
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
-Z:1-4 GermanCall
-A:+49
-T:*/*=0.026/60
+Z:1 Ortsgesprch
+T:W/9-18=0.0280/60 Hauptzeit
+T:W/18-9=0.0099/60 Nebenzeit
+T:E/*=0.0099/60 Nebenzeit
+Z:2-4 GermanCall
+A:DE
+T:W/9-18=0.0360/60 Hauptzeit
+T:W/18-9=0.0280/60 Nebenzeit
+T:E/*=0.0280/60 Nebenzeit
 Z:10 Mobilfunk
 A:_DEMD1
 A:_DEMD2
@@ -3276,184 +4672,410 @@
 #####################################################################
 #
 #
-P:249,0 Germanphone
+P:247,0 Surprise Telecom
+B:0190047
+C:Name:Surprise Telecom (TeleDiscount)
+C:Name:(vormals) Spar Telecom (TeleDiscount)
+C:Address:Surprise Telecom @
+C:Address:TeleDiscount GmbH, Schillingroter Strasse 38, 50996 Kln
+C:Homepage:http://www.surprisetelecom.com/
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+# G:01-Jun-2003
+Z:0 FreeCall
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
+T:*/*=0
+Z:1-4 GermanCall
+A:+49
+T:1-5/09-18=0.025/60 Hauptzeit
+T:1-5/18-09=0.020/60 Nebenzeit
+T:6-7/*=0.016/60 Sa-So
+Z:10 Mobilfunk
+A:_DEMF
+T:*/*=0.17/60
+Z:208 Dnemark
+A:DK
+T:*/*=0.037/60
+#####################################################################
+#
+#
+P:249,0 Germanphone!
 B:0190049
-C:Address:
+C:Address:Callax Telecom Holding GmbH, Stichwort "GERMANPHONE", Leopoldstr. 16, 40211 Dsseldorf
 C:Name:Germanphone (01058)
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.germanphone.de/
+C:Special:Germanphone Homepage erfordert Flash, vermutlich Version >= 6.
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-# G:22-Jun-2002
+# G:26-Jul-2003
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:1-4 GermanCall
 A:+49
-T:*/*=0.018(60)/300
+T:*/*=0.020(60)/300
 Z:10 Mobilfunk
 A:_DEMD1
 A:_DEMD2
 A:_DEME1
 A:_DEME2
-T:*/*=0.16(60)/300
+T:*/*=0.138(60)/300
+Z:208 Dnemark
+A:DK
+T:*/*=0.020(60)/300
+#####################################################################
+#
+#
+P:251,0 Junior Telecom*
+B:0190051
+C:Address:Junior Telecom @ TeleDiscount GmbH, Schillingrotter Strasse 38, 50996 Kln
+C:Name:Junior Telecom (01051)
+C:Homepage:http://www.junior-telecom.de/
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+# G:28-Jun-2003
+Z:0 FreeCall
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
+T:*/*=0
+Z:1-4 GermanCall
+A:+49
+T:W/09-18=0.021/60 Hauptzeit
+T:W/18-09=0.024/60 Nebenzeit
+T:E,H/*=0.024/60 Nebenzeit
+Z:10 Mobilfunk
+A:_DEMD1
+A:_DEMD2
+A:_DEME2
+A:_DEME1
+T:*/*=0.175/60
 #####################################################################
 #
 #
 P:254,0 Calladin!
 B:0190054
-C:Address:
+C:Address:Callax Telecom Holding GmbH, Stichwort "Calladin", Leopoldstr. 16, 40211 Dsseldorf
 C:Name:Calladin (01058)
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.calladin.de/
+C:TarifURL:http://www.calladin.de/tarife.php
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-# G:23-Apr-2002
+# G:07-Dec-2002
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:1-4 GermanCall
 A:+49
-T:W/08-19=0.03/0,0.026/60 Hauptzeit
-T:W/19-08=0.03/0,0.018/60 Nebenzeit
-T:E,H/*=0.03/0,0.018/60 Freizeit
+T:1-5/08-19=0.046(60)/180 Hauptzeit
+T:1-5/19-08=0.0185(60)/180 Nebenzeit
+T:6-7/*=0.0185(60)/180 Freizeit
 Z:10 Mobilfunk
 A:_DEMD1
 A:_DEMD2
-A:_DEME1
-A:_DEME2
-T:*/*=0.185/60
+A:_DEME1		# Eplus
+A:_DEME2		# E2
+T:*/*=0.169(60)/180
 #####################################################################
 #
 #
 P:271,0 RapidCall!
 B:0190071
-C:Address:
+C:Address:Callax Telecom Holding GmbH, Stichwort "Rapidcall", Leopoldstr. 16, 40211 Dsseldorf
 C:Name:RapidCall (01058)
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.rapidcall.de/
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
 C:TarifURL:http://www.rapidcall.de/tarife.php
+# G:21-Sep-2002
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:1-4 GermanCall
 A:+49
-T:W/08-19=0.024(60)/240 Hauptzeit
-T:W/19-08=0.019(60)/240 Nebenzeit
-T:E,H/*=0.019(60)/240 Freizeit
+T:1-5/08-19=0.024(60)/240 Hauptzeit
+T:1-5/19-08=0.019(60)/240 Nebenzeit
+T:6-7/*=0.019(60)/240 Freizeit
 Z:10 Mobilfunk
 A:_DEMD1
 A:_DEMD2
 A:_DEME1
 A:_DEME2
-T:*/*=0.16(60)/240
+T:*/*=0.159(60)/240
+Z:208 Dnemark
+A:DK
+T:*/*=0.029(60)/240
+#####################################################################
+#
+#
+P:273,0 Tele2 Ortstarif
+#
+# Das folgende sind *nur* Vermutungen von mir (c)AK:10-Aug-2002
+#
+# Seit einigen Tagen koennen Tele2 Kunden, die einen Tele2-LCR
+# besitzen, angeblich auch im Ortsnetz telefonieren.
+# Dazu verwendet dieser Router alias "Ihear-Telefon" offensichtlich die
+# 01900732.
+# -------^ ! <-- so etwas ist bislang nicht wirklich vorgesehen ...
+# Fhrt aus Sicht von isdnlog zu verschiedenen Gebhren im eigenen Ortsnetz.
+# Nach Entfernen der VBN beginnen alle Rufnummern mit 2, sind damit keine
+# Sonderrufnummern, werden daher in +49-<eigenes_Ortsnetz>-2.. umgesetzt.
+# Als Folge muss in Zonen 2 und weiter hier das eigene Ortsnetz angegeben
+# werden.  Somit bekommt fast jeder Tele2 Kunde sein eigenes rate-file.
+# Im folgenden ist dafr @areacode@ durch die Kennzahl des eigenen Ortsnetzes
+# zu ersetzen; die Kennzahl ohne fhrende Null. Mglicher Befehl dafr:
+# cat rate-de.dat | sed -e s%@areacode@%521%g > rate-de.dat.new 
+# wenn 0521 das eigene Ortsnetz ist (Anregung aus dem isdnlog Makefile).
+# Diese Pseudo-Variable darf keine Grossbuchstaben enthalten, da diese
+# beim Entstehen der rate-de.dat durch pp_rate in Kleinbuchstaben gewandelt
+# werden wrden.  Ohne diesen Eingriff finden die Tarifdaten nur beim
+# Vergleich mit isdnrate Anwendung.  Das alles ist hochexperimentell.
+# Erfahrungsberichte an die rates4linux Mailingliste sind erwnscht.
+#
+B:0190073
+C:Name:Tele2 Ortstarif
+C:Address:TELE2 Telecommunications Services GmbH,
+C:Address:In der Steele 39, 40599 Dsseldorf
+C:Quelle:Preisliste 22, gltig ab 2003-07-09
+C:TarifURL:http://www.tele2.de/ger/pdf/T_Privat.pdf
+C:TarifURL:http://www.tele2.de/chap02/c020201b.html
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+# G:05-May-2003
+Z:0 FreeCall
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
+T:*/*=0
+# default fr alles nicht weiter definierte
+Z:1 Ort
+A:+49@areacode@21
+A:+49@areacode@22,+49@areacode@23,+49@areacode@24,+49@areacode@25
+A:+49@areacode@26,+49@areacode@27,+49@areacode@28,+49@areacode@29
+T:W/07-19=0.0309/60
+T:W/19-07=0.0099/60 Einfhrungspreis bis mind. 31.08.2003
+T:E,H/*=0.0099/60 Einfhrungspreis bis mind. 31.08.2003
+# Ferngesprch nach 0521* als 2_0521* -> Ortsnetze von 202*-209*
+Z:2-4 Fern
+A:+49
+A:+49@areacode@202,+49@areacode@203,+49@areacode@204,+49@areacode@205
+A:+49@areacode@206,+49@areacode@207,+49@areacode@208,+49@areacode@209
+T:W/07-19=0.045/60
+T:W/19-07=0.0165/60
+T:E,H/*=0.0175/60
+# Ab hier Tarifbeschreibung (s. TarifURL) unklar:
+# Unterschieden wird zwischen `Tele2 Preselection' (Tele2-iHead Telefone, Tele2-
+# Smartbox, Intellinet-Controller) und `Tele2 Call by Call'.
+# `Call by Call' gilt gem http://www.tele2.de/ger/pdf/T_Privat.pdf fr
+# `0-10-13 Vorwhler', daher hier `Preselection' gewhlt.
+Z:10 Mobil D
+A:_DEMD1,_DEMD2
+A:+49@areacode@201511*,+49@areacode@20160*
+A:+49@areacode@20170*,+49@areacode@20171*,+49@areacode@20175*
+A:+49@areacode@201720*,+49@areacode@20162*
+A:+49@areacode@20172*,+49@areacode@20173*,+49@areacode@20174*
+T:*/*=0.1999/60
+Z:11 Mobil E
+A:_DEME1,_DEME2
+A:+49@areacode@20163*,+49@areacode@20177*,+49@areacode@20178*
+A:+49@areacode@20176*,+49@areacode@20179*
+T:*/*=0.2199/60
+# Ausland wird nur fr Tarifvergleich eingebunden, nicht fr Berechnung
+# gewhlter Nummern, das wrde zu +49@areacode@200.. fhren.
+R:13,1;200-
 #####################################################################
 #
 #
 P:276,0 Telestunt*
 B:0190076
-C:Address:
+C:Address:Telestunt @ TeleDiscount GmbH, Schillingrotter Strasse 38, 50996 Kln
 C:Name:Telestunt (01051)
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.telestunt.de/
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-# G:01-Mai-2002
+# G:01-Jun-2003
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:1-4 GermanCall
 A:+49
-T:*/*=0.019/60
+T:*/09-18=0.028/60
+T:*/18-09=0.022/60
 Z:10 Mobilfunk
 A:_DEMF
-T:*/*=0.15(60)/240
+T:*/09-18=0.185/60
+T:*/18-09=0.150/60
+#####################################################################
+#
+#
+P:279,0 Ventelo smart79
+B:0190079
+C:Address:smart79 @, Ventelo GmbH, Am Seestern 3, 40547 Dsseldorf
+C:Name:Ventelo smart79
+C:Homepage:http://www.smart79.de/
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+# G:29-Jan-2003
+Z:0 FreeCall
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
+T:*/*=0
+Z:1-4 GermanCall
+A:+49
+T:W/08-18=0.0304/60
+T:[-12.02.2003]W/18-08=0.0184/60 Aktionspreis
+T:[-12.02.2003]E,H/*=0.0184/60 Aktionspreis
+T:[12.02.2003]W/18-08=0.0214/60
+T:[12.02.2003]E,H/*=0.0214/60
+Z:10 Mobilfunk
+A:_DEMF
+T:*/*=0.239/60
 #####################################################################
 #
 #
 P:282,0 lightTALK
 B:0190082
-C:Address:
+C:Address:Callax Telecom Holding GmbH, Stichwort "lightTALK", Leopoldstr. 16, 40211 Dsseldorf
 C:Name:lightTALK (01058)
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.lighttalk.de/
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+# G:05-Aug-2002
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:1-4 GermanCall
 A:+49
-T:W/08-19=0.044(60)/1
-T:W/19-08=0.024(60)/1
-T:E,H/*=0.024(60)/1
+T:1-5/08-19=0.044(60)/1
+T:1-5/19-08=0.024(60)/1
+T:6-7/*=0.024(60)/1
 Z:10 Mobilfunk
 A:_DEMD1
 A:_DEMD2
 A:_DEME1
 A:_DEME2
-T:*/*=0.244(60)/1
+T:*/*=0.225(60)/1
+# Quelle folgender Zone unbekannt (2003-01-04)
+Z:11 Quam
+A:_DEMQ
+T:*/*=0.24(60)/1
 #####################################################################
 #
 #
 P:284,0 maxbell
 B:0190084
-C:Address:
+C:Address:Callax Telecom Holding GmbH, Stichwort "MAXBELL", Leopoldstr. 16, 40211 Dsseldorf
 C:Name:maxbell (01058)
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.maxbell.de/
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
-# G:26-Jun-2002
+# G:16-Nov-2002
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:1-4 GermanCall
 A:+49
-T:*/*=0.020/60
+T:*/*=0.028/60
 Z:10 Mobilfunk
 A:_DEMD1
 A:_DEMD2
 A:_DEME1
 A:_DEME2
-T:*/*=0.20/60
+T:*/*=0.189/60
 #####################################################################
 #
 #
 P:287,0 Phonecraft
 B:0190087
-C:Address:
+D:dtag
+C:Address:Callax Telecom Holding GmbH, Stichwort "PHONECRAFT", Leopoldstr. 16, 40211 Dsseldorf
 C:Name:Phonecraft (01058)
-C:Maintainer:Tarif Datenbank Crew <crew@rates4linux.sourceforge.net>
+C:Homepage:http://www.phonecraft.de/
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:TarifURL:http://www.phonecraft.de/tarife.php
 C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+# G:07-Aug-2003
 Z:0 FreeCall
-A:011*
-A:0130*,0800*,0801*
-A:031*
-A:110
-A:112
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
+T:*/*=0
+Z:1 Ortsgesprch
+T:1-5/12-18=0.0099/60
+T:1-5/18-12=0.029/60
+T:6-7/*=0.029/60
+Z:2-4 Ferngesprch
+A:DE
+T:1-5/*=0.029/60
+T:6-7/*=0.016/60
+Z:10 Mobilfunk
+A:_DEMD1
+A:_DEMD2
+A:_DEME1
+A:_DEME2
+T:*/*=0.190/60
+#####################################################################
+#
+#
+P:295,0 superdump
+B:0190095
+C:Address:Callax Telecom Holding GmbH, Stichwort "Superdump", Postfach 240 319, 40091 Dsseldorf
+C:Name:superdump (01058)
+C:Homepage:http://www.superdump.de/
+C:Maintainer:Tarif Datenbank Crew <rates4linux-crew@lists.sourceforge.net>
+C:Special:Die Homepage der Tarif-Datenbank Crew: http://rates4linux.sourceforge.net
+# G:09-Feb-2003
+Z:0 FreeCall
+A:011*		      # netzinterne Nutzung
+A:0130*,0800*,0801* # Freephone
+A:031* 	 	      # Testrufnummern
+A:110		      # Polizei
+A:112		      # Notruf, Feuerwehr
 T:*/*=0
 Z:1-4 GermanCall
 A:+49
-T:*/*=0.025/60
+T:*/*=0.029/60
 Z:10 Mobilfunk
 A:_DEMD1
 A:_DEMD2
 A:_DEME1
 A:_DEME2
-T:*/*=0.20/60
+T:*/*=0.21/60
 #####################################################################
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/samples/rate.conf.de isdn4k-utils-v3.3/isdnlog/samples/rate.conf.de
--- isdn4k-utils-v3.2p1/isdnlog/samples/rate.conf.de	2002-07-05 23:22:32.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/samples/rate.conf.de	2003-08-07 21:08:51.000000000 +0000
@@ -1,209 +1,82 @@
-# rate.conf  4.46  07-Jun-02  17:33
+# rate.conf zur rate-de.dat fr Konfiguration der aktiven Provider.
+# 
+# $Id: rate.conf.de,v 1.37 2003/08/07 21:08:51 tobiasb Exp $
+# Basiert auf Rev. 1.35 von isdn4k-utils/isdnlog/samples/rate.conf.de
+# zu isdnlog-4.64 im isdn4linux-CVS.
+# blicherweise in /etc/isdn installiert.
 
 # E = echtes Call by Call, d.h. kann sofort ohne Anmeldung genutzt
 #     werden. Abrechnung erfolgt ueber die Telekom-Rechnung
 #
 # A = unechtes Call by Call, d.h. man muss sich zuerst anmelden
 
-# P:10=0  #A Teleglobe
 P:11=0    #E o.tel.o CbC
-# P:11=1  #A o.tel.o private Preselection
-# P:11=2  #A o.tel.o private plus Preselection
-# P:11=3  #A o.tel.o professional plus Preselection
-# P:11=4  #A o.tel.o international plus Preselection
-# P:12=0  #A Tele Danmark
-# P:13=0  #A Tele 2 Privatkunden
-# P:13=1  #A Tele 2 Preselection
-# P:14=0  #A EWE TEL CbC national
-# P:14=1  #A EWE TEL CbC/pre-select regional
-# P:14=2  #A EWE TEL direct
-P:15=0    #E RSL clever call
-# P:15=1  #A RSL CleverLine global
-# P:15=2  #A RSL CleverLine metropolitan
-# P:16=0  #A LausitzNet
-P:17=0    #E 01017
-# P:18=0  #A debitel
-# P:18=1  #A debitel DirectLine Profi-Tarif 30 Sekunden
-# P:18=2  #A debitel DirectLine Privat-Tarif Sekunden Takt
-# P:18=3  #A debitel DirectLine Profi-Tarif Sekunden Takt
-P:19=0    #E Mobilcom CbC
-# P:19=1  #A Mobilcom Preselection/Business
-# P:19=2  #A Mobilcom Preselection/Privat
-# P:19=3  #A Mobilcom CbC mit freenet PowerTarif
-# P:20=0  #A ISIS isiFON classic
-# P:20=1  #A ISIS isiFON plus
-# P:20=2  #A ISIS Preselection
-P:21=0    #E QSC
-# P:22=0  #A NetCologne
-# P:23=0  #A tesion connectClassic
-# P:23=1  #A tesion connectProfi
-P:23=2    #E tesion CbC
-# P:24=0  #A Telepassport 99 Plus
-# P:24=1  #A Telepassport Plus
-# P:24=2  #A Telepassport CbC
-# P:24=3  #A Telepassport RegionalTarif Plus
-# P:24=4  #A Telepassport SdOst-Tarif
-# P:24=5  #A Telepassport SdOst
-# P:24=6  #A Telepassport StudentenTarif
-P:24=7    #E Super 24
-# P:25=0  #A CityKom
-# P:25=1  #A CityKom Preselection
-# P:26=0  #A ECN
-# P:27=0  #A Nordcom Butensurf
-# P:27=1  #A Nordcom Butensurf Plus
-# P:28=0  #A TeleBridge CbC
-# P:28=1  #A TeleBridge EasyBridge
-# P:28=2  #A UPX Super 8
-# P:28=3  #A Nikoma by Call
-# P:29=0  #A Unisource
-P:30=0    #E TelDaFax
-# P:31=0  #A HEAG
-# P:32=0  #A KDD
+P:13=0    #E Tele 2 Privat CbC (Anmeldung fuer separate Rechnung)
+# P:13=1  #A Tele 2 Privat Preselection
+# P:13=2  #A Tele 2 Turbo CbC
+# P:13=3  #A Tele 2 Turbo Preselection
+P:15=0    #E Maestro Telekom
+P:19=0    #E 01019 CbC (ehemals Mobilcom)
+# P:19=1  #A 01019 Profi 
+# P:19=2  #A 01019 Privat
+# P:19=3  #A 01019 Aktiv 8
+P:24=0    #E 01024 CbC
+# P:27=0  #A Nordcom nordFon(Net) ISDN
+# P:27=1  #A Nordcom nordFonNet Pro
 P:33=0  #E DTAG T-ISDN Standard
-# P:33=1  #A DTAG T-ISDN 300
-# P:33=2  #A DTAG T-ISDN xxl
-# P:34=0  #A NEFkom
-# P:35=0  #A interCOM
-# P:36=0  #A Hutchison fairfon
-# P:36=1  #A Hutchison easyfon
-# P:36=2  #A Hutchison o.tel.o private
-# P:36=3  #A Hutchison fairfon Sekundentakt
-# P:36=4  #A Hutchison easyfon Sekundentakt
-# P:37=0  #A ETS
-# P:38=0  #A MediaWays
-P:39=0    #E First Telecom CbC
+# P:33=1  #A DTAG AktivPlus
+# P:33=2  #A DTAG AktivPlus xxl
+# P:33=3  #A DTAG AktivPlus basis
+P:39=0    #E 01039 Call-Mc-Call
 P:40=0    #E Ventelo
-# P:41=0  #A HanseNet
+# P:41=0  #E HanseNet CbC (nur aus Hamburg)
 # P:41=1  #A HanseNet Preselection
-# P:42=0  #A TeleBeL ISDN Plus
-# P:42=1  #A TeleBeL ISDN XL
-# P:43=0  #A KielNet CbC
-# P:43=1  #A KielNet Preselection
-# P:43=2  #A KielNet Telefonanschlu
-# P:44=0  #A VEW TELNET
-# P:45=0  #A Global Network
-# P:46=0  #A KomTel
-# P:46=1  #A KomTel MoinMoin
-# P:47=0  #A PrimeTec
-# P:48=0  #A DOKOM
-# P:49=0  #A ACC ACCess Direkt Pre-Selection Einheitentarif  # diese Firma gibt es nicht mehr
-# P:49=1  #A ACC ACCess Direkt Pre-Selection Minutentarif
-# P:49=2  #A ACC ACCess Einheitentarif CbC
-# P:49=3  #A ACC ACCess Minutentarif CbC
+# P:41=2  #A HanseNet Komplett Standard
+# P:41=3  #A HanseNet Komplett Profi
 P:50=0    #E Talkline CbC
-# P:50=1  #A Talkline EasyLine
-# P:50=2  #A Talkline talkmax
-# P:50=3  #A Talkline BusinessLine Classic
-# P:50=4  #A Talkline BusinessLine Local
 P:51=0    #E 01051
-# P:52=0  #A Long Distance
-# P:53=0  #A WOBCOM
-# P:54=0  #A USFI
 P:55=0    #E prompt
-# P:56=0  #A BITel
-# P:57=0  #A Mox
-# P:58=0  #A KaTel
-# P:59=0  #A Pacific Gateway Exchange
-# P:60=0  #A Telecom-InfoService
-# P:61=0  #A TelSA
-# P:62=0  #A DENTEL
-# P:63=0  #A KDD-Conos PrivateCall easy
-# P:63=1  #A KDD-Conos PrivateCall genau
-P:63=2    #E KDD-Conos CbC
-# P:64=0  #A Hannoversche
-# P:65=0  #A Rapid Link
-P:66=0    #E Interoute
-# P:67=0  #A RegioCom
-# P:68=0  #A Tele Media
-# P:69=0  #A PTI Primus
+P:58=0    #E 01058 (vormals KaTel)
+P:63=0    #E Conos CbC
+# P:63=1  #A oneVoice Second
+# P:63=2  #A oneVoice Minute
 P:70=0    #E Arcor CbC
-# P:70=1  #A Arcor Town to Town
-# P:70=2  #A Arcor Town to Town Sekunde
-# P:71=0  #A DeTeMobil
-# P:72=0  #A Mannesmann
-# P:73=0  #A AXXON
-# P:74=0  #A Alpha
-P:75=0    #E Callino
-# P:76=0  #A QuickNet
-# P:77=0  #A E-Plus
+# P:70=1  #A Arcor Preselect standard
+# P:70=2  #A Arcor Preselect world
+P:77=0    #E 01077
 P:78=0    #E 3U
-P:79=0    #E Viatel
-# P:80=0  #E Telegate                     # diesen Dienst gibt es seit 14.3.2000 nicht mehr
-# P:81=0  #A Infotel
-# P:82=0  #A AugustaKom
-# P:83=0  #A Wuerzburger
-# P:84=0  #A Telegroup
-# P:85=0  #E GTS-WESTCom              # Diese Firma gibt es seit 31.12.1999 nicht mehr!
-P:86=0    #E One.Tel
-# P:87=0  #A HAMCOM
-# P:88=0  #A WorldCom
-# P:88=1  #A Hutchison CbC
-# P:89=0  #A M'net
-P:90=0    #E Viag Interkom
-# P:91=0  #A IDT
-# P:92=0  #A Hallo Telefon Service
-# P:93=0  #A Kray
+P:80=0    #E Telegate
+P:81=0    #E 01081
+P:86=0    #E 01086 by Call (Standard)  # aus dem brigen Bundesgebiet
+# P:86=1  #E 01086 by Call-City        # aus 23 Grostdten
+# P:89=0  #A M'net ISDN privat (vormals M'net Klassik)
+# P:89=1  #A M'net Klassik plus
+# P:89=2  #A M'net GGD
+# P:89=3  #A M'net ISDN privat sekundengenau
+P:90=0    #E BT Ignite CbC (vormals Viag Interkom)
 P:94=0    #E Startec
-# P:95=0  #A Teleos
-# P:96=0  #A GELSEN-NET
-# P:97=0  #A AT & T-Unisource
-# P:98=0  #A Mox
-# P:99=0  #A ECONOPHONE
-# P:100=0 #A TELELEV
-# P:100=1 #A Meocom
-# P:101=0 #A Netnet
-# P:102=0 #A EncoTel
-# P:103=0 #A mevacom
-# P:107=0 #A KPN
-# P:108=0 #A USA Global Link
-# P:109=0 #A ChemTel
-# P:110=0 #A Bertelsmann mediaSystems
-# P:111=0 #A RED LINE
+# P:100=0 #A Meocom ISDN
+# P:100=1 #A Meocom ISDN plus
 P:112=0   #E 11883 Telecom
-# P:114=0 #A <FREI>
-# P:115=0 #A Delta Three
-# P:118=0 #A MFS
-# P:119=0 #A E.T.H.
-# P:120=0 #A Komm Consult
-P:121=0   #E FITphone
-# P:122=0 #A Motorola
-# P:125=0 #A Mediascape
-# P:130=0 #A tnp telenet
-# P:131=0 #A accom
-# P:132=0 #A SD
-# P:133=0 #A Level 3
-# P:140=0 #A VossNet
-# P:142=0 #A connection 42
-# P:144=0 #A Carrier 1
-P:150=0   #E ElisaNet
-# P:154=0 #A Osnatel
-# P:155=0 #A Telia
-# P:156=0 #A NETCOM
-# P:160=0 #A JelloCom
-# P:168=0 #A VSE
-# P:170=0 #A Deutsche Telefon- und Marketing Services
-# P:173=0 #A TFN COM SA
-# P:175=0 #A <FREI>
-# P:177=0 #A WorldxChange
-# P:178=0 #A Cybernet
-# P:180=0 #A FaciliCom
-# P:181=0 #A Daten- und Telekommunikations-GmbH Dessau
-# P:184=0 #A <FREI>
-# P:185=0 #A FirstMark
-# P:188=0 #A jk-tel
-# P:190=0 #A CNE
-# P:195=0 #A TeleNec
-# P:199=0 #A ESTel
-P:224=0		#E Pennyphone   # -> 01058
-P:229=0		#E Telebillig   # -> 01051
-P:231=0		#E Teledump     # -> 01051
-P:232=0		#E Phonedump    # -> 01058
-P:235=0		#E TeleDiscount # -> 01051
-P:237=0		#E Fonfux       # -> 01058
-P:249=0		#E Germanphone	# -> 01058
-P:254=0		#E Calladin	# -> 01058
-P:271=0		#E RapidCall	# -> 01058
-P:276=0		#E Telestunt	# -> 01051
-P:282=0		#E lightTalk	# -> 01058
-P:284=0		#E maxbell	# -> 01058
-P:287=0		#E Phonecraft	# -> 01058
+P:123=0   #E 010023 CbC (VarTec Telecom)
+P:223=0     #E HugoTel          # -> 01063 Conos AG
+P:224=0		#E Pennyphone     # -> 01058
+P:225=0     #E Clever25         # -> 01050 Talkline ID
+P:228=0		#E maxTEL	  # -> 01058
+P:229=0		#E Telebillig     # -> 01051
+P:231=0		#E Teledump       # -> 01051
+P:232=0		#E Phonedump      # -> 01058
+P:235=0		#E TeleDiscount   # -> 01051
+P:237=0		#E Fonfux         # -> 01058
+P:247=0		#E Surprise Telecom  # -> TeleDiscount
+P:249=0		#E Germanphone	  # -> 01058
+P:251=0		#E Junior Telecom # -> 01051
+P:254=0		#E Calladin	  # -> 01058
+P:271=0		#E RapidCall	  # -> 01058
+P:273=0		#A Tele2 Ortstarif *experimentell*
+P:276=0		#E Telestunt	  # -> 01051
+P:279=0		#E smart79	  # -> Ventelo
+P:282=0		#E lightTalk	  # -> 01058
+P:284=0		#E maxbell	  # -> 01058
+P:287=0		#E Phonecraft	  # -> 01058
+P:295=0		#E superdump	  # -> 01058
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/.cvsignore isdn4k-utils-v3.3/isdnlog/tools/.cvsignore
--- isdn4k-utils-v3.2p1/isdnlog/tools/.cvsignore	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/.cvsignore	2003-07-25 22:55:24.000000000 +0000
@@ -0,0 +1,3 @@
+country
+isdnrate.1
+rate-files.5
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/NEWS isdn4k-utils-v3.3/isdnlog/tools/NEWS
--- isdn4k-utils-v3.2p1/isdnlog/tools/NEWS	2000-10-05 20:45:30.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/NEWS	2002-09-11 09:07:09.000000000 +0000
@@ -1,5 +1,10 @@
 NEWS for tools: (rate, isdnrate, isdnrep)
 
+2002.09.11
+  dest.c: patch from Tobias Becker to improve CC separation
+  s. also dest/README.probecc (in German) - many thanks
+  -lt
+  
 2000.08.16
   isdnrep: new option -S (summary)
   -lt
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/cdb/.cvsignore isdn4k-utils-v3.3/isdnlog/tools/cdb/.cvsignore
--- isdn4k-utils-v3.2p1/isdnlog/tools/cdb/.cvsignore	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/cdb/.cvsignore	2003-07-25 22:55:24.000000000 +0000
@@ -0,0 +1,18 @@
+config.cache
+config.h
+config.log
+config.status
+.depend
+Makefile
+cdbdump
+cdbdump.1
+cdbget
+cdbget.1
+cdb_hash.3
+cdbmake
+cdbmake.1
+cdb_seek.3
+cdbstats
+cdbstats.1
+cdbtest
+cdbtest.1
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/dest/.cvsignore isdn4k-utils-v3.3/isdnlog/tools/dest/.cvsignore
--- isdn4k-utils-v3.2p1/isdnlog/tools/dest/.cvsignore	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/dest/.cvsignore	2003-07-25 22:55:24.000000000 +0000
@@ -0,0 +1,7 @@
+config.cache
+config.log
+config.status
+dest
+dest.cdb
+dest.gdbm
+Makefile
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/dest/Makefile.in isdn4k-utils-v3.3/isdnlog/tools/dest/Makefile.in
--- isdn4k-utils-v3.2p1/isdnlog/tools/dest/Makefile.in	2002-02-22 11:10:25.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/dest/Makefile.in	2003-07-25 21:23:15.000000000 +0000
@@ -9,7 +9,7 @@
 CFLAGS			= -Wall -g
 INCLUDES		=
 LDFLAGS			= @DBMLIB@
-DBEXT			= @DBEXT@
+export DBEXT		= @DBEXT@
 RDBEXT			= @RDBEXT@
 CDBEXTRALIBS		= @CDBEXTRALIBS@
 PROGRAM			= dest
@@ -70,7 +70,7 @@
 	rm -f *.o *~ $(PROGRAM)
 
 dataclean:
-	rm -f *.gdbm *.db *.cdb
+	rm -f *.gdbm *.db *.cdb *.cdb.dump
 
 distclean: clean dataclean
 	rm -f config.status config.cache config.log *.man Makefile
@@ -81,12 +81,34 @@
 DEST_LANG= -en
 endif
 
-data:
-ifeq ($(DBEXT),.cdb)
-	@if [ -e dest.cdb.dump ] ; then \
-	    rm dest.cdb.dump ; \
-	fi
+# set source dependencies for destination database
+#  works only for data when $(DBEXT) = .cdb, otherwhise existing destination
+#  database blocks rebuilding and requires a manual make dataclean before.
+DEST_SRC_GLOBAL		:= ../../country-de.dat cities.dat
+DEST_SRC_ALLNATIONAL	:= $(shell ls ../zone/??/code)
+DEST_SRC_NATIONAL	:=
+ifeq ($(CONFIG_ISDN_LOG_DEST_AT),y)
+DEST_SRC_NATIONAL	+= ../zone/at/code
+endif
+ifeq ($(CONFIG_ISDN_LOG_DEST_DE),y)
+DEST_SRC_NATIONAL	+= ../zone/de/code
+endif
+ifeq ($(CONFIG_ISDN_LOG_DEST_NL),y)
+DEST_SRC_NATIONAL	+= ../zone/nl/code
 endif
+ifeq ($(CONFIG_ISDN_LOG_DEST_CH),y)
+DEST_SRC_NATIONAL	+= ../zone/ch/code
+endif
+
+ifeq ($(DBEXT),.cdb)
+data: dest.cdb
+
+# allow explicit request for dest.gbdm with configured DBEXT=".cdb"
+dest.gdbm: $(DEST_SRC_GLOBAL) $(DEST_SRC_NATIONAL)
+	$(MAKE) DBEXT=".gdbm" data
+
+else
+data: $(DEST_SRC_GLOBAL) $(DEST_SRC_NATIONAL)
 	@if [ ! -e dest$(DBEXT) ] ; then \
 	./makedest -v $(DEST_LANG) ; \
 	./makedest -v -gcities.dat -a $(DEST_LANG) ; \
@@ -103,16 +125,36 @@
 		./makedest -v -a ch || true; \
 	fi ; \
 	fi
-ifeq ($(DBEXT),.cdb)
-	@if [ ! -e dest.cdb ] ; then \
-	    echo "" >> dest.cdb.dump ; \
-	    echo Running cdbmake ; \
-	    ../cdb/cdbmake < dest.cdb.dump dest.cdb dest.temp ; \
-	    rm dest.cdb.dump ;\
-	fi
 endif
 
-alldata:
+dest.cdb: $(DEST_SRC_GLOBAL) $(DEST_SRC_NATIONAL)
+	@echo "Building destination database $@ ..."
+	@if [ -e dest.cdb.dump ] ; then \
+		rm dest.cdb.dump ; \
+	fi;
+	@if [ -e dest.cdb ] ; then \
+		rm dest.cdb ; \
+	fi;
+	./makedest -v $(DEST_LANG)
+	./makedest -v -gcities.dat -a $(DEST_LANG)
+ifeq ($(CONFIG_ISDN_LOG_DEST_AT),y)
+	./makedest -v -a at
+endif
+ifeq ($(CONFIG_ISDN_LOG_DEST_DE),y)
+	./makedest -v -a de
+endif
+ifeq ($(CONFIG_ISDN_LOG_DEST_NL),y)
+	./makedest -v -a nl
+endif
+ifeq ($(CONFIG_ISDN_LOG_DEST_CH),y)
+	./makedest -v -a ch || true
+endif
+	@echo "" >> dest.cdb.dump
+	../cdb/cdbmake < dest.cdb.dump dest.cdb dest.temp
+	@rm dest.cdb.dump
+	@echo "$@ complete."
+
+alldata: $(DEST_SRC_GLOBAL) $(DEST_SRC_ALLNATIONAL)
 ifeq ($(DBEXT),.cdb)
 	if [ -e dest.cdb.dump ] ; then \
 	    rm dest.cdb.dump ; \
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/dest/README.probecc isdn4k-utils-v3.3/isdnlog/tools/dest/README.probecc
--- isdn4k-utils-v3.2p1/isdnlog/tools/dest/README.probecc	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/dest/README.probecc	2002-09-11 09:07:09.000000000 +0000
@@ -0,0 +1,702 @@
+Folgender Text stammt von Tobias Becker, dem ich dafr meinen
+herzlichen Dank aussprechen mchte.
+
+Der Text zeigt erstens umfassend, wie die Lnder- und Nummernerkennung
+in isndlog funktioniert und behebt zweitens einen Bug darin, deshalb
+gebe ich ihn hier ungekrzt wieder. -lt
+
+
+isdnlog: country[-de].dat dest.cdb
+==================================
+
+Problem
+-------
+isdnrate -N <NUMMER>
+scheitert wenn <NUMMER> zwar in country-de.dat definiert ist,
+dieser Eintrag aber ein top-level Eintrag ist, d. h. ber
+kein R:-Tag verfgt und <NUMMER> nicht als erstes mit
+einem C:-Tag definiert ist.
+
+Beispiel
+--------
+country.dat:
+| N:Marianen (SaipanNord-)
+| A:Nrdliche Marianen, Marianen, Marianen (Saipan), Saipan, Salpan
+| A:Marianen (Nrdliche)
+| A:Westl. Marianen
+| E:Northern Mariana Islands
+| C:+1670, +1671
+| T:MP
+
+isdnrate erkennt nur den ersten Eintrag:
+| isdnrate -N +1670 +1671
+| +1670 => +1670 - (MP) - DTAG T-ISDN
+| +1671 => - (DE) - DTAG T-ISDN
+
+Ziel
+----
+Das Problem liesse sich wahrscheinlich umgehen, in dem alle Eintrge,
+deren Nummernraum eine Teilmenge des Nummernraumes eines anderen Lands
+darstellt, mit entsprechenden R:-Tags ausgestattet wrden.  Allerdings
+entspricht diese logische Zuordnung nicht den realen (politischen)
+Gegebenheiten.
+	Alternativ knnte man fr die gemeinsamen Rufnummernrume
+(+1, +269, +44, +7, u. a.) Pseudo top-level Eintrge anlegen,
+mte dann aber z. B. die USA vollstndig definieren und knnte
+nicht mittels einer Art default-Zuordnung fr +1, wie sie jetzt
+verwendet wird, arbeiten.
+	Daher soll versucht werden, denn Quelltext entsprechend
+abzundern, um ohne Nebeneffekte und ohne Zuordnung mit R:-Tags
+das Problem zu lsen.
+
+Ansatz
+------
+main() von isdnrate liegt in der Datei isdnlog/tools/isdnrate.c.
+hier wird opts() zum Auswerten der Optionen aufgerufen, -N
+veranlasst das Setzen der globalen Variable explain auf 55.
+opts() gibt den Index der ersten Nichtoption, hier der ersten
+Nummer zurueck.
+Es folgen die Funktionen init() und doit().
+init() ruft unter anderen initDest() aus isdnlog/tools/dest.c auf.
+
+doit() beginnt mit post_init():
+|   clearNum(&srcnum);
+|   if (fromarea) {
+|     Strncpy(srcnum.area, fromarea, TN_MAX_AREA_LEN);
+|     free(fromarea);
+|     fromarea = 0;
+|   }
+|   initNum(&srcnum);
+|
+|   if (wanted_day)
+| get_day(wanted_day);
+
+srcnum ist global definiert:
+| static TELNUM srcnum, destnum;
+
+Der Typ TELNUM stammt aus  isdnlog/tools/telnum.h:
+| /* for number 1002 0043 1 2345 or 1002 01 2345 it gives */
+| typedef struct {
+|   char vbn[TN_MAX_VBN_LEN];             /* "10" */
+|   char provider[TN_MAX_PROVIDER_LEN];   /* "UTA" */
+|   int nprovider;                        /* 2 */
+|   char scountry[TN_MAX_SCOUNTRY_LEN];   /* "Austria" */
+|   char country[TN_MAX_COUNTRY_LEN];     /* "+43" */
+|   char keys[TN_MAX_SCOUNTRY_LEN];       /* "VIA/AT" */
+|   char tld[3];                          /* "AT" */
+|   int ncountry;                         /* 43 */
+|   char area[TN_MAX_AREA_LEN];           /* "1" */
+|   int narea;                            /* 1 */
+|   char sarea[TN_MAX_SAREA_LEN];         /* "Wien" */
+|   char msn[TN_MAX_MSN_LEN];             /* "2345" */
+| } TELNUM;
+
+clearNum() stammt aus isdnlog/tools/telnum.c und wird dort
+wie folgt beschrieben
+|  * void clearNum(TELNUM *num)
+|  * --------------------------
+|  *      call this if you have a number on stack or want to reuse it
+|  *      normalizeNumber calls this for you
+|  *
+|  * void initNum(TELNUM *num)
+|  *      inits a number with myarea, mycountry
+|  *      you may set the area yourself prior to calling this
+
+clearNum() kopiert defnum, dies sind Standardwerte abhngig von der Konfiguration
+nach num.  defnum wird von initTelNum() aus telnum.c erstellt, das von initRate()
+aus rate.c aufgerufen, welches in isdnrate.c von init() aufgerufen wird.
+
+initNum() belegt einige Defaultwerte, falls nicht vorhanden und ruft getDest()
+auf mit +431, sofern im vergleich zu obigen TELNUM-Beispiel nichts anderes
+angegeben ist.
+
+getDest("+431", &srcnum) stammt aus isdnlog/tools/dest.c und ruft seinerseits
+get_cache("+431", &srcnum) auf, offenbar eine Art Zwischenspeicher fuer Zugriffe
+auf dest.cdb?
+
+
+... zunchst weiter mit doit() aus isdnrate.c unter der Annahme, das
+post_init nur srcnum sinnvoll vorbelegt, was hier nicht weiter von
+Interesse sein drfte.  Mglicherweise ist aber das oben erwhnte
+getDest() der gesuchte Ansatzpunkt.
+
+In doit werden nun in einer Schleife alle weitere Parameter der Befehlszeile
+abgearbeitet, hier der relevante Teil, da -N explain=55 zur Folge hatte.
+
+|    num = sub_sp(argv[i]);
+|    if (explain == 55) {
+|      if (n_providers) {
+|        destnum.nprovider = pnum2prefix_variant(providers[0], 0);
+|        Strncpy(destnum.provider, getProvider(destnum.nprovider), TN_MAX_PROVIDER_LEN);
+|        normalizeNumber(num, &destnum, TN_NO_PROVIDER);
+|      }
+|      else
+|        normalizeNumber(num, &destnum, TN_ALL);
+|      printf("%s => %s \n", num, formatNumber("%l - %p", &destnum));
+|      i++;
+|      continue;
+|    }
+
+sub_sp ersetzt Unterstriche durch Leerzeichen, sofern num nicht vollstndig aus
+Grossbuchstaben, Unterstrichen und Ziffern besteht, was bei Codes der Bauart
+AT oder _DEMD1 der Fall wre.
+
+n_providers ist ein globaler int, der anfnglich 0 ist und die Anzahl der in
+providers gespeicherten und mittels -p Option gewhlten Provider angibt.
+Gibt es keine Option -p, bleibt nproviders 0. (?)  Da im gewhlten Fehlerfall
+kein -p angegeben wurde, reduziert sich die Betrachtung auf die beiden Zeilen
+|        normalizeNumber(num, &destnum, TN_ALL);
+|      printf("%s => %s \n", num, formatNumber("%l - %p", &destnum));
+
+ num ist die Zielnummer aus der Befehlszeile, &destnum vom Typ TELNUM und
+bislang uninitialisiert, TN_ALL ist gleich 15 (telnum.h).  normalizeNumber
+stammt aus telnum.c und hat die Aufgabe num in einzelne Bestandteile zu
+zerlegen.
+
+ Rufen wir uns die kritisierte Ausgabe in Erinnerung:
+| isdnrate -N +1670 +1671
+| +1670 => +1670 - (MP) - DTAG T-ISDN
+| +1671 => - (DE) - DTAG T-ISDN
+formatNumber (ebenfalls aus telnum.c) ersetzt %p durch
+den verwendeten Provider, wobei hier die rate.conf offenbar
+nicht bercksichtigt wird.  Fr %l ist folgende Beispielausgabe
+vermerkt: %l .. long +49 30 12356 - Berlin (DE)
+
+%l ist ein Abkrzung fr formatNumber("%1c %1a %1m - %1A (%t)", num)
+wobei %c = .country  wenn vorhanden und .ncountry>0
+                     .country ist die Landesvorwahl als String mit + am Anfang,
+                     .ncountry die Landesvorwahl (country code) als Zahl
+      %a = .area  ist die inlndische Vorwahl (area code) als String,
+                  .narea ist das numerische Pendant.
+      %m = .msn  ist die Anschlussnummer im jeweiligen (Orts-) Netz als String.
+      %A = .sarea  ist die Bezeichnung der Vorwahl, z. B. Ortsname.
+      %t = .tld   ist die top-level Destination der Rufnummer.
+                  .tld ist nur 3 Zeichen lang, hier wre zu klren, ob es bei
+                  lngeren top-level Bezeichnern zu mehr als optischen Problemen
+                  kommt, Beispiel Inmarsat A = _INA_.
+
+Angeben sind jeweils die Komponenten von TELNUM.
+Die 1 nach dem Prozentzeich unterdrckt bei Nichtvorhandensein des
+Elements 1 nachfolgendes Leerzeichen.
+
+Nun weiter zu normalizeNumber(num, &destnum, TN_ALL).
+TN_ALL ist ein flagwert aus telnum.h, hier alle:
+| /* flags */
+| #define TN_PROVIDER 1
+| #define TN_COUNTRY      2
+| #define TN_AREA         4
+| #define TN_MSN          8
+| #define TN_ALL          15
+| #define TN_NO_PROVIDER 14
+| #define TN_NOCLEAR 0x80
+
+Zunchst clearNum(&destnum) was fr konfiguruierte Standardwerte sorgt:
+|   if ((flag & TN_NOCLEAR) == 0)
+|   clearNum(num);
+
+Dann erfolgt die Verarbeitung einer eventuellen VBN, z. B. 01033:
+|   if (flag & TN_PROVIDER) {
+|     if (!split_vbn(&p, num)) {
+|       num->nprovider = pnum2prefix(preselect,0);
+|     }
+|     Strncpy(num->provider, getProvider(num->nprovider), TN_MAX_PROVIDER_LEN);
+|   }
+
+Der Reihe nach, zunchst split_vbn:
+static int split_vbn(char **p, TELNUM * num)
+| {
+|   int     l;
+|
+|   if ((l = provider2prefix(*p, &num->nprovider))) {
+|     Strncpy(num->provider, *p, l + 1);
+|     *p += l;
+|     return l;
+|   }
+|   return 0;
+| }
+Sinn und Zweck ist es offenbar, zu erkennen, ob eine VBN am
+Anfang von num steht, split_vbn gibt die Lnge der VBN zurck.
+Ist eine VBN vorhanden, steht die Providernummer (alle P:-Tags
+aus der rate-CC.dat durchnumeriert) dann in num.nprovider,
+andernfalls wird der Standardprovider (PRESELECTED in isdn.conf)
+mit dem Subprovider 0 eingetragen, die rate.conf wird also nicht
+ausgewertet, dies erklrt die Angabe von T-ISDN an Stelle von
+T-ISDN xxl im isdnrate-Beispiel.  Die weitere Funktionialitt
+in provider2prefix, u. a. das Beobachten der X:-Tags aus der
+rate-CC.dat wird bis auf weiteres nicht betrachtet.
+
+In normalizeNumber() geht es wie folgt weiter:
+|   if (flag & TN_COUNTRY) {
+|     /* subst '00' => '+' */
+|     if (p[0] == '0' && p[1] == '0')
+|       *++p = '+';
+|     if (getSpecial(p)) {        /* sondernummer */
+|       goto is_sonder;
+|     }
+|     if (!isdigit(*p)) {
+|       res = getDest(p, num);
+|       /* isdnrate is coming with +4319430 but this may be a
+|          sondernummer */
+|       if (atoi(mycountry + 1) == num->ncountry && (*num->area || *num->msn)) {
+|
+
+TN_COUNTRY ist durch TN_ALL gesetzt, p zeigt auf den Beginn einer Kopie der
+zu untersuchenden Nummer num.  Eine Nummer 0012345 wird zu +12345, an dieser
+Stelle ist die internationale Vorwahl hart kodiert, es gibt (noch) Lnder,
+die eine anderen Zugang zum internationalen Telefonnetz verwenden.
+
+getSpecial (rate.c) prft, ob eine (nationale) Sondernummer vorliegt.  Die
+Sonderrufnummern werden durch N:-Tags in der rate-CC.dat definiert ist fr
+nur national erreichbare Rufnummern verwendet.  Dies soll nicht der Fall sein.
+
+Liegt eine internationale Rufnummer, d. h. begann die Nummer auf der
+Befehlszeile mit + oder 00 wird getDest() aufgerufen.  Dies trifft auch
+auf nationale Rufnummer zu, die mitsamt Landesvorwahl angegeben wurde.
+num kann an dieser Stelle auch ein Name sein.
+Im weiteren wird hier geprft (letzte Zeile des obigen Ausschnitts),
+ob der eben genannte Fall, Rufnummer im eigenen Land vorliegt, und falls
+ja, ob es eine Sonderrufnummer ist.  Ist letzteres nicht der Fall, endet
+normalizeNumber mit dem Rckgabewert von getDest.
+
+Liegt keine internationale Nummer vor, wird ebenfalls auf Sonderrufnummern
+geprft.  Ist dies negativ und beginnt die Rufnummer mit einer 0 (ebenfalls
+hard kodiert nationale Vorwahl, AREAPREFIX aus isdn.conf wird nicht verwendet)
+wird die Rufnummer ins internationale Format gebracht und getDest wie oben
+aufgerufen.  Liegt andernfalls eine Rufnummer ohne 0 am Anfang vor, wird diese
+nach num.msn kopiert; num.area, num.naera num.sarea wurden zuvor bereits mit
+den Werten des eigenen Ortsnetzes belegt.
+
+
+Im weiteren zu untersuchen ist also, was getDest mit einer internationalen
+Rufnummer 'number' und einer bis auf .vbn (?), .provider, .nprovider
+undefinierten TELNUM-Struktur 'num' anfngt.
+
+Unser Beispiel ist weiterhin:
+| isdnrate -N +1670 +1671
+| +1670 => +1670 - (MP) - DTAG T-ISDN
+| +1671 => - (DE) - DTAG T-ISDN
+
+In der dest.cdb finden sich nach cdbdump dazu folgende Eintrge:
+| +2,35:MP->Marianen (SaipanNord-);+1670,+1671^@
+| +5,4:+1670->:MP^@
+| +5,4:+1671->:MP^@
+Links vom Doppelpunkt stehen die Lngen von Schlssel und Wert,
+Rechts davon Schlssel->Wert. ^@ ist das NUL-Zeichen.
+
+Eingangs finden wir den Typ datum, definiert in isdnlog/tools/cdb/i4l_cdb.h:
+| typedef struct datum_t {
+|     unsigned char *dptr;
+|     size_t dsize;
+| } datum;
+
+Anschlieend begegnet uns erneut get_cache, womit ein lokaler Zwischenspeicher
+fr CACHE_SIZE Nummern realisiert wird.  Ist hier das Ergebnis eines getDest()-
+Aufrufs in Form einer TELNUM-Variable bereits abgelegt, wird diese ab der
+Komponente scountry einfach nach 'num' kopiert.  Die Details dieses cleveren
+Mechanismus sollten nicht von Belang sein, da isdnrate -N +1671 ebenfalls
+fehl schlgt.  Gehen wir also im folgenden davon aus, das number noch
+nicht angefragt wurde.
+
+Weiter geht es in getDest():
+|   len = strlen(number);
+|   if (len==2 && isalpha(*number) && isupper(*number))
+|     Strncpy(tld,number,3);
+|
+|   if (isdigit(*number)) {
+|     warning("getDest called with local number '%s'", number);
+|     add_cache(number, num);
+|     return UNKNOWN;
+|   }
+Ist number zwei Zeichen land und das erste ein Grobuchstabe, wird offenbar ein
+Countrycode angenommen und nach num.tld kopiert.  Bei unserem Beispiel trifft
+dies nicht zu.
+Beginnt Nummer mit einer Ziffer liegt ein Fehler vor, da internationale Rufnummern
+hier zumindest bei unserer Vorgeschichte mit einem + beginnen.
+
+Es folgen Initialisierungen:
+|   countrylen = arealen = prefixlen = 0;
+|   num->ncountry = 0;
+|   num->narea = 0;
+|   *num->area = '\0';
+|   *num->sarea = '\0';
+|   *num->scountry = '\0';
+|   *num->country = '\0';
+|   *num->msn = '\0';
+|   *num->keys = '\0';
+|   if (len > 1 && !isdigit(number[1]) && !isKey(number))
+|     city = strdup(number);
+Besteht number aus mindestens zwei Zeichen und ist das zweite Zeichen keine Ziffer
+(number damit keine int. Nummer sondern ein Name) und kein Code der Bauart
+/[A-Z_]?[A-Z_0-9]*/ (Perl-Regexp), wie z. B. AT oder _DEMD1, wird number nach city
+kopiert.
+
+Nun die (erste(n)) Abfragen der dest.cdb:
+| again:
+|   key.dptr = number;
+|   key.dsize = len;
+|   value = FETCH(db, key);
+| again2:
+|   if (value.dptr != 0) {
+| /* we have a value:
+|  * it could be
+|  *   :RKEY ... pointer to a KEY
+|  *   :city ... pointer to a city
+|  *   name;code ... top level entry i.e country
+|  *   name;codes[;:KEY]  ... region
+|  *   [#len];code;:KEY ... city
+|  */
+| [...]
+|   }/* if value */
+|   else if (first && len && *number == '+') {    /* try shorter nums */
+|     number[--len] = '\0';
+|     goto again;                 /* I like it */
+|   }
+Es unter number nachgesehen, das Ergebnis der Lnge value.dsize steht unter
+value.dptr.  Wird nichts gefunden, wird bei einer Nummer (+123..) am Ende
+Ziffer um Ziffer entfernt, bis ein Fund auftritt oder die Nummer komplett
+gelscht wurde.  Die Anwendung ist offensichtlich, es geht darum, fr eine
+beliebige Nummer die genauest mgliche Destination zu bekommen, gemessen
+ber die Nummernlnge
+In unserem Beispiel sollte fr beide Nummern der Wert ":MP" bestimmt werden,
+gem Kommentar ein RKEY.
+
+Schauen wir uns den Anfang der obige Auslassung [...] genauer an:
+|     while (value.dptr && *value.dptr == ':') {
+|       /* check for city, i.e. lowercase chars */
+|       if (!isKey(value.dptr + 1)) {
+|         city = strdup(value.dptr + 1);
+|       }
+|       else {
+|         append(num->keys, value.dptr + 1);
+|         Strncpy(tld,value.dptr+1,3);
+|       }
+|       key.dptr = value.dptr + 1;
+|       key.dsize = value.dsize - 2;      /* w/o : and \x0 */
+|       nvalue = FETCH(db, key);
+|       if (*dbv == 'G')
+|         free(value.dptr);
+|       value = nvalue;
+|     }
+|
+Ein Ergebnis, das mit : beginnt ist entweder ein Code oder eine
+Stadt.  Ersterer (seine ersten 2 Zeichen) werden nach num.tld
+kopiert.  Strncpy terminiert im Gegensatz zu strncpy in jedem
+Fall den Zielstring.  Der Code beginnt ferner die hierarchiche
+Liste der Codes in num->keys.  Haben wir es mit einer Stadt
+zu tun, landet ihr Name in city und wrde dort die ursprngliche
+Anfrage berschreiben, wenn denn eine Abfrage mit einer Stadt
+wiederum eine Stadt liefern wrde, was hier nicht der Fall ist.
+
+Danach wird ein reverse lookup gemacht, in unserem Fall
+wird nach 'MP' gesucht und dafr als nvalue
+'Marianen (SaipanNord-);+1670,+1671' gefunden.
+dbv ist in isdnlog/tools/zone/common.h definiert und bezeichnet die
+verwendete Datenbank: CDB/GBDM/.. . Somit dienen die Abfragen *dbv == 'G'
+wohl nur der sorgsamen Speicherverwaltung.
+Schlielich wird das erste Ergebnis verworfen und durch das zweite ersetzt.
+number ist weiterhin +1671,
+value.dptr zeigt auf 'Marianen (SaipanNord-);+1670,+1671'
+
+Sollte der neue Wert wiederum mit : beginnen, wrde das obige Procedere
+wiederholt.  Ein Beispiel hierfr ist nicht bekannt:
++49170 liefert :_DEMD1,
+es folgt num.keys = _DEMD1,
+_DEMD1 liefert Deutschland Mobilfunk D1;+491511,+49160,+49170,+49171,+49175;:_DEMF
+Zumindest zu dieser Phase wird die while-Schleife nur einmal genutzt.  Ein Code mte
+direkt den nchsten Code liefern.
+
+Betrachten wir noch einen Durchlauf der mit einem Namen (Stadt) als
+number beginnt:
+"Grnau, Almtal" liefert ;+437616;:AT
+dies lst keinen reverse-lookup aus.
+
+Eine Flughafenstadt:
++4969 fhrt zu :_FRA,
+_FRA zu ;Frankfurt;+4969;:DE
+('Frankfurt' wrde zu :_FRA fhren.)
+
+Zusammenfassung hieraus:  value sollte nun die Form [city];nummer[,nummer][;:code]
+haben.  Ist city nicht vorhanden, ist die gleichnamige Variable aber belegt.
+
+Es geht weiter:
+|     /* do we have something valid */
+|     if (value.dptr == 0 && first) {
+|       strcpy(num->scountry, unknown);
+|       strcpy(num->sarea, unknown);
+|       Strncpy(num->msn, number, TN_MAX_MSN_LEN);
+|       free(number);
+|       if (city)
+|         free(city);
+|       return 0;
+|     }
+Ist beim ersten Durchlauf (first unterhalb dieses Abschnitts
+unabnderlich false) nichts gefunden worden, wird die gesamte
+number num.msn zugeschlagen und getDest() beendet.
+
+Es geht weiter:
+|     first = false;
+|     s = value.dptr;
+|     p = strsep(&s, ";");
+|     /* name or #len or empty */
+|     name = 0;
+|     if (p && *p) {
+|       if (*p == '#')
+|         prefixlen = atoi(p + 1);
+|       else
+|         name = strdup(p);
+|     }
+Ein evtl. vorhandener Name gelangt nach name, bspwl. "Marianen (SaipanNord-)".
+
+Bei #num wurde die Laengenangabe nach prefixlen gelangen, das ansonsten 0 bleibt.
+Den #-Fall gibt es hier genau einmal:
+Shared Cost 0180-1->#3;+491801;:DE
+Ursprung ist isdnlog/tools/zone/de/code,
+die restlichen 0180-Eintrge sind offenbar falsch kodiert:
+Shared Cost 0180-4      3->;+491804;:DE
+Konkret stehen vor der abschlieenden Prefixlnge Leerzeichen statt
+Tabulatoren.  Andere Baustelle (TODO).
+
+s Zeigt auf den Beginn der Nummernliste, bsplw. +1670,+1671.
+
+weiter gehts in getDest() aus der Datei dest.c:
+|     p = strsep(&s, ";");
+|     /* codes or empty */
+|     if (p && *p) {
+|       q = strtok(p, ",");       /* we could have multiple codes */
+|       if(*number!='+') {
+|         if (arealen == 0) {     /* first one must be city */
+|           arealen = strlen(q);
+|           Strncpy(num->area, q, TN_MAX_AREA_LEN);
+|         }
+|       }
+|       else {
+|         if (arealen == 0) {     /* we take the orig number */
+|           arealen = strlen(number);
+|           Strncpy(num->area, number, TN_MAX_AREA_LEN);
+|         }
+|       }
+|       if (strstr(num->area, q)) /* only if new number has same prefix */
+|         countrylen = strlen(q); /* last one must be country */
+|     }
+p zeigt auf die Nummernliste. q auf den Eintrag davon.
+Ist die angefragte number ein Name, wird die erste Nummer nach num.area kopiert und
+arealen entsprechend gesetzt.  Andernfalls (arealen beim ersten Erreichen zwingend
+0) wird die angefragte number als num.area eingesetzt und arealen gesetzt.
+Im Beispiel ist num.aera somit (zunchst) +1670 und +1671, arealen wird 5.
+Kommt der die erste Nummer in der angefragten vor wird countrylen auf die erste
+Lnge gesetzt.
+Bei +1670 ist dies der Fall: countrylen = 5,
+bei +1671 nicht:             countrylen = 0.
+
+Weiter gehts, die Ursache knnte naheliegen, daher erstmal das Anfangsbeispiel
+betrachten:
+|     p = strsep(&s, ";");
+|     /* :KEY or empty */
+|     /* we should be at toplevel i.e country */
+|     if (!p) {
+So, hinter dem 2. ; steht nichts, kein hhere/allgemeinerer Eintrag vorhanden.
+Daher num fertigmachen:
+|       append(num->scountry, name);
+name ist in beiden Fllen Marianen ..., passender _s_tring fr country.
+
+|       if (countrylen && (arealen || prefixlen)) {
+das trifft nur fr den ersten Code zu, die +1670, nicht fr +1671.
+
+|         append(num->sarea, city);
+city wre Name fr Stadt oder auch Ortsnetz, haben wir hier nicht.
+num.sarea bleibt leer.
+|         Strncpy(num->country, num->area, countrylen+1);
+|         num->ncountry = atoi(num->country+1);
+num.area ist +1670: num.country wird +1670\0\0
+|         strcpy(num->tld,tld);
+num.tld wird MP, ansonsten wurde num.tld bislang in getDest() nicht angefasst.
+num ist physisch destnum in doit() aus isdnrate.c und wurde an normalizeNumber()
+bergeben, das den hier untersuchten getDest() Aufruf veranlasste, vorher aber
+mittels Clearnum u. a. .tld fr die eigene Rufnummer setzt (ber defnum und _init()
+in telnum.c).  Dies erklrt das (DE) in der Ausgabe fr +1671.
+|         p = num->area + countrylen;
+p zeigt auf \0
+|         arealen -= countrylen;
+arealen = 5 - 5 = 0
+|         if(prefixlen)
+|           arealen=prefixlen;
+haben wir hier nicht, nur bei #len vor ersten ;
+|         Strncpy(num->area, p, 1 + arealen);
+num.area wird geleert, richtig, da Angabe komplett country.
+|         num->narea = atoi(num->area);
+num.narea = 0
+|         if (*onumber == '+' && strlen(onumber) > arealen + countrylen)
+|           Strncpy(num->msn, onumber + arealen + countrylen, TN_MAX_MSN_LEN);
+Was nicht in der dest.cdb gefunden wurde, ist die lokale Nummer.
+area werden in dest.cdb Nummernbestandteile mit Ausnahme des letzten Fundes,
+der country darstellt.
+|         add_cache(onumber, num);
+|       }
+|     }
+Abschlieend cache-Verwaltung.
+bei +1671 fehlen die ganzen obigen Zuweisungen!
+
+|     else if (p && *p == ':') {
+|       /* do we have a  code */
+|       append(num->sarea, name);
+|       append(num->keys, p + 1);
+|       Strncpy(tld,p+1,3);
+|       key.dptr = p + 1;
+|       key.dsize = strlen(p + 1);
+|       nvalue = FETCH(db, key);
+|       value = nvalue;
+|       goto again2;
+|     }
+Obiger Mechanismus durchluft Abfrage erneut, wenn nach dem zweiten ; :CODE angegeben war,
+um einen mglichst allgemeinen Code zu finden.
+
+|     free(number);
+|     if (city)
+|       free(city);
+|     return 0;
+|   }                             /* if value */
+Wurde einmal etwas in der dest.cdb gefunden (mit ggf. verkrzter Nummer, das dadurch
+entfallene sollte in num.msn landen) endet getDest hier und fhrt im zweiten Testfall
+(+1671) zu dn unvollstndigen Daten in num und damit der unvollstndigen Ausgabe.
+
+
+Fazit der Fehlersuche
+---------------------
+Eine Nummer wird zunchst soweit verkrzt, bis sie in der dest.cdb auftaucht.
+Nach dem erst Fund wird ihr Code oder Cityname bestimmt, der ggf. zu bergeordneten
+Codes fhrt.  Dieser Pfad wird bis zu einem Code verfolgt, zu dem kein bergeordneter
+mehr angegeben ist.  Whrend im allgemeinen mehrere Nummer zum selben Code fhren knnen,
+und fr einen Code mehrere Nummern(anfnge) angegeben sind, wird fr den letzten Code
+erwartet, dass er nur ber eine Nummer verfgt, die Landesvorwahl.  Dies ist im
+gewhlten Beispiel nicht der Fall.
+
+
+Korrekturansatz
+---------------
+(Teilweise spekulativ).  Der letzte Code wird am Fehlen eines bergeordneten
+erkannt.  countrylen>0 ist dann erforderlich, damit die Struktur num richtig
+belegt wird.  Warum sollte daher bei gescheiterter Prfung strstr(number, code),
+wobei code der erste ist, nicht der nchste Code versucht werden?
+
+Gewissermaen knnte dies zum Beispiel die folgende Notation in der
+country-de.dat erklren, wahrscheinlicher liegt hier aber einfach ein
+unentdeckter Widerspruch infolge einer automatischen Datenbernahme vor:
+| N:Kasachstan
+| E:Kazakhstan
+| C:+7336, +7330, +7329, +7328, +7327, +7326, +7325, +7324, +7323, +7322, +7321, +7318, +7317, +7316, +7315, +7314, +7313, +7312, +7311, +7310, +73
+| T:KZ
+(Man beachte die +73 am Ende).
+
+Eine derartige Erweiterung deckt mglicherweise bislang unerkannte Probleme im
+Umfeld country-de.dat / dest.cdb auf oder aber schafft neue.
+
+Historische Analyse
+-------------------
+Fr die Datei isdnlog/tools/dest.c und hierin die Funktion getDest():
+aktuell ist Version 1.8, zuletzt gendert 2000-08-01 durch Andreas Kool
+oder Leopold Ttsch (CVS Benutzer, Name im Changelog).
+getDest() wurde in Version 1.6 in Bezug auf die Behandlung prefixlen
+(Hinweis auf 'dutch virtual area codes').
+Version 1.4 machte tld zu einem char-Feld der Lnge 4 und brachte
+vermutlich die Erkennung von Codes als zu bearbeitende Nummer in
+getDest().
+Version 1.2 lie eine Hilfsvariable fr abschlieende Bestimmung
+von num.ncountry entfallen.
+Die auslsende Stelle (bzw. die als solches angesehene) ist somit
+von Anfang an enthalten.
+
+Doppelte Nummern bei Lndercodes in der country-de.dat finden sich
+ab der ersten CVS Version 1.1 von 1999-06-27.
+R: und T: Tags erscheinen zuerst in Version 1.15 von 1999-09-26.
+
+1. Versuch
+----------
+$ cvs diff -u dest.c
+Index: dest.c
+===================================================================
+RCS file: /i4ldev/isdn4k-utils/isdnlog/tools/dest.c,v
+retrieving revision 1.8
+diff -u -r1.8 dest.c
+--- dest.c      2000/08/01 20:31:31     1.8
++++ dest.c      2002/08/25 02:00:30
+@@ -338,6 +338,12 @@
+       }
+       if (strstr(num->area, q))        /* only if new number has same prefix */
+         countrylen = strlen(q);        /* last one must be country */
++      else                             /* test other (country(?)) codes */
++        while ( (q = strtok(NULL, ",")) )
++          if (strstr(num->area, q)) {
++            countrylen = strlen(q);
++            break;
++          }
+     }
+
+     p = strsep(&s, ";");
+
+
+kleiner Erfolg:
+| $ ./bin/isdnrate -N +1670 +1671
+| +1670 => +1670 - (MP) - DTAG T-ISDN
+| +1671 => +1671 - (MP) - DTAG T-ISDN
+
+etwas grerer Erfolg: genderte Programme berleben
+einen (halben) Telefonsonntag, bis die Frage nach der
+Performance auftaucht, da jetzt unter Umstnden gegen
+zahlreiche Nummern mit strstr() geprft wird, siehe
+etwa _DEMF:
+|_DEMF->Deutschland Mobilfunk;+491610,+491611,+491612,+491613,+491614,+491615,
+| +491616,+491617,+491619,+491618,+491511,+49160,+49170,+49171,+49175,+491520,
+| +49162,+49172,+49173,+49174,+49163,+49177,+49178,+49176,+49179,+491505,
+| +491566;:DE^
+
+
+2. Versuch
+----------
+$ cvs diff -u dest.c
+Index: dest.c
+===================================================================
+RCS file: /i4ldev/isdn4k-utils/isdnlog/tools/dest.c,v
+retrieving revision 1.8
+diff -u -r1.8 dest.c
+--- dest.c      2000/08/01 20:31:31     1.8
++++ dest.c      2002/08/25 12:34:24
+@@ -219,7 +219,7 @@
+   size_t  len;
+   datum   key, value, nvalue;
+   static char unknown[] = "Unknown";
+-  char   *p, *q, *city = 0, *s, *name;
++  char   *p, *q, *r = 0, *city = 0, *s, *name;
+   int     arealen, countrylen, prefixlen;
+   char   *number = strdup(onumber);
+   char    dummy[100]; /* V2.7.2.3 kills stack */
+@@ -338,6 +338,8 @@
+       }
+       if (strstr(num->area, q))        /* only if new number has same prefix */
+         countrylen = strlen(q);        /* last one must be country */
++      else
++        r = strtok(NULL, ";"); /* save remaining number codes if any */
+     }
+
+     p = strsep(&s, ";");
+@@ -349,6 +351,14 @@
+     if (!p) {
+
+       append(num->scountry, name);
++      if (!countrylen)         /* countrylen missing */
++        while (r) {            /* test remaining number codes */
++          q = strsep(&r, ",");
++          if (strstr(num->area, q)) {
++            countrylen = strlen(q);
++            break;
++          }
++        }
+       if (countrylen && (arealen || prefixlen)) {
+        append(num->sarea, city);
+        Strncpy(num->country, num->area, countrylen+1);
+
+
+So sollte sich der Aufwand deutlich reduzieren, anstelle ber
+strtok() drfte r sich ebenfalls mittels Pointerarithmetik bestimmen
+lassen.
+
+Bislang funktioniert es.
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/dest/cities.dat isdn4k-utils-v3.3/isdnlog/tools/dest/cities.dat
--- isdn4k-utils-v3.2p1/isdnlog/tools/dest/cities.dat	1999-10-28 18:36:51.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/dest/cities.dat	2003-07-25 21:33:02.000000000 +0000
@@ -818,16 +818,16 @@
 C:+49201
 R:DE	# Deutschland
 
-#N:Frankfurt am Main
-#T:
-#C:+4969
-#R:DE	# Deutschland
-
-N:Frankfurt		#Frankfurt, Oder
+N:Frankfurt am Main
 T:FRA
-C:+49335
+C:+4969
 R:DE	# Deutschland
 
+#N:Frankfurt		#Frankfurt, Oder
+#T:FRA
+#C:+49335
+#R:DE	# Deutschland
+
 #N:Freiburg im Breisgau
 #T:
 #C:+49761
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/dest/i4lconf.pm isdn4k-utils-v3.3/isdnlog/tools/dest/i4lconf.pm
--- isdn4k-utils-v3.2p1/isdnlog/tools/dest/i4lconf.pm	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/dest/i4lconf.pm	2003-07-25 21:23:15.000000000 +0000
@@ -0,0 +1,88 @@
+=pod
+$Id: i4lconf.pm,v 1.1 2003/07/25 21:23:15 tobiasb Exp $
+Copyright 2002..2003 Tobias Becker <i4l-projects@talypso.de>
+License terms of isdnlog apply.
+
+locate_countryfile() returns the location of the system's countryfile.
+This file is used by pp_rate for the preparation of rate-files und by
+makedest for the generation of the destination database.  Usually the
+location is specified with the COUNTRYFILE keyword in the ISDNLOG
+section of /etc/isdn/isdn.conf.  If this fails, locate_countryfile()
+will look for a file named country.dat or country-de.dat in some
+usual directories.  If this fails too, an empty string will be returned.
+Please note, that locate_countryfile() does not prove whether the
+returned file is a valid countryfile or not.
+=cut
+
+package i4lconf;
+use strict;
+use vars qw($VERSION @ISA @EXPORT);
+$VERSION=1.01;
+require Exporter;
+@ISA=qw(Exporter);
+@EXPORT=qw(locate_countryfile);
+
+sub locate_countryfile(;$) {
+    my $countryfile = "";
+
+    # Step 0 - check filename from caller if submitted
+    if ( defined($_[0]) ) {
+        $countryfile = $_[0];
+        if ( -e $countryfile and -f _ and -r _ and -s _ ) {
+            return $countryfile;
+        }
+    }
+    
+    # Step 1 - /etc/isdn/isdn.conf
+    if ( open(CONF, "</etc/isdn/isdn.conf") ) {
+        my ($line, $section, $keyword, $content);
+	while ($line = <CONF>) {
+	    chomp $line;
+	    $line =~ s/(\s*[^\\]|^)\#.*//;
+	    next unless ($line);
+	    if ( $line =~ /\s*\[([^\]]+)\]/ ) {
+	        $section = uc($1);
+		next;
+            }
+	    next unless ($section eq "ISDNLOG");
+	    if ( $line =~ /^\s*(\S+)\s*=\s*(.*)\s*$/ ) {
+	        $keyword = uc($1);
+		$content = $2;
+		if ($keyword eq "COUNTRYFILE") {
+		    $countryfile = $content;
+		    last;
+		}
+	    }
+ 	}
+	close(CONF);
+    }
+    if ( -e $countryfile and -f _ and -r _ and -s _ ) {
+        return $countryfile;
+    }
+    
+    # step 2 - searching
+    $countryfile = "";
+    my @dirs = ( '/usr/lib/isdn',	# default installation
+                 '/usr/share/isdn',     # seen on debian
+		 '/usr/local/lib/isdn', # my choose
+		 '../..'                # the isdnlog directory of the i4l-CVS
+	       );
+    my @names = ( 'country.dat',	# canonical name since 2000
+                  'country-de.dat'      # former name, still used in source
+		);  
+    my ($name, $dir);
+    foreach $dir (@dirs) {
+        foreach $name (@names) {
+	    $countryfile = "$dir/$name";
+            if ( -e $countryfile and -f _ and -r _ and -s _ ) {
+                return $countryfile;
+            }
+	}    
+    }
+
+    # nothing found at all
+    $countryfile = "";
+    return $countryfile;
+}					# end of sub locate_countryfile
+
+1;
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/dest/makedest isdn4k-utils-v3.3/isdnlog/tools/dest/makedest
--- isdn4k-utils-v3.2p1/isdnlog/tools/dest/makedest	2002-02-22 11:10:25.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/dest/makedest	2003-07-25 21:23:15.000000000 +0000
@@ -1,12 +1,16 @@
 #! /usr/bin/perl
 
 # make dest.gdbm
-# necessary parts: /usr/lib/isdn/country.dat
+# necessary parts: ../../country-de.dat
+#                  or installed countryfile, e. g. /usr/lib/isdn/country.dat
 # optional parts: zone/CC/code
 #
 # usage:
 #	makedest [-en] [-v] [-a] [cc ...] [-cCC file...] [-gFile]
 #
+# When DBEXT in the environment is set to something other than ".cdb"
+# the old gdbm format is used instead of the current standard cdb.
+#
 # these entries are written as 0-terminated strings
 # vErSiO\0 => 1.0 int[ cc...]
 #
@@ -23,7 +27,8 @@
 package main;
 use wld;
 BEGIN {
-  if (-e "../cdb/i4l_cdb.c") {
+  if ( (! exists $ENV{DBEXT} or $ENV{DBEXT} eq ".cdb") and
+        -e "../cdb/i4l_cdb.c" ) {
     @AnyDBM_File::ISA = qw( CDB_File_Dump GDBM_File NDBM_File DB_File );
   }
   else {
@@ -34,7 +39,12 @@
 use POSIX;
 use strict;
 $|=1;
-my $co_dat = '/usr/lib/isdn/country.dat';
+# locate countryfile (country.dat or country-de.dat)
+my $co_dat = '';
+eval 'use i4lconf; $co_dat = locate_countryfile();';
+unless ($co_dat) {              # old behaviour as last ressort
+    $co_dat = '/usr/lib/isdn/country-de.dat';
+}
 my $dest_gdbm = './dest.gdbm';
 if (@AnyDBM_File::ISA eq @CDB_File_Dump::ISA) {
   $dest_gdbm = './dest.cdb.dump';
@@ -90,7 +100,8 @@
 
 unless($append) {
     $db{$vers}="Dest $VERSION int\x00";
-    write_global($co_dat);
+    # priority for country-de.dat in source tree against installed countryfile
+    write_global($co_dat, '../../country-de.dat');
 }
 
 foreach $C (@ARGV) {
@@ -99,12 +110,17 @@
 untie(%db);
 
 print "End.\n" if($verbose);
+
 sub write_global   {
+    # $co_dat can be countryfile or global file (-gfile)
     my($co_dat) = $_[0];	
-    print "Adding global $co_dat...\n" if($verbose);
-    open(IN, '../../country-de.dat') || 
-	open(IN, $co_dat) ||
-		die("Cant find country.dat");
+    if ( $_[1] and open(IN, $_[1]) ) {
+        $co_dat = $_[1];
+    }
+    else {
+	open(IN, $co_dat) || die("Cant find $co_dat");
+    }
+    print "Adding global $co_dat ...\n" if($verbose);
     $i=0;
     while (<IN>) {
 	print "$i\r" if (++$i % 10==0 && $verbose && $outistty);
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/dest/pp_rate isdn4k-utils-v3.3/isdnlog/tools/dest/pp_rate
--- isdn4k-utils-v3.2p1/isdnlog/tools/dest/pp_rate	2002-01-29 16:39:20.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/dest/pp_rate	2003-07-25 21:23:15.000000000 +0000
@@ -1,11 +1,26 @@
 #! /usr/bin/perl
 
+# This version of pp_rate originates from rates4linux:
+# $Id: pp_rate,v 1.6 2003/07/25 21:23:15 tobiasb Exp $
+# The rates4linux homepage: http://www.sourceforge.net/projects/rates4linux/
+# It bases on Rev. 1.5 of isdn4k-utils/isdnlog/tools/dest/pp_rate
+# in the CVS at http://www.isdn4linux.de.
+#
+
 use wld;
 use strict;
 use IO::File;
 $|=1;
-use vars qw( %names $COUNTRY %myalias );
+use vars qw( %names $COUNTRY %myalias $co_dat );
 $COUNTRY = '../country';
+$COUNTRY = '' unless (-x $COUNTRY); 	# disable country query if not available
+# unique global determination of countryfile to use:
+# The guessed filename country.dat works used within rates4linux.
+$co_dat = '';
+eval 'use i4lconf; $co_dat = locate_countryfile(\'country.dat\');';
+unless ($co_dat) {		# old behaviour as last ressort
+    $co_dat = '/usr/lib/isdn/country-de.dat';
+}	
 
 &get_country;
 &get_alias;
@@ -24,7 +39,6 @@
 	    $names{lc $a}=$key;
 	}
     }
-    my $co_dat = '/usr/lib/isdn/country-de.dat';
     open(IN,$co_dat) || die("Cant read $co_dat");
     while (<IN>) {
 	chomp;
@@ -44,7 +58,7 @@
     }
     &add1;
     close IN;
-    print "$nn Countrys $na Aliases loaded\n";
+    print "$nn Countrys $na Aliases loaded from $co_dat\n";
 }
 
 sub get_alias {
@@ -126,7 +140,11 @@
 	}
 	elsif (/^A:(.*)/) {
 	    $a=$1;
-	    $a =~ s/\s*#.*$//;
+	    my $acmt = '';
+	    if ( $a =~ s/(\s*#.*$)// ) { 	# preserve comments in A: lines
+		$acmt = $1;
+		$acmt = '' unless ( $acmt =~/#\s*\S/ ); 	# only non-empty
+	    }
 	    $a =~ s/[,\s]+$//;
 	    @a=split(/\s*,\s*/, $a);
 	    foreach $c (@a) {
@@ -155,11 +173,13 @@
 		    }
 		    else {
 		    	foreach $name (keys(%names)) {
-				if (($r=wld($name,$c)) < $m) {
+			    if (($r=wld($name,$c,$m)) < $m) {
 			    	$m=$r; $tf=$name;
+				print "\r'$c' searching (d<$m) ..";
 			    	last if($m==0);
 			    }
 			}
+			print "\r'$c'";
 		    }
 		    if ($tf && $m<=1) {
 			push(@keys,$names{$tf});
@@ -168,8 +188,9 @@
 			print " -> $tf\n";
 		    }
 		    else {
+choice:
 			my($x);
-			print "\nLine $l: $c => $tf  ($m)\n ? [j,q,[+|=]...,/] : ";
+			print "\nLine $l: $c => $tf  ($m)\n ? [j,q,i,[+|=]...,/] : ";
 			$x = <STDIN>;
 			chomp($x);
 			if ($x =~ /^=(.*)/) {
@@ -181,8 +202,8 @@
 			    goto again;
 			}
 			elsif ($x =~ /^\/(.*)/) {
-			    print `grep -3 -i $1 /usr/lib/isdn/country-de.dat`;
-			    goto again;
+			    print `grep -3 -i $1 $co_dat`;
+			    goto choice;
 			}
 			if ($x eq 'j') {
 			    $c = $tf;
@@ -193,17 +214,22 @@
 			elsif ($x eq 'h') {
 			    print "j	=> Vorschlag annehmen\n";
 			    print "q	=> abbrechen\n";
-			    print "n	=> unbekannt ignorieren (gilt dann fuer die gesamte Datei)\n";
+			    print "n	=> [ohne Funktion] unbekannt ignorieren (gilt dann fuer die gesamte Datei)\n";
+			    print "i	=> Eintrag ignorieren\n";
 			    print "+xx	=> xx an unbekannt anhaengen\n";
 			    print "= SO => SO uebernehmen\n";
 			    print "=	=> unbekannt uebernehmen\n";
-			    print "/xx	=> in country-de.dat nach xx greppen\n";
+			    $co_dat =~ m{/([^/]*)$};
+			    print "/xx	=> in $1 nach xx greppen\n";
 			    print "xx	=> xx ausprobieren\n";
-			    goto again;
+			    goto choice;
 			}
 			elsif ($x eq 'q') {
 			    exit;
 			}
+			elsif ($x eq 'i') {
+			    next;
+			}
 			else {
 			    $c = $x;
 			}
@@ -211,7 +237,7 @@
 		    }
 		}   # else found
 	    } # foreach
-	    $outf[$wrinclude]->print ("A:", join(',',@keys),"\n") || die("can' write");
+	    $outf[$wrinclude]->print ("A:", join(',',@keys),"$acmt\n") || die("can' write");
 	} # if A
 	else {
 	    $outf[$wrinclude]->print( $_);
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/dest/wld.pm isdn4k-utils-v3.3/isdnlog/tools/dest/wld.pm
--- isdn4k-utils-v3.2p1/isdnlog/tools/dest/wld.pm	1999-10-25 18:37:52.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/dest/wld.pm	2003-07-25 21:23:15.000000000 +0000
@@ -1,41 +1,55 @@
 package wld;
 use strict;
+use integer;
 use vars qw($VERSION @ISA @EXPORT);
-$VERSION=1.0;
+$VERSION=1.1;
 require Exporter;
 @ISA=qw(Exporter);
 @EXPORT=qw(wld);
 sub min3 {
     my ($x, $y, $z)=@_;
-    $y = $x if ($x lt $y);
-    $z = $y if ($y lt $z);
+    $y = $x if ($x < $y);
+    $z = $y if ($y < $z);
     $z;
 }
 
 sub wld	{	#/* weighted Levenshtein distance */
-  my ($needle, $haystack) = @_;
+  # $dmax is the smallest distance already found, only
+  # smaller distances are computed, otherwise a number
+  # equal or less than the real distance is returned  
+  my ($needle, $haystack, $dmax) = @_;
+  $dmax = 98 unless (defined($dmax)); 	# default when 3rd arg is missing 
   my($i, $j);
   my $l1 = length($needle);
   my $l2 = length($haystack);
+  my @s1 = (0, unpack('A' x $l1, $needle));
+  my @s2 = (0, unpack('A' x $l2, $haystack));
+  my $ldiff = abs($l1-$l2);
+  # the distance can not be less than the length difference
+  return $ldiff unless ($ldiff < $dmax);
   my @dw;
-  my ($WMAX,$P,$Q,$R);
-  $WMAX=$l1>$l2?$l1:$l2;
+  my $imin; 	# minimum value of column $i, also lower limit of result
+  my ($P,$Q,$R);
   $P=1;
   $Q=1;
   $R=1;
 
   $dw[0][0]=0;
-  for ($j=1; $j<=$WMAX; $j++) {
+  for ($j=1; $j<=$l2; $j++) {
     $dw[0][$j]=$dw[0][$j-1]+$Q;
   }
-  for ($i=1; $i<=$WMAX; $i++) {
+  for ($i=1; $i<=$l1; $i++) {
     $dw[$i][0]=$dw[$i-1][0]+$R;
   }
   for ($i=1; $i<=$l1; $i++) {
+    $imin = $dw[$i][0];
     for($j=1; $j<=$l2; $j++) {
-      $dw[$i][$j]=&min3($dw[$i-1][$j-1]+((substr($needle,$i-1,1) eq
-        substr($haystack,$j-1,1))?0:$P),$dw[$i][$j-1]+$Q,$dw[$i-1][$j]+$R);
+      $dw[$i][$j] = &min3( $dw[$i-1][$j-1] + ( ($s1[$i] eq $s2[$j])?0:$P ),
+                           $dw[$i][$j-1]+$Q, $dw[$i-1][$j]+$R );
+      $imin = $dw[$i][$j] if ($dw[$i][$j]<$imin);
     }	
+    # abort if complete column makes results less than $dmax impossible
+    return ($imin) unless ($imin<$dmax);
   }
   return($dw[$l1][$l2]);
 }
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/dest.c isdn4k-utils-v3.3/isdnlog/tools/dest.c
--- isdn4k-utils-v3.2p1/isdnlog/tools/dest.c	2000-10-05 20:45:30.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/dest.c	2002-09-11 09:07:09.000000000 +0000
@@ -219,7 +219,7 @@
   size_t  len;
   datum   key, value, nvalue;
   static char unknown[] = "Unknown";
-  char   *p, *q, *city = 0, *s, *name;
+  char   *p, *q, *r = 0, *city = 0, *s, *name;
   int     arealen, countrylen, prefixlen;
   char   *number = strdup(onumber);
   char    dummy[100]; /* V2.7.2.3 kills stack */
@@ -338,6 +338,8 @@
       }
       if (strstr(num->area, q))	/* only if new number has same prefix */
         countrylen = strlen(q);	/* last one must be country */
+      else
+        r = strtok(NULL, ";"); /* save remaining number codes if any */
     }
 
     p = strsep(&s, ";");
@@ -349,6 +351,14 @@
     if (!p) {
 
       append(num->scountry, name);
+      if (!countrylen)         /* countrylen missing */
+        while (r) {            /* test remaining number codes */
+          q = strsep(&r, ",");
+          if (strstr(num->area, q)) {
+            countrylen = strlen(q);
+            break;
+          }
+        }
       if (countrylen && (arealen || prefixlen)) {
 	append(num->sarea, city);
 	Strncpy(num->country, num->area, countrylen+1);
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/isdnrate.c isdn4k-utils-v3.3/isdnlog/tools/isdnrate.c
--- isdn4k-utils-v3.2p1/isdnlog/tools/isdnrate.c	2001-06-21 16:34:56.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/isdnrate.c	2002-08-15 17:22:43.000000000 +0000
@@ -1,4 +1,4 @@
-/* $Id: isdnrate.c,v 1.38 2001/03/01 14:59:16 paul Exp $
+/* $Id: isdnrate.c,v 1.39 2002/08/15 17:22:43 akool Exp $
 
  * ISDN accounting for isdn4linux. (rate evaluation)
  *
@@ -19,6 +19,11 @@
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
  * $Log: isdnrate.c,v $
+ * Revision 1.39  2002/08/15 17:22:43  akool
+ * isdnlog-4.63
+ *  - new rates/provider ...
+ *  - isdnrate now display EuroCent as the default
+ *
  * Revision 1.38  2001/03/01 14:59:16  paul
  * Various patches to fix errors when using the newest glibc,
  * replaced use of insecure tempnam() function
@@ -1139,9 +1144,9 @@
   if (n > best)
     n = best;
   for (i = 0; i < n; i++)
-    printf("%s  %s %8.3f  %s\n",
-    Provider(sort[i].prefix), currency, sort[i].rate, sort[i].explain);
-}				/* result */
+    printf("%s  %s  %s\n",
+    Provider(sort[i].prefix), printRate(sort[i].rate), sort[i].explain);
+} /* result */
 
 
 static void purge(int n)
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/rate.c isdn4k-utils-v3.3/isdnlog/tools/rate.c
--- isdn4k-utils-v3.2p1/isdnlog/tools/rate.c	2002-07-05 23:22:33.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/rate.c	2002-07-25 18:16:06.000000000 +0000
@@ -1,6 +1,6 @@
 /* #define DEBUG_REDIRZ */
 
-/* $Id: rate.c,v 1.84 2002/04/22 19:07:50 akool Exp $
+/* $Id: rate.c,v 1.85 2002/07/25 18:16:06 akool Exp $
  *
  * Tarifdatenbank
  *
@@ -21,6 +21,13 @@
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
  * $Log: rate.c,v $
+ * Revision 1.85  2002/07/25 18:16:06  akool
+ * isdnlog-2.60:
+ *   - new provider "01081" (1,5 EuroCent/minute)
+ * 	- good bye Euro ;-)
+ *   	with the entry "U:^%.3f c" in "rate-de.dat" now isdnlog/isdnbill
+ *     shows amounts in EuroCent (Value *= 100.0)
+ *
  * Revision 1.84  2002/04/22 19:07:50  akool
  * isdnlog-4.58:
  *   - Patches from Enrico Scholz <enrico.scholz@informatik.tu-chemnitz.de>
@@ -2469,18 +2476,18 @@
      with "known" _area and _zone, from other prefix, which gives nice
      SIGSEGVs
   */
-        
+
   if (clear && prefix != oprefix) {
     oprefix = prefix;
     Rate->_area = Rate->_zone = UNKNOWN;
   }
-  
+
   if (Rate->_area==UNKNOWN || Rate->_zone == UNKNOWN)
     if(get_area(&prefix, Rate, number, msg, message) == UNKNOWN)
       return UNKNOWN;
 
   oprefix = prefix;
-  
+
   Rate->Country  = Provider[prefix].Area[Rate->_area].Name;
   if (Rate->dst[0] && *Rate->dst[0])
     Rate->Zone     = Provider[prefix].Zone[Rate->_zone].Name;
@@ -2820,7 +2827,12 @@
   static int  index=0;
 
   if (++index>=STRINGS) index=0;
-  snprintf (buffer[index], STRINGL, Format, value);
+
+  if (*Format == '^')
+    snprintf (buffer[index], STRINGL, Format + 1, value * 100.0);
+  else
+    snprintf (buffer[index], STRINGL, Format, value);
+
   return buffer[index];
 }
 
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/tools.c isdn4k-utils-v3.3/isdnlog/tools/tools.c
--- isdn4k-utils-v3.2p1/isdnlog/tools/tools.c	2002-01-29 16:39:20.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/tools.c	2003-07-25 22:18:03.000000000 +0000
@@ -1,4 +1,4 @@
-/* $Id: tools.c,v 1.51 2001/12/30 17:17:41 akool Exp $
+/* $Id: tools.c,v 1.52 2003/07/25 22:18:03 tobiasb Exp $
  *
  * ISDN accounting for isdn4linux. (Utilities)
  *
@@ -19,6 +19,31 @@
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
  * $Log: tools.c,v $
+ * Revision 1.52  2003/07/25 22:18:03  tobiasb
+ * isdnlog-4.65:
+ *  - New values for isdnlog option -2x / dual=x with enable certain
+ *    workarounds for correct logging in dualmode in case of prior
+ *    errors.  See `man isdnlog' and isdnlog/processor.c for details.
+ *  - New isdnlog option -U2 / ignoreCOLP=2 for displaying ignored
+ *    COLP information.
+ *  - Improved handling of incomplete D-channel frames.
+ *  - Increased length of number aliases shown immediately by isdnlog.
+ *    Now 127 instead of 32 chars are possible. (Patch by Jochen Erwied.)
+ *  - The zone number for an outgoing call as defined in the rate-file
+ *    is written to the logfile again and used by isdnrep
+ *  - Improved zone summary of isdnrep.  Now the real zone numbers as
+ *    defined in the rate-file are shown.  The zone number is taken
+ *    from the logfile as mentioned before or computed from the current
+ *    rate-file.  Missmatches are indicated with the chars ~,+ and *,
+ *    isdnrep -v ... explains the meanings.
+ *  - Fixed provider summary of isdnrep. Calls should no longer be
+ *    treated wrongly as done via the default (preselected) provider.
+ *  - Fixed the -pmx command line option of isdnrep, where x is the xth
+ *    defined [MSN].
+ *  - `make install' restarts isdnlog after installing the data files.
+ *  - A new version number generates new binaries.
+ *  - `make clean' removes isdnlog/isdnlog/ilp.o when called with ILP=1.
+ *
  * Revision 1.51  2001/12/30 17:17:41  akool
  * isdnlog-4.55:
  *   Tatahhh: isdnlog speaks Euro :-)
@@ -851,7 +876,8 @@
     } /* else */
   } /* if */
 
-  strcpy(call[chan].alias[who], num2nam(call[chan].num[who], call[chan].si1));
+  strncpy(call[chan].alias[who], num2nam(call[chan].num[who], call[chan].si1), RETSIZE);
+  call[chan].alias[who][sizeof(call[chan].alias[who])-1] = '\0';
 
   if (cnf > UNKNOWN) {                    /* Alias gefunden! */
     call[chan].confentry[who] = cnf;
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/tools.h isdn4k-utils-v3.3/isdnlog/tools/tools.h
--- isdn4k-utils-v3.2p1/isdnlog/tools/tools.h	2000-10-05 20:45:30.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/tools.h	2003-07-25 22:18:04.000000000 +0000
@@ -1,4 +1,4 @@
-/* $Id: tools.h,v 1.57 2000/09/05 08:05:03 paul Exp $
+/* $Id: tools.h,v 1.58 2003/07/25 22:18:04 tobiasb Exp $
  *
  * ISDN accounting for isdn4linux.
  *
@@ -20,6 +20,31 @@
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
  * $Log: tools.h,v $
+ * Revision 1.58  2003/07/25 22:18:04  tobiasb
+ * isdnlog-4.65:
+ *  - New values for isdnlog option -2x / dual=x with enable certain
+ *    workarounds for correct logging in dualmode in case of prior
+ *    errors.  See `man isdnlog' and isdnlog/processor.c for details.
+ *  - New isdnlog option -U2 / ignoreCOLP=2 for displaying ignored
+ *    COLP information.
+ *  - Improved handling of incomplete D-channel frames.
+ *  - Increased length of number aliases shown immediately by isdnlog.
+ *    Now 127 instead of 32 chars are possible. (Patch by Jochen Erwied.)
+ *  - The zone number for an outgoing call as defined in the rate-file
+ *    is written to the logfile again and used by isdnrep
+ *  - Improved zone summary of isdnrep.  Now the real zone numbers as
+ *    defined in the rate-file are shown.  The zone number is taken
+ *    from the logfile as mentioned before or computed from the current
+ *    rate-file.  Missmatches are indicated with the chars ~,+ and *,
+ *    isdnrep -v ... explains the meanings.
+ *  - Fixed provider summary of isdnrep. Calls should no longer be
+ *    treated wrongly as done via the default (preselected) provider.
+ *  - Fixed the -pmx command line option of isdnrep, where x is the xth
+ *    defined [MSN].
+ *  - `make install' restarts isdnlog after installing the data files.
+ *  - A new version number generates new binaries.
+ *  - `make clean' removes isdnlog/isdnlog/ilp.o when called with ILP=1.
+ *
  * Revision 1.57  2000/09/05 08:05:03  paul
  * Now isdnlog doesn't use any more ISDN_XX defines to determine the way it works.
  * It now uses the value of "COUNTRYCODE = 999" to determine the country, and sets
@@ -914,6 +939,12 @@
 
 /****************************************************************************/
 
+#define DUALFIX_DESTNUM    0x100
+#define DUALFIX_SRCNUM     0x200
+#define DUALFIX_MULTLOG    0x400
+
+/****************************************************************************/
+
 typedef struct {
   int	  state;
   int     cref;
@@ -928,6 +959,7 @@
   int     bearer;
   int	  si1;     /* Service Indicator entsprechend i4l convention */
   int	  si11;	   /* if (si1 == 1) :: 0 = Telefon analog / 1 = Telefon digital */
+  int     logcount; /* number of writen logfile entries (for DUALFIX_MULTLOG) */
   char    onum[MAXMSNS][NUMSIZE];
   int	  screening;
   char    num[MAXMSNS][NUMSIZE];
@@ -954,7 +986,7 @@
   char	  areacode[MAXMSNS][NUMSIZE];
   char	  vorwahl[MAXMSNS][NUMSIZE];
   char	  rufnummer[MAXMSNS][NUMSIZE];
-  char	  alias[MAXMSNS][NUMSIZE];
+  char	  alias[MAXMSNS][RETSIZE];
   char	  area[MAXMSNS][128];
   char	  money[64];
   char	  currency[32];
@@ -1092,6 +1124,12 @@
 #endif
 _EXTERN	int	 preselect;
 _EXTERN int	dual;
+/* Bitvalues 0x100 and greater in dual are used for activation of workarounds
+ * in isdnlog/processor.c.  The input value for -2 (commandline) or dual
+ * (parameterfile) is splitted between dual and dualfix. Bitvalues less than
+ * 0x100 remain unchanged in dual, greater values are copied to dualfix and
+ * removed from dual to maintain backward compatibility.  |TB| */
+_EXTERN int	dualfix;
 _EXTERN int	hfcdual;
 _EXTERN int	abclcr;
 _EXTERN char  * providerchange;
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/zone/.cvsignore isdn4k-utils-v3.3/isdnlog/tools/zone/.cvsignore
--- isdn4k-utils-v3.2p1/isdnlog/tools/zone/.cvsignore	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/zone/.cvsignore	2003-07-25 22:55:25.000000000 +0000
@@ -0,0 +1,7 @@
+config.cache
+config.log
+config.status
+Makefile
+mkzonedb
+mkzonedb.man
+zone
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/zone/Makefile.in isdn4k-utils-v3.3/isdnlog/tools/zone/Makefile.in
--- isdn4k-utils-v3.2p1/isdnlog/tools/zone/Makefile.in	2001-06-21 16:34:56.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/zone/Makefile.in	2003-03-11 13:08:00.000000000 +0000
@@ -81,7 +81,7 @@
 	mkdir -p $(DESTDIR)$(MAN8DIR)
 	$(INSTALL_MAN) $< $(DESTDIR)$(MAN8DIR)/$(MANPAGE)
 
-install: $(PROGRAM) # install-man
+install: $(PROGRAM) install-man
 	$(INSTALL_PROGRAM) $(PROGRAM) $(DESTDIR)$(SBINDIR)/$(PROGRAM)
 
 install-strip: $(PROGRAM)
@@ -91,7 +91,7 @@
 	rm -f $(DESTDIR)$(SBINDIR)/$(PROGRAM) $(DESTDIR)$(MAN8DIR)/$(MANPAGE)
 
 clean:
-	rm -f *.o *~ $(PROGRAM) zone
+	rm -f *.o *~ $(PROGRAM) zone zone-at-pta$(DBEXT)
 	@if [ -e ../cdb/i4l_cdb.c ] ; then \
 	    $(MAKE) -C ../cdb clean ; \
 	fi
@@ -113,7 +113,7 @@
 # ATTENTION:
 # zonedatabasefilenames must be zone-CC-*
 #
-zonefiles:	AT DE NL CH
+zonefiles:	AT DE NL CH defaultzone
 
 at: AT
 de: DE
@@ -186,3 +186,8 @@
 	if [ ! -e ../../zone-ch-10741$(DBEXT) ] ; then \
 	./$(PROGRAM) -d ../../zone-ch-10741$(DBEXT) -r ch/10741/zred -v; \
 	fi
+
+.PHONY: defaultzone
+defaultzone:
+	# some dummy values
+	echo "123 124 3" |  ./$(PROGRAM) -d ../../zone-default-x$(DBEXT) -r - -v;
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/zone/configure isdn4k-utils-v3.3/isdnlog/tools/zone/configure
--- isdn4k-utils-v3.2p1/isdnlog/tools/zone/configure	2000-10-05 20:45:31.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/zone/configure	2003-03-11 13:08:00.000000000 +0000
@@ -1,7 +1,7 @@
 #! /bin/sh
 
 # Guess values for system-dependent variables and create Makefiles.
-# Generated automatically using autoconf version 2.12
+# Generated automatically using autoconf version 2.13 
 # Copyright (C) 1992, 93, 94, 95, 96 Free Software Foundation, Inc.
 #
 # This configure script is free software; the Free Software Foundation
@@ -50,6 +50,7 @@
 # Initialize some other variables.
 subdirs=
 MFLAGS= MAKEFLAGS=
+SHELL=${CONFIG_SHELL-/bin/sh}
 # Maximum number of lines to put in a shell here document.
 ac_max_here_lines=12
 
@@ -333,7 +334,7 @@
     verbose=yes ;;
 
   -version | --version | --versio | --versi | --vers)
-    echo "configure generated by autoconf version 2.12"
+    echo "configure generated by autoconf version 2.13"
     exit 0 ;;
 
   -with-* | --with-*)
@@ -503,9 +504,11 @@
 # CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
 ac_cpp='$CPP $CPPFLAGS'
 ac_compile='${CC-cc} -c $CFLAGS $CPPFLAGS conftest.$ac_ext 1>&5'
-ac_link='${CC-cc} -o conftest $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5'
+ac_link='${CC-cc} -o conftest${ac_exeext} $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5'
 cross_compiling=$ac_cv_prog_cc_cross
 
+ac_exeext=
+ac_objext=o
 if (echo "testing\c"; echo 1,2,3) | grep c >/dev/null; then
   # Stardent Vistra SVR4 grep lacks -e, says ghazi@caip.rutgers.edu.
   if (echo -n testing; echo 1,2,3) | sed s/-n/xn/ | grep xn >/dev/null; then
@@ -528,15 +531,16 @@
 # Extract the first word of "gcc", so it can be a program name with args.
 set dummy gcc; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:532: checking for $ac_word" >&5
+echo "configure:535: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   if test -n "$CC"; then
   ac_cv_prog_CC="$CC" # Let the user override the test.
 else
-  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}:"
-  for ac_dir in $PATH; do
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
     test -z "$ac_dir" && ac_dir=.
     if test -f $ac_dir/$ac_word; then
       ac_cv_prog_CC="gcc"
@@ -557,16 +561,17 @@
   # Extract the first word of "cc", so it can be a program name with args.
 set dummy cc; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:561: checking for $ac_word" >&5
+echo "configure:565: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   if test -n "$CC"; then
   ac_cv_prog_CC="$CC" # Let the user override the test.
 else
-  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}:"
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
   ac_prog_rejected=no
-  for ac_dir in $PATH; do
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
     test -z "$ac_dir" && ac_dir=.
     if test -f $ac_dir/$ac_word; then
       if test "$ac_dir/$ac_word" = "/usr/ucb/cc"; then
@@ -601,25 +606,61 @@
   echo "$ac_t""no" 1>&6
 fi
 
+  if test -z "$CC"; then
+    case "`uname -s`" in
+    *win32* | *WIN32*)
+      # Extract the first word of "cl", so it can be a program name with args.
+set dummy cl; ac_word=$2
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:616: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_prog_CC="cl"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
+fi
+fi
+CC="$ac_cv_prog_CC"
+if test -n "$CC"; then
+  echo "$ac_t""$CC" 1>&6
+else
+  echo "$ac_t""no" 1>&6
+fi
+ ;;
+    esac
+  fi
   test -z "$CC" && { echo "configure: error: no acceptable cc found in \$PATH" 1>&2; exit 1; }
 fi
 
 echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works""... $ac_c" 1>&6
-echo "configure:609: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
+echo "configure:648: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
 
 ac_ext=c
 # CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
 ac_cpp='$CPP $CPPFLAGS'
 ac_compile='${CC-cc} -c $CFLAGS $CPPFLAGS conftest.$ac_ext 1>&5'
-ac_link='${CC-cc} -o conftest $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5'
+ac_link='${CC-cc} -o conftest${ac_exeext} $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5'
 cross_compiling=$ac_cv_prog_cc_cross
 
-cat > conftest.$ac_ext <<EOF
-#line 619 "configure"
+cat > conftest.$ac_ext << EOF
+
+#line 659 "configure"
 #include "confdefs.h"
+
 main(){return(0);}
 EOF
-if { (eval echo configure:623: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
+if { (eval echo configure:664: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   ac_cv_prog_cc_works=yes
   # If we can't run a trivial program, we are probably using a cross compiler.
   if (./conftest; exit) 2>/dev/null; then
@@ -633,18 +674,24 @@
   ac_cv_prog_cc_works=no
 fi
 rm -fr conftest*
+ac_ext=c
+# CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='${CC-cc} -c $CFLAGS $CPPFLAGS conftest.$ac_ext 1>&5'
+ac_link='${CC-cc} -o conftest${ac_exeext} $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5'
+cross_compiling=$ac_cv_prog_cc_cross
 
 echo "$ac_t""$ac_cv_prog_cc_works" 1>&6
 if test $ac_cv_prog_cc_works = no; then
   { echo "configure: error: installation or configuration problem: C compiler cannot create executables." 1>&2; exit 1; }
 fi
 echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler""... $ac_c" 1>&6
-echo "configure:643: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
+echo "configure:690: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
 echo "$ac_t""$ac_cv_prog_cc_cross" 1>&6
 cross_compiling=$ac_cv_prog_cc_cross
 
 echo $ac_n "checking whether we are using GNU C""... $ac_c" 1>&6
-echo "configure:648: checking whether we are using GNU C" >&5
+echo "configure:695: checking whether we are using GNU C" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_gcc'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -653,7 +700,7 @@
   yes;
 #endif
 EOF
-if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:657: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
+if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:704: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
   ac_cv_prog_gcc=yes
 else
   ac_cv_prog_gcc=no
@@ -664,11 +711,15 @@
 
 if test $ac_cv_prog_gcc = yes; then
   GCC=yes
-  ac_test_CFLAGS="${CFLAGS+set}"
-  ac_save_CFLAGS="$CFLAGS"
-  CFLAGS=
-  echo $ac_n "checking whether ${CC-cc} accepts -g""... $ac_c" 1>&6
-echo "configure:672: checking whether ${CC-cc} accepts -g" >&5
+else
+  GCC=
+fi
+
+ac_test_CFLAGS="${CFLAGS+set}"
+ac_save_CFLAGS="$CFLAGS"
+CFLAGS=
+echo $ac_n "checking whether ${CC-cc} accepts -g""... $ac_c" 1>&6
+echo "configure:723: checking whether ${CC-cc} accepts -g" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_cc_g'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -683,16 +734,20 @@
 fi
 
 echo "$ac_t""$ac_cv_prog_cc_g" 1>&6
-  if test "$ac_test_CFLAGS" = set; then
-    CFLAGS="$ac_save_CFLAGS"
-  elif test $ac_cv_prog_cc_g = yes; then
+if test "$ac_test_CFLAGS" = set; then
+  CFLAGS="$ac_save_CFLAGS"
+elif test $ac_cv_prog_cc_g = yes; then
+  if test "$GCC" = yes; then
     CFLAGS="-g -O2"
   else
-    CFLAGS="-O2"
+    CFLAGS="-g"
   fi
 else
-  GCC=
-  test "${CFLAGS+set}" = set || CFLAGS="-g"
+  if test "$GCC" = yes; then
+    CFLAGS="-O2"
+  else
+    CFLAGS=
+  fi
 fi
 
 ac_aux_dir=
@@ -721,28 +776,30 @@
 # SunOS /usr/etc/install
 # IRIX /sbin/install
 # AIX /bin/install
+# AIX 4 /usr/bin/installbsd, which doesn't work without a -g flag
 # AFS /usr/afsws/bin/install, which mishandles nonexistent args
 # SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
 # ./install, which can be erroneously created by make from ./install.sh.
 echo $ac_n "checking for a BSD compatible install""... $ac_c" 1>&6
-echo "configure:729: checking for a BSD compatible install" >&5
+echo "configure:785: checking for a BSD compatible install" >&5
 if test -z "$INSTALL"; then
 if eval "test \"`echo '$''{'ac_cv_path_install'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
-    IFS="${IFS= 	}"; ac_save_IFS="$IFS"; IFS="${IFS}:"
+    IFS="${IFS= 	}"; ac_save_IFS="$IFS"; IFS=":"
   for ac_dir in $PATH; do
     # Account for people who put trailing slashes in PATH elements.
     case "$ac_dir/" in
     /|./|.//|/etc/*|/usr/sbin/*|/usr/etc/*|/sbin/*|/usr/afsws/bin/*|/usr/ucb/*) ;;
     *)
       # OSF1 and SCO ODT 3.0 have their own names for install.
-      for ac_prog in ginstall installbsd scoinst install; do
+      # Don't use installbsd from OSF since it installs stuff as root
+      # by default.
+      for ac_prog in ginstall scoinst install; do
         if test -f $ac_dir/$ac_prog; then
 	  if test $ac_prog = install &&
             grep dspmsg $ac_dir/$ac_prog >/dev/null 2>&1; then
 	    # AIX install.  It has an incompatible calling convention.
-	    # OSF/1 installbsd also uses dspmsg, but is usable.
 	    :
 	  else
 	    ac_cv_path_install="$ac_dir/$ac_prog -c"
@@ -772,6 +829,8 @@
 # It thinks the first close brace ends the variable substitution.
 test -z "$INSTALL_PROGRAM" && INSTALL_PROGRAM='${INSTALL}'
 
+test -z "$INSTALL_SCRIPT" && INSTALL_SCRIPT='${INSTALL_PROGRAM}'
+
 test -z "$INSTALL_DATA" && INSTALL_DATA='${INSTALL} -m 644'
 
 for ac_prog in bzip2
@@ -779,15 +838,16 @@
 # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:783: checking for $ac_word" >&5
+echo "configure:842: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_BZIP2'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   if test -n "$BZIP2"; then
   ac_cv_prog_BZIP2="$BZIP2" # Let the user override the test.
 else
-  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}:"
-  for ac_dir in $PATH; do
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
     test -z "$ac_dir" && ac_dir=.
     if test -f $ac_dir/$ac_word; then
       ac_cv_prog_BZIP2="$ac_prog"
@@ -824,7 +884,7 @@
 else
 CDBEXTRALIBS=""
 echo $ac_n "checking for gdbm_open in -lgdbm""... $ac_c" 1>&6
-echo "configure:828: checking for gdbm_open in -lgdbm" >&5
+echo "configure:888: checking for gdbm_open in -lgdbm" >&5
 ac_lib_var=`echo gdbm'_'gdbm_open | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -832,7 +892,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lgdbm  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 836 "configure"
+#line 896 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -843,7 +903,7 @@
 gdbm_open()
 ; return 0; }
 EOF
-if { (eval echo configure:847: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
+if { (eval echo configure:907: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -865,7 +925,7 @@
 else
   echo "$ac_t""no" 1>&6
 echo $ac_n "checking for dbm_open in -ldbm""... $ac_c" 1>&6
-echo "configure:869: checking for dbm_open in -ldbm" >&5
+echo "configure:929: checking for dbm_open in -ldbm" >&5
 ac_lib_var=`echo dbm'_'dbm_open | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -873,7 +933,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-ldbm  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 877 "configure"
+#line 937 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -884,7 +944,7 @@
 dbm_open()
 ; return 0; }
 EOF
-if { (eval echo configure:888: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
+if { (eval echo configure:948: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -906,7 +966,7 @@
 else
   echo "$ac_t""no" 1>&6
 echo $ac_n "checking for dbm_open in -ldb""... $ac_c" 1>&6
-echo "configure:910: checking for dbm_open in -ldb" >&5
+echo "configure:970: checking for dbm_open in -ldb" >&5
 ac_lib_var=`echo db'_'dbm_open | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -914,7 +974,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-ldb  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 918 "configure"
+#line 978 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -925,7 +985,7 @@
 dbm_open()
 ; return 0; }
 EOF
-if { (eval echo configure:929: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
+if { (eval echo configure:989: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -960,7 +1020,7 @@
 
 
 echo $ac_n "checking how to run the C preprocessor""... $ac_c" 1>&6
-echo "configure:964: checking how to run the C preprocessor" >&5
+echo "configure:1024: checking how to run the C preprocessor" >&5
 # On Suns, sometimes $CPP names a directory.
 if test -n "$CPP" && test -d "$CPP"; then
   CPP=
@@ -975,14 +1035,14 @@
   # On the NeXT, cc -E runs the code through the compiler's parser,
   # not just through cpp.
   cat > conftest.$ac_ext <<EOF
-#line 979 "configure"
+#line 1039 "configure"
 #include "confdefs.h"
 #include <assert.h>
 Syntax Error
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:985: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
-ac_err=`grep -v '^ *+' conftest.out`
+{ (eval echo configure:1045: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   :
 else
@@ -992,14 +1052,31 @@
   rm -rf conftest*
   CPP="${CC-cc} -E -traditional-cpp"
   cat > conftest.$ac_ext <<EOF
-#line 996 "configure"
+#line 1056 "configure"
 #include "confdefs.h"
 #include <assert.h>
 Syntax Error
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1002: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
-ac_err=`grep -v '^ *+' conftest.out`
+{ (eval echo configure:1062: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  :
+else
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  CPP="${CC-cc} -nologo -E"
+  cat > conftest.$ac_ext <<EOF
+#line 1073 "configure"
+#include "confdefs.h"
+#include <assert.h>
+Syntax Error
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:1079: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   :
 else
@@ -1012,6 +1089,8 @@
 rm -f conftest*
 fi
 rm -f conftest*
+fi
+rm -f conftest*
   ac_cv_prog_CPP="$CPP"
 fi
   CPP="$ac_cv_prog_CPP"
@@ -1021,12 +1100,12 @@
 echo "$ac_t""$CPP" 1>&6
 
 echo $ac_n "checking for ANSI C header files""... $ac_c" 1>&6
-echo "configure:1025: checking for ANSI C header files" >&5
+echo "configure:1104: checking for ANSI C header files" >&5
 if eval "test \"`echo '$''{'ac_cv_header_stdc'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1030 "configure"
+#line 1109 "configure"
 #include "confdefs.h"
 #include <stdlib.h>
 #include <stdarg.h>
@@ -1034,8 +1113,8 @@
 #include <float.h>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1038: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
-ac_err=`grep -v '^ *+' conftest.out`
+{ (eval echo configure:1117: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
   ac_cv_header_stdc=yes
@@ -1051,7 +1130,7 @@
 if test $ac_cv_header_stdc = yes; then
   # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
 cat > conftest.$ac_ext <<EOF
-#line 1055 "configure"
+#line 1134 "configure"
 #include "confdefs.h"
 #include <string.h>
 EOF
@@ -1069,7 +1148,7 @@
 if test $ac_cv_header_stdc = yes; then
   # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
 cat > conftest.$ac_ext <<EOF
-#line 1073 "configure"
+#line 1152 "configure"
 #include "confdefs.h"
 #include <stdlib.h>
 EOF
@@ -1090,7 +1169,7 @@
   :
 else
   cat > conftest.$ac_ext <<EOF
-#line 1094 "configure"
+#line 1173 "configure"
 #include "confdefs.h"
 #include <ctype.h>
 #define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
@@ -1101,7 +1180,7 @@
 exit (0); }
 
 EOF
-if { (eval echo configure:1105: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:1184: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   :
 else
@@ -1128,18 +1207,18 @@
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
-echo "configure:1132: checking for $ac_hdr" >&5
+echo "configure:1211: checking for $ac_hdr" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1137 "configure"
+#line 1216 "configure"
 #include "confdefs.h"
 #include <$ac_hdr>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1142: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
-ac_err=`grep -v '^ *+' conftest.out`
+{ (eval echo configure:1221: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
   eval "ac_cv_header_$ac_safe=yes"
@@ -1158,7 +1237,7 @@
   cat >> confdefs.h <<EOF
 #define $ac_tr_hdr 1
 EOF
-
+ 
 else
   echo "$ac_t""no" 1>&6
 fi
@@ -1166,12 +1245,12 @@
 
 
 echo $ac_n "checking for size_t""... $ac_c" 1>&6
-echo "configure:1170: checking for size_t" >&5
+echo "configure:1249: checking for size_t" >&5
 if eval "test \"`echo '$''{'ac_cv_type_size_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1175 "configure"
+#line 1254 "configure"
 #include "confdefs.h"
 #include <sys/types.h>
 #if STDC_HEADERS
@@ -1180,7 +1259,7 @@
 #endif
 EOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  egrep "size_t[^a-zA-Z_0-9]" >/dev/null 2>&1; then
+  egrep "(^|[^a-zA-Z_0-9])size_t[^a-zA-Z_0-9]" >/dev/null 2>&1; then
   rm -rf conftest*
   ac_cv_type_size_t=yes
 else
@@ -1200,7 +1279,7 @@
 
 
 echo $ac_n "checking size of char""... $ac_c" 1>&6
-echo "configure:1204: checking size of char" >&5
+echo "configure:1283: checking size of char" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_char'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1208,9 +1287,10 @@
   ac_cv_sizeof_char=1
 else
   cat > conftest.$ac_ext <<EOF
-#line 1212 "configure"
+#line 1291 "configure"
 #include "confdefs.h"
 #include <stdio.h>
+#include <sys/types.h>
 main()
 {
   FILE *f=fopen("conftestval", "w");
@@ -1219,7 +1299,7 @@
   exit(0);
 }
 EOF
-if { (eval echo configure:1223: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:1303: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_char=`cat conftestval`
 else
@@ -1239,7 +1319,7 @@
 
 
 echo $ac_n "checking size of short""... $ac_c" 1>&6
-echo "configure:1243: checking size of short" >&5
+echo "configure:1323: checking size of short" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_short'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1247,9 +1327,10 @@
   ac_cv_sizeof_short=2
 else
   cat > conftest.$ac_ext <<EOF
-#line 1251 "configure"
+#line 1331 "configure"
 #include "confdefs.h"
 #include <stdio.h>
+#include <sys/types.h>
 main()
 {
   FILE *f=fopen("conftestval", "w");
@@ -1258,7 +1339,7 @@
   exit(0);
 }
 EOF
-if { (eval echo configure:1262: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:1343: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_short=`cat conftestval`
 else
@@ -1278,7 +1359,7 @@
 
 
 echo $ac_n "checking size of long""... $ac_c" 1>&6
-echo "configure:1282: checking size of long" >&5
+echo "configure:1363: checking size of long" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_long'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1286,9 +1367,10 @@
   ac_cv_sizeof_long=4
 else
   cat > conftest.$ac_ext <<EOF
-#line 1290 "configure"
+#line 1371 "configure"
 #include "confdefs.h"
 #include <stdio.h>
+#include <sys/types.h>
 main()
 {
   FILE *f=fopen("conftestval", "w");
@@ -1297,7 +1379,7 @@
   exit(0);
 }
 EOF
-if { (eval echo configure:1301: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:1383: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_long=`cat conftestval`
 else
@@ -1317,7 +1399,7 @@
 
 
 echo $ac_n "checking size of int""... $ac_c" 1>&6
-echo "configure:1321: checking size of int" >&5
+echo "configure:1403: checking size of int" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_int'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1325,9 +1407,10 @@
   ac_cv_sizeof_int=4
 else
   cat > conftest.$ac_ext <<EOF
-#line 1329 "configure"
+#line 1411 "configure"
 #include "confdefs.h"
 #include <stdio.h>
+#include <sys/types.h>
 main()
 {
   FILE *f=fopen("conftestval", "w");
@@ -1336,7 +1419,7 @@
   exit(0);
 }
 EOF
-if { (eval echo configure:1340: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:1423: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_int=`cat conftestval`
 else
@@ -1356,14 +1439,14 @@
 
 
 echo $ac_n "checking whether byte ordering is bigendian""... $ac_c" 1>&6
-echo "configure:1360: checking whether byte ordering is bigendian" >&5
+echo "configure:1443: checking whether byte ordering is bigendian" >&5
 if eval "test \"`echo '$''{'ac_cv_c_bigendian'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   ac_cv_c_bigendian=unknown
 # See if sys/param.h defines the BYTE_ORDER macro.
 cat > conftest.$ac_ext <<EOF
-#line 1367 "configure"
+#line 1450 "configure"
 #include "confdefs.h"
 #include <sys/types.h>
 #include <sys/param.h>
@@ -1374,11 +1457,11 @@
 #endif
 ; return 0; }
 EOF
-if { (eval echo configure:1378: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:1461: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   # It does; now see whether it defined to BIG_ENDIAN or not.
 cat > conftest.$ac_ext <<EOF
-#line 1382 "configure"
+#line 1465 "configure"
 #include "confdefs.h"
 #include <sys/types.h>
 #include <sys/param.h>
@@ -1389,7 +1472,7 @@
 #endif
 ; return 0; }
 EOF
-if { (eval echo configure:1393: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:1476: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   ac_cv_c_bigendian=yes
 else
@@ -1409,7 +1492,7 @@
     { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
 else
   cat > conftest.$ac_ext <<EOF
-#line 1413 "configure"
+#line 1496 "configure"
 #include "confdefs.h"
 main () {
   /* Are we little or big endian?  From Harbison&Steele.  */
@@ -1422,7 +1505,7 @@
   exit (u.c[sizeof (long) - 1] == 1);
 }
 EOF
-if { (eval echo configure:1426: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:1509: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_c_bigendian=no
 else
@@ -1452,12 +1535,12 @@
 for ac_func in strdup strtoul
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:1456: checking for $ac_func" >&5
+echo "configure:1539: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1461 "configure"
+#line 1544 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -1480,7 +1563,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:1484: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
+if { (eval echo configure:1567: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -1498,13 +1581,16 @@
   cat >> confdefs.h <<EOF
 #define $ac_tr_func 1
 EOF
-
+ 
 else
   echo "$ac_t""no" 1>&6
 fi
 done
 
 
+MANDATE=`grep CHECKIN mkzonedb.man.in | awk '{print $4}'`
+
+
 
 
 
@@ -1537,7 +1623,7 @@
 # Ultrix sh set writes to stderr and can't be redirected directly,
 # and sets the high bit in the cache file unless we assign to the vars.
 (set) 2>&1 |
-  case `(ac_space=' '; set) 2>&1` in
+  case `(ac_space=' '; set | grep ac_space) 2>&1` in
   *ac_space=\ *)
     # `set' does not quote correctly, so add quotes (double-quote substitution
     # turns \\\\ into \\, and sed turns \\ into \).
@@ -1604,7 +1690,7 @@
     echo "running \${CONFIG_SHELL-/bin/sh} $0 $ac_configure_args --no-create --no-recursion"
     exec \${CONFIG_SHELL-/bin/sh} $0 $ac_configure_args --no-create --no-recursion ;;
   -version | --version | --versio | --versi | --vers | --ver | --ve | --v)
-    echo "$CONFIG_STATUS generated by autoconf version 2.12"
+    echo "$CONFIG_STATUS generated by autoconf version 2.13"
     exit 0 ;;
   -help | --help | --hel | --he | --h)
     echo "\$ac_cs_usage"; exit 0 ;;
@@ -1615,7 +1701,7 @@
 ac_given_srcdir=$srcdir
 ac_given_INSTALL="$INSTALL"
 
-trap 'rm -fr `echo "Makefile config.h" | sed "s/:[^ ]*//g"` conftest*; exit 1' 1 2 15
+trap 'rm -fr `echo "Makefile mkzonedb.man config.h" | sed "s/:[^ ]*//g"` conftest*; exit 1' 1 2 15
 EOF
 cat >> $CONFIG_STATUS <<EOF
 
@@ -1624,9 +1710,11 @@
  s/@@/%@/; s/@@/@%/; s/@g\$/%g/' > conftest.subs <<\\CEOF
 $ac_vpsub
 $extrasub
+s%@SHELL@%$SHELL%g
 s%@CFLAGS@%$CFLAGS%g
 s%@CPPFLAGS@%$CPPFLAGS%g
 s%@CXXFLAGS@%$CXXFLAGS%g
+s%@FFLAGS@%$FFLAGS%g
 s%@DEFS@%$DEFS%g
 s%@LDFLAGS@%$LDFLAGS%g
 s%@LIBS@%$LIBS%g
@@ -1647,6 +1735,7 @@
 s%@mandir@%$mandir%g
 s%@CC@%$CC%g
 s%@INSTALL_PROGRAM@%$INSTALL_PROGRAM%g
+s%@INSTALL_SCRIPT@%$INSTALL_SCRIPT%g
 s%@INSTALL_DATA@%$INSTALL_DATA%g
 s%@BZIP2@%$BZIP2%g
 s%@CPP@%$CPP%g
@@ -1658,6 +1747,7 @@
 s%@CONFIG_SBINDIR@%$CONFIG_SBINDIR%g
 s%@CONFIG_MANDIR@%$CONFIG_MANDIR%g
 s%@WORDS_BIGENDIAN@%$WORDS_BIGENDIAN%g
+s%@MANDATE@%$MANDATE%g
 
 CEOF
 EOF
@@ -1699,7 +1789,7 @@
 
 cat >> $CONFIG_STATUS <<EOF
 
-CONFIG_FILES=\${CONFIG_FILES-"Makefile"}
+CONFIG_FILES=\${CONFIG_FILES-"Makefile mkzonedb.man"}
 EOF
 cat >> $CONFIG_STATUS <<\EOF
 for ac_file in .. $CONFIG_FILES; do if test "x$ac_file" != x..; then
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/zone/configure.in isdn4k-utils-v3.3/isdnlog/tools/zone/configure.in
--- isdn4k-utils-v3.2p1/isdnlog/tools/zone/configure.in	2002-07-06 00:02:02.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/zone/configure.in	2003-03-11 13:08:00.000000000 +0000
@@ -51,6 +51,8 @@
 dnl Checks for library functions.
 AC_CHECK_FUNCS(strdup strtoul)
 
+MANDATE=`grep CHECKIN mkzonedb.man.in | awk '{print $4}'`
+
 AC_SUBST(DBMLIB)
 AC_SUBST(DBEXT)
 AC_SUBST(RDBEXT)
@@ -60,4 +62,5 @@
 AC_SUBST(CONFIG_SBINDIR)
 AC_SUBST(CONFIG_MANDIR)
 AC_SUBST(WORDS_BIGENDIAN)
-AC_OUTPUT(Makefile)
+AC_SUBST(MANDATE)
+AC_OUTPUT(Makefile mkzonedb.man)
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/zone/de/code isdn4k-utils-v3.3/isdnlog/tools/zone/de/code
--- isdn4k-utils-v3.2p1/isdnlog/tools/zone/de/code	2002-01-30 01:17:19.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/zone/de/code	2003-07-25 21:33:02.000000000 +0000
@@ -1,5 +1,4 @@
-130	FreeCall
-151	Mobilfunknetz D1
+1511	Mobilfunknetz D1
 160	Mobilfunknetz D1
 170	Mobilfunknetz D1
 171	Mobilfunknetz D1
@@ -14,26 +13,42 @@
 178	Mobilfunknetz Eplus
 176	Mobilfunknetz E2
 179	Mobilfunknetz E2
-150	Mobilfunknetz Quam
+1505	Mobilfunknetz Quam
 1801	Shared Cost 0180-1	3
-1802	Shared Cost 0180-2      3
-1803	Shared Cost 0180-3      3
-1804	Shared Cost 0180-4      3
-1805	Shared Cost 0180-5      3
-1901	Premium Rate 0190-1     3
-1902	Premium Rate 0190-2     3
-1903	Premium Rate 0190-3     3
-1904	Premium Rate 0190-4     3
-1905	Premium Rate 0190-5     3
-1906	Premium Rate 0190-6     3
-1907	Premium Rate 0190-7     3
-1908	Premium Rate 0190-8     3
-1909	Premium Rate 0190-9     3
+1802	Shared Cost 0180-2	3
+1803	Shared Cost 0180-3	3
+1804	Shared Cost 0180-4	3
+1805	Shared Cost 0180-5	3
+1901	Premium Rate 0190-1	3
+1902	Premium Rate 0190-2	3
+1903	Premium Rate 0190-3	3
+1904	Premium Rate 0190-4	3
+1905	Premium Rate 0190-5	3
+1906	Premium Rate 0190-6	3
+1907	Premium Rate 0190-7	3
+1908	Premium Rate 0190-8	3
+1909	Premium Rate 0190-9	3
+190023	HugoTel
+190024	Pennyphone
+190025	clever25
+190028	maxTEL
 190029	Telebillig
 190031	Teledump
+190032	Phonedump
 190035	TeleDiscount
 190037	Fonfux
+190047	Surprise Telecom
+190049	Germanphone
+190051	Junior Telecom
+190054	Calladin
+190071	RapidCall
+190073	Tele2 Ortstarif
+190076	Telestunt
+190079	smart79
+190082	lightTalk
+190084	maxbell
 190087	Phonecraft
+190095	superdump
 201	Essen
 202	Wuppertal
 203	Duisburg
@@ -564,7 +579,6 @@
 3303	Birkenwerdr
 3304	Velten
 33051	Nassenheide
-33052	Leegebruch
 33053	Zehlendorf
 33054	Liebenwalde
 33055	Kremmen
@@ -771,7 +785,6 @@
 33924	Rgelin
 33925	Wustrau-Altfriesack
 33926	Herzberg
-33927	Linum
 33928	Wildberg
 33929	Ghlen-Glienicke
 33931	Reinsberg
@@ -2456,7 +2469,7 @@
 4791	Osterholz-Scharmbeck
 4792	Worpswede
 4793	Hambergen
-4794	Worpswede-Osterode
+4794	Worpswede-Ostersode
 4795	Garlstedt
 4796	Teufelsmoor
 4802	Wrohm
@@ -4700,15 +4713,11 @@
 8868	Schwabsoien
 8869	Kinsau
 89	Mnchen
-9002	Rain Lech
-9003	Harburg
-9004	Tapfheim
-9005	Bissingen
-9006	Mertingen
-9007	Marxheim
-9008	Bissingen-Unterringingen
-9009	Kaisheim
+9001	Premium Rate - Information
+9003	Premium Rate - Unterhaltung
+9005	Premium Rate - Sonstige (Erotik)
 906	Donauwrth
+9070	Tapfheim
 9071	Dillingen
 9072	Lauingen
 9073	Gundelfingen
@@ -4716,17 +4725,24 @@
 9075	Gltt
 9076	Wittislingen
 9077	Bachhagel
+9078	Mertingen
+9080	Harburg Schwaben
 9081	Nrdlingen
 9082	Oettingen
 9083	Mttingen
+9084	Bissingen
 9085	Alerheim
 9086	Fremdingen
 9087	Marktoffingen
 9088	Mnchsdeggingen
+9089	Bissingen-Unterringingen
+9090	Rain Lech
 9091	Monheim
 9092	Wemding
 9093	Polsingen
 9094	Tagmersheim
+9097	Marxheim
+9099	Kaisheim
 9101	Langenzenn
 9102	Wilhermsdorf
 9103	Cadolzburg
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/zone/mkzonedb.c isdn4k-utils-v3.3/isdnlog/tools/zone/mkzonedb.c
--- isdn4k-utils-v3.2p1/isdnlog/tools/zone/mkzonedb.c	2002-02-22 11:10:25.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/zone/mkzonedb.c	2003-03-11 13:09:08.000000000 +0000
@@ -4,7 +4,7 @@
  * Copyright 1999 by Leopold Toetsch <lt@toetsch.at>
  *
  * SYNOPSIS
- * mkzonedb -r Zonefile -d database [-f] [-v] [-V] [-o Oz] [-l L]
+ * mkzonedb -r Zonefile -d database [-v] [-V] [-o Oz] [-l L]
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License as published by
@@ -95,7 +95,7 @@
         else {
             fp = stdin;
         }
-	maxnum = numlen==5 ? 40000 : 10000;
+	maxnum = numlen>=5 ? 40000 : 10000;
 	if ((numbers = calloc(maxnum+1, sizeof(int))) == 0) {
 		fprintf(stderr, "Out of mem\n");
 		exit(EXIT_FAILURE);
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/isdnlog/tools/zone/mkzonedb.man.in isdn4k-utils-v3.3/isdnlog/tools/zone/mkzonedb.man.in
--- isdn4k-utils-v3.2p1/isdnlog/tools/zone/mkzonedb.man.in	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/isdnlog/tools/zone/mkzonedb.man.in	2003-03-11 13:08:00.000000000 +0000
@@ -0,0 +1,53 @@
+.\" $Id: mkzonedb.man.in,v 1.1 2003/03/11 13:08:00 paul Exp $
+.\"
+.\" CHECKIN $Date: 2003/03/11 13:08:00 $
+.\"
+.TH MKZONEDB 8 "@MANDATE@" mkzonedb "Linux System Administration"
+.SH NAME
+mkzonedb \- Utility create a zone file for isdnlog
+.SH SYNOPSIS
+mkzonedb -r zonefile -d database [-v] [-V] [-o Oz] [-l len]
+.SH DESCRIPTION
+.B mkzonedb
+reads a text file with zone (area code) information,
+and writes it in a special format to the database file
+so that other apps such as isdnlog can easily access the data.
+
+This data is used to determine in what "zone" a given area code
+is in relation to another, to see what rate applies to a call
+between these area codes ("is the call a local call").
+
+This utility is really only used during the building of the isdnlog-data
+package, but it may be useful for those who want to create their own
+custom tables.
+.SH OPTIONS
+.TP
+.BI "-r" " zonefile"
+the text file with the zone information.
+Use "-" for standard input.
+
+.TP
+.BI "-d" " database"
+the output database filename
+
+.TP
+.BI -v
+verbose mode
+
+.TP
+.BI -V
+show version information, and quit (don't do anything)
+
+.TP
+.BI "-o" " Oz"
+Use "Oz" area zone. Default is 1. (What does this mean, exactly?)
+
+.TP
+.BI "-l" " len"
+"len" is the length of areacodes.
+.br
+If 5 or more is given, then more space is allocated for the internal tables
+(40000 instead of 10000 numbers allowed). Other values aren't really used.
+
+.SH AUTHOR
+manpage written from C source by Paul Slootman <paul@debian.org>.
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/lib/isdntools.c isdn4k-utils-v3.3/lib/isdntools.c
--- isdn4k-utils-v3.2p1/lib/isdntools.c	2002-01-29 16:39:20.000000000 +0000
+++ isdn4k-utils-v3.3/lib/isdntools.c	2003-07-23 20:55:39.000000000 +0000
@@ -1,4 +1,4 @@
-/* $Id: isdntools.c,v 1.28 2001/08/18 11:59:01 paul Exp $
+/* $Id: isdntools.c,v 1.29 2003/07/23 20:55:39 tobiasb Exp $
  *
  * ISDN accounting for isdn4linux. (Utilities)
  *
@@ -19,6 +19,40 @@
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
  * $Log: isdntools.c,v $
+ * Revision 1.29  2003/07/23 20:55:39  tobiasb
+ * The modifications remove a bug which occurs when dealing with special
+ * numbers and the callerid.conf file.  Regular numbers such as +4940555
+ * can be noted in the following way in a NUMBER line:
+ * NUMBER=+49-40-555, +49-69-555
+ *
+ * For special numbers prior to this modifications there are strong
+ * unmentioned limitations.  Only one number per NUMBER line is allowed
+ * without any of the options shown above.
+ * Allowed: NUMBER=01802555
+ * Not allowed/not working: NUMBER=01802-555
+ * also not working: NUMBER=0180255, 0700555
+ *
+ * This modification brings the later two examples in function.  About the
+ * background of the problem:  isdnlog/isdnrep and other know a sort of
+ * telephone numbers called `special numbers', which are noted with S: and
+ * N: Tags in the rate-file. These numbers are per definition only available
+ * within the country.  In order to emphasize this and for other more
+ * practical reasons, the normalized format for this numbers is not the
+ * usual +<countrycode><areacode><local number> but the national format
+ * like 01802555.
+ *
+ * While the logged numbers in /var/log/isdn.log or so follow this convention,
+ * such entries in callerid.conf got internally converted to the normalized
+ * format (+49180255 in case of the last mentioned number) so that the
+ * comparison executed by isdnlog or isdnrep did not show the expected
+ * result.
+ *
+ * The modification activates the advanced feature in the notation of normal
+ * numbers for special numbers.
+ *
+ * IMPORTANT NOTE:  As the resulting library is located outside the isdnlog
+ * subdirectory, this changes may influence other parts of the isdn4k-utils.
+ *
  * Revision 1.28  2001/08/18 11:59:01  paul
  * Added missing endpwent() call that meant /etc/passwd was being kept open;
  * reorganized num_match() a bit; made the arrays in expand_number() one byte
@@ -238,6 +272,8 @@
 static int area_read_file(void);
 static int area_get_index(char *code);
 #endif
+static char *expand_number_all (char *s, int add_prefix);
+static char *expand_number_pure (char *s);
 
 /****************************************************************************/
 
@@ -313,8 +349,13 @@
 	if (!strcmp(Pattern, number)) /* match */
 		return 0;
 
-	if (!strchr(Pattern,C_NUM_DELIM))
-    return match(expand_number(Pattern), number, 0);
+	if (!strchr(Pattern,C_NUM_DELIM)) /* Pattern is a single number, not a list */
+	{
+    RetCode = match(expand_number(Pattern), number, 0);
+		if (RetCode != 0) /* try Pattern without additional prefix */
+			RetCode = match(expand_number_pure(Pattern), number, 0);
+    return RetCode;
+	}
 
 	Ptr = Array = String_to_Array(Pattern,C_NUM_DELIM);
 
@@ -324,6 +365,16 @@
 		Ptr++;
 	}
 
+	if (RetCode != 0)	/* second try in case of number list */
+	{
+		Ptr = Array;
+		while (*Ptr != NULL && RetCode != 0)
+		{
+			RetCode = match(expand_number_pure(*Ptr), number, 0);
+			Ptr++;
+		}
+	}
+
 	del_Array(Array);
 
 	return RetCode;
@@ -331,7 +382,21 @@
 
 /****************************************************************************/
 
-char *expand_number(char *s)
+/* Introducing expand_number_pure as a variant of expand_number without
+ * adding countrycode or countrycode and areacode to numbers.  This is
+ * needed for isdnlog/isdnrep where national special numbers such as
+ * 01805 in Germany are intentionally stored as 01805 and not as +491805.
+ * The orginal expand_number which remains unchanged has no idea about
+ * special numbers and adds the countrycode to all numbers without, so
+ * that a correct entry from callerid.conf for a special number gets
+ * falsified and does not match as intended.
+ * The work is done by expand_number_all, which is the slighty extented
+ * former expand_number.  The aliasing for expand_number and
+ * expand_number_all might be done in a more efficient way.
+ * Tobias Becker, 2003-02-11.
+ */
+
+static char *expand_number_all(char *s, int add_prefix)
 {
 	int all_allowed = 0;
 	char *Ptr;
@@ -382,7 +447,7 @@
 	if (Help[0] == '\0')
 		return s;
 
-	if (Help[0] == '*' || !strncmp(Help,countryprefix,strlen(countryprefix)))
+	if (Help[0] == '*' || !strncmp(Help,countryprefix,strlen(countryprefix)) || !add_prefix)
 	{
 		strcpy(Num,Help);
 	}
@@ -402,6 +467,16 @@
 	return Num;
 }
 
+char *expand_number(char *s)
+{
+	return expand_number_all(s, 1);
+}
+
+static char *expand_number_pure(char *s)
+{
+	return expand_number_all(s, 0);
+}
+
 /****************************************************************************/
 
 char *expand_file(char *s)
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/pppdcapiplugin/Makefile isdn4k-utils-v3.3/pppdcapiplugin/Makefile
--- isdn4k-utils-v3.2p1/pppdcapiplugin/Makefile	2002-07-05 23:22:33.000000000 +0000
+++ isdn4k-utils-v3.3/pppdcapiplugin/Makefile	2003-05-18 20:22:12.000000000 +0000
@@ -18,7 +18,7 @@
 PPPSRCDIRS=/src/isdn/pppd
 
 ifeq ($(PPPVERSIONS),)
-PPPVERSIONS = 2.3.11 2.4.0 2.4.1 2.4.1b1 2.4.1b2
+PPPVERSIONS = 2.3.11 2.4.0 2.4.1 2.4.1b1 2.4.1b2 2.4.2b3
 endif
 
 PEERDIR=${DESTDIR}/etc/ppp/peers/isdn
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/pppdcapiplugin/capiplugin.8 isdn4k-utils-v3.3/pppdcapiplugin/capiplugin.8
--- isdn4k-utils-v3.2p1/pppdcapiplugin/capiplugin.8	2002-04-19 19:32:21.000000000 +0000
+++ isdn4k-utils-v3.3/pppdcapiplugin/capiplugin.8	2002-08-04 10:28:16.000000000 +0000
@@ -1,5 +1,5 @@
 .\" manual page [] for capiplugin 2.3
-.\" $Id: capiplugin.8,v 1.9 2002/04/10 15:09:42 calle Exp $
+.\" $Id: capiplugin.8,v 1.10 2002/08/04 10:28:16 calle Exp $
 .\" SH section heading
 .\" SS subsection heading
 .\" LP paragraph
@@ -363,7 +363,7 @@
 name USERNAME
 .br
 plugin capiplugin.so
-.r
+.R
 msn MSN
 .br
 number PHONENUMBER
@@ -441,7 +441,7 @@
 name USERNAME
 .br
 plugin capiplugin.so
-.r
+.R
 msn MSN
 .br
 number PHONENUMBER
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/pppdcapiplugin/capiplugin.c isdn4k-utils-v3.3/pppdcapiplugin/capiplugin.c
--- isdn4k-utils-v3.2p1/pppdcapiplugin/capiplugin.c	2002-07-05 23:22:33.000000000 +0000
+++ isdn4k-utils-v3.3/pppdcapiplugin/capiplugin.c	2003-02-28 08:36:08.000000000 +0000
@@ -26,7 +26,7 @@
 #include <linux/if.h>
 #include <linux/in.h>
 
-static char *revision = "$Revision: 1.27 $";
+static char *revision = "$Revision: 1.32 $";
 
 /* -------------------------------------------------------------------- */
 
@@ -73,6 +73,7 @@
 /* -------------------------------------------------------------------- */
 
 static void handlemessages(void) ;
+static int shmatch(char *string, char *expr);
 static void stringlist_free(STRINGLIST **pp);
 static int stringlist_append_string(STRINGLIST **pp, char *s);
 static STRINGLIST *stringlist_split(char *tosplit, char *seps);
@@ -521,8 +522,24 @@
 	 * cli & inmsn
 	 */
 	if (opt_cli) {
+		STRINGLIST *sl;
+		char *old;
 		stringlist_free(&clis);
 		clis = stringlist_split(opt_cli, " \t,");
+		for (sl = clis; sl; sl = sl->next) {
+		   if (*sl->s != '*') {
+		      old = sl->s;
+		      sl->s = (char *)malloc(strlen(old)+2);
+		      if (sl->s) {
+			 *sl->s = '*';
+			 strcpy(sl->s+1, old);
+			 free(old);
+		      } else {
+			 sl->s = old;
+	                 option_error("capiplugin: prepend '*' to cli failed");
+		      }
+		   }
+		}
 	}
 	if (opt_inmsn) {
 		stringlist_free(&inmsns);
@@ -607,6 +624,55 @@
 }
 
 /* -------------------------------------------------------------------- */
+/* -------- Match with * and ? ---------------------------------------- */
+/* -------------------------------------------------------------------- */
+
+static int shmatch(char *string, char *expr)
+{
+   char *match = expr;
+   char *s = string;
+   char *p;
+   int escape = 0;
+
+   while (*match && *s) {
+      if (escape) {
+	     if (*s != *match)
+		    return 0;
+	     s++;
+		 match++;
+      } else if (*match == '\\') {
+         match++;
+         escape = 1;
+      } else if (*match == '*') {
+		 match++;
+		 if (*match == 0) 
+		    return 1;
+         if (*match == '\\') 
+            match++;
+         while ((p = strchr(s, *match)) != 0) {
+		    if (shmatch(p+1, match+1))
+			   return 1;
+		    s = p + 1;
+         }
+		 return 0;
+	  } else if (*match == '?') {
+	     s++;
+		 match++;
+	  } else {
+	     if (*s != *match)
+		    return 0;
+	     s++;
+		 match++;
+	  }
+   }
+   if (*s == 0) {
+      if (*match == 0) return 1;
+      if (*match == '*' && match[1] == 0) return 1;
+   }
+   return 0;
+}
+
+/* -------------------------------------------------------------------- */
 /* -------- STRINGLIST for parsing ------------------------------------ */
 /* -------------------------------------------------------------------- */
 
@@ -1036,7 +1102,7 @@
 	    handlemessages();
         } while (connections && time(0) < t);
 
-	if (connections)
+	if (connections && !exiting)
         	fatal("capiplugin: disconnectall failed");
 }
 
@@ -1170,9 +1236,8 @@
 
 	if (opt_cli) {
 	   for (p = clis; p; p = p->next) {
-	       if (   (s = strstr(callingnumber, p->s)) != 0
-                   && strcmp(s, p->s) == 0)
-		   break;
+	       if (shmatch(callingnumber, p->s))
+		  break;
 	   }
 	   if (!p) {
 	           info("capiplugin: ignoring call, cli mismatch (%s != %s)",
@@ -1236,6 +1301,14 @@
 			   if (demand) goto wakeupmatch;
 			   if (coso == COSO_LOCAL) goto callback;
 			   goto accept;
+	                } else if (proto == PROTO_V110_ASYNC) {
+			   if (demand) goto wakeupmatch;
+			   if (coso == COSO_LOCAL) goto callback;
+			   goto accept;
+	                } else if (proto == PROTO_V120_ASYNC) {
+			   if (demand) goto wakeupmatch;
+			   if (coso == COSO_LOCAL) goto callback;
+			   goto accept;
 			} else {
 	                   info("capiplugin: ignoring digital call from %s",
 			   		callingnumber);
@@ -1528,27 +1601,50 @@
 static void makeleasedline(void)
 {
 	capi_connection *cp;
+	int retry = 0;
 	time_t t;
 
-	cp = setupconnection("", 0);
-
-	t = time(0)+opt_dialtimeout;
 	do {
+	     if (retry) {
+		t = time(0)+opt_redialdelay;
+		do {
+		   handlemessages();
+		   if (status != EXIT_OK)
+		      die(status);
+		} while (time(0) < t);
+	     }
+
+	     cp = setupconnection("", 0);
+
+	     t = time(0)+opt_dialtimeout;
+	     do {
 		handlemessages();
-		if (status != EXIT_OK && conn_find(cp)) {
-			info("capiplugin: pppd status %d, disconnecting ...", status);
- 			dodisconnect(cp);
+		if (status != EXIT_OK) {
+		   if (conn_find(cp)) {
+		      info("capiplugin: pppd status %d, disconnecting ...", status);
+		      dodisconnect(cp);
+		   } else {
+		      die(status);
+		   }
 		}
-	} while (time(0) < t && conn_inprogress(cp));
+	     } while (time(0) < t && conn_inprogress(cp));
 
-	if (status != EXIT_OK)
+	     if (conn_isconnected(cp))
+		goto connected;
+
+	     if (status != EXIT_OK)
 		die(status);
 
+	} while (++retry < opt_dialmax);
+
+connected:
         if (conn_isconnected(cp)) {
-		t = time(0)+opt_connectdelay;
-		do {
-			handlemessages();
-		} while (time(0) < t);
+	   t = time(0)+opt_connectdelay;
+	   do {
+	      handlemessages();
+	      if (status != EXIT_OK)
+		 die(status);
+	   } while (time(0) < t);
 	}
 
 	if (status != EXIT_OK)
@@ -1559,7 +1655,7 @@
 }
 
 /* -------------------------------------------------------------------- */
-/* -------- connect a dislup connection ------------------------------- */
+/* -------- connect a dialup connection ------------------------------- */
 /* -------------------------------------------------------------------- */
 
 static void makeconnection(STRINGLIST *numbers)
@@ -1605,10 +1701,12 @@
 
 connected:
         if (conn_isconnected(cp)) {
-		t = time(0)+opt_connectdelay;
-		do {
-			handlemessages();
-		} while (time(0) < t);
+	   t = time(0)+opt_connectdelay;
+	   do {
+	      handlemessages();
+	      if (status != EXIT_OK)
+		 die(status);
+	   } while (time(0) < t);
 	}
 
         if (!conn_isconnected(cp))
@@ -1729,10 +1827,12 @@
 	} while (!conn_incoming_connected());
 
         if (conn_incoming_connected()) {
-		time_t t = time(0)+opt_connectdelay;
-		do {
-			handlemessages();
-		} while (time(0) < t);
+	   time_t t = time(0)+opt_connectdelay;
+	   do {
+	      handlemessages();
+	      if (status != EXIT_OK)
+		 die(status);
+	   } while (time(0) < t);
 	}
 	add_fd(capi20_fileno(applid));
 	setup_timeout();
@@ -1876,7 +1976,7 @@
 
 	add_options(my_options);
 
-	if ((err = capi20_register (30, 8, 2048, &applid)) != 0) {
+	if ((err = capi20_register (2, 8, 2048, &applid)) != 0) {
 		serrno = errno;
 		fatal("capiplugin: CAPI_REGISTER failed - %s (0x%04x) [%s (%d)]",
 				capi_info2str(err), err,
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/pppdcapiplugin/ppp-2.4.2b3/Makefile isdn4k-utils-v3.3/pppdcapiplugin/ppp-2.4.2b3/Makefile
--- isdn4k-utils-v3.2p1/pppdcapiplugin/ppp-2.4.2b3/Makefile	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/pppdcapiplugin/ppp-2.4.2b3/Makefile	2003-05-18 20:22:12.000000000 +0000
@@ -0,0 +1,14 @@
+# Makefile for the capiplugin for pppd(8).
+#
+# Copyright 2000 Carsten Paeth (calle@calle.in-berlin.de)
+# Copyright 2000 AVM GmbH Berlin (info@avm.de)
+#
+#  This program is free software; you can redistribute it and/or
+#  modify it under the terms of the GNU General Public License
+#  as published by the Free Software Foundation; either version
+#  2 of the License, or (at your option) any later version.
+
+PLUGINDIR=${DESTDIR}/usr/lib/pppd/$(PPPVERSION)
+
+include $(TOPDIR)/Rules.make
+
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/pppdcapiplugin/ppp-2.4.2b3/pppd/patchlevel.h isdn4k-utils-v3.3/pppdcapiplugin/ppp-2.4.2b3/pppd/patchlevel.h
--- isdn4k-utils-v3.2p1/pppdcapiplugin/ppp-2.4.2b3/pppd/patchlevel.h	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/pppdcapiplugin/ppp-2.4.2b3/pppd/patchlevel.h	2003-05-18 20:22:12.000000000 +0000
@@ -0,0 +1,4 @@
+/* $Id: patchlevel.h,v 1.1 2003/05/18 20:22:12 calle Exp $ */
+
+#define VERSION		"2.4.2b3"
+#define DATE		"1 May 2003"
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/pppdcapiplugin/ppp-2.4.2b3/pppd/pppd.h isdn4k-utils-v3.3/pppdcapiplugin/ppp-2.4.2b3/pppd/pppd.h
--- isdn4k-utils-v3.2p1/pppdcapiplugin/ppp-2.4.2b3/pppd/pppd.h	1970-01-01 00:00:00.000000000 +0000
+++ isdn4k-utils-v3.3/pppdcapiplugin/ppp-2.4.2b3/pppd/pppd.h	2003-05-18 20:22:12.000000000 +0000
@@ -0,0 +1,881 @@
+/*
+ * pppd.h - PPP daemon global declarations.
+ *
+ * Copyright (c) 1984-2000 Carnegie Mellon University. All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. The name "Carnegie Mellon University" must not be used to
+ *    endorse or promote products derived from this software without
+ *    prior written permission. For permission or any legal
+ *    details, please contact
+ *      Office of Technology Transfer
+ *      Carnegie Mellon University
+ *      5000 Forbes Avenue
+ *      Pittsburgh, PA  15213-3890
+ *      (412) 268-4387, fax: (412) 268-7395
+ *      tech-transfer@andrew.cmu.edu
+ *
+ * 4. Redistributions of any form whatsoever must retain the following
+ *    acknowledgment:
+ *    "This product includes software developed by Computing Services
+ *     at Carnegie Mellon University (http://www.cmu.edu/computing/)."
+ *
+ * CARNEGIE MELLON UNIVERSITY DISCLAIMS ALL WARRANTIES WITH REGARD TO
+ * THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
+ * AND FITNESS, IN NO EVENT SHALL CARNEGIE MELLON UNIVERSITY BE LIABLE
+ * FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
+ * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN
+ * AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING
+ * OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
+ *
+ * $Id: pppd.h,v 1.1 2003/05/18 20:22:12 calle Exp $
+ */
+
+/*
+ * TODO:
+ */
+
+#ifndef __PPPD_H__
+#define __PPPD_H__
+
+#include <stdio.h>		/* for FILE */
+#include <limits.h>		/* for NGROUPS_MAX */
+#include <sys/param.h>		/* for MAXPATHLEN and BSD4_4, if defined */
+#include <sys/types.h>		/* for u_int32_t, if defined */
+#include <sys/time.h>		/* for struct timeval */
+#include <net/ppp_defs.h>
+#include "patchlevel.h"
+
+#if defined(__STDC__)
+#include <stdarg.h>
+#define __V(x)	x
+#else
+#include <varargs.h>
+#define __V(x)	(va_alist) va_dcl
+#define const
+#define volatile
+#endif
+
+#ifdef INET6
+#include "eui64.h"
+#endif
+
+/*
+ * Limits.
+ */
+
+#define NUM_PPP		1	/* One PPP interface supported (per process) */
+#define MAXWORDLEN	1024	/* max length of word in file (incl null) */
+#define MAXARGS		1	/* max # args to a command */
+#define MAXNAMELEN	256	/* max length of hostname or name for auth */
+#define MAXSECRETLEN	256	/* max length of password or secret */
+
+/*
+ * Option descriptor structure.
+ */
+
+typedef unsigned char	bool;
+
+enum opt_type {
+	o_special_noarg = 0,
+	o_special = 1,
+	o_bool,
+	o_int,
+	o_uint32,
+	o_string,
+	o_wild
+};
+
+typedef struct {
+	char	*name;		/* name of the option */
+	enum opt_type type;
+	void	*addr;
+	char	*description;
+	unsigned int flags;
+	void	*addr2;
+	int	upper_limit;
+	int	lower_limit;
+	const char *source;
+	short int priority;
+	short int winner;
+} option_t;
+
+/* Values for flags */
+#define OPT_VALUE	0xff	/* mask for presupplied value */
+#define OPT_HEX		0x100	/* int option is in hex */
+#define OPT_NOARG	0x200	/* option doesn't take argument */
+#define OPT_OR		0x400	/* OR in argument to value */
+#define OPT_INC		0x800	/* increment value */
+#define OPT_A2OR	0x800	/* for o_bool, OR arg to *(u_char *)addr2 */
+#define OPT_PRIV	0x1000	/* privileged option */
+#define OPT_STATIC	0x2000	/* string option goes into static array */
+#define OPT_LLIMIT	0x4000	/* check value against lower limit */
+#define OPT_ULIMIT	0x8000	/* check value against upper limit */
+#define OPT_LIMITS	(OPT_LLIMIT|OPT_ULIMIT)
+#define OPT_ZEROOK	0x10000	/* 0 value is OK even if not within limits */
+#define OPT_HIDE	0x10000	/* for o_string, print value as ?????? */
+#define OPT_A2LIST	0x10000 /* for o_special, keep list of values */
+#define OPT_A2CLRB	0x10000 /* o_bool, clr val bits in *(u_char *)addr2 */
+#define OPT_NOINCR	0x20000	/* value mustn't be increased */
+#define OPT_ZEROINF	0x40000	/* with OPT_NOINCR, 0 == infinity */
+#define OPT_PRIO	0x80000	/* process option priorities for this option */
+#define OPT_PRIOSUB	0x100000 /* subsidiary member of priority group */
+#define OPT_ALIAS	0x200000 /* option is alias for previous option */
+#define OPT_A2COPY	0x400000 /* addr2 -> second location to rcv value */
+#define OPT_ENABLE	0x800000 /* use *addr2 as enable for option */
+#define OPT_A2CLR	0x1000000 /* clear *(bool *)addr2 */
+#define OPT_PRIVFIX	0x2000000 /* user can't override if set by root */
+#define OPT_INITONLY	0x4000000 /* option can only be set in init phase */
+#define OPT_DEVEQUIV	0x8000000 /* equiv to device name */
+#define OPT_DEVNAM	(OPT_INITONLY | OPT_DEVEQUIV)
+#define OPT_A2PRINTER	0x10000000 /* *addr2 is a fn for printing option */
+#define OPT_A2STRVAL	0x20000000 /* *addr2 points to current string value */
+#define OPT_NOPRINT	0x40000000 /* don't print this option at all */
+
+#define OPT_VAL(x)	((x) & OPT_VALUE)
+
+/* Values for priority */
+#define OPRIO_DEFAULT	0	/* a default value */
+#define OPRIO_CFGFILE	1	/* value from a configuration file */
+#define OPRIO_CMDLINE	2	/* value from the command line */
+#define OPRIO_SECFILE	3	/* value from options in a secrets file */
+#define OPRIO_ROOT	100	/* added to priority if OPT_PRIVFIX && root */
+
+#ifndef GIDSET_TYPE
+#define GIDSET_TYPE	gid_t
+#endif
+
+/* Structure representing a list of permitted IP addresses. */
+struct permitted_ip {
+    int		permit;		/* 1 = permit, 0 = forbid */
+    u_int32_t	base;		/* match if (addr & mask) == base */
+    u_int32_t	mask;		/* base and mask are in network byte order */
+};
+
+/*
+ * Unfortunately, the linux kernel driver uses a different structure
+ * for statistics from the rest of the ports.
+ * This structure serves as a common representation for the bits
+ * pppd needs.
+ */
+struct pppd_stats {
+    unsigned int	bytes_in;
+    unsigned int	bytes_out;
+    unsigned int	pkts_in;
+    unsigned int	pkts_out;
+};
+
+/* Used for storing a sequence of words.  Usually malloced. */
+struct wordlist {
+    struct wordlist	*next;
+    char		*word;
+};
+
+/* An endpoint discriminator, used with multilink. */
+#define MAX_ENDP_LEN	20	/* maximum length of discriminator value */
+struct epdisc {
+    unsigned char	class;
+    unsigned char	length;
+    unsigned char	value[MAX_ENDP_LEN];
+};
+
+/* values for epdisc.class */
+#define EPD_NULL	0	/* null discriminator, no data */
+#define EPD_LOCAL	1
+#define EPD_IP		2
+#define EPD_MAC		3
+#define EPD_MAGIC	4
+#define EPD_PHONENUM	5
+
+typedef void (*notify_func) __P((void *, int));
+
+struct notifier {
+    struct notifier *next;
+    notify_func	    func;
+    void	    *arg;
+};
+
+/*
+ * Global variables.
+ */
+
+extern int	hungup;		/* Physical layer has disconnected */
+extern int	ifunit;		/* Interface unit number */
+extern char	ifname[];	/* Interface name */
+extern char	hostname[];	/* Our hostname */
+extern u_char	outpacket_buf[]; /* Buffer for outgoing packets */
+extern int	phase;		/* Current state of link - see values below */
+extern int	baud_rate;	/* Current link speed in bits/sec */
+extern char	*progname;	/* Name of this program */
+extern int	redirect_stderr;/* Connector's stderr should go to file */
+extern char	peer_authname[];/* Authenticated name of peer */
+extern int	auth_done[NUM_PPP]; /* Methods actually used for auth */
+extern int	privileged;	/* We were run by real-uid root */
+extern int	need_holdoff;	/* Need holdoff period after link terminates */
+extern char	**script_env;	/* Environment variables for scripts */
+extern int	detached;	/* Have detached from controlling tty */
+extern GIDSET_TYPE groups[NGROUPS_MAX];	/* groups the user is in */
+extern int	ngroups;	/* How many groups valid in groups */
+extern struct pppd_stats link_stats; /* byte/packet counts etc. for link */
+extern int	link_stats_valid; /* set if link_stats is valid */
+extern unsigned	link_connect_time; /* time the link was up for */
+extern int	using_pty;	/* using pty as device (notty or pty opt.) */
+extern int	log_to_fd;	/* logging to this fd as well as syslog */
+extern bool	log_default;	/* log_to_fd is default (stdout) */
+extern char	*no_ppp_msg;	/* message to print if ppp not in kernel */
+extern volatile int status;	/* exit status for pppd */
+extern bool	devnam_fixed;	/* can no longer change devnam */
+extern int	unsuccess;	/* # unsuccessful connection attempts */
+extern int	do_callback;	/* set if we want to do callback next */
+extern int	doing_callback;	/* set if this is a callback */
+extern int	error_count;	/* # of times error() has been called */
+extern char	ppp_devnam[MAXPATHLEN];
+extern char     remote_number[MAXNAMELEN]; /* Remote telephone number, if avail. */
+extern int      ppp_session_number; /* Session number (eg PPPoE session) */
+
+extern int	listen_time;	/* time to listen first (ms) */
+extern struct notifier *pidchange;   /* for notifications of pid changing */
+extern struct notifier *phasechange; /* for notifications of phase changes */
+extern struct notifier *exitnotify;  /* for notification that we're exiting */
+extern struct notifier *sigreceived; /* notification of received signal */
+extern struct notifier *ip_up_notifier; /* IPCP has come up */
+extern struct notifier *ip_down_notifier; /* IPCP has gone down */
+extern struct notifier *auth_up_notifier; /* peer has authenticated */
+extern struct notifier *link_down_notifier; /* link has gone down */
+extern struct notifier *fork_notifier;	/* we are a new child process */
+
+/* Values for do_callback and doing_callback */
+#define CALLBACK_DIALIN		1	/* we are expecting the call back */
+#define CALLBACK_DIALOUT	2	/* we are dialling out to call back */
+
+/*
+ * Variables set by command-line options.
+ */
+
+extern int	debug;		/* Debug flag */
+extern int	kdebugflag;	/* Tell kernel to print debug messages */
+extern int	default_device;	/* Using /dev/tty or equivalent */
+extern char	devnam[MAXPATHLEN];	/* Device name */
+extern int	crtscts;	/* Use hardware flow control */
+extern bool	modem;		/* Use modem control lines */
+extern int	inspeed;	/* Input/Output speed requested */
+extern u_int32_t netmask;	/* IP netmask to set on interface */
+extern bool	lockflag;	/* Create lock file to lock the serial dev */
+extern bool	nodetach;	/* Don't detach from controlling tty */
+extern bool	updetach;	/* Detach from controlling tty when link up */
+extern char	*initializer;	/* Script to initialize physical link */
+extern char	*connect_script; /* Script to establish physical link */
+extern char	*disconnect_script; /* Script to disestablish physical link */
+extern char	*welcomer;	/* Script to welcome client after connection */
+extern char	*ptycommand;	/* Command to run on other side of pty */
+extern int	maxconnect;	/* Maximum connect time (seconds) */
+extern char	user[MAXNAMELEN];/* Our name for authenticating ourselves */
+extern char	passwd[MAXSECRETLEN];	/* Password for PAP or CHAP */
+extern bool	auth_required;	/* Peer is required to authenticate */
+extern bool	persist;	/* Reopen link after it goes down */
+extern bool	uselogin;	/* Use /etc/passwd for checking PAP */
+extern char	our_name[MAXNAMELEN];/* Our name for authentication purposes */
+extern char	remote_name[MAXNAMELEN]; /* Peer's name for authentication */
+extern bool	explicit_remote;/* remote_name specified with remotename opt */
+extern bool	demand;		/* Do dial-on-demand */
+extern char	*ipparam;	/* Extra parameter for ip up/down scripts */
+extern bool	cryptpap;	/* Others' PAP passwords are encrypted */
+extern int	idle_time_limit;/* Shut down link if idle for this long */
+extern int	holdoff;	/* Dead time before restarting */
+extern bool	holdoff_specified; /* true if user gave a holdoff value */
+extern bool	notty;		/* Stdin/out is not a tty */
+extern char	*pty_socket;	/* Socket to connect to pty */
+extern char	*record_file;	/* File to record chars sent/received */
+extern bool	sync_serial;	/* Device is synchronous serial device */
+extern int	maxfail;	/* Max # of unsuccessful connection attempts */
+extern char	linkname[MAXPATHLEN]; /* logical name for link */
+extern bool	tune_kernel;	/* May alter kernel settings as necessary */
+extern int	connect_delay;	/* Time to delay after connect script */
+extern int	max_data_rate;	/* max bytes/sec through charshunt */
+extern int	req_unit;	/* interface unit number to use */
+extern bool	multilink;	/* enable multilink operation */
+extern bool	noendpoint;	/* don't send or accept endpt. discrim. */
+extern char	*bundle_name;	/* bundle name for multilink */
+extern bool	dump_options;	/* print out option values */
+extern bool	dryrun;		/* check everything, print options, exit */
+
+#ifdef MAXOCTETS
+extern unsigned int maxoctets;	     /* Maximum octetes per session (in bytes) */
+extern int       maxoctets_dir;      /* Direction :
+				      0 - in+out (default)
+				      1 - in 
+				      2 - out
+				      3 - max(in,out) */
+extern int       maxoctets_timeout;  /* Timeout for check of octets limit */
+#define PPP_OCTETS_DIRECTION_SUM        0
+#define PPP_OCTETS_DIRECTION_IN         1
+#define PPP_OCTETS_DIRECTION_OUT        2
+#define PPP_OCTETS_DIRECTION_MAXOVERAL  3
+/* same as previos, but little different on RADIUS side */
+#define PPP_OCTETS_DIRECTION_MAXSESSION 4	
+#endif
+
+#ifdef PPP_FILTER
+extern struct	bpf_program pass_filter;   /* Filter for pkts to pass */
+extern struct	bpf_program active_filter; /* Filter for link-active pkts */
+#endif
+
+#ifdef MSLANMAN
+extern bool	ms_lanman;	/* Use LanMan password instead of NT */
+				/* Has meaning only with MS-CHAP challenges */
+#endif
+
+/* Values for auth_pending, auth_done */
+#define PAP_WITHPEER	0x1
+#define PAP_PEER	0x2
+#define CHAP_WITHPEER	0x4
+#define CHAP_PEER	0x8
+#define EAP_WITHPEER	0x10
+#define EAP_PEER	0x20
+
+/* Values for auth_done only */
+#define CHAP_MD5_WITHPEER	0x40
+#define CHAP_MD5_PEER		0x80
+#ifdef CHAPMS
+#define CHAP_MS_SHIFT		8	/* LSB position for MS auths */
+#define CHAP_MS_WITHPEER	0x100
+#define CHAP_MS_PEER		0x200
+#define CHAP_MS2_WITHPEER	0x400
+#define CHAP_MS2_PEER		0x800
+#endif
+
+extern char *current_option;	/* the name of the option being parsed */
+extern int  privileged_option;	/* set iff the current option came from root */
+extern char *option_source;	/* string saying where the option came from */
+extern int  option_priority;	/* priority of current options */
+
+/*
+ * Values for phase.
+ */
+#define PHASE_DEAD		0
+#define PHASE_INITIALIZE	1
+#define PHASE_SERIALCONN	2
+#define PHASE_DORMANT		3
+#define PHASE_ESTABLISH		4
+#define PHASE_AUTHENTICATE	5
+#define PHASE_CALLBACK		6
+#define PHASE_NETWORK		7
+#define PHASE_RUNNING		8
+#define PHASE_TERMINATE		9
+#define PHASE_DISCONNECT	10
+#define PHASE_HOLDOFF		11
+
+/*
+ * The following struct gives the addresses of procedures to call
+ * for a particular protocol.
+ */
+struct protent {
+    u_short protocol;		/* PPP protocol number */
+    /* Initialization procedure */
+    void (*init) __P((int unit));
+    /* Process a received packet */
+    void (*input) __P((int unit, u_char *pkt, int len));
+    /* Process a received protocol-reject */
+    void (*protrej) __P((int unit));
+    /* Lower layer has come up */
+    void (*lowerup) __P((int unit));
+    /* Lower layer has gone down */
+    void (*lowerdown) __P((int unit));
+    /* Open the protocol */
+    void (*open) __P((int unit));
+    /* Close the protocol */
+    void (*close) __P((int unit, char *reason));
+    /* Print a packet in readable form */
+    int  (*printpkt) __P((u_char *pkt, int len,
+			  void (*printer) __P((void *, char *, ...)),
+			  void *arg));
+    /* Process a received data packet */
+    void (*datainput) __P((int unit, u_char *pkt, int len));
+    bool enabled_flag;		/* 0 iff protocol is disabled */
+    char *name;			/* Text name of protocol */
+    char *data_name;		/* Text name of corresponding data protocol */
+    option_t *options;		/* List of command-line options */
+    /* Check requested options, assign defaults */
+    void (*check_options) __P((void));
+    /* Configure interface for demand-dial */
+    int  (*demand_conf) __P((int unit));
+    /* Say whether to bring up link for this pkt */
+    int  (*active_pkt) __P((u_char *pkt, int len));
+};
+
+/* Table of pointers to supported protocols */
+extern struct protent *protocols[];
+
+/*
+ * This struct contains pointers to a set of procedures for
+ * doing operations on a "channel".  A channel provides a way
+ * to send and receive PPP packets - the canonical example is
+ * a serial port device in PPP line discipline (or equivalently
+ * with PPP STREAMS modules pushed onto it).
+ */
+struct channel {
+	/* set of options for this channel */
+	option_t *options;
+	/* find and process a per-channel options file */
+	void (*process_extra_options) __P((void));
+	/* check all the options that have been given */
+	void (*check_options) __P((void));
+	/* get the channel ready to do PPP, return a file descriptor */
+	int  (*connect) __P((void));
+	/* we're finished with the channel */
+	void (*disconnect) __P((void));
+	/* put the channel into PPP `mode' */
+	int  (*establish_ppp) __P((int));
+	/* take the channel out of PPP `mode', restore loopback if demand */
+	void (*disestablish_ppp) __P((int));
+	/* set the transmit-side PPP parameters of the channel */
+	void (*send_config) __P((int, u_int32_t, int, int));
+	/* set the receive-side PPP parameters of the channel */
+	void (*recv_config) __P((int, u_int32_t, int, int));
+	/* cleanup on error or normal exit */
+	void (*cleanup) __P((void));
+	/* close the device, called in children after fork */
+	void (*close) __P((void));
+};
+
+extern struct channel *the_channel;
+
+/*
+ * Prototypes.
+ */
+
+/* Procedures exported from main.c. */
+void set_ifunit __P((int));	/* set stuff that depends on ifunit */
+void detach __P((void));	/* Detach from controlling tty */
+void die __P((int));		/* Cleanup and exit */
+void quit __P((void));		/* like die(1) */
+void novm __P((char *));	/* Say we ran out of memory, and die */
+void timeout __P((void (*func)(void *), void *arg, int s, int us));
+				/* Call func(arg) after s.us seconds */
+void untimeout __P((void (*func)(void *), void *arg));
+				/* Cancel call to func(arg) */
+void record_child __P((int, char *, void (*) (void *), void *));
+pid_t safe_fork __P((void));	/* Fork & close stuff in child */
+int  device_script __P((char *cmd, int in, int out, int dont_wait));
+				/* Run `cmd' with given stdin and stdout */
+pid_t run_program __P((char *prog, char **args, int must_exist,
+		       void (*done)(void *), void *arg));
+				/* Run program prog with args in child */
+void reopen_log __P((void));	/* (re)open the connection to syslog */
+void update_link_stats __P((int)); /* Get stats at link termination */
+void script_setenv __P((char *, char *, int));	/* set script env var */
+void script_unsetenv __P((char *));		/* unset script env var */
+void new_phase __P((int));	/* signal start of new phase */
+void add_notifier __P((struct notifier **, notify_func, void *));
+void remove_notifier __P((struct notifier **, notify_func, void *));
+void notify __P((struct notifier *, int));
+int  ppp_send_config __P((int, int, u_int32_t, int, int));
+int  ppp_recv_config __P((int, int, u_int32_t, int, int));
+
+/* Procedures exported from tty.c. */
+void tty_init __P((void));
+
+/* Procedures exported from utils.c. */
+void log_packet __P((u_char *, int, char *, int));
+				/* Format a packet and log it with syslog */
+void print_string __P((char *, int,  void (*) (void *, char *, ...),
+		void *));	/* Format a string for output */
+int slprintf __P((char *, int, char *, ...));		/* sprintf++ */
+int vslprintf __P((char *, int, char *, va_list));	/* vsprintf++ */
+size_t strlcpy __P((char *, const char *, size_t));	/* safe strcpy */
+size_t strlcat __P((char *, const char *, size_t));	/* safe strncpy */
+void dbglog __P((char *, ...));	/* log a debug message */
+void info __P((char *, ...));	/* log an informational message */
+void notice __P((char *, ...));	/* log a notice-level message */
+void warn __P((char *, ...));	/* log a warning message */
+void error __P((char *, ...));	/* log an error message */
+void fatal __P((char *, ...));	/* log an error message and die(1) */
+void init_pr_log __P((char *, int));	/* initialize for using pr_log */
+void pr_log __P((void *, char *, ...));	/* printer fn, output to syslog */
+void end_pr_log __P((void));	/* finish up after using pr_log */
+void dump_packet __P((const char *, u_char *, int));
+				/* dump packet to debug log if interesting */
+ssize_t complete_read __P((int, void *, size_t));
+				/* read a complete buffer */
+
+/* Procedures exported from auth.c */
+void link_required __P((int));	  /* we are starting to use the link */
+void link_terminated __P((int));  /* we are finished with the link */
+void link_down __P((int));	  /* the LCP layer has left the Opened state */
+void link_established __P((int)); /* the link is up; authenticate now */
+void start_networks __P((int));   /* start all the network control protos */
+void continue_networks __P((int)); /* start network [ip, etc] control protos */
+void np_up __P((int, int));	  /* a network protocol has come up */
+void np_down __P((int, int));	  /* a network protocol has gone down */
+void np_finished __P((int, int)); /* a network protocol no longer needs link */
+void auth_peer_fail __P((int, int));
+				/* peer failed to authenticate itself */
+void auth_peer_success __P((int, int, int, char *, int));
+				/* peer successfully authenticated itself */
+void auth_withpeer_fail __P((int, int));
+				/* we failed to authenticate ourselves */
+void auth_withpeer_success __P((int, int, int));
+				/* we successfully authenticated ourselves */
+void auth_check_options __P((void));
+				/* check authentication options supplied */
+void auth_reset __P((int));	/* check what secrets we have */
+int  check_passwd __P((int, char *, int, char *, int, char **));
+				/* Check peer-supplied username/password */
+int  get_secret __P((int, char *, char *, char *, int *, int));
+				/* get "secret" for chap */
+int  get_srp_secret __P((int unit, char *client, char *server, char *secret,
+    int am_server));
+int  auth_ip_addr __P((int, u_int32_t));
+				/* check if IP address is authorized */
+int  auth_number __P((void));	/* check if remote number is authorized */
+int  bad_ip_adrs __P((u_int32_t));
+				/* check if IP address is unreasonable */
+
+/* Procedures exported from demand.c */
+void demand_conf __P((void));	/* config interface(s) for demand-dial */
+void demand_block __P((void));	/* set all NPs to queue up packets */
+void demand_unblock __P((void)); /* set all NPs to pass packets */
+void demand_discard __P((void)); /* set all NPs to discard packets */
+void demand_rexmit __P((int));	/* retransmit saved frames for an NP */
+int  loop_chars __P((unsigned char *, int)); /* process chars from loopback */
+int  loop_frame __P((unsigned char *, int)); /* should we bring link up? */
+
+/* Procedures exported from multilink.c */
+void mp_check_options __P((void)); /* Check multilink-related options */
+int  mp_join_bundle __P((void));  /* join our link to an appropriate bundle */
+char *epdisc_to_str __P((struct epdisc *)); /* string from endpoint discrim. */
+int  str_to_epdisc __P((struct epdisc *, char *)); /* endpt disc. from str */
+
+/* Procedures exported from sys-*.c */
+void sys_init __P((void));	/* Do system-dependent initialization */
+void sys_cleanup __P((void));	/* Restore system state before exiting */
+int  sys_check_options __P((void)); /* Check options specified */
+void sys_close __P((void));	/* Clean up in a child before execing */
+int  ppp_available __P((void));	/* Test whether ppp kernel support exists */
+int  get_pty __P((int *, int *, char *, int));	/* Get pty master/slave */
+int  open_ppp_loopback __P((void)); /* Open loopback for demand-dialling */
+int  tty_establish_ppp __P((int));  /* Turn serial port into a ppp interface */
+void tty_disestablish_ppp __P((int)); /* Restore port to normal operation */
+void generic_disestablish_ppp __P((int dev_fd)); /* Restore device setting */
+int  generic_establish_ppp __P((int dev_fd)); /* Make a ppp interface */
+void make_new_bundle __P((int, int, int, int)); /* Create new bundle */
+int  bundle_attach __P((int));	/* Attach link to existing bundle */
+void cfg_bundle __P((int, int, int, int)); /* Configure existing bundle */
+void clean_check __P((void));	/* Check if line was 8-bit clean */
+void set_up_tty __P((int, int)); /* Set up port's speed, parameters, etc. */
+void restore_tty __P((int));	/* Restore port's original parameters */
+void setdtr __P((int, int));	/* Raise or lower port's DTR line */
+void output __P((int, u_char *, int)); /* Output a PPP packet */
+void wait_input __P((struct timeval *));
+				/* Wait for input, with timeout */
+void add_fd __P((int));		/* Add fd to set to wait for */
+void remove_fd __P((int));	/* Remove fd from set to wait for */
+int  read_packet __P((u_char *)); /* Read PPP packet */
+int  get_loop_output __P((void)); /* Read pkts from loopback */
+void tty_send_config __P((int, u_int32_t, int, int));
+				/* Configure i/f transmit parameters */
+void tty_set_xaccm __P((ext_accm));
+				/* Set extended transmit ACCM */
+void tty_recv_config __P((int, u_int32_t, int, int));
+				/* Configure i/f receive parameters */
+int  ccp_test __P((int, u_char *, int, int));
+				/* Test support for compression scheme */
+void ccp_flags_set __P((int, int, int));
+				/* Set kernel CCP state */
+int  ccp_fatal_error __P((int)); /* Test for fatal decomp error in kernel */
+int  get_idle_time __P((int, struct ppp_idle *));
+				/* Find out how long link has been idle */
+int  get_ppp_stats __P((int, struct pppd_stats *));
+				/* Return link statistics */
+void netif_set_mtu __P((int, int)); /* Set PPP interface MTU */
+int  netif_get_mtu __P((int));      /* Get PPP interface MTU */
+int  sifvjcomp __P((int, int, int, int));
+				/* Configure VJ TCP header compression */
+int  sifup __P((int));		/* Configure i/f up for one protocol */
+int  sifnpmode __P((int u, int proto, enum NPmode mode));
+				/* Set mode for handling packets for proto */
+int  sifdown __P((int));	/* Configure i/f down for one protocol */
+int  sifaddr __P((int, u_int32_t, u_int32_t, u_int32_t));
+				/* Configure IPv4 addresses for i/f */
+int  cifaddr __P((int, u_int32_t, u_int32_t));
+				/* Reset i/f IP addresses */
+#ifdef INET6
+int  sif6addr __P((int, eui64_t, eui64_t));
+				/* Configure IPv6 addresses for i/f */
+int  cif6addr __P((int, eui64_t, eui64_t));
+				/* Remove an IPv6 address from i/f */
+#endif
+int  sifdefaultroute __P((int, u_int32_t, u_int32_t));
+				/* Create default route through i/f */
+int  cifdefaultroute __P((int, u_int32_t, u_int32_t));
+				/* Delete default route through i/f */
+int  sifproxyarp __P((int, u_int32_t));
+				/* Add proxy ARP entry for peer */
+int  cifproxyarp __P((int, u_int32_t));
+				/* Delete proxy ARP entry for peer */
+u_int32_t GetMask __P((u_int32_t)); /* Get appropriate netmask for address */
+int  lock __P((char *));	/* Create lock file for device */
+int  relock __P((int));		/* Rewrite lock file with new pid */
+void unlock __P((void));	/* Delete previously-created lock file */
+void logwtmp __P((const char *, const char *, const char *));
+				/* Write entry to wtmp file */
+int  get_host_seed __P((void));	/* Get host-dependent random number seed */
+int  have_route_to __P((u_int32_t)); /* Check if route to addr exists */
+#ifdef PPP_FILTER
+int  set_filters __P((struct bpf_program *pass, struct bpf_program *active));
+				/* Set filter programs in kernel */
+#endif
+#ifdef IPX_CHANGE
+int  sipxfaddr __P((int, unsigned long, unsigned char *));
+int  cipxfaddr __P((int));
+#endif
+int  get_if_hwaddr __P((u_char *addr, char *name));
+char *get_first_ethernet __P((void));
+
+/* Procedures exported from options.c */
+int setipaddr __P((char *, char **, int)); /* Set local/remote ip addresses */
+int  parse_args __P((int argc, char **argv));
+				/* Parse options from arguments given */
+int  options_from_file __P((char *filename, int must_exist, int check_prot,
+			    int privileged));
+				/* Parse options from an options file */
+int  options_from_user __P((void)); /* Parse options from user's .ppprc */
+int  options_for_tty __P((void)); /* Parse options from /etc/ppp/options.tty */
+int  options_from_list __P((struct wordlist *, int privileged));
+				/* Parse options from a wordlist */
+int  getword __P((FILE *f, char *word, int *newlinep, char *filename));
+				/* Read a word from a file */
+void option_error __P((char *fmt, ...));
+				/* Print an error message about an option */
+int int_option __P((char *, int *));
+				/* Simplified number_option for decimal ints */
+void add_options __P((option_t *)); /* Add extra options */
+void check_options __P((void));	/* check values after all options parsed */
+int  override_value __P((const char *, int, const char *));
+				/* override value if permitted by priority */
+void print_options __P((void (*) __P((void *, char *, ...)), void *));
+				/* print out values of all options */
+
+int parse_dotted_ip __P((char *, u_int32_t *));
+
+/*
+ * Hooks to enable plugins to change various things.
+ */
+extern int (*new_phase_hook) __P((int));
+extern int (*idle_time_hook) __P((struct ppp_idle *));
+extern int (*holdoff_hook) __P((void));
+extern int (*pap_check_hook) __P((void));
+extern int (*pap_auth_hook) __P((char *user, char *passwd, char **msgp,
+				 struct wordlist **paddrs,
+				 struct wordlist **popts));
+extern void (*pap_logout_hook) __P((void));
+extern int (*pap_passwd_hook) __P((char *user, char *passwd));
+extern int (*allowed_address_hook) __P((u_int32_t addr));
+extern void (*ip_up_hook) __P((void));
+extern void (*ip_down_hook) __P((void));
+extern void (*ip_choose_hook) __P((u_int32_t *));
+
+extern int (*chap_check_hook) __P((void));
+extern int (*chap_passwd_hook) __P((char *user, char *passwd));
+
+/* Let a plugin snoop sent and received packets.  Useful for L2TP */
+extern void (*snoop_recv_hook) __P((unsigned char *p, int len));
+extern void (*snoop_send_hook) __P((unsigned char *p, int len));
+
+/*
+ * Inline versions of get/put char/short/long.
+ * Pointer is advanced; we assume that both arguments
+ * are lvalues and will already be in registers.
+ * cp MUST be u_char *.
+ */
+#define GETCHAR(c, cp) { \
+	(c) = *(cp)++; \
+}
+#define PUTCHAR(c, cp) { \
+	*(cp)++ = (u_char) (c); \
+}
+
+
+#define GETSHORT(s, cp) { \
+	(s) = *(cp)++ << 8; \
+	(s) |= *(cp)++; \
+}
+#define PUTSHORT(s, cp) { \
+	*(cp)++ = (u_char) ((s) >> 8); \
+	*(cp)++ = (u_char) (s); \
+}
+
+#define GETLONG(l, cp) { \
+	(l) = *(cp)++ << 8; \
+	(l) |= *(cp)++; (l) <<= 8; \
+	(l) |= *(cp)++; (l) <<= 8; \
+	(l) |= *(cp)++; \
+}
+#define PUTLONG(l, cp) { \
+	*(cp)++ = (u_char) ((l) >> 24); \
+	*(cp)++ = (u_char) ((l) >> 16); \
+	*(cp)++ = (u_char) ((l) >> 8); \
+	*(cp)++ = (u_char) (l); \
+}
+
+#define INCPTR(n, cp)	((cp) += (n))
+#define DECPTR(n, cp)	((cp) -= (n))
+
+/*
+ * System dependent definitions for user-level 4.3BSD UNIX implementation.
+ */
+
+#define TIMEOUT(r, f, t)	timeout((r), (f), (t), 0)
+#define UNTIMEOUT(r, f)		untimeout((r), (f))
+
+#define BCOPY(s, d, l)		memcpy(d, s, l)
+#define BZERO(s, n)		memset(s, 0, n)
+#define	BCMP(s1, s2, l)		memcmp(s1, s2, l)
+
+#define PRINTMSG(m, l)		{ info("Remote message: %0.*v", l, m); }
+
+/*
+ * MAKEHEADER - Add Header fields to a packet.
+ */
+#define MAKEHEADER(p, t) { \
+    PUTCHAR(PPP_ALLSTATIONS, p); \
+    PUTCHAR(PPP_UI, p); \
+    PUTSHORT(t, p); }
+
+/*
+ * Exit status values.
+ */
+#define EXIT_OK			0
+#define EXIT_FATAL_ERROR	1
+#define EXIT_OPTION_ERROR	2
+#define EXIT_NOT_ROOT		3
+#define EXIT_NO_KERNEL_SUPPORT	4
+#define EXIT_USER_REQUEST	5
+#define EXIT_LOCK_FAILED	6
+#define EXIT_OPEN_FAILED	7
+#define EXIT_CONNECT_FAILED	8
+#define EXIT_PTYCMD_FAILED	9
+#define EXIT_NEGOTIATION_FAILED	10
+#define EXIT_PEER_AUTH_FAILED	11
+#define EXIT_IDLE_TIMEOUT	12
+#define EXIT_CONNECT_TIME	13
+#define EXIT_CALLBACK		14
+#define EXIT_PEER_DEAD		15
+#define EXIT_HANGUP		16
+#define EXIT_LOOPBACK		17
+#define EXIT_INIT_FAILED	18
+#define EXIT_AUTH_TOPEER_FAILED	19
+#ifdef MAXOCTETS
+#define EXIT_TRAFFIC_LIMIT	20
+#endif
+#define EXIT_CNID_AUTH_FAILED	21
+
+/*
+ * Debug macros.  Slightly useful for finding bugs in pppd, not particularly
+ * useful for finding out why your connection isn't being established.
+ */
+#ifdef DEBUGALL
+#define DEBUGMAIN	1
+#define DEBUGFSM	1
+#define DEBUGLCP	1
+#define DEBUGIPCP	1
+#define DEBUGIPV6CP	1
+#define DEBUGUPAP	1
+#define DEBUGCHAP	1
+#endif
+
+#ifndef LOG_PPP			/* we use LOG_LOCAL2 for syslog by default */
+#if defined(DEBUGMAIN) || defined(DEBUGFSM) || defined(DEBUGSYS) \
+  || defined(DEBUGLCP) || defined(DEBUGIPCP) || defined(DEBUGUPAP) \
+  || defined(DEBUGCHAP) || defined(DEBUG) || defined(DEBUGIPV6CP)
+#define LOG_PPP LOG_LOCAL2
+#else
+#define LOG_PPP LOG_DAEMON
+#endif
+#endif /* LOG_PPP */
+
+#ifdef DEBUGMAIN
+#define MAINDEBUG(x)	if (debug) dbglog x
+#else
+#define MAINDEBUG(x)
+#endif
+
+#ifdef DEBUGSYS
+#define SYSDEBUG(x)	if (debug) dbglog x
+#else
+#define SYSDEBUG(x)
+#endif
+
+#ifdef DEBUGFSM
+#define FSMDEBUG(x)	if (debug) dbglog x
+#else
+#define FSMDEBUG(x)
+#endif
+
+#ifdef DEBUGLCP
+#define LCPDEBUG(x)	if (debug) dbglog x
+#else
+#define LCPDEBUG(x)
+#endif
+
+#ifdef DEBUGIPCP
+#define IPCPDEBUG(x)	if (debug) dbglog x
+#else
+#define IPCPDEBUG(x)
+#endif
+
+#ifdef DEBUGIPV6CP
+#define IPV6CPDEBUG(x)  if (debug) dbglog x
+#else
+#define IPV6CPDEBUG(x)
+#endif
+
+#ifdef DEBUGUPAP
+#define UPAPDEBUG(x)	if (debug) dbglog x
+#else
+#define UPAPDEBUG(x)
+#endif
+
+#ifdef DEBUGCHAP
+#define CHAPDEBUG(x)	if (debug) dbglog x
+#else
+#define CHAPDEBUG(x)
+#endif
+
+#ifdef DEBUGIPXCP
+#define IPXCPDEBUG(x)	if (debug) dbglog x
+#else
+#define IPXCPDEBUG(x)
+#endif
+
+#ifndef SIGTYPE
+#if defined(sun) || defined(SYSV) || defined(POSIX_SOURCE)
+#define SIGTYPE void
+#else
+#define SIGTYPE int
+#endif /* defined(sun) || defined(SYSV) || defined(POSIX_SOURCE) */
+#endif /* SIGTYPE */
+
+#ifndef MIN
+#define MIN(a, b)	((a) < (b)? (a): (b))
+#endif
+#ifndef MAX
+#define MAX(a, b)	((a) > (b)? (a): (b))
+#endif
+
+#ifndef offsetof
+#define offsetof(type, member) ((size_t) &((type *)0)->member)
+#endif
+
+#endif /* __PPP_H__ */
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/pppdcapiplugin/userpass.c isdn4k-utils-v3.3/pppdcapiplugin/userpass.c
--- isdn4k-utils-v3.2p1/pppdcapiplugin/userpass.c	2002-01-29 16:39:21.000000000 +0000
+++ isdn4k-utils-v3.3/pppdcapiplugin/userpass.c	2003-05-19 06:57:22.000000000 +0000
@@ -1,6 +1,6 @@
 /*
  *
- * $Id: userpass.c,v 1.3 2001/11/07 14:38:17 calle Exp $
+ * $Id: userpass.c,v 1.4 2003/05/19 06:57:22 calle Exp $
  *
  * userpass.c - pppd plugin to provide username password
  *
@@ -12,6 +12,9 @@
  *  2 of the License, or (at your option) any later version.
  *
  * $Log: userpass.c,v $
+ * Revision 1.4  2003/05/19 06:57:22  calle
+ * Now with support for chap with pppd >= 2.4.2b3
+ *
  * Revision 1.3  2001/11/07 14:38:17  calle
  * show version info.
  *
@@ -34,13 +37,13 @@
 char pppd_version[] = VERSION;
 #endif
 
-static char *revision = "$Revision: 1.3 $";
+#define PPPVersion(v1,v2,v3,v4) ((v1)*1000000+(v2)*10000+(v3)*100+(v4))
+
+static char *revision = "$Revision: 1.4 $";
 
-static char username[MAXNAMELEN+1];
 static char password[MAXSECRETLEN+1];
 
 static option_t options[] = {
-{ "username", o_string, username, "username", OPT_STATIC, 0, MAXNAMELEN },
 { "password", o_string, password, "password", OPT_STATIC, 0, MAXSECRETLEN },
 { 0 }
 };
@@ -52,9 +55,8 @@
 	*to = 0;
 }
 
-static int userpass(char *user, char *passwd)
+static int getpass(char *user, char *passwd)
 {
-    if (username) copystr(user, username);
     if (passwd) copystr(passwd, password);
     return 1;
 }
@@ -63,5 +65,8 @@
 {
     info("userpass: %s", revision);
     add_options(options);
-    pap_passwd_hook = userpass;
+    pap_passwd_hook = getpass;
+#if PPPVER >= PPPVersion(2,4,2,3)
+    chap_passwd_hook = getpass;
+#endif
 }
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/rcapid/Makefile isdn4k-utils-v3.3/rcapid/Makefile
--- isdn4k-utils-v3.2p1/rcapid/Makefile	2002-07-19 21:59:29.000000000 +0000
+++ isdn4k-utils-v3.3/rcapid/Makefile	1970-01-01 00:00:00.000000000 +0000
@@ -1,367 +0,0 @@
-# Makefile.in generated automatically by automake 1.4 from Makefile.am
-
-# Copyright (C) 1994, 1995-8, 1999 Free Software Foundation, Inc.
-# This Makefile.in is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY, to the extent permitted by law; without
-# even the implied warranty of MERCHANTABILITY or FITNESS FOR A
-# PARTICULAR PURPOSE.
-
-
-SHELL = /bin/sh
-
-srcdir = .
-top_srcdir = .
-
-prefix = /usr
-exec_prefix = ${prefix}
-
-bindir = ${exec_prefix}/bin
-sbindir = ${exec_prefix}/sbin
-libexecdir = ${exec_prefix}/libexec
-datadir = ${prefix}/share
-sysconfdir = ${prefix}/etc
-sharedstatedir = ${prefix}/com
-localstatedir = ${prefix}/var
-libdir = ${exec_prefix}/lib
-infodir = ${prefix}/info
-mandir = ${prefix}/man
-includedir = ${prefix}/include
-oldincludedir = /usr/include
-
-DESTDIR =
-
-pkgdatadir = $(datadir)/rcapid
-pkglibdir = $(libdir)/rcapid
-pkgincludedir = $(includedir)/rcapid
-
-top_builddir = .
-
-ACLOCAL = aclocal-1.6
-AUTOCONF = autoconf
-AUTOMAKE = automake-1.6
-AUTOHEADER = autoheader
-
-INSTALL = /usr/bin/ginstall -c
-INSTALL_PROGRAM = ${INSTALL} $(AM_INSTALL_PROGRAM_FLAGS)
-INSTALL_DATA = ${INSTALL} -m 644
-INSTALL_SCRIPT = ${INSTALL}
-transform = s,x,x,
-
-NORMAL_INSTALL = :
-PRE_INSTALL = :
-POST_INSTALL = :
-NORMAL_UNINSTALL = :
-PRE_UNINSTALL = :
-POST_UNINSTALL = :
-CC = gcc
-CONFIG_MANDIR = /usr/man
-CONFIG_SBINDIR = /sbin
-CPP = gcc -E
-INSTALL = /usr/bin/ginstall -c
-MAKEINFO = makeinfo
-PACKAGE = rcapid
-VERSION = 1.2
-
-AUTOMAKE_OPTIONS = foreign
-CLEANFILES = *~ comperr
-MAINTAINERCLEANFILES = configure aclocal.m4 Makefile.in config.h.in 			  stamp-h.in comperr
-
-
-INCLUDES = -I../capi20 $(all_includes)
-CFLAGS = -Wall -O2
-LDFLAGS = -L../capi20/.libs -L../capi20 $(all_libraries)
-LDADD = -lcapi20
-
-sbin_PROGRAMS = rcapid
-
-rcapid_SOURCES = rcapid.c
-ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
-mkinstalldirs = $(SHELL) $(top_srcdir)/mkinstalldirs
-CONFIG_CLEAN_FILES = 
-PROGRAMS =  $(sbin_PROGRAMS)
-
-
-DEFS = -DPACKAGE_NAME=\"\" -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\" -DPACKAGE_BUGREPORT=\"\" -DPACKAGE=\"rcapid\" -DVERSION=\"1.2\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_FCNTL_H=1 -DHAVE_SYS_IOCTL_H=1 -DSTDC_HEADERS=1 -DRETSIGTYPE=void -DHAVE_SOCKET=1  -I. -I$(srcdir) 
-CPPFLAGS = 
-LIBS = 
-rcapid_OBJECTS =  rcapid.o
-rcapid_LDADD = $(LDADD)
-rcapid_DEPENDENCIES = 
-rcapid_LDFLAGS = 
-COMPILE = $(CC) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
-CCLD = $(CC)
-LINK = $(CCLD) $(AM_CFLAGS) $(CFLAGS) $(LDFLAGS) -o $@
-DIST_COMMON =  README Makefile.am Makefile.in acinclude.m4 aclocal.m4 \
-configure configure.in install-sh missing mkinstalldirs
-
-
-DISTFILES = $(DIST_COMMON) $(SOURCES) $(HEADERS) $(TEXINFOS) $(EXTRA_DIST)
-
-TAR = tar
-GZIP_ENV = --best
-DEP_FILES =  .deps/rcapid.P
-SOURCES = $(rcapid_SOURCES)
-OBJECTS = $(rcapid_OBJECTS)
-
-all: all-redirect
-.SUFFIXES:
-.SUFFIXES: .S .c .o .s
-$(srcdir)/Makefile.in: Makefile.am $(top_srcdir)/configure.in $(ACLOCAL_M4) 
-	cd $(top_srcdir) && $(AUTOMAKE) --foreign Makefile
-
-Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status $(BUILT_SOURCES)
-	cd $(top_builddir) \
-	  && CONFIG_FILES=$@ CONFIG_HEADERS= $(SHELL) ./config.status
-
-$(ACLOCAL_M4):  configure.in  acinclude.m4
-	cd $(srcdir) && $(ACLOCAL)
-
-config.status: $(srcdir)/configure $(CONFIG_STATUS_DEPENDENCIES)
-	$(SHELL) ./config.status --recheck
-$(srcdir)/configure: $(srcdir)/configure.in $(ACLOCAL_M4) $(CONFIGURE_DEPENDENCIES)
-	cd $(srcdir) && $(AUTOCONF)
-
-mostlyclean-sbinPROGRAMS:
-
-clean-sbinPROGRAMS:
-	-test -z "$(sbin_PROGRAMS)" || rm -f $(sbin_PROGRAMS)
-
-distclean-sbinPROGRAMS:
-
-maintainer-clean-sbinPROGRAMS:
-
-install-sbinPROGRAMS: $(sbin_PROGRAMS)
-	@$(NORMAL_INSTALL)
-	$(mkinstalldirs) $(DESTDIR)$(sbindir)
-	@list='$(sbin_PROGRAMS)'; for p in $$list; do \
-	  if test -f $$p; then \
-	    echo "  $(INSTALL_PROGRAM) $$p $(DESTDIR)$(sbindir)/`echo $$p|sed 's/$(EXEEXT)$$//'|sed '$(transform)'|sed 's/$$/$(EXEEXT)/'`"; \
-	     $(INSTALL_PROGRAM) $$p $(DESTDIR)$(sbindir)/`echo $$p|sed 's/$(EXEEXT)$$//'|sed '$(transform)'|sed 's/$$/$(EXEEXT)/'`; \
-	  else :; fi; \
-	done
-
-uninstall-sbinPROGRAMS:
-	@$(NORMAL_UNINSTALL)
-	list='$(sbin_PROGRAMS)'; for p in $$list; do \
-	  rm -f $(DESTDIR)$(sbindir)/`echo $$p|sed 's/$(EXEEXT)$$//'|sed '$(transform)'|sed 's/$$/$(EXEEXT)/'`; \
-	done
-
-.s.o:
-	$(COMPILE) -c $<
-
-.S.o:
-	$(COMPILE) -c $<
-
-mostlyclean-compile:
-	-rm -f *.o core *.core
-
-clean-compile:
-
-distclean-compile:
-	-rm -f *.tab.c
-
-maintainer-clean-compile:
-
-rcapid: $(rcapid_OBJECTS) $(rcapid_DEPENDENCIES)
-	@rm -f rcapid
-	$(LINK) $(rcapid_LDFLAGS) $(rcapid_OBJECTS) $(rcapid_LDADD) $(LIBS)
-
-tags: TAGS
-
-ID: $(HEADERS) $(SOURCES) $(LISP)
-	list='$(SOURCES) $(HEADERS)'; \
-	unique=`for i in $$list; do echo $$i; done | \
-	  awk '    { files[$$0] = 1; } \
-	       END { for (i in files) print i; }'`; \
-	here=`pwd` && cd $(srcdir) \
-	  && mkid -f$$here/ID $$unique $(LISP)
-
-TAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) $(LISP)
-	tags=; \
-	here=`pwd`; \
-	list='$(SOURCES) $(HEADERS)'; \
-	unique=`for i in $$list; do echo $$i; done | \
-	  awk '    { files[$$0] = 1; } \
-	       END { for (i in files) print i; }'`; \
-	test -z "$(ETAGS_ARGS)$$unique$(LISP)$$tags" \
-	  || (cd $(srcdir) && etags $(ETAGS_ARGS) $$tags  $$unique $(LISP) -o $$here/TAGS)
-
-mostlyclean-tags:
-
-clean-tags:
-
-distclean-tags:
-	-rm -f TAGS ID
-
-maintainer-clean-tags:
-
-distdir = $(PACKAGE)-$(VERSION)
-top_distdir = $(distdir)
-
-# This target untars the dist file and tries a VPATH configuration.  Then
-# it guarantees that the distribution is self-contained by making another
-# tarfile.
-distcheck: dist
-	-rm -rf $(distdir)
-	GZIP=$(GZIP_ENV) $(TAR) zxf $(distdir).tar.gz
-	mkdir $(distdir)/=build
-	mkdir $(distdir)/=inst
-	dc_install_base=`cd $(distdir)/=inst && pwd`; \
-	cd $(distdir)/=build \
-	  && ../configure --srcdir=.. --prefix=$$dc_install_base \
-	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
-	  && $(MAKE) $(AM_MAKEFLAGS) check \
-	  && $(MAKE) $(AM_MAKEFLAGS) install \
-	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
-	  && $(MAKE) $(AM_MAKEFLAGS) dist
-	-rm -rf $(distdir)
-	@banner="$(distdir).tar.gz is ready for distribution"; \
-	dashes=`echo "$$banner" | sed s/./=/g`; \
-	echo "$$dashes"; \
-	echo "$$banner"; \
-	echo "$$dashes"
-dist: distdir
-	-chmod -R a+r $(distdir)
-	GZIP=$(GZIP_ENV) $(TAR) chozf $(distdir).tar.gz $(distdir)
-	-rm -rf $(distdir)
-dist-all: distdir
-	-chmod -R a+r $(distdir)
-	GZIP=$(GZIP_ENV) $(TAR) chozf $(distdir).tar.gz $(distdir)
-	-rm -rf $(distdir)
-distdir: $(DISTFILES)
-	-rm -rf $(distdir)
-	mkdir $(distdir)
-	-chmod 777 $(distdir)
-	here=`cd $(top_builddir) && pwd`; \
-	top_distdir=`cd $(distdir) && pwd`; \
-	distdir=`cd $(distdir) && pwd`; \
-	cd $(top_srcdir) \
-	  && $(AUTOMAKE) --include-deps --build-dir=$$here --srcdir-name=$(top_srcdir) --output-dir=$$top_distdir --foreign Makefile
-	@for file in $(DISTFILES); do \
-	  d=$(srcdir); \
-	  if test -d $$d/$$file; then \
-	    cp -pr $$d/$$file $(distdir)/$$file; \
-	  else \
-	    test -f $(distdir)/$$file \
-	    || ln $$d/$$file $(distdir)/$$file 2> /dev/null \
-	    || cp -p $$d/$$file $(distdir)/$$file || :; \
-	  fi; \
-	done
-
-DEPS_MAGIC := $(shell mkdir .deps > /dev/null 2>&1 || :)
-
--include $(DEP_FILES)
-
-mostlyclean-depend:
-
-clean-depend:
-
-distclean-depend:
-	-rm -rf .deps
-
-maintainer-clean-depend:
-
-%.o: %.c
-	@echo '$(COMPILE) -c $<'; \
-	$(COMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
-	@-cp .deps/$(*F).pp .deps/$(*F).P; \
-	tr ' ' '\012' < .deps/$(*F).pp \
-	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
-	    >> .deps/$(*F).P; \
-	rm .deps/$(*F).pp
-
-%.lo: %.c
-	@echo '$(LTCOMPILE) -c $<'; \
-	$(LTCOMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
-	@-sed -e 's/^\([^:]*\)\.o[ 	]*:/\1.lo \1.o :/' \
-	  < .deps/$(*F).pp > .deps/$(*F).P; \
-	tr ' ' '\012' < .deps/$(*F).pp \
-	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
-	    >> .deps/$(*F).P; \
-	rm -f .deps/$(*F).pp
-info-am:
-info: info-am
-dvi-am:
-dvi: dvi-am
-check-am: all-am
-check: check-am
-installcheck-am:
-installcheck: installcheck-am
-install-exec-am: install-sbinPROGRAMS
-install-exec: install-exec-am
-
-install-data-am:
-install-data: install-data-am
-
-install-am: all-am
-	@$(MAKE) $(AM_MAKEFLAGS) install-exec-am install-data-am
-install: install-am
-uninstall-am: uninstall-sbinPROGRAMS
-uninstall: uninstall-am
-all-am: Makefile $(PROGRAMS)
-all-redirect: all-am
-install-strip:
-	$(MAKE) $(AM_MAKEFLAGS) AM_INSTALL_PROGRAM_FLAGS=-s install
-installdirs:
-	$(mkinstalldirs)  $(DESTDIR)$(sbindir)
-
-
-mostlyclean-generic:
-
-clean-generic:
-	-test -z "$(CLEANFILES)" || rm -f $(CLEANFILES)
-
-distclean-generic:
-	-rm -f Makefile $(CONFIG_CLEAN_FILES)
-	-rm -f config.cache config.log stamp-h stamp-h[0-9]*
-
-maintainer-clean-generic:
-	-test -z "$(MAINTAINERCLEANFILES)" || rm -f $(MAINTAINERCLEANFILES)
-mostlyclean-am:  mostlyclean-sbinPROGRAMS mostlyclean-compile \
-		mostlyclean-tags mostlyclean-depend mostlyclean-generic
-
-mostlyclean: mostlyclean-am
-
-clean-am:  clean-sbinPROGRAMS clean-compile clean-tags clean-depend \
-		clean-generic mostlyclean-am
-
-clean: clean-am
-
-distclean-am:  distclean-sbinPROGRAMS distclean-compile distclean-tags \
-		distclean-depend distclean-generic clean-am
-
-distclean: distclean-am
-	-rm -f config.status
-
-maintainer-clean-am:  maintainer-clean-sbinPROGRAMS \
-		maintainer-clean-compile maintainer-clean-tags \
-		maintainer-clean-depend maintainer-clean-generic \
-		distclean-am
-	@echo "This command is intended for maintainers to use;"
-	@echo "it deletes files that may require special tools to rebuild."
-
-maintainer-clean: maintainer-clean-am
-	-rm -f config.status
-
-.PHONY: mostlyclean-sbinPROGRAMS distclean-sbinPROGRAMS \
-clean-sbinPROGRAMS maintainer-clean-sbinPROGRAMS uninstall-sbinPROGRAMS \
-install-sbinPROGRAMS mostlyclean-compile distclean-compile \
-clean-compile maintainer-clean-compile tags mostlyclean-tags \
-distclean-tags clean-tags maintainer-clean-tags distdir \
-mostlyclean-depend distclean-depend clean-depend \
-maintainer-clean-depend info-am info dvi-am dvi check check-am \
-installcheck-am installcheck install-exec-am install-exec \
-install-data-am install-data install-am install uninstall-am uninstall \
-all-redirect all-am all installdirs mostlyclean-generic \
-distclean-generic clean-generic maintainer-clean-generic clean \
-mostlyclean distclean maintainer-clean
-
-
-# Tell versions [3.59,3.63) of GNU make to not export all variables.
-# Otherwise a system limit (for SysV at least) may be exceeded.
-.NOEXPORT:
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/vbox/doc/autovbox.man isdn4k-utils-v3.3/vbox/doc/autovbox.man
--- isdn4k-utils-v3.2p1/vbox/doc/autovbox.man	2000-10-05 20:46:03.000000000 +0000
+++ isdn4k-utils-v3.3/vbox/doc/autovbox.man	2002-10-15 14:47:11.000000000 +0000
@@ -1,14 +1,13 @@
-.\" $Id: autovbox.man,v 1.3 2000/09/15 09:10:10 paul Exp $
-.\" CHECKIN $Date: 2000/09/15 09:10:10 $
+.\" $Id: autovbox.man,v 1.5 2002/10/15 14:47:11 paul Exp $
+.\" CHECKIN $Date: 2002/10/15 14:47:11 $
 .TH autovbox 1 "@MANDATE@" "ISDN 4 Linux @I4LVERSION@" "Linux System Administration"
 .SH NAME
-autovbox \- isdn voice box (sound converter)
+autovbox \- ISDN voice box (sound converter)
 .SH SYNOPSIS
-.B autovbox
-.I "[OPTION] [OPTION] [...] < IN-FILE > OUT-FILE"
+autovbox [-2 | -3 | -4 | -h | -v] [-n name] [-p phone] [-l location]
 .SH "DESCRIPTION"
-Convert au files (sun audio format) into vbox files (vbox audio header).
-autovbox is a link to vboxcnvt.
+Convert .au files (Sun audio format) on standard input into vbox files
+(vbox audio header) on standard output. autovbox is a link to vboxcnvt(1).
 .SH OPTIONS
 Autovbox reads from stdin and writes to stdout.
 .TP
@@ -24,13 +23,13 @@
 .B \-u, \-\-ulaw
 Convert to ulaw format (default).
 .TP
-.B \-n, \-\-name NAME
+.B \-n NAME, \-\-name NAME
 Name to write into the header.
 .TP
 .B \-p, \-\-phone PHONE
 Telephone number to write into the header.
 .TP
-.B \-l, \-\-location LOCATION
+.B \-l LOCATION, \-\-location LOCATION
 City to write into the header.
 .TP
 .B \-h, \-\-help
@@ -39,7 +38,13 @@
 .B \-v, \-\-version
 Show version of program.
 .SH SEE ALSO
-.B rmdtovbox(1), vboxtoau(1), vboxmode(1), vboxcnvt(1), vbox(5)
+.IR rmdtovbox (1),
+.IR vboxtoau (1),
+.IR vboxmode (1),
+.IR vboxcnvt (1),
+.IR vbox (5).
 .SH AUTHOR
 This manual page was written by Andreas Jellinghaus <aj@dungeon.inka.de>,
 for Debian GNU/Linux and isdn4linux.
+.br
+Now maintained by Paul Slootman <paul@debian.org>.
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/vbox/doc/vboxctrl.man isdn4k-utils-v3.3/vbox/doc/vboxctrl.man
--- isdn4k-utils-v3.2p1/vbox/doc/vboxctrl.man	1998-12-02 16:54:25.000000000 +0000
+++ isdn4k-utils-v3.3/vbox/doc/vboxctrl.man	2002-10-15 14:46:42.000000000 +0000
@@ -1,5 +1,5 @@
-.\" $Id: vboxctrl.man,v 1.2 1998/12/02 16:54:25 paul Exp $
-.\" CHECKIN $Date: 1998/12/02 16:54:25 $
+.\" $Id: vboxctrl.man,v 1.3 2002/10/15 14:46:42 paul Exp $
+.\" CHECKIN $Date: 2002/10/15 14:46:42 $
 .TH vboxctrl 1 "@MANDATE@" "ISDN 4 Linux @I4LVERSION@" "Linux System Administration"
 
 .SH NAME
@@ -44,8 +44,7 @@
 .TP
 .I "\-h, \-\-help"
 Displays a usage message.
-.TE
-.br
+.PP
 The spool directory is taken from one of the following:
 .TP
 .I 1
@@ -53,9 +52,9 @@
 .TP
 .I 2
 The value of the environment variable VBOXSPOOL, if set.
+.TP
 .I 3
 The directory of the command line option "--spooldir".
-.TE
 
 .SH SEE ALSO
 .B vbox(1), vboxd(8)
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/vbox/doc/vboxgetty.conf.man isdn4k-utils-v3.3/vbox/doc/vboxgetty.conf.man
--- isdn4k-utils-v3.2p1/vbox/doc/vboxgetty.conf.man	2000-10-05 20:46:03.000000000 +0000
+++ isdn4k-utils-v3.3/vbox/doc/vboxgetty.conf.man	2003-03-11 13:05:18.000000000 +0000
@@ -1,5 +1,5 @@
-.\" $Id: vboxgetty.conf.man,v 1.3 2000/09/15 09:19:50 paul Exp $
-.\" CHECKIN $Date: 2000/09/15 09:19:50 $
+.\" $Id: vboxgetty.conf.man,v 1.4 2003/03/11 13:05:18 paul Exp $
+.\" CHECKIN $Date: 2003/03/11 13:05:18 $
 .TH vboxgetty.conf 5 "@MANDATE@" "ISDN 4 Linux @I4LVERSION@" "Linux System Administration"
 .PD 0
 .SH NAME
@@ -99,6 +99,13 @@
 Number of bytes that must be available on the partition with the spool
 directory, so that a call may be taken. Default is 0.
 
+.TP
+.B debuglevel <string>
+What messages are be written to @LOGFILEDIR@/vboxgetty-<device>.log.
+The string consists of letters representing the severities of the messages
+to log (F=FATAL, E=ERROR, W=WARNING, I=INFO, D=DEBUG, J=JUNK).  Default
+is FEWI.
+
 .SH FILES
 .TP
 .B @I4LCONFDIR@/vboxgetty.conf
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/vbox/src/libvbox.c isdn4k-utils-v3.3/vbox/src/libvbox.c
--- isdn4k-utils-v3.2p1/vbox/src/libvbox.c	2001-06-21 16:34:57.000000000 +0000
+++ isdn4k-utils-v3.3/vbox/src/libvbox.c	2003-02-24 17:27:32.000000000 +0000
@@ -1,5 +1,5 @@
 /*
-** $Id: libvbox.c,v 1.12 2001/03/01 14:59:16 paul Exp $
+** $Id: libvbox.c,v 1.13 2003/02/24 17:27:32 keil Exp $
 **
 ** Copyright (C) 1996, 1997 Michael 'Ghandi' Herold
 */
@@ -198,7 +198,7 @@
 	fd_set         rmask;
 	char          *stop;
 	int            p;
-	int            c;
+	char           c;
 	int            rc;
 
 	*vboxd_message = '\0';
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/xisdnload/xisdnload.c isdn4k-utils-v3.3/xisdnload/xisdnload.c
--- isdn4k-utils-v3.2p1/xisdnload/xisdnload.c	2002-07-18 00:00:27.000000000 +0000
+++ isdn4k-utils-v3.3/xisdnload/xisdnload.c	2003-03-11 14:12:30.000000000 +0000
@@ -71,6 +71,7 @@
 
 typedef struct _XISDNLoadResources {
   Boolean show_label;
+  Boolean manual_mode;
   char *online_color;
   char *active_color;
   char *trying_color;
@@ -97,6 +98,7 @@
  {"-online",		"*onlineColor",         XrmoptionSepArg,	NULL},
  {"-trying",		"*tryingColor",         XrmoptionSepArg,	NULL},
  {"-active",		"*activeColor",         XrmoptionSepArg,	NULL},
+ {"-manual",            "*ManualMode",          XrmoptionNoArg,       "True"},
  {"-activate",		"*activate",		XrmoptionSepArg,	NULL},
  {"-deactivate",	"*deactivate",		XrmoptionSepArg,	NULL},
 #ifdef REGEX_NUMBER
@@ -114,6 +116,8 @@
 static XtResource my_resources[] = {
   {"showLabel", XtCBoolean, XtRBoolean, sizeof(Boolean),
      Offset(show_label), XtRImmediate, (XtPointer) TRUE},
+  {"ManualMode", XtCBoolean, XtRBoolean, sizeof(Boolean),
+     Offset(manual_mode), XtRImmediate, (XtPointer) FALSE},
   {"onlineColor", "OnlineColor", XtRString, sizeof(char *),
      Offset(online_color), XtRString, NULL},
   {"activeColor", "ActiveColor", XtRString, sizeof(char *),
@@ -201,6 +205,8 @@
       "    -activate string        exec this to activate demand dialing\n");
     fprintf (stderr,
       "    -deactivate string      exec this to deactivate demand dialing\n");
+    fprintf (stderr,
+      "    -manual                 manual dialing mode\n");
 #ifdef REGEX_NUMBER
     fprintf (stderr,
       "    -number string          regexp to match against number to watch\n");
@@ -439,7 +445,9 @@
 void ToggleActive(Widget w, XtPointer p, XEvent *e, Boolean *c)
 {
   if (e->type == ButtonPress) {
-    if (get_active()) {
+    if (!resources.manual_mode 
+	  ? get_active()
+          : (trying_last > 0 || online_last > 0)) { 
       system(resources.deactivate);
     } else {
       system(resources.activate);
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/xisdnload/xisdnload.man isdn4k-utils-v3.3/xisdnload/xisdnload.man
--- isdn4k-utils-v3.2p1/xisdnload/xisdnload.man	1998-03-08 18:54:07.000000000 +0000
+++ isdn4k-utils-v3.3/xisdnload/xisdnload.man	2003-03-11 14:12:30.000000000 +0000
@@ -75,6 +75,13 @@
 `sudo /etc/init.d/isdn stop' to shut down your connection.
 .PP
 .TP 8
+.B \-manual
+With this option the interface is assumed to be active and in manual dial
+mode.  The activate/deactive commands are selected depending on the
+connection state.  A typical activate command might be `isdnctrl dial
+ippp0', and to deactivate `isdnctrl hangup ippp0'.
+.PP
+.TP 8
 .B \-number \fIregexp\fP
 The supplied regular expression is used to limit the set numbers
 to be observed by \fIxisdnload\fP.
diff -Naurd -x .svn -x CVS isdn4k-utils-v3.2p1/xmonisdn/Net.c isdn4k-utils-v3.3/xmonisdn/Net.c
--- isdn4k-utils-v3.2p1/xmonisdn/Net.c	2000-10-05 20:46:04.000000000 +0000
+++ isdn4k-utils-v3.3/xmonisdn/Net.c	2003-03-11 14:15:02.000000000 +0000
@@ -279,7 +279,7 @@
     NetstatWidget w = (NetstatWidget) gw;
 
     
-    if ((w->netstat.state <= 1) && (!updownwait)) {
+    if ((w->netstat.state <= 2) && (!updownwait)) {
       w->netstat.state = 5;
       updownwait = 150 / w->netstat.update;
       if (updownwait < 2)
